<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ValueSep.Ledger</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------</a>
<a id="44" class="Comment">-- ** Denotational &amp; operational semantics</a>

<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="112" class="Symbol">;</a> <a id="114" class="Keyword">open</a> <a id="119" href="Prelude.Init.html#397" class="Module">SetAsType</a>
<a id="129" class="Keyword">open</a> <a id="134" class="Keyword">import</a> <a id="141" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="183" class="Keyword">open</a> <a id="188" class="Keyword">import</a> <a id="195" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="237" class="Keyword">open</a> <a id="242" class="Keyword">import</a> <a id="249" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="414" class="Keyword">module</a> <a id="421" href="ValueSep.Ledger.html" class="Module">ValueSep.Ledger</a>
  <a id="439" class="Symbol">(</a><a id="440" href="ValueSep.Ledger.html#440" class="Bound">Part</a> <a id="445" class="Symbol">:</a> <a id="447" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="451" class="Symbol">)</a> <a id="453" class="Comment">-- a fixed set of participants</a>
  <a id="486" class="Symbol">⦃</a> <a id="488" href="ValueSep.Ledger.html#488" class="Bound">_</a> <a id="490" class="Symbol">:</a> <a id="492" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="498" href="ValueSep.Ledger.html#440" class="Bound">Part</a> <a id="503" class="Symbol">⦄</a>
  <a id="507" class="Keyword">where</a>

<a id="514" class="Keyword">variable</a>
  <a id="525" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="527" href="ValueSep.Ledger.html#527" class="Generalizable">B</a> <a id="529" href="ValueSep.Ledger.html#529" class="Generalizable">C</a> <a id="531" href="ValueSep.Ledger.html#531" class="Generalizable">D</a> <a id="533" class="Symbol">:</a> <a id="535" href="ValueSep.Ledger.html#440" class="Bound">Part</a>
  <a id="542" href="ValueSep.Ledger.html#542" class="Generalizable">v</a> <a id="544" href="ValueSep.Ledger.html#544" class="Generalizable">v′</a> <a id="547" href="ValueSep.Ledger.html#547" class="Generalizable">v″</a> <a id="550" class="Symbol">:</a> <a id="552" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="555" class="Keyword">open</a> <a id="560" class="Keyword">import</a> <a id="567" href="ValueSep.Maps.html" class="Module">ValueSep.Maps</a>

<a id="582" class="Comment">-- The state of a ledger is a collection of participants, along with their balance.</a>
<a id="S"></a><a id="666" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="668" class="Symbol">:</a> <a id="670" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="675" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="677" class="Symbol">=</a> <a id="679" href="ValueSep.Maps.html#441" class="Function">Map⟨</a> <a id="684" href="ValueSep.Ledger.html#440" class="Bound">Part</a> <a id="689" href="ValueSep.Maps.html#441" class="Function">↦</a> <a id="691" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="693" href="ValueSep.Maps.html#441" class="Function">⟩</a>

<a id="696" class="Keyword">instance</a>
  <a id="Sℕ"></a><a id="707" href="ValueSep.Ledger.html#707" class="Function">Sℕ</a>  <a id="711" class="Symbol">=</a> <a id="713" href="Prelude.Semigroup.html#2765" class="Function">Semigroup-ℕ-+</a>
  <a id="Sℕ⁺"></a><a id="729" href="ValueSep.Ledger.html#729" class="Function">Sℕ⁺</a> <a id="733" class="Symbol">=</a> <a id="735" href="Prelude.Semigroup.html#3058" class="Function">SemigroupLaws-ℕ-+</a>
  <a id="Mℕ"></a><a id="755" href="ValueSep.Ledger.html#755" class="Function">Mℕ</a>  <a id="759" class="Symbol">=</a> <a id="761" href="Prelude.Monoid.html#1892" class="Function">Monoid-ℕ-+</a>
  <a id="Mℕ⁺"></a><a id="774" href="ValueSep.Ledger.html#774" class="Function">Mℕ⁺</a> <a id="778" class="Symbol">=</a> <a id="780" href="Prelude.Monoid.html#1970" class="Function">MonoidLaws-ℕ-+</a>

<a id="796" class="Comment">-- A transaction is transferring money from one participant to another.</a>
<a id="868" class="Keyword">record</a> <a id="Tx"></a><a id="875" href="ValueSep.Ledger.html#875" class="Record">Tx</a> <a id="878" class="Symbol">:</a> <a id="880" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="885" class="Keyword">where</a>
  <a id="893" class="Keyword">constructor</a> <a id="_—→⟨_⟩_"></a><a id="905" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">_—→⟨_⟩_</a>
  <a id="915" class="Keyword">field</a>
    <a id="Tx.sender"></a><a id="925" href="ValueSep.Ledger.html#925" class="Field">sender</a>   <a id="934" class="Symbol">:</a> <a id="936" href="ValueSep.Ledger.html#440" class="Bound">Part</a>
    <a id="Tx.value"></a><a id="945" href="ValueSep.Ledger.html#945" class="Field">value</a>    <a id="954" class="Symbol">:</a> <a id="956" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Tx.receiver"></a><a id="962" href="ValueSep.Ledger.html#962" class="Field">receiver</a> <a id="971" class="Symbol">:</a> <a id="973" href="ValueSep.Ledger.html#440" class="Bound">Part</a>
<a id="978" class="Keyword">open</a> <a id="983" href="ValueSep.Ledger.html#875" class="Module">Tx</a> <a id="986" class="Keyword">public</a>
<a id="993" class="Keyword">unquoteDecl</a> <a id="DecEq-Tx"></a><a id="1005" href="ValueSep.Ledger.html#1005" class="Function">DecEq-Tx</a> <a id="1014" class="Symbol">=</a> <a id="1016" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="1023" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="1029" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1031" class="Keyword">quote</a> <a id="1037" href="ValueSep.Ledger.html#875" class="Record">Tx</a> <a id="1040" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1042" href="ValueSep.Ledger.html#1005" class="Function">DecEq-Tx</a> <a id="1051" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="1054" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="1093" href="ValueSep.Ledger.html#1093" class="Function">L</a> <a id="1095" class="Symbol">=</a> <a id="1097" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1102" href="ValueSep.Ledger.html#875" class="Record">Tx</a>

<a id="1106" class="Keyword">variable</a>
  <a id="1117" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="1119" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a> <a id="1122" href="ValueSep.Ledger.html#1122" class="Generalizable">s″</a> <a id="1125" href="ValueSep.Ledger.html#1125" class="Generalizable">s₁</a> <a id="1128" href="ValueSep.Ledger.html#1128" class="Generalizable">s₁′</a> <a id="1132" href="ValueSep.Ledger.html#1132" class="Generalizable">s₁″</a> <a id="1136" href="ValueSep.Ledger.html#1136" class="Generalizable">s₂</a> <a id="1139" href="ValueSep.Ledger.html#1139" class="Generalizable">s₂′</a> <a id="1143" href="ValueSep.Ledger.html#1143" class="Generalizable">s₂″</a> <a id="1147" href="ValueSep.Ledger.html#1147" class="Generalizable">s₃</a> <a id="1150" href="ValueSep.Ledger.html#1150" class="Generalizable">s₃′</a> <a id="1154" href="ValueSep.Ledger.html#1154" class="Generalizable">s₃″</a> <a id="1158" href="ValueSep.Ledger.html#1158" class="Generalizable">s₂₃</a> <a id="1162" href="ValueSep.Ledger.html#1162" class="Generalizable">s₂₃′</a> <a id="1167" href="ValueSep.Ledger.html#1167" class="Generalizable">s₂₃″</a> <a id="1172" class="Symbol">:</a> <a id="1174" href="ValueSep.Ledger.html#666" class="Function">S</a>
  <a id="1178" href="ValueSep.Ledger.html#1178" class="Generalizable">t</a> <a id="1180" href="ValueSep.Ledger.html#1180" class="Generalizable">t′</a> <a id="1183" href="ValueSep.Ledger.html#1183" class="Generalizable">t″</a> <a id="1186" class="Symbol">:</a> <a id="1188" href="ValueSep.Ledger.html#875" class="Record">Tx</a>
  <a id="1193" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="1195" href="ValueSep.Ledger.html#1195" class="Generalizable">l′</a> <a id="1198" href="ValueSep.Ledger.html#1198" class="Generalizable">l″</a> <a id="1201" href="ValueSep.Ledger.html#1201" class="Generalizable">l₁</a> <a id="1204" href="ValueSep.Ledger.html#1204" class="Generalizable">l₂</a> <a id="1207" class="Symbol">:</a> <a id="1209" href="ValueSep.Ledger.html#1093" class="Function">L</a>
  <a id="1213" href="ValueSep.Ledger.html#1213" class="Generalizable">ls</a> <a id="1216" href="ValueSep.Ledger.html#1216" class="Generalizable">ls′</a> <a id="1220" href="ValueSep.Ledger.html#1220" class="Generalizable">ls″</a> <a id="1224" class="Symbol">:</a> <a id="1226" href="ValueSep.Ledger.html#1093" class="Function">L</a> <a id="1228" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1230" href="ValueSep.Ledger.html#666" class="Function">S</a>

  <a id="1235" href="ValueSep.Ledger.html#1235" class="Generalizable">ms</a> <a id="1238" href="ValueSep.Ledger.html#1238" class="Generalizable">ms′</a> <a id="1242" href="ValueSep.Ledger.html#1242" class="Generalizable">ms″</a> <a id="1246" class="Symbol">:</a> <a id="1248" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1254" href="ValueSep.Ledger.html#666" class="Function">S</a>
  <a id="1258" href="ValueSep.Ledger.html#1258" class="Generalizable">mls</a> <a id="1262" href="ValueSep.Ledger.html#1262" class="Generalizable">mls′</a> <a id="1267" href="ValueSep.Ledger.html#1267" class="Generalizable">mls″</a> <a id="1272" class="Symbol">:</a> <a id="1274" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1280" class="Symbol">(</a><a id="1281" href="ValueSep.Ledger.html#1093" class="Function">L</a> <a id="1283" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1285" href="ValueSep.Ledger.html#666" class="Function">S</a><a id="1286" class="Symbol">)</a>

<a id="1289" class="Comment">-- ** Denotational semantics</a>

<a id="1319" class="Comment">-- The meaning of a transaction or a whole ledger will be denoted by state transformers,</a>
<a id="1408" class="Comment">-- i.e. a function from the current state to the updated one that may produce an error.</a>
<a id="Domain"></a><a id="1496" href="ValueSep.Ledger.html#1496" class="Function">Domain</a> <a id="1503" class="Symbol">=</a> <a id="1505" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="1507" class="Symbol">→</a> <a id="1509" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1515" href="ValueSep.Ledger.html#666" class="Function">S</a>

<a id="1518" class="Keyword">record</a> <a id="Denotable"></a><a id="1525" href="ValueSep.Ledger.html#1525" class="Record">Denotable</a> <a id="1535" class="Symbol">(</a><a id="1536" href="ValueSep.Ledger.html#1536" class="Bound">A</a> <a id="1538" class="Symbol">:</a> <a id="1540" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="1544" class="Symbol">)</a> <a id="1546" class="Symbol">:</a> <a id="1548" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1553" class="Keyword">where</a>
  <a id="1561" class="Keyword">field</a> <a id="Denotable.⟦_⟧"></a><a id="1567" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦_⟧</a> <a id="1571" class="Symbol">:</a> <a id="1573" href="ValueSep.Ledger.html#1536" class="Bound">A</a> <a id="1575" class="Symbol">→</a> <a id="1577" href="ValueSep.Ledger.html#1496" class="Function">Domain</a>
<a id="1584" class="Keyword">open</a> <a id="1589" href="ValueSep.Ledger.html#1525" class="Module">Denotable</a> <a id="1599" class="Symbol">⦃...⦄</a> <a id="1605" class="Keyword">public</a>

<a id="1613" class="Comment">-- pure fragment without error-handling</a>
<a id="Domain₀"></a><a id="1653" href="ValueSep.Ledger.html#1653" class="Function">Domain₀</a> <a id="1661" class="Symbol">=</a> <a id="1663" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="1665" class="Symbol">→</a> <a id="1667" href="ValueSep.Ledger.html#666" class="Function">S</a>

<a id="1670" class="Keyword">record</a> <a id="Denotable₀"></a><a id="1677" href="ValueSep.Ledger.html#1677" class="Record">Denotable₀</a> <a id="1688" class="Symbol">(</a><a id="1689" href="ValueSep.Ledger.html#1689" class="Bound">A</a> <a id="1691" class="Symbol">:</a> <a id="1693" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="1697" class="Symbol">)</a> <a id="1699" class="Symbol">:</a> <a id="1701" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1706" class="Keyword">where</a>
  <a id="1714" class="Keyword">field</a> <a id="Denotable₀.⟦_⟧₀"></a><a id="1720" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦_⟧₀</a> <a id="1725" class="Symbol">:</a> <a id="1727" href="ValueSep.Ledger.html#1689" class="Bound">A</a> <a id="1729" class="Symbol">→</a> <a id="1731" href="ValueSep.Ledger.html#1653" class="Function">Domain₀</a>
<a id="1739" class="Keyword">open</a> <a id="1744" href="ValueSep.Ledger.html#1677" class="Module">Denotable₀</a> <a id="1755" class="Symbol">⦃...⦄</a> <a id="1761" class="Keyword">public</a>

<a id="IsValidTx"></a><a id="1769" href="ValueSep.Ledger.html#1769" class="Function">IsValidTx</a> <a id="1779" class="Symbol">:</a> <a id="1781" href="ValueSep.Ledger.html#875" class="Record">Tx</a> <a id="1784" class="Symbol">→</a> <a id="1786" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="1788" class="Symbol">→</a> <a id="1790" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="1795" href="ValueSep.Ledger.html#1769" class="Function">IsValidTx</a> <a id="1805" class="Symbol">(</a><a id="1806" href="ValueSep.Ledger.html#1806" class="Bound">A</a> <a id="1808" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="1812" href="ValueSep.Ledger.html#1812" class="Bound">v</a> <a id="1814" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="1816" href="ValueSep.Ledger.html#1816" class="Bound">B</a><a id="1817" class="Symbol">)</a> <a id="1819" href="ValueSep.Ledger.html#1819" class="Bound">s</a> <a id="1821" class="Symbol">=</a>
  <a id="1825" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="1830" class="Symbol">(</a><a id="1831" href="ValueSep.Ledger.html#1819" class="Bound">s</a> <a id="1833" href="ValueSep.Ledger.html#1806" class="Bound">A</a> <a id="1835" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1837" href="ValueSep.Ledger.html#1819" class="Bound">s</a> <a id="1839" href="ValueSep.Ledger.html#1816" class="Bound">B</a><a id="1840" class="Symbol">)</a> <a id="1842" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="1845" class="Symbol">λ</a> <a id="1847" class="Keyword">where</a>
    <a id="1857" class="Symbol">(</a><a id="1858" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1863" href="ValueSep.Ledger.html#1863" class="Bound">vᵃ</a> <a id="1866" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1868" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1873" class="Symbol">_)</a> <a id="1876" class="Symbol">→</a> <a id="1878" href="ValueSep.Ledger.html#1812" class="Bound">v</a> <a id="1880" href="Prelude.Ord.Core.html#416" class="Field Operator">≤</a> <a id="1882" href="ValueSep.Ledger.html#1863" class="Bound">vᵃ</a>
    <a id="1889" class="CatchallClause Symbol">(_</a><a id="1891" class="CatchallClause"> </a><a id="1892" href="Agda.Builtin.Sigma.html#236" class="CatchallClause InductiveConstructor Operator">,</a><a id="1893" class="CatchallClause"> </a><a id="1894" class="CatchallClause Symbol">_)</a> <a id="1897" class="Symbol">→</a> <a id="1899" href="Data.Empty.html#526" class="Datatype">⊥</a>

<a id="1902" class="Keyword">data</a> <a id="IsValidTx′"></a><a id="1907" href="ValueSep.Ledger.html#1907" class="Datatype">IsValidTx′</a> <a id="1918" class="Symbol">:</a> <a id="1920" href="ValueSep.Ledger.html#875" class="Record">Tx</a> <a id="1923" class="Symbol">→</a> <a id="1925" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="1927" class="Symbol">→</a> <a id="1929" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1934" class="Keyword">where</a>

  <a id="IsValidTx′.mkValid"></a><a id="1943" href="ValueSep.Ledger.html#1943" class="InductiveConstructor">mkValid</a> <a id="1951" class="Symbol">:</a> <a id="1953" class="Symbol">∀</a> <a id="1955" class="Symbol">{</a><a id="1956" href="ValueSep.Ledger.html#1956" class="Bound">vᵃ</a><a id="1958" class="Symbol">}</a> <a id="1960" class="Symbol">→</a>

    <a id="1967" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="1969" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="1971" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="1973" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1975" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1980" href="ValueSep.Ledger.html#1956" class="Bound">vᵃ</a>
    <a id="1987" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="1989" href="Data.Maybe.html#801" class="Function">Is-just</a> <a id="1997" class="Symbol">(</a><a id="1998" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="2000" href="ValueSep.Ledger.html#527" class="Generalizable">B</a><a id="2001" class="Symbol">)</a>
    <a id="2007" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="2009" href="ValueSep.Ledger.html#542" class="Generalizable">v</a> <a id="2011" href="Prelude.Ord.Core.html#416" class="Field Operator">≤</a> <a id="2013" href="ValueSep.Ledger.html#1956" class="Bound">vᵃ</a>
      <a id="2022" href="Prelude.InferenceRules.html#13944" class="Function Operator">──────────────────────────</a>
      <a id="2055" href="ValueSep.Ledger.html#1907" class="Datatype">IsValidTx′</a> <a id="2066" class="Symbol">(</a><a id="2067" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="2069" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="2073" href="ValueSep.Ledger.html#542" class="Generalizable">v</a> <a id="2075" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="2077" href="ValueSep.Ledger.html#527" class="Generalizable">B</a><a id="2078" class="Symbol">)</a> <a id="2080" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a>

<a id="isValidTx?"></a><a id="2083" href="ValueSep.Ledger.html#2083" class="Function">isValidTx?</a> <a id="2094" class="Symbol">:</a> <a id="2096" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable²</a> <a id="2107" href="ValueSep.Ledger.html#1769" class="Function">IsValidTx</a>
<a id="2117" href="ValueSep.Ledger.html#2083" class="Function">isValidTx?</a> <a id="2128" href="ValueSep.Ledger.html#2128" class="Bound">t</a><a id="2129" class="Symbol">@(</a><a id="2131" href="ValueSep.Ledger.html#2131" class="Bound">A</a> <a id="2133" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="2137" href="ValueSep.Ledger.html#2137" class="Bound">v</a> <a id="2139" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="2141" href="ValueSep.Ledger.html#2141" class="Bound">B</a><a id="2142" class="Symbol">)</a> <a id="2144" href="ValueSep.Ledger.html#2144" class="Bound">s</a>
  <a id="2148" class="Keyword">with</a> <a id="2153" href="ValueSep.Ledger.html#2144" class="Bound">s</a> <a id="2155" href="ValueSep.Ledger.html#2131" class="Bound">A</a> <a id="2157" class="Symbol">|</a> <a id="2159" href="ValueSep.Ledger.html#2144" class="Bound">s</a> <a id="2161" href="ValueSep.Ledger.html#2141" class="Bound">B</a>
<a id="2163" class="Symbol">...</a> <a id="2167" class="Symbol">|</a> <a id="2169" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="2177" class="Symbol">|</a> <a id="2179" class="Symbol">_</a>       <a id="2187" class="Symbol">=</a> <a id="2189" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2192" class="Symbol">λ</a> <a id="2194" class="Symbol">()</a>
<a id="2197" class="Symbol">...</a> <a id="2201" class="Symbol">|</a> <a id="2203" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2208" class="Symbol">_</a>  <a id="2211" class="Symbol">|</a> <a id="2213" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="2221" class="Symbol">=</a> <a id="2223" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2226" class="Symbol">λ</a> <a id="2228" class="Symbol">()</a>
<a id="2231" class="Symbol">...</a> <a id="2235" class="Symbol">|</a> <a id="2237" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2242" href="ValueSep.Ledger.html#2242" class="Bound">vᵃ</a> <a id="2245" class="Symbol">|</a> <a id="2247" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2252" class="Symbol">_</a>
  <a id="2256" class="Keyword">with</a> <a id="2261" class="Bound">v</a> <a id="2263" href="Prelude.Ord.Core.html#554" class="Function Operator">≤?</a> <a id="2266" href="ValueSep.Ledger.html#2242" class="Bound">vᵃ</a>
<a id="2269" class="Symbol">...</a> <a id="2273" class="Symbol">|</a> <a id="2275" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="2279" href="ValueSep.Ledger.html#2279" class="Bound">v≰</a> <a id="2282" class="Symbol">=</a> <a id="2284" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="2288" href="ValueSep.Ledger.html#2279" class="Bound">v≰</a>
<a id="2291" class="Symbol">...</a> <a id="2295" class="Symbol">|</a> <a id="2297" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2301" href="ValueSep.Ledger.html#2301" class="Bound">v≤</a> <a id="2304" class="Symbol">=</a> <a id="2306" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2310" href="ValueSep.Ledger.html#2301" class="Bound">v≤</a>

<a id="isValidTx"></a><a id="2314" href="ValueSep.Ledger.html#2314" class="Function">isValidTx</a> <a id="2324" class="Symbol">:</a> <a id="2326" href="ValueSep.Ledger.html#875" class="Record">Tx</a> <a id="2329" class="Symbol">→</a> <a id="2331" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="2333" class="Symbol">→</a> <a id="2335" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="2340" href="ValueSep.Ledger.html#2314" class="Function">isValidTx</a> <a id="2350" href="ValueSep.Ledger.html#2350" class="Bound">t</a> <a id="2352" href="ValueSep.Ledger.html#2352" class="Bound">s</a> <a id="2354" class="Symbol">=</a> <a id="2356" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="2358" href="ValueSep.Ledger.html#2083" class="Function">isValidTx?</a> <a id="2369" href="ValueSep.Ledger.html#2350" class="Bound">t</a> <a id="2371" href="ValueSep.Ledger.html#2352" class="Bound">s</a> <a id="2373" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>

<a id="2376" class="Comment">-- Express the action of tranferring values between keys in a map.</a>
<a id="2443" class="Comment">-- NB: a transaction goes through only when:</a>
<a id="2488" class="Comment">--   1. both participants are present in the domain</a>
<a id="2540" class="Comment">--   2. the sender holds sufficient funds</a>
<a id="2582" class="Keyword">instance</a>
  <a id="2593" class="Comment">-- we denote a transaction as the map transformation that implements the transfer</a>
  <a id="⟦Tx⟧₀"></a><a id="2677" href="ValueSep.Ledger.html#2677" class="Function">⟦Tx⟧₀</a> <a id="2683" class="Symbol">:</a> <a id="2685" href="ValueSep.Ledger.html#1677" class="Record">Denotable₀</a> <a id="2696" href="ValueSep.Ledger.html#875" class="Record">Tx</a>
  <a id="2701" href="ValueSep.Ledger.html#2677" class="Function">⟦Tx⟧₀</a> <a id="2707" class="Symbol">.</a><a id="2708" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦_⟧₀</a> <a id="2713" class="Symbol">(</a><a id="2714" href="ValueSep.Ledger.html#2714" class="Bound">A</a> <a id="2716" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="2720" href="ValueSep.Ledger.html#2720" class="Bound">v</a> <a id="2722" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="2724" href="ValueSep.Ledger.html#2724" class="Bound">B</a><a id="2725" class="Symbol">)</a> <a id="2727" href="ValueSep.Ledger.html#2727" class="Bound">s</a> <a id="2729" class="Symbol">=</a> <a id="2731" href="ValueSep.Ledger.html#2727" class="Bound">s</a> <a id="2733" href="ValueSep.Maps.html#2554" class="Function Operator">[</a> <a id="2735" href="ValueSep.Ledger.html#2714" class="Bound">A</a> <a id="2737" href="ValueSep.Maps.html#2554" class="Function Operator">↝</a> <a id="2739" class="Symbol">(</a><a id="2740" href="Data.Nat.Base.html#2874" class="Primitive Operator">_∸</a> <a id="2743" href="ValueSep.Ledger.html#2720" class="Bound">v</a><a id="2744" class="Symbol">)</a> <a id="2746" href="ValueSep.Maps.html#2554" class="Function Operator">]</a> <a id="2748" href="ValueSep.Maps.html#2554" class="Function Operator">[</a> <a id="2750" href="ValueSep.Ledger.html#2724" class="Bound">B</a> <a id="2752" href="ValueSep.Maps.html#2554" class="Function Operator">↝</a> <a id="2754" class="Symbol">(</a><a id="2755" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="2758" href="ValueSep.Ledger.html#2720" class="Bound">v</a><a id="2759" class="Symbol">)</a> <a id="2761" href="ValueSep.Maps.html#2554" class="Function Operator">]</a>

  <a id="⟦Tx⟧"></a><a id="2766" href="ValueSep.Ledger.html#2766" class="Function">⟦Tx⟧</a> <a id="2771" class="Symbol">:</a> <a id="2773" href="ValueSep.Ledger.html#1525" class="Record">Denotable</a> <a id="2783" href="ValueSep.Ledger.html#875" class="Record">Tx</a>
  <a id="2788" href="ValueSep.Ledger.html#2766" class="Function">⟦Tx⟧</a> <a id="2793" class="Symbol">.</a><a id="2794" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦_⟧</a> <a id="2798" href="ValueSep.Ledger.html#2798" class="Bound">t</a> <a id="2800" href="ValueSep.Ledger.html#2800" class="Bound">s</a> <a id="2802" class="Symbol">=</a> <a id="2804" href="Data.Maybe.Base.html#2450" class="Function">M.when</a> <a id="2811" class="Symbol">(</a><a id="2812" href="ValueSep.Ledger.html#2314" class="Function">isValidTx</a> <a id="2822" href="ValueSep.Ledger.html#2798" class="Bound">t</a> <a id="2824" href="ValueSep.Ledger.html#2800" class="Bound">s</a><a id="2825" class="Symbol">)</a> <a id="2827" class="Symbol">(</a><a id="2828" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦</a> <a id="2830" href="ValueSep.Ledger.html#2798" class="Bound">t</a> <a id="2832" href="ValueSep.Ledger.html#1720" class="Field Operator">⟧₀</a> <a id="2835" href="ValueSep.Ledger.html#2800" class="Bound">s</a><a id="2836" class="Symbol">)</a>

  <a id="2841" class="Comment">-- we denote a ledger as the composition of the denotations of its transactions,</a>
  <a id="2924" class="Comment">-- i.e. we run all transactions in sequence</a>
  <a id="⟦L⟧₀"></a><a id="2970" href="ValueSep.Ledger.html#2970" class="Function">⟦L⟧₀</a> <a id="2975" class="Symbol">:</a> <a id="2977" href="ValueSep.Ledger.html#1677" class="Record">Denotable₀</a> <a id="2988" href="ValueSep.Ledger.html#1093" class="Function">L</a>
  <a id="2992" href="ValueSep.Ledger.html#2970" class="Function">⟦L⟧₀</a> <a id="2997" class="Symbol">.</a><a id="2998" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦_⟧₀</a> <a id="3003" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>      <a id="3011" class="Symbol">=</a> <a id="3013" href="Function.Base.html#615" class="Function">id</a>
  <a id="3018" href="ValueSep.Ledger.html#2970" class="Function">⟦L⟧₀</a> <a id="3023" class="Symbol">.</a><a id="3024" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦_⟧₀</a> <a id="3029" class="Symbol">(</a><a id="3030" href="ValueSep.Ledger.html#3030" class="Bound">t</a> <a id="3032" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3034" href="ValueSep.Ledger.html#3034" class="Bound">l</a><a id="3035" class="Symbol">)</a> <a id="3037" class="Symbol">=</a> <a id="3039" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦</a> <a id="3041" href="ValueSep.Ledger.html#3034" class="Bound">l</a> <a id="3043" href="ValueSep.Ledger.html#1720" class="Field Operator">⟧₀</a> <a id="3046" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3048" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦</a> <a id="3050" href="ValueSep.Ledger.html#3030" class="Bound">t</a> <a id="3052" href="ValueSep.Ledger.html#1720" class="Field Operator">⟧₀</a>

  <a id="⟦L⟧"></a><a id="3058" href="ValueSep.Ledger.html#3058" class="Function">⟦L⟧</a> <a id="3062" class="Symbol">:</a> <a id="3064" href="ValueSep.Ledger.html#1525" class="Record">Denotable</a> <a id="3074" href="ValueSep.Ledger.html#1093" class="Function">L</a>
  <a id="3078" href="ValueSep.Ledger.html#3058" class="Function">⟦L⟧</a> <a id="3082" class="Symbol">.</a><a id="3083" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦_⟧</a> <a id="3087" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>      <a id="3095" href="ValueSep.Ledger.html#3095" class="Bound">s</a> <a id="3097" class="Symbol">=</a> <a id="3099" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3104" href="ValueSep.Ledger.html#3095" class="Bound">s</a>
  <a id="3108" href="ValueSep.Ledger.html#3058" class="Function">⟦L⟧</a> <a id="3112" class="Symbol">.</a><a id="3113" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦_⟧</a> <a id="3117" class="Symbol">(</a><a id="3118" href="ValueSep.Ledger.html#3118" class="Bound">t</a> <a id="3120" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3122" href="ValueSep.Ledger.html#3122" class="Bound">l</a><a id="3123" class="Symbol">)</a> <a id="3125" class="Symbol">=</a> <a id="3127" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3129" href="ValueSep.Ledger.html#3118" class="Bound">t</a> <a id="3131" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="3133" href="Prelude.Monad.html#752" class="Function Operator">&gt;=&gt;</a> <a id="3137" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3139" href="ValueSep.Ledger.html#3122" class="Bound">l</a> <a id="3141" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a>

<a id="comp₀"></a><a id="3144" href="ValueSep.Ledger.html#3144" class="Function">comp₀</a> <a id="3150" class="Symbol">:</a> <a id="3152" class="Symbol">∀</a> <a id="3154" href="ValueSep.Ledger.html#3154" class="Bound">x</a> <a id="3156" class="Symbol">→</a> <a id="3158" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦</a> <a id="3160" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="3162" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="3165" href="ValueSep.Ledger.html#1195" class="Generalizable">l′</a> <a id="3168" href="ValueSep.Ledger.html#1720" class="Field Operator">⟧₀</a> <a id="3171" href="ValueSep.Ledger.html#3154" class="Bound">x</a> <a id="3173" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3175" class="Symbol">(</a><a id="3176" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦</a> <a id="3178" href="ValueSep.Ledger.html#1195" class="Generalizable">l′</a> <a id="3181" href="ValueSep.Ledger.html#1720" class="Field Operator">⟧₀</a> <a id="3184" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3186" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦</a> <a id="3188" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="3190" href="ValueSep.Ledger.html#1720" class="Field Operator">⟧₀</a><a id="3192" class="Symbol">)</a> <a id="3194" href="ValueSep.Ledger.html#3154" class="Bound">x</a>
<a id="3196" href="ValueSep.Ledger.html#3144" class="Function">comp₀</a> <a id="3202" class="Symbol">{</a><a id="3203" class="Argument">l</a> <a id="3205" class="Symbol">=</a> <a id="3207" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3209" class="Symbol">}</a>    <a id="3214" class="Symbol">_</a> <a id="3216" class="Symbol">=</a> <a id="3218" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3223" href="ValueSep.Ledger.html#3144" class="Function">comp₀</a> <a id="3229" class="Symbol">{</a><a id="3230" class="Argument">l</a> <a id="3232" class="Symbol">=</a> <a id="3234" href="ValueSep.Ledger.html#3234" class="Bound">t</a> <a id="3236" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3238" href="ValueSep.Ledger.html#3238" class="Bound">l</a><a id="3239" class="Symbol">}</a> <a id="3241" href="ValueSep.Ledger.html#3241" class="Bound">x</a> <a id="3243" class="Symbol">=</a> <a id="3245" href="ValueSep.Ledger.html#3144" class="Function">comp₀</a> <a id="3251" class="Symbol">{</a><a id="3252" href="ValueSep.Ledger.html#3238" class="Bound">l</a><a id="3253" class="Symbol">}</a> <a id="3255" class="Symbol">(</a><a id="3256" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦</a> <a id="3258" href="ValueSep.Ledger.html#3234" class="Bound">t</a> <a id="3260" href="ValueSep.Ledger.html#1720" class="Field Operator">⟧₀</a> <a id="3263" href="ValueSep.Ledger.html#3241" class="Bound">x</a><a id="3264" class="Symbol">)</a>

<a id="comp"></a><a id="3267" href="ValueSep.Ledger.html#3267" class="Function">comp</a> <a id="3272" class="Symbol">:</a> <a id="3274" class="Symbol">∀</a> <a id="3276" href="ValueSep.Ledger.html#3276" class="Bound">x</a> <a id="3278" class="Symbol">→</a> <a id="3280" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3282" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="3284" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="3287" href="ValueSep.Ledger.html#1195" class="Generalizable">l′</a> <a id="3290" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="3292" href="ValueSep.Ledger.html#3276" class="Bound">x</a> <a id="3294" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3296" class="Symbol">(</a><a id="3297" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3299" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="3301" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="3303" href="Prelude.Monad.html#752" class="Function Operator">&gt;=&gt;</a> <a id="3307" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3309" href="ValueSep.Ledger.html#1195" class="Generalizable">l′</a> <a id="3312" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a><a id="3313" class="Symbol">)</a> <a id="3315" href="ValueSep.Ledger.html#3276" class="Bound">x</a>
<a id="3317" href="ValueSep.Ledger.html#3267" class="Function">comp</a> <a id="3322" class="Symbol">{</a><a id="3323" class="Argument">l</a> <a id="3325" class="Symbol">=</a> <a id="3327" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3329" class="Symbol">}</a>    <a id="3334" href="ValueSep.Ledger.html#3334" class="Bound">x</a> <a id="3336" class="Symbol">=</a> <a id="3338" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3343" href="ValueSep.Ledger.html#3267" class="Function">comp</a> <a id="3348" class="Symbol">{</a><a id="3349" class="Argument">l</a> <a id="3351" class="Symbol">=</a> <a id="3353" href="ValueSep.Ledger.html#3353" class="Bound">t</a> <a id="3355" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3357" href="ValueSep.Ledger.html#3357" class="Bound">l</a><a id="3358" class="Symbol">}</a> <a id="3360" href="ValueSep.Ledger.html#3360" class="Bound">x</a> <a id="3362" class="Keyword">with</a> <a id="3367" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3369" href="ValueSep.Ledger.html#3353" class="Bound">t</a> <a id="3371" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="3373" href="ValueSep.Ledger.html#3360" class="Bound">x</a>
<a id="3375" class="Symbol">...</a> <a id="3379" class="Symbol">|</a> <a id="3381" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="3389" class="Symbol">=</a> <a id="3391" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3396" class="Symbol">...</a> <a id="3400" class="Symbol">|</a> <a id="3402" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3407" href="ValueSep.Ledger.html#3407" class="Bound">s</a>  <a id="3410" class="Symbol">=</a> <a id="3412" href="ValueSep.Ledger.html#3267" class="Function">comp</a> <a id="3417" class="Symbol">{</a><a id="3418" class="Bound">l</a><a id="3419" class="Symbol">}</a> <a id="3421" href="ValueSep.Ledger.html#3407" class="Bound">s</a>

<a id="3424" class="Comment">-- Executing transactions never introduces new keys in the resulting map out-of-thin-air.</a>
<a id="⟦⟧ₜ-mono"></a><a id="3514" href="ValueSep.Ledger.html#3514" class="Function">⟦⟧ₜ-mono</a> <a id="3523" class="Symbol">:</a> <a id="3525" href="ValueSep.Maps.html#1749" class="Function">KeyMonotonicᵐ</a> <a id="3539" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3541" href="ValueSep.Ledger.html#1178" class="Generalizable">t</a> <a id="3543" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a>
<a id="3545" href="ValueSep.Ledger.html#3514" class="Function">⟦⟧ₜ-mono</a> <a id="3554" class="Symbol">{</a><a id="3555" class="Argument">t</a> <a id="3557" class="Symbol">=</a> <a id="3559" href="ValueSep.Ledger.html#3559" class="Bound">A</a> <a id="3561" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="3565" href="ValueSep.Ledger.html#3565" class="Bound">v</a> <a id="3567" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="3569" href="ValueSep.Ledger.html#3569" class="Bound">B</a><a id="3570" class="Symbol">}</a> <a id="3572" href="ValueSep.Ledger.html#3572" class="Bound">m</a>
  <a id="3576" class="Keyword">with</a> <a id="3581" href="ValueSep.Ledger.html#3572" class="Bound">m</a> <a id="3583" href="ValueSep.Ledger.html#3559" class="Bound">A</a> <a id="3585" class="Symbol">|</a> <a id="3587" href="ValueSep.Ledger.html#3572" class="Bound">m</a> <a id="3589" href="ValueSep.Ledger.html#3569" class="Bound">B</a>
<a id="3591" class="Symbol">...</a> <a id="3595" class="Symbol">|</a> <a id="3597" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3602" class="Symbol">_</a>  <a id="3605" class="Symbol">|</a> <a id="3607" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="3615" class="Symbol">=</a> <a id="3617" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="3631" class="Symbol">...</a> <a id="3635" class="Symbol">|</a> <a id="3637" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="3645" class="Symbol">|</a> <a id="3647" class="Symbol">_</a>       <a id="3655" class="Symbol">=</a> <a id="3657" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="3671" class="Symbol">...</a> <a id="3675" class="Symbol">|</a> <a id="3677" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3682" href="ValueSep.Ledger.html#3682" class="Bound">vᵃ</a> <a id="3685" class="Symbol">|</a> <a id="3687" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3692" href="ValueSep.Ledger.html#3692" class="Bound">vᵇ</a>
  <a id="3697" class="Keyword">with</a> <a id="3702" class="Bound">v</a> <a id="3704" href="Prelude.Ord.Core.html#554" class="Function Operator">≤?</a> <a id="3707" href="ValueSep.Ledger.html#3682" class="Bound">vᵃ</a>
<a id="3710" class="Symbol">...</a> <a id="3714" class="Symbol">|</a> <a id="3716" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="3720" class="Symbol">_</a> <a id="3722" class="Symbol">=</a> <a id="3724" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="3738" class="Symbol">...</a> <a id="3742" class="Symbol">|</a> <a id="3744" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3748" class="Symbol">_</a> <a id="3750" class="Symbol">=</a> <a id="3752" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="3763" class="Symbol">λ</a> <a id="3765" href="ValueSep.Ledger.html#3765" class="Bound">k</a> <a id="3767" class="Symbol">→</a> <a id="3769" href="ValueSep.Maps.html#2710" class="Function">[↝]-mono</a> <a id="3778" class="Bound">B</a> <a id="3780" class="Symbol">(</a><a id="3781" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="3784" class="Bound">v</a><a id="3785" class="Symbol">)</a> <a id="3787" class="Symbol">(</a><a id="3788" class="Bound">m</a> <a id="3790" href="ValueSep.Maps.html#2554" class="Function Operator">[</a> <a id="3792" class="Bound">A</a> <a id="3794" href="ValueSep.Maps.html#2554" class="Function Operator">↝</a> <a id="3796" class="Symbol">(</a><a id="3797" href="Data.Nat.Base.html#2874" class="Primitive Operator">_∸</a> <a id="3800" class="Bound">v</a><a id="3801" class="Symbol">)</a> <a id="3803" href="ValueSep.Maps.html#2554" class="Function Operator">]</a><a id="3804" class="Symbol">)</a> <a id="3806" href="ValueSep.Ledger.html#3765" class="Bound">k</a> <a id="3808" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3810" href="ValueSep.Maps.html#2710" class="Function">[↝]-mono</a> <a id="3819" class="Bound">A</a> <a id="3821" class="Symbol">(</a><a id="3822" href="Data.Nat.Base.html#2874" class="Primitive Operator">_∸</a> <a id="3825" class="Bound">v</a><a id="3826" class="Symbol">)</a> <a id="3828" class="Bound">m</a> <a id="3830" href="ValueSep.Ledger.html#3765" class="Bound">k</a>

<a id="⟦⟧ₗ-mono"></a><a id="3833" href="ValueSep.Ledger.html#3833" class="Function">⟦⟧ₗ-mono</a> <a id="3842" class="Symbol">:</a> <a id="3844" href="ValueSep.Maps.html#1749" class="Function">KeyMonotonicᵐ</a> <a id="3858" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3860" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="3862" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a>
<a id="3864" href="ValueSep.Ledger.html#3833" class="Function">⟦⟧ₗ-mono</a> <a id="3873" class="Symbol">{</a><a id="3874" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3876" class="Symbol">}</a>    <a id="3881" class="Symbol">_</a> <a id="3883" class="Symbol">=</a> <a id="3885" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="3896" class="Symbol">λ</a> <a id="3898" href="ValueSep.Ledger.html#3898" class="Bound">_</a> <a id="3900" class="Symbol">→</a> <a id="3902" href="Function.Base.html#615" class="Function">id</a>
<a id="3905" href="ValueSep.Ledger.html#3833" class="Function">⟦⟧ₗ-mono</a> <a id="3914" class="Symbol">{</a><a id="3915" href="ValueSep.Ledger.html#3915" class="Bound">t</a> <a id="3917" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3919" href="ValueSep.Ledger.html#3919" class="Bound">l</a><a id="3920" class="Symbol">}</a> <a id="3922" href="ValueSep.Ledger.html#3922" class="Bound">s</a>
  <a id="3926" class="Keyword">with</a> <a id="3931" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="3933" href="ValueSep.Ledger.html#3915" class="Bound">t</a> <a id="3935" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="3937" href="ValueSep.Ledger.html#3922" class="Bound">s</a> <a id="3939" class="Symbol">|</a> <a id="3941" href="ValueSep.Ledger.html#3514" class="Function">⟦⟧ₜ-mono</a> <a id="3950" class="Symbol">{</a><a id="3951" class="Argument">t</a> <a id="3953" class="Symbol">=</a> <a id="3955" href="ValueSep.Ledger.html#3915" class="Bound">t</a><a id="3956" class="Symbol">}</a> <a id="3958" href="ValueSep.Ledger.html#3922" class="Bound">s</a>
<a id="3960" class="Symbol">...</a> <a id="3964" class="Symbol">|</a> <a id="3966" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="3974" class="Symbol">|</a> <a id="3976" class="Symbol">_</a> <a id="3978" class="Symbol">=</a> <a id="3980" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="3994" class="Symbol">...</a> <a id="3998" class="Symbol">|</a> <a id="4000" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4005" href="ValueSep.Ledger.html#4005" class="Bound">s′</a> <a id="4008" class="Symbol">|</a> <a id="4010" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="4021" href="ValueSep.Ledger.html#4021" class="Bound">IHₜ</a>
  <a id="4027" class="Keyword">with</a> <a id="4032" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="4034" class="Bound">l</a> <a id="4036" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="4038" href="ValueSep.Ledger.html#4005" class="Bound">s′</a> <a id="4041" class="Symbol">|</a> <a id="4043" href="ValueSep.Ledger.html#3833" class="Function">⟦⟧ₗ-mono</a> <a id="4052" class="Symbol">{</a><a id="4053" class="Argument">l</a> <a id="4055" class="Symbol">=</a> <a id="4057" class="Bound">l</a><a id="4058" class="Symbol">}</a> <a id="4060" href="ValueSep.Ledger.html#4005" class="Bound">s′</a>
<a id="4063" class="Symbol">...</a> <a id="4067" class="Symbol">|</a> <a id="4069" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4077" class="Symbol">|</a> <a id="4079" class="Symbol">_</a> <a id="4081" class="Symbol">=</a> <a id="4083" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="4097" class="Symbol">...</a> <a id="4101" class="Symbol">|</a> <a id="4103" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4108" href="ValueSep.Ledger.html#4108" class="Bound">s′</a> <a id="4111" class="Symbol">|</a> <a id="4113" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="4124" href="ValueSep.Ledger.html#4124" class="Bound">IHₗ</a> <a id="4128" class="Symbol">=</a> <a id="4130" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="4141" class="Symbol">(</a><a id="4142" href="ValueSep.Ledger.html#4124" class="Bound">IHₗ</a> <a id="4146" class="Symbol">_</a> <a id="4148" href="Function.Base.html#1219" class="Function Operator">∘₂</a> <a id="4151" class="Bound">IHₜ</a><a id="4154" class="Symbol">)</a>

<a id="4157" class="Comment">-- -- Executing a transaction never removes existing keys.</a>
<a id="⟦⟧ₜ-pre"></a><a id="4216" href="ValueSep.Ledger.html#4216" class="Function">⟦⟧ₜ-pre</a> <a id="4224" class="Symbol">:</a> <a id="4226" href="ValueSep.Maps.html#1763" class="Function">KeyPreservingᵐ</a> <a id="4241" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="4243" href="ValueSep.Ledger.html#1178" class="Generalizable">t</a> <a id="4245" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a>
<a id="4247" href="ValueSep.Ledger.html#4216" class="Function">⟦⟧ₜ-pre</a> <a id="4255" class="Symbol">{</a><a id="4256" class="Argument">t</a> <a id="4258" class="Symbol">=</a> <a id="4260" href="ValueSep.Ledger.html#4260" class="Bound">A</a> <a id="4262" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="4266" href="ValueSep.Ledger.html#4266" class="Bound">v</a> <a id="4268" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="4270" href="ValueSep.Ledger.html#4270" class="Bound">B</a><a id="4271" class="Symbol">}</a> <a id="4273" href="ValueSep.Ledger.html#4273" class="Bound">m</a>
  <a id="4277" class="Keyword">with</a> <a id="4282" href="ValueSep.Ledger.html#4273" class="Bound">m</a> <a id="4284" href="ValueSep.Ledger.html#4260" class="Bound">A</a> <a id="4286" class="Keyword">in</a> <a id="4289" class="Argument">A≡</a> <a id="4292" class="Symbol">|</a> <a id="4294" href="ValueSep.Ledger.html#4273" class="Bound">m</a> <a id="4296" href="ValueSep.Ledger.html#4270" class="Bound">B</a> <a id="4298" class="Keyword">in</a> <a id="4301" class="Argument">B≡</a>
<a id="4304" class="Symbol">...</a> <a id="4308" class="Symbol">|</a> <a id="4310" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4315" class="Symbol">_</a>  <a id="4318" class="Symbol">|</a> <a id="4320" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4328" class="Symbol">=</a> <a id="4330" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="4344" class="Symbol">...</a> <a id="4348" class="Symbol">|</a> <a id="4350" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4358" class="Symbol">|</a> <a id="4360" class="Symbol">_</a>       <a id="4368" class="Symbol">=</a> <a id="4370" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="4384" class="Symbol">...</a> <a id="4388" class="Symbol">|</a> <a id="4390" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4395" href="ValueSep.Ledger.html#4395" class="Bound">vᵃ</a> <a id="4398" class="Symbol">|</a> <a id="4400" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4405" href="ValueSep.Ledger.html#4405" class="Bound">vᵇ</a>
  <a id="4410" class="Keyword">with</a> <a id="4415" class="Bound">v</a> <a id="4417" href="Prelude.Ord.Core.html#554" class="Function Operator">≤?</a> <a id="4420" href="ValueSep.Ledger.html#4395" class="Bound">vᵃ</a>
<a id="4423" class="Symbol">...</a> <a id="4427" class="Symbol">|</a> <a id="4429" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="4433" class="Symbol">_</a> <a id="4435" class="Symbol">=</a> <a id="4437" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="4451" class="Symbol">...</a> <a id="4455" class="Symbol">|</a> <a id="4457" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4461" class="Symbol">_</a> <a id="4463" class="Symbol">=</a> <a id="4465" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="4476" class="Symbol">λ</a> <a id="4478" href="ValueSep.Ledger.html#4478" class="Bound">k</a> <a id="4480" href="ValueSep.Ledger.html#4480" class="Bound">k∈</a> <a id="4483" class="Symbol">→</a> <a id="4485" href="ValueSep.Maps.html#2929" class="Function">[↝]-pre</a> <a id="4493" class="Bound">A</a> <a id="4495" class="Symbol">(</a><a id="4496" href="Data.Nat.Base.html#2874" class="Primitive Operator">_∸</a> <a id="4499" class="Bound">v</a><a id="4500" class="Symbol">)</a> <a id="4502" class="Bound">m</a> <a id="4504" class="Symbol">_</a> <a id="4506" class="Symbol">(</a><a id="4507" href="ValueSep.Maps.html#2929" class="Function">[↝]-pre</a> <a id="4515" class="Bound">B</a> <a id="4517" class="Symbol">(</a><a id="4518" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="4521" class="Bound">v</a><a id="4522" class="Symbol">)</a> <a id="4524" class="Symbol">(</a><a id="4525" class="Bound">m</a> <a id="4527" href="ValueSep.Maps.html#2554" class="Function Operator">[</a> <a id="4529" class="Bound">A</a> <a id="4531" href="ValueSep.Maps.html#2554" class="Function Operator">↝</a> <a id="4533" class="Symbol">(</a><a id="4534" href="Data.Nat.Base.html#2874" class="Primitive Operator">_∸</a> <a id="4537" class="Bound">v</a><a id="4538" class="Symbol">)</a> <a id="4540" href="ValueSep.Maps.html#2554" class="Function Operator">]</a><a id="4541" class="Symbol">)</a> <a id="4543" href="ValueSep.Ledger.html#4478" class="Bound">k</a> <a id="4545" href="ValueSep.Ledger.html#4480" class="Bound">k∈</a><a id="4547" class="Symbol">)</a>

<a id="⟦⟧ₗ-pre"></a><a id="4550" href="ValueSep.Ledger.html#4550" class="Function">⟦⟧ₗ-pre</a> <a id="4558" class="Symbol">:</a> <a id="4560" href="ValueSep.Maps.html#1763" class="Function">KeyPreservingᵐ</a> <a id="4575" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="4577" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="4579" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a>
<a id="4581" href="ValueSep.Ledger.html#4550" class="Function">⟦⟧ₗ-pre</a> <a id="4589" class="Symbol">{</a><a id="4590" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4592" class="Symbol">}</a> <a id="4594" class="Symbol">_</a> <a id="4596" class="Symbol">=</a> <a id="4598" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="4609" class="Symbol">λ</a> <a id="4611" href="ValueSep.Ledger.html#4611" class="Bound">_</a> <a id="4613" class="Symbol">→</a> <a id="4615" href="Function.Base.html#615" class="Function">id</a>
<a id="4618" href="ValueSep.Ledger.html#4550" class="Function">⟦⟧ₗ-pre</a> <a id="4626" class="Symbol">{</a><a id="4627" href="ValueSep.Ledger.html#4627" class="Bound">t</a> <a id="4629" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4631" href="ValueSep.Ledger.html#4631" class="Bound">l</a><a id="4632" class="Symbol">}</a> <a id="4634" href="ValueSep.Ledger.html#4634" class="Bound">s</a>
  <a id="4638" class="Keyword">with</a> <a id="4643" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="4645" href="ValueSep.Ledger.html#4627" class="Bound">t</a> <a id="4647" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="4649" href="ValueSep.Ledger.html#4634" class="Bound">s</a> <a id="4651" class="Symbol">|</a> <a id="4653" href="ValueSep.Ledger.html#4216" class="Function">⟦⟧ₜ-pre</a> <a id="4661" class="Symbol">{</a><a id="4662" class="Argument">t</a> <a id="4664" class="Symbol">=</a> <a id="4666" href="ValueSep.Ledger.html#4627" class="Bound">t</a><a id="4667" class="Symbol">}</a> <a id="4669" href="ValueSep.Ledger.html#4634" class="Bound">s</a>
<a id="4671" class="Symbol">...</a> <a id="4675" class="Symbol">|</a> <a id="4677" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4685" class="Symbol">|</a> <a id="4687" class="Symbol">_</a> <a id="4689" class="Symbol">=</a> <a id="4691" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="4705" class="Symbol">...</a> <a id="4709" class="Symbol">|</a> <a id="4711" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4716" href="ValueSep.Ledger.html#4716" class="Bound">s′</a> <a id="4719" class="Symbol">|</a> <a id="4721" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="4732" href="ValueSep.Ledger.html#4732" class="Bound">IHₜ</a>
  <a id="4738" class="Keyword">with</a> <a id="4743" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="4745" class="Bound">l</a> <a id="4747" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="4749" href="ValueSep.Ledger.html#4716" class="Bound">s′</a> <a id="4752" class="Symbol">|</a> <a id="4754" href="ValueSep.Ledger.html#4550" class="Function">⟦⟧ₗ-pre</a> <a id="4762" class="Symbol">{</a><a id="4763" class="Argument">l</a> <a id="4765" class="Symbol">=</a> <a id="4767" class="Bound">l</a><a id="4768" class="Symbol">}</a> <a id="4770" href="ValueSep.Ledger.html#4716" class="Bound">s′</a>
<a id="4773" class="Symbol">...</a> <a id="4777" class="Symbol">|</a> <a id="4779" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4787" class="Symbol">|</a> <a id="4789" class="Symbol">_</a> <a id="4791" class="Symbol">=</a> <a id="4793" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="4807" class="Symbol">...</a> <a id="4811" class="Symbol">|</a> <a id="4813" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4818" href="ValueSep.Ledger.html#4818" class="Bound">s′</a> <a id="4821" class="Symbol">|</a> <a id="4823" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="4834" href="ValueSep.Ledger.html#4834" class="Bound">IHₗ</a> <a id="4838" class="Symbol">=</a> <a id="4840" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="4851" class="Symbol">(</a><a id="4852" class="Bound">IHₜ</a> <a id="4856" class="Symbol">_</a> <a id="4858" href="Function.Base.html#1219" class="Function Operator">∘₂</a> <a id="4861" href="ValueSep.Ledger.html#4834" class="Bound">IHₗ</a><a id="4864" class="Symbol">)</a>

<a id="4867" class="Comment">-- ** Utility lemmas about membership/transfer/maps.</a>
<a id="∉-⟦⟧ₜ"></a><a id="4920" href="ValueSep.Ledger.html#4920" class="Function">∉-⟦⟧ₜ</a> <a id="4926" class="Symbol">:</a> <a id="4928" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="4930" href="ValueSep.Maps.html#683" class="Function Operator">∉ᵈ</a> <a id="4933" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="4935" class="Symbol">→</a> <a id="4937" href="Data.Maybe.Relation.Unary.All.html#943" class="Datatype">M.All.All</a> <a id="4947" class="Symbol">(</a><a id="4948" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="4950" href="ValueSep.Maps.html#683" class="Function Operator">∉ᵈ_</a><a id="4953" class="Symbol">)</a> <a id="4955" class="Symbol">(</a><a id="4956" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="4958" href="ValueSep.Ledger.html#1178" class="Generalizable">t</a> <a id="4960" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="4962" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a><a id="4963" class="Symbol">)</a>
<a id="4965" href="ValueSep.Ledger.html#4920" class="Function">∉-⟦⟧ₜ</a> <a id="4971" class="Symbol">{</a><a id="4972" href="ValueSep.Ledger.html#4972" class="Bound">A</a><a id="4973" class="Symbol">}{</a><a id="4975" href="ValueSep.Ledger.html#4975" class="Bound">s</a><a id="4976" class="Symbol">}{</a><a id="4978" href="ValueSep.Ledger.html#4978" class="Bound">t</a><a id="4979" class="Symbol">}</a> <a id="4981" href="ValueSep.Ledger.html#4981" class="Bound">A∉</a> <a id="4984" class="Keyword">with</a> <a id="4989" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="4991" href="ValueSep.Ledger.html#4978" class="Bound">t</a> <a id="4993" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="4995" href="ValueSep.Ledger.html#4975" class="Bound">s</a> <a id="4997" class="Symbol">|</a> <a id="4999" href="ValueSep.Ledger.html#4216" class="Function">⟦⟧ₜ-pre</a> <a id="5007" class="Symbol">{</a><a id="5008" class="Argument">t</a> <a id="5010" class="Symbol">=</a> <a id="5012" href="ValueSep.Ledger.html#4978" class="Bound">t</a><a id="5013" class="Symbol">}</a> <a id="5015" href="ValueSep.Ledger.html#4975" class="Bound">s</a>
<a id="5017" class="Symbol">...</a> <a id="5021" class="Symbol">|</a> <a id="5023" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="5031" class="Symbol">|</a> <a id="5033" class="Symbol">_</a> <a id="5035" class="Symbol">=</a> <a id="5037" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="5051" class="Symbol">...</a> <a id="5055" class="Symbol">|</a> <a id="5057" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5062" href="ValueSep.Ledger.html#5062" class="Bound">s′</a> <a id="5065" class="Symbol">|</a> <a id="5067" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="5078" href="ValueSep.Ledger.html#5078" class="Bound">IHₜ</a> <a id="5082" class="Symbol">=</a> <a id="5084" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="5095" class="Symbol">(</a><a id="5096" class="Bound">A∉</a> <a id="5099" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5101" href="ValueSep.Ledger.html#5078" class="Bound">IHₜ</a> <a id="5105" class="Symbol">_)</a>

<a id="∉-⟦⟧ₗ"></a><a id="5109" href="ValueSep.Ledger.html#5109" class="Function">∉-⟦⟧ₗ</a> <a id="5115" class="Symbol">:</a> <a id="5117" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="5119" href="ValueSep.Maps.html#683" class="Function Operator">∉ᵈ</a> <a id="5122" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="5124" class="Symbol">→</a> <a id="5126" href="Data.Maybe.Relation.Unary.All.html#943" class="Datatype">M.All.All</a> <a id="5136" class="Symbol">(</a><a id="5137" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="5139" href="ValueSep.Maps.html#683" class="Function Operator">∉ᵈ_</a><a id="5142" class="Symbol">)</a> <a id="5144" class="Symbol">(</a><a id="5145" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="5147" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="5149" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="5151" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a><a id="5152" class="Symbol">)</a>
<a id="5154" href="ValueSep.Ledger.html#5109" class="Function">∉-⟦⟧ₗ</a> <a id="5160" class="Symbol">{</a><a id="5161" href="ValueSep.Ledger.html#5161" class="Bound">A</a><a id="5162" class="Symbol">}{</a><a id="5164" href="ValueSep.Ledger.html#5164" class="Bound">s</a><a id="5165" class="Symbol">}{</a><a id="5167" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5169" class="Symbol">}</a> <a id="5171" href="ValueSep.Ledger.html#5171" class="Bound">A∉</a> <a id="5174" class="Symbol">=</a> <a id="5176" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="5187" href="ValueSep.Ledger.html#5171" class="Bound">A∉</a>
<a id="5190" href="ValueSep.Ledger.html#5109" class="Function">∉-⟦⟧ₗ</a> <a id="5196" class="Symbol">{</a><a id="5197" href="ValueSep.Ledger.html#5197" class="Bound">A</a><a id="5198" class="Symbol">}{</a><a id="5200" href="ValueSep.Ledger.html#5200" class="Bound">s</a><a id="5201" class="Symbol">}{</a><a id="5203" href="ValueSep.Ledger.html#5203" class="Bound">t</a> <a id="5205" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5207" href="ValueSep.Ledger.html#5207" class="Bound">l</a><a id="5208" class="Symbol">}</a> <a id="5210" href="ValueSep.Ledger.html#5210" class="Bound">A∉</a> <a id="5213" class="Keyword">with</a> <a id="5218" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="5220" href="ValueSep.Ledger.html#5203" class="Bound">t</a> <a id="5222" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="5224" href="ValueSep.Ledger.html#5200" class="Bound">s</a> <a id="5226" class="Symbol">|</a> <a id="5228" href="ValueSep.Ledger.html#4920" class="Function">∉-⟦⟧ₜ</a> <a id="5234" class="Symbol">{</a><a id="5235" href="ValueSep.Ledger.html#5197" class="Bound">A</a><a id="5236" class="Symbol">}{</a><a id="5238" href="ValueSep.Ledger.html#5200" class="Bound">s</a><a id="5239" class="Symbol">}{</a><a id="5241" href="ValueSep.Ledger.html#5203" class="Bound">t</a><a id="5242" class="Symbol">}</a> <a id="5244" href="ValueSep.Ledger.html#5210" class="Bound">A∉</a>
<a id="5247" class="Symbol">...</a> <a id="5251" class="Symbol">|</a> <a id="5253" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="5261" class="Symbol">|</a> <a id="5263" class="Symbol">_</a> <a id="5265" class="Symbol">=</a> <a id="5267" href="Data.Maybe.Relation.Unary.All.html#1054" class="InductiveConstructor">M.All.nothing</a>
<a id="5281" class="Symbol">...</a> <a id="5285" class="Symbol">|</a> <a id="5287" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5292" href="ValueSep.Ledger.html#5292" class="Bound">s′</a> <a id="5295" class="Symbol">|</a> <a id="5297" href="Data.Maybe.Relation.Unary.All.html#1013" class="InductiveConstructor">M.All.just</a> <a id="5308" href="ValueSep.Ledger.html#5308" class="Bound">IHₜ</a> <a id="5312" class="Symbol">=</a> <a id="5314" href="ValueSep.Ledger.html#5109" class="Function">∉-⟦⟧ₗ</a> <a id="5320" class="Symbol">{</a><a id="5321" class="Bound">A</a><a id="5322" class="Symbol">}</a> <a id="5324" class="Symbol">{</a><a id="5325" href="ValueSep.Ledger.html#5292" class="Bound">s′</a><a id="5327" class="Symbol">}</a> <a id="5329" class="Symbol">{</a><a id="5330" class="Bound">l</a><a id="5331" class="Symbol">}</a> <a id="5333" href="ValueSep.Ledger.html#5308" class="Bound">IHₜ</a>

<a id="5338" class="Comment">-- ** Operational semantics</a>
<a id="5366" class="Comment">-- We model configurations of the transition system as pairs of a ledger and its current state.</a>

<a id="5463" class="Keyword">infix</a> <a id="5469" class="Number">0</a> <a id="5471" href="ValueSep.Ledger.html#5481" class="Datatype Operator">_—→_</a>
<a id="5476" class="Keyword">data</a> <a id="_—→_"></a><a id="5481" href="ValueSep.Ledger.html#5481" class="Datatype Operator">_—→_</a> <a id="5486" class="Symbol">:</a> <a id="5488" href="ValueSep.Ledger.html#1093" class="Function">L</a> <a id="5490" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5492" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="5494" class="Symbol">→</a> <a id="5496" href="ValueSep.Ledger.html#666" class="Function">S</a> <a id="5498" class="Symbol">→</a> <a id="5500" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="5505" class="Keyword">where</a>

  <a id="_—→_.base"></a><a id="5514" href="ValueSep.Ledger.html#5514" class="InductiveConstructor">base</a> <a id="5519" class="Symbol">:</a>
    <a id="5525" href="Prelude.InferenceRules.html#47618" class="Function Operator">────────────</a>
    <a id="5542" href="Prelude.Monoid.html#196" class="Field">ε</a> <a id="5544" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5546" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="5548" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="5551" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a>

  <a id="_—→_.step"></a><a id="5556" href="ValueSep.Ledger.html#5556" class="InductiveConstructor">step</a> <a id="5561" class="Symbol">:</a> <a id="5563" class="Symbol">∀</a> <a id="5565" class="Symbol">{</a><a id="5566" href="ValueSep.Ledger.html#5566" class="Bound">vᵃ</a><a id="5568" class="Symbol">}</a> <a id="5570" class="Symbol">→</a> <a id="5572" class="Keyword">let</a> <a id="5576" href="ValueSep.Ledger.html#5576" class="Bound">t</a> <a id="5578" class="Symbol">=</a> <a id="5580" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="5582" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="5586" href="ValueSep.Ledger.html#542" class="Generalizable">v</a> <a id="5588" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="5590" href="ValueSep.Ledger.html#527" class="Generalizable">B</a> <a id="5592" class="Keyword">in</a>

    <a id="5600" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="5602" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="5604" href="ValueSep.Ledger.html#525" class="Generalizable">A</a> <a id="5606" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5608" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5613" href="ValueSep.Ledger.html#5566" class="Bound">vᵃ</a>
    <a id="5620" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="5622" href="Data.Maybe.html#801" class="Function">Is-just</a> <a id="5630" class="Symbol">(</a><a id="5631" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="5633" href="ValueSep.Ledger.html#527" class="Generalizable">B</a><a id="5634" class="Symbol">)</a>
    <a id="5640" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="5642" href="ValueSep.Ledger.html#542" class="Generalizable">v</a> <a id="5644" href="Prelude.Ord.Core.html#416" class="Field Operator">≤</a> <a id="5646" href="ValueSep.Ledger.html#5566" class="Bound">vᵃ</a>
    <a id="5653" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="5655" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="5657" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5659" href="ValueSep.Ledger.html#1720" class="Field Operator">⟦</a> <a id="5661" href="ValueSep.Ledger.html#5576" class="Bound">t</a> <a id="5663" href="ValueSep.Ledger.html#1720" class="Field Operator">⟧₀</a> <a id="5666" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="5668" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="5671" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>
      <a id="5680" href="Prelude.InferenceRules.html#14164" class="Function Operator">──────────────────</a>
      <a id="5705" href="ValueSep.Ledger.html#5576" class="Bound">t</a> <a id="5707" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5709" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="5711" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5713" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="5715" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="5718" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>

<a id="oper-comp"></a><a id="5722" href="ValueSep.Ledger.html#5722" class="Function">oper-comp</a> <a id="5732" class="Symbol">:</a>
  <a id="5736" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="5738" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a>       <a id="5746" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5748" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a>  <a id="5751" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="5754" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>
  <a id="5759" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="5761" href="ValueSep.Ledger.html#1195" class="Generalizable">l′</a>      <a id="5769" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5771" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a> <a id="5774" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="5777" href="ValueSep.Ledger.html#1122" class="Generalizable">s″</a>
    <a id="5784" href="Prelude.InferenceRules.html#14115" class="Function Operator">────────────────────</a>
    <a id="5809" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="5811" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="5814" href="ValueSep.Ledger.html#1195" class="Generalizable">l′</a> <a id="5817" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5819" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a>  <a id="5822" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="5825" href="ValueSep.Ledger.html#1122" class="Generalizable">s″</a>
<a id="5828" href="ValueSep.Ledger.html#5722" class="Function">oper-comp</a> <a id="5838" class="Symbol">{</a><a id="5839" class="Argument">l</a> <a id="5841" class="Symbol">=</a> <a id="5843" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5845" class="Symbol">}</a>    <a id="5850" href="ValueSep.Ledger.html#5514" class="InductiveConstructor">base</a>                   <a id="5873" href="ValueSep.Ledger.html#5873" class="Bound">s′→s″</a> <a id="5879" class="Symbol">=</a> <a id="5881" href="ValueSep.Ledger.html#5873" class="Bound">s′→s″</a>
<a id="5887" href="ValueSep.Ledger.html#5722" class="Function">oper-comp</a> <a id="5897" class="Symbol">{</a><a id="5898" class="Argument">l</a> <a id="5900" class="Symbol">=</a> <a id="5902" class="Symbol">_</a> <a id="5904" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5906" class="Symbol">_}</a> <a id="5909" class="Symbol">(</a><a id="5910" href="ValueSep.Ledger.html#5556" class="InductiveConstructor">step</a> <a id="5915" href="ValueSep.Ledger.html#5915" class="Bound">sA≡</a> <a id="5919" href="ValueSep.Ledger.html#5919" class="Bound">sB≡</a> <a id="5923" href="ValueSep.Ledger.html#5923" class="Bound">v≤</a> <a id="5926" href="ValueSep.Ledger.html#5926" class="Bound">s→s′</a><a id="5930" class="Symbol">)</a> <a id="5932" href="ValueSep.Ledger.html#5932" class="Bound">s′→s″</a> <a id="5938" class="Symbol">=</a> <a id="5940" href="ValueSep.Ledger.html#5556" class="InductiveConstructor">step</a> <a id="5945" href="ValueSep.Ledger.html#5915" class="Bound">sA≡</a> <a id="5949" href="ValueSep.Ledger.html#5919" class="Bound">sB≡</a> <a id="5953" href="ValueSep.Ledger.html#5923" class="Bound">v≤</a> <a id="5956" class="Symbol">(</a><a id="5957" href="ValueSep.Ledger.html#5722" class="Function">oper-comp</a> <a id="5967" href="ValueSep.Ledger.html#5926" class="Bound">s→s′</a> <a id="5972" href="ValueSep.Ledger.html#5932" class="Bound">s′→s″</a><a id="5977" class="Symbol">)</a>

<a id="5980" class="Comment">-- ** Relating denotational and operational semantics.</a>
<a id="denot⇒oper"></a><a id="6035" href="ValueSep.Ledger.html#6035" class="Function">denot⇒oper</a> <a id="6046" class="Symbol">:</a>
  <a id="6050" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="6052" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="6054" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="6056" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="6058" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6060" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6065" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>
  <a id="6070" href="Prelude.InferenceRules.html#14187" class="Function Operator">─────────────────</a>
  <a id="6090" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="6092" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6094" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="6096" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="6099" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>
<a id="6102" href="ValueSep.Ledger.html#6035" class="Function">denot⇒oper</a> <a id="6113" class="Symbol">{</a><a id="6114" class="Argument">l</a> <a id="6116" class="Symbol">=</a> <a id="6118" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6120" class="Symbol">}</a> <a id="6122" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="6127" class="Symbol">=</a> <a id="6129" href="ValueSep.Ledger.html#5514" class="InductiveConstructor">base</a>
<a id="6134" href="ValueSep.Ledger.html#6035" class="Function">denot⇒oper</a> <a id="6145" class="Symbol">{</a><a id="6146" class="Argument">l</a> <a id="6148" class="Symbol">=</a> <a id="6150" href="ValueSep.Ledger.html#6150" class="Bound">A</a> <a id="6152" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="6156" href="ValueSep.Ledger.html#6156" class="Bound">v</a> <a id="6158" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="6160" href="ValueSep.Ledger.html#6160" class="Bound">B</a> <a id="6162" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6164" href="ValueSep.Ledger.html#6164" class="Bound">l</a><a id="6165" class="Symbol">}{</a><a id="6167" href="ValueSep.Ledger.html#6167" class="Bound">s</a><a id="6168" class="Symbol">}</a> <a id="6170" href="ValueSep.Ledger.html#6170" class="Bound">l≡</a>
  <a id="6175" class="Keyword">with</a> <a id="6180" href="ValueSep.Ledger.html#6167" class="Bound">s</a> <a id="6182" href="ValueSep.Ledger.html#6150" class="Bound">A</a> <a id="6184" class="Keyword">in</a> <a id="6187" class="Argument">sA≡</a> <a id="6191" class="Symbol">|</a> <a id="6193" href="ValueSep.Ledger.html#6167" class="Bound">s</a> <a id="6195" href="ValueSep.Ledger.html#6160" class="Bound">B</a> <a id="6197" class="Keyword">in</a> <a id="6200" class="Argument">sB≡</a>
<a id="6204" class="Symbol">...</a> <a id="6208" class="Symbol">|</a> <a id="6210" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6215" href="ValueSep.Ledger.html#6215" class="Bound">vᵃ</a> <a id="6218" class="Symbol">|</a> <a id="6220" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6225" href="ValueSep.Ledger.html#6225" class="Bound">vᵇ</a>
  <a id="6230" class="Keyword">with</a> <a id="6235" class="Bound">v</a> <a id="6237" href="Prelude.Ord.Core.html#554" class="Function Operator">≤?</a> <a id="6240" href="ValueSep.Ledger.html#6215" class="Bound">vᵃ</a>
<a id="6243" class="Symbol">...</a> <a id="6247" class="Symbol">|</a> <a id="6249" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="6253" href="ValueSep.Ledger.html#6253" class="Bound">v≤</a>
  <a id="6258" class="Symbol">=</a> <a id="6260" href="ValueSep.Ledger.html#5556" class="InductiveConstructor">step</a> <a id="6265" href="ValueSep.Ledger.html#6187" class="Bound">sA≡</a> <a id="6269" class="Symbol">(</a><a id="6270" href="Prelude.SubstDSL.html#465" class="Function">⟪</a> <a id="6272" href="Data.Maybe.html#801" class="Function">Is-just</a> <a id="6280" href="Prelude.SubstDSL.html#465" class="Function">⟫</a> <a id="6282" href="ValueSep.Ledger.html#6200" class="Bound">sB≡</a> <a id="6286" href="Prelude.SubstDSL.html#465" class="Function">~:</a> <a id="6289" href="Prelude.Decidable.Base.html#158" class="Function">auto</a><a id="6293" class="Symbol">)</a> <a id="6295" href="ValueSep.Ledger.html#6253" class="Bound">v≤</a> <a id="6298" class="Symbol">(</a><a id="6299" href="ValueSep.Ledger.html#6035" class="Function">denot⇒oper</a> <a id="6310" class="Bound">l≡</a><a id="6312" class="Symbol">)</a>

<a id="oper⇒denot"></a><a id="6315" href="ValueSep.Ledger.html#6315" class="Function">oper⇒denot</a> <a id="6326" class="Symbol">:</a>
  <a id="6330" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="6332" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6334" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="6336" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="6339" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>
  <a id="6344" href="Prelude.InferenceRules.html#14187" class="Function Operator">─────────────────</a>
  <a id="6364" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="6366" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="6368" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="6370" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="6372" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6374" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6379" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>
<a id="6382" href="ValueSep.Ledger.html#6315" class="Function">oper⇒denot</a> <a id="6393" class="Symbol">{</a><a id="6394" class="Argument">l</a> <a id="6396" class="Symbol">=</a> <a id="6398" class="DottedPattern Symbol">.</a><a id="6399" href="Agda.Builtin.List.html#185" class="DottedPattern InductiveConstructor">[]</a><a id="6401" class="Symbol">}</a> <a id="6403" href="ValueSep.Ledger.html#5514" class="InductiveConstructor">base</a> <a id="6408" class="Symbol">=</a> <a id="6410" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="6415" href="ValueSep.Ledger.html#6315" class="Function">oper⇒denot</a> <a id="6426" class="Symbol">{</a><a id="6427" class="Argument">l</a> <a id="6429" class="Symbol">=</a> <a id="6431" href="ValueSep.Ledger.html#6431" class="Bound">A</a> <a id="6433" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">—→⟨</a> <a id="6437" href="ValueSep.Ledger.html#6437" class="Bound">v</a> <a id="6439" href="ValueSep.Ledger.html#905" class="InductiveConstructor Operator">⟩</a> <a id="6441" href="ValueSep.Ledger.html#6441" class="Bound">B</a> <a id="6443" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6445" class="Symbol">_}{</a><a id="6448" href="ValueSep.Ledger.html#6448" class="Bound">s</a><a id="6449" class="Symbol">}</a> <a id="6451" class="Symbol">(</a><a id="6452" href="ValueSep.Ledger.html#5556" class="InductiveConstructor">step</a> <a id="6457" class="Symbol">{</a><a id="6458" class="Argument">vᵃ</a> <a id="6461" class="Symbol">=</a> <a id="6463" href="ValueSep.Ledger.html#6463" class="Bound">vᵃ</a><a id="6465" class="Symbol">}</a> <a id="6467" href="ValueSep.Ledger.html#6467" class="Bound">sA≡</a> <a id="6471" href="ValueSep.Ledger.html#6471" class="Bound">sB≡</a> <a id="6475" href="ValueSep.Ledger.html#6475" class="Bound">v≤</a> <a id="6478" href="ValueSep.Ledger.html#6478" class="Bound">p</a><a id="6479" class="Symbol">)</a>
  <a id="6483" class="Keyword">with</a> <a id="6488" href="ValueSep.Ledger.html#6448" class="Bound">s</a> <a id="6490" href="ValueSep.Ledger.html#6431" class="Bound">A</a>     <a id="6496" class="Symbol">|</a> <a id="6498" href="ValueSep.Ledger.html#6467" class="Bound">sA≡</a>    <a id="6505" class="Symbol">|</a> <a id="6507" href="ValueSep.Ledger.html#6448" class="Bound">s</a> <a id="6509" href="ValueSep.Ledger.html#6441" class="Bound">B</a>    <a id="6514" class="Symbol">|</a> <a id="6516" href="ValueSep.Ledger.html#6471" class="Bound">sB≡</a>
<a id="6520" class="Symbol">...</a> <a id="6524" class="Symbol">|</a> <a id="6526" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6531" class="DottedPattern Symbol">.</a><a id="6532" class="DottedPattern Bound">vᵃ</a> <a id="6535" class="Symbol">|</a> <a id="6537" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>   <a id="6544" class="Symbol">|</a> <a id="6546" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6551" class="Symbol">_</a> <a id="6553" class="Symbol">|</a> <a id="6555" class="Symbol">_</a>
  <a id="6559" class="Keyword">rewrite</a> <a id="6567" href="Relation.Nullary.Decidable.Core.html#3166" class="Function">dec-yes</a> <a id="6575" class="Symbol">(</a><a id="6576" class="Bound">v</a> <a id="6578" href="Prelude.Ord.Core.html#554" class="Function Operator">≤?</a> <a id="6581" class="Bound">vᵃ</a><a id="6583" class="Symbol">)</a> <a id="6585" class="Bound">v≤</a> <a id="6588" class="Symbol">.</a><a id="6589" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a>
  <a id="6597" class="Symbol">=</a> <a id="6599" href="ValueSep.Ledger.html#6315" class="Function">oper⇒denot</a> <a id="6610" class="Bound">p</a>

<a id="denot⇔oper"></a><a id="6613" href="ValueSep.Ledger.html#6613" class="Function">denot⇔oper</a> <a id="6624" class="Symbol">:</a>
  <a id="6628" href="ValueSep.Ledger.html#1567" class="Field Operator">⟦</a> <a id="6630" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="6632" href="ValueSep.Ledger.html#1567" class="Field Operator">⟧</a> <a id="6634" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="6636" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6638" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6643" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>
  <a id="6648" href="Prelude.InferenceRules.html#70247" class="Function Operator">═════════════════</a>
  <a id="6668" href="ValueSep.Ledger.html#1193" class="Generalizable">l</a> <a id="6670" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6672" href="ValueSep.Ledger.html#1117" class="Generalizable">s</a> <a id="6674" href="ValueSep.Ledger.html#5481" class="Datatype Operator">—→</a> <a id="6677" href="ValueSep.Ledger.html#1119" class="Generalizable">s′</a>
<a id="6680" href="ValueSep.Ledger.html#6613" class="Function">denot⇔oper</a> <a id="6691" class="Symbol">=</a> <a id="6693" href="ValueSep.Ledger.html#6035" class="Function">denot⇒oper</a> <a id="6704" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6706" href="ValueSep.Ledger.html#6315" class="Function">oper⇒denot</a>
</pre></body></html>