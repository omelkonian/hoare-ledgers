<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO.UTxO</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/hoare-ledgers/tree/master/UTxO/UTxO.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">----------------------------------------------</a>
<a id="48" class="Comment">-- ** Basic definition for UTxO-based ledgers.</a>

<a id="96" class="Keyword">module</a> <a id="103" href="UTxO.UTxO.html" class="Module">UTxO.UTxO</a> <a id="113" class="Keyword">where</a>

<a id="120" class="Keyword">open</a> <a id="125" class="Keyword">import</a> <a id="132" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="144" class="Symbol">;</a> <a id="146" class="Keyword">open</a> <a id="151" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="161" class="Keyword">open</a> <a id="166" class="Keyword">import</a> <a id="173" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Prelude.Lists.Dec.html" class="Module">Prelude.Lists.Dec</a>
<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="385" class="Keyword">open</a> <a id="390" class="Keyword">import</a> <a id="397" href="Prelude.ToList.html" class="Module">Prelude.ToList</a>

<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>

<a id="Value"></a><a id="439" href="UTxO.UTxO.html#439" class="Function">Value</a>   <a id="447" class="Symbol">=</a> <a id="449" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="HashId"></a><a id="451" href="UTxO.UTxO.html#451" class="Function">HashId</a>  <a id="459" class="Symbol">=</a> <a id="461" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="Address"></a><a id="463" href="UTxO.UTxO.html#463" class="Function">Address</a> <a id="471" class="Symbol">=</a> <a id="473" href="UTxO.UTxO.html#451" class="Function">HashId</a>
<a id="480" class="Keyword">postulate</a> <a id="_♯"></a><a id="490" href="UTxO.UTxO.html#490" class="Postulate Operator">_♯</a> <a id="493" class="Symbol">:</a> <a id="495" class="Symbol">∀</a> <a id="497" class="Symbol">{</a><a id="498" href="UTxO.UTxO.html#498" class="Bound">A</a> <a id="500" class="Symbol">:</a> <a id="502" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="507" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="508" class="Symbol">}</a> <a id="510" class="Symbol">→</a> <a id="512" href="UTxO.UTxO.html#498" class="Bound">A</a> <a id="514" class="Symbol">→</a> <a id="516" href="UTxO.UTxO.html#451" class="Function">HashId</a>

<a id="DATA"></a><a id="524" href="UTxO.UTxO.html#524" class="Function">DATA</a> <a id="529" class="Symbol">=</a> <a id="531" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="533" class="Comment">-- T0D0: more realistic data for redeemers</a>

<a id="577" class="Keyword">record</a> <a id="TxOutputRef"></a><a id="584" href="UTxO.UTxO.html#584" class="Record">TxOutputRef</a> <a id="596" class="Symbol">:</a> <a id="598" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="603" class="Keyword">where</a>
  <a id="611" class="Keyword">constructor</a> <a id="_indexed-at_"></a><a id="623" href="UTxO.UTxO.html#623" class="InductiveConstructor Operator">_indexed-at_</a>
  <a id="638" class="Keyword">field</a> <a id="TxOutputRef.txId"></a><a id="644" href="UTxO.UTxO.html#644" class="Field">txId</a>  <a id="650" class="Symbol">:</a> <a id="652" href="UTxO.UTxO.html#451" class="Function">HashId</a>
        <a id="TxOutputRef.index"></a><a id="667" href="UTxO.UTxO.html#667" class="Field">index</a> <a id="673" class="Symbol">:</a> <a id="675" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="677" class="Keyword">open</a> <a id="682" href="UTxO.UTxO.html#584" class="Module">TxOutputRef</a> <a id="694" class="Keyword">public</a>
<a id="701" class="Keyword">unquoteDecl</a> <a id="DecEq-TxOR"></a><a id="713" href="UTxO.UTxO.html#713" class="Function">DecEq-TxOR</a> <a id="724" class="Symbol">=</a> <a id="726" href="Prelude.Generics.Deriving.html#1119" class="Macro">DERIVE</a> <a id="733" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="739" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="741" class="Keyword">quote</a> <a id="747" href="UTxO.UTxO.html#584" class="Record">TxOutputRef</a> <a id="759" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="761" href="UTxO.UTxO.html#713" class="Function">DecEq-TxOR</a> <a id="772" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="775" class="Keyword">record</a> <a id="TxOutput"></a><a id="782" href="UTxO.UTxO.html#782" class="Record">TxOutput</a> <a id="791" class="Symbol">:</a> <a id="793" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="798" class="Keyword">where</a>
  <a id="806" class="Keyword">constructor</a> <a id="_at_"></a><a id="818" href="UTxO.UTxO.html#818" class="InductiveConstructor Operator">_at_</a>
  <a id="825" class="Keyword">field</a> <a id="TxOutput.value"></a><a id="831" href="UTxO.UTxO.html#831" class="Field">value</a>    <a id="840" class="Symbol">:</a> <a id="842" href="UTxO.UTxO.html#439" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="856" href="UTxO.UTxO.html#856" class="Field">address</a>  <a id="865" class="Symbol">:</a> <a id="867" href="UTxO.UTxO.html#463" class="Function">Address</a>
<a id="875" class="Keyword">open</a> <a id="880" href="UTxO.UTxO.html#782" class="Module">TxOutput</a> <a id="889" class="Keyword">public</a>
<a id="896" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="908" href="UTxO.UTxO.html#908" class="Function">DecEq-TxO</a> <a id="918" class="Symbol">=</a> <a id="920" href="Prelude.Generics.Deriving.html#1119" class="Macro">DERIVE</a> <a id="927" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="933" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="935" class="Keyword">quote</a> <a id="941" href="UTxO.UTxO.html#782" class="Record">TxOutput</a> <a id="950" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="952" href="UTxO.UTxO.html#908" class="Function">DecEq-TxO</a> <a id="962" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="965" class="Keyword">record</a> <a id="InputInfo"></a><a id="972" href="UTxO.UTxO.html#972" class="Record">InputInfo</a> <a id="982" class="Symbol">:</a> <a id="984" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="989" class="Keyword">where</a>
  <a id="997" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="1003" href="UTxO.UTxO.html#1003" class="Field">outputRef</a>     <a id="1017" class="Symbol">:</a> <a id="1019" href="UTxO.UTxO.html#584" class="Record">TxOutputRef</a>
        <a id="InputInfo.validatorHash"></a><a id="1039" href="UTxO.UTxO.html#1039" class="Field">validatorHash</a> <a id="1053" class="Symbol">:</a> <a id="1055" href="UTxO.UTxO.html#451" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="1070" href="UTxO.UTxO.html#1070" class="Field">redeemerHash</a>  <a id="1084" class="Symbol">:</a> <a id="1086" href="UTxO.UTxO.html#451" class="Function">HashId</a>

<a id="1094" class="Keyword">record</a> <a id="TxInfo"></a><a id="1101" href="UTxO.UTxO.html#1101" class="Record">TxInfo</a> <a id="1108" class="Symbol">:</a> <a id="1110" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1115" class="Keyword">where</a>
  <a id="1123" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="1129" href="UTxO.UTxO.html#1129" class="Field">inputs</a>  <a id="1137" class="Symbol">:</a> <a id="1139" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1144" href="UTxO.UTxO.html#972" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="1162" href="UTxO.UTxO.html#1162" class="Field">outputs</a> <a id="1170" class="Symbol">:</a> <a id="1172" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1177" href="UTxO.UTxO.html#782" class="Record">TxOutput</a>
        <a id="TxInfo.forge"></a><a id="1194" href="UTxO.UTxO.html#1194" class="Field">forge</a>   <a id="1202" class="Symbol">:</a> <a id="1204" href="UTxO.UTxO.html#439" class="Function">Value</a>

<a id="1211" class="Keyword">record</a> <a id="TxInput"></a><a id="1218" href="UTxO.UTxO.html#1218" class="Record">TxInput</a> <a id="1226" class="Symbol">:</a> <a id="1228" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1233" class="Keyword">where</a>
  <a id="1241" class="Keyword">field</a> <a id="TxInput.outputRef"></a><a id="1247" href="UTxO.UTxO.html#1247" class="Field">outputRef</a> <a id="1257" class="Symbol">:</a> <a id="1259" href="UTxO.UTxO.html#584" class="Record">TxOutputRef</a>
        <a id="TxInput.validator"></a><a id="1279" href="UTxO.UTxO.html#1279" class="Field">validator</a> <a id="1289" class="Symbol">:</a> <a id="1291" href="UTxO.UTxO.html#1101" class="Record">TxInfo</a> <a id="1298" class="Symbol">→</a> <a id="1300" href="UTxO.UTxO.html#524" class="Function">DATA</a> <a id="1305" class="Symbol">→</a> <a id="1307" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
        <a id="TxInput.redeemer"></a><a id="1320" href="UTxO.UTxO.html#1320" class="Field">redeemer</a>  <a id="1330" class="Symbol">:</a> <a id="1332" href="UTxO.UTxO.html#524" class="Function">DATA</a>
<a id="1337" class="Keyword">open</a> <a id="1342" href="UTxO.UTxO.html#1218" class="Module">TxInput</a> <a id="1350" class="Keyword">public</a>

<a id="mkInputInfo"></a><a id="1358" href="UTxO.UTxO.html#1358" class="Function">mkInputInfo</a> <a id="1370" class="Symbol">:</a> <a id="1372" href="UTxO.UTxO.html#1218" class="Record">TxInput</a> <a id="1380" class="Symbol">→</a> <a id="1382" href="UTxO.UTxO.html#972" class="Record">InputInfo</a>
<a id="1392" href="UTxO.UTxO.html#1358" class="Function">mkInputInfo</a> <a id="1404" href="UTxO.UTxO.html#1404" class="Bound">i</a> <a id="1406" class="Symbol">=</a> <a id="1408" class="Keyword">record</a>
  <a id="1417" class="Symbol">{</a> <a id="1419" href="UTxO.UTxO.html#1003" class="Field">outputRef</a>     <a id="1433" class="Symbol">=</a> <a id="1435" href="UTxO.UTxO.html#1404" class="Bound">i</a> <a id="1437" class="Symbol">.</a><a id="1438" href="UTxO.UTxO.html#1247" class="Field">outputRef</a>
  <a id="1450" class="Symbol">;</a> <a id="1452" href="UTxO.UTxO.html#1039" class="Field">validatorHash</a> <a id="1466" class="Symbol">=</a> <a id="1468" href="UTxO.UTxO.html#1404" class="Bound">i</a> <a id="1470" class="Symbol">.</a><a id="1471" href="UTxO.UTxO.html#1279" class="Field">validator</a> <a id="1481" href="UTxO.UTxO.html#490" class="Postulate Operator">♯</a>
  <a id="1485" class="Symbol">;</a> <a id="1487" href="UTxO.UTxO.html#1070" class="Field">redeemerHash</a>  <a id="1501" class="Symbol">=</a> <a id="1503" href="UTxO.UTxO.html#1404" class="Bound">i</a> <a id="1505" class="Symbol">.</a><a id="1506" href="UTxO.UTxO.html#1320" class="Field">redeemer</a> <a id="1515" href="UTxO.UTxO.html#490" class="Postulate Operator">♯</a> <a id="1517" class="Symbol">}</a>

<a id="1520" class="Keyword">record</a> <a id="Tx"></a><a id="1527" href="UTxO.UTxO.html#1527" class="Record">Tx</a> <a id="1530" class="Symbol">:</a> <a id="1532" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1537" class="Keyword">where</a>
  <a id="1545" class="Keyword">field</a>
    <a id="Tx.inputs"></a><a id="1555" href="UTxO.UTxO.html#1555" class="Field">inputs</a>  <a id="1563" class="Symbol">:</a> <a id="1565" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1570" href="UTxO.UTxO.html#1218" class="Record">TxInput</a>
    <a id="Tx.outputs"></a><a id="1582" href="UTxO.UTxO.html#1582" class="Field">outputs</a> <a id="1590" class="Symbol">:</a> <a id="1592" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1597" href="UTxO.UTxO.html#782" class="Record">TxOutput</a>
    <a id="Tx.forge"></a><a id="1610" href="UTxO.UTxO.html#1610" class="Field">forge</a>   <a id="1618" class="Symbol">:</a> <a id="1620" href="UTxO.UTxO.html#439" class="Function">Value</a>
<a id="1626" class="Keyword">open</a> <a id="1631" href="UTxO.UTxO.html#1527" class="Module">Tx</a> <a id="1634" class="Keyword">public</a>

<a id="mkTxInfo"></a><a id="1642" href="UTxO.UTxO.html#1642" class="Function">mkTxInfo</a> <a id="1651" class="Symbol">:</a> <a id="1653" href="UTxO.UTxO.html#1527" class="Record">Tx</a> <a id="1656" class="Symbol">→</a> <a id="1658" href="UTxO.UTxO.html#1101" class="Record">TxInfo</a>
<a id="1665" href="UTxO.UTxO.html#1642" class="Function">mkTxInfo</a> <a id="1674" href="UTxO.UTxO.html#1674" class="Bound">tx</a> <a id="1677" class="Symbol">=</a> <a id="1679" class="Keyword">record</a>
  <a id="1688" class="Symbol">{</a> <a id="1690" href="UTxO.UTxO.html#1129" class="Field">inputs</a>  <a id="1698" class="Symbol">=</a> <a id="1700" href="UTxO.UTxO.html#1358" class="Function">mkInputInfo</a> <a id="1712" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1716" href="UTxO.UTxO.html#1674" class="Bound">tx</a> <a id="1719" class="Symbol">.</a><a id="1720" href="UTxO.UTxO.html#1555" class="Field">inputs</a>
  <a id="1729" class="Symbol">;</a> <a id="1731" href="UTxO.UTxO.html#1162" class="Field">outputs</a> <a id="1739" class="Symbol">=</a> <a id="1741" href="UTxO.UTxO.html#1674" class="Bound">tx</a> <a id="1744" class="Symbol">.</a><a id="1745" href="UTxO.UTxO.html#1582" class="Field">outputs</a>
  <a id="1755" class="Symbol">;</a> <a id="1757" href="UTxO.UTxO.html#1194" class="Field">forge</a>   <a id="1765" class="Symbol">=</a> <a id="1767" href="UTxO.UTxO.html#1674" class="Bound">tx</a> <a id="1770" class="Symbol">.</a><a id="1771" href="UTxO.UTxO.html#1610" class="Field">forge</a> <a id="1777" class="Symbol">}</a>

<a id="1780" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="1819" href="UTxO.UTxO.html#1819" class="Function">L</a> <a id="1821" class="Symbol">=</a> <a id="1823" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1828" href="UTxO.UTxO.html#1527" class="Record">Tx</a>

<a id="1832" class="Keyword">record</a> <a id="UTXO"></a><a id="1839" href="UTxO.UTxO.html#1839" class="Record">UTXO</a> <a id="1844" class="Symbol">:</a> <a id="1846" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1851" class="Keyword">where</a>
  <a id="1859" class="Keyword">field</a> <a id="UTXO.outRef"></a><a id="1865" href="UTxO.UTxO.html#1865" class="Field">outRef</a> <a id="1872" class="Symbol">:</a> <a id="1874" href="UTxO.UTxO.html#584" class="Record">TxOutputRef</a>
        <a id="UTXO.out"></a><a id="1894" href="UTxO.UTxO.html#1894" class="Field">out</a>    <a id="1901" class="Symbol">:</a> <a id="1903" href="UTxO.UTxO.html#782" class="Record">TxOutput</a>
<a id="1912" class="Keyword">unquoteDecl</a> <a id="DecEq-UTXO"></a><a id="1924" href="UTxO.UTxO.html#1924" class="Function">DecEq-UTXO</a> <a id="1935" class="Symbol">=</a> <a id="1937" href="Prelude.Generics.Deriving.html#1119" class="Macro">DERIVE</a> <a id="1944" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="1950" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1952" class="Keyword">quote</a> <a id="1958" href="UTxO.UTxO.html#1839" class="Record">UTXO</a> <a id="1963" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1965" href="UTxO.UTxO.html#1924" class="Function">DecEq-UTXO</a> <a id="1976" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="1979" class="Comment">-- The state of a ledger is a collection of unspent transaction outputs.</a>
<a id="S"></a><a id="2052" href="UTxO.UTxO.html#2052" class="Function">S</a> <a id="2054" class="Symbol">:</a> <a id="2056" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="2061" href="UTxO.UTxO.html#2052" class="Function">S</a> <a id="2063" class="Symbol">=</a> <a id="2065" href="Prelude.Sets.AsUniqueLists.Core.html#1017" class="Record">Set⟨</a> <a id="2070" href="UTxO.UTxO.html#1839" class="Record">UTXO</a> <a id="2075" href="Prelude.Sets.AsUniqueLists.Core.html#1017" class="Record">⟩</a>

<a id="mkUtxo"></a><a id="2078" href="UTxO.UTxO.html#2078" class="Function">mkUtxo</a> <a id="2085" class="Symbol">:</a> <a id="2087" class="Symbol">∀</a> <a id="2089" class="Symbol">{</a><a id="2090" href="UTxO.UTxO.html#2090" class="Bound">out</a><a id="2093" class="Symbol">}</a> <a id="2095" href="UTxO.UTxO.html#2095" class="Bound">tx</a> <a id="2098" class="Symbol">→</a> <a id="2100" href="UTxO.UTxO.html#2090" class="Bound">out</a> <a id="2104" href="Data.List.Membership.Setoid.html#896" class="Function Operator">L.Mem.∈</a> <a id="2112" href="UTxO.UTxO.html#1582" class="Field">outputs</a> <a id="2120" href="UTxO.UTxO.html#2095" class="Bound">tx</a> <a id="2123" class="Symbol">→</a> <a id="2125" href="UTxO.UTxO.html#1839" class="Record">UTXO</a>
<a id="2130" href="UTxO.UTxO.html#2078" class="Function">mkUtxo</a> <a id="2137" class="Symbol">{</a><a id="2138" href="UTxO.UTxO.html#2138" class="Bound">out</a><a id="2141" class="Symbol">}</a> <a id="2143" href="UTxO.UTxO.html#2143" class="Bound">tx</a> <a id="2146" href="UTxO.UTxO.html#2146" class="Bound">out∈</a> <a id="2151" class="Symbol">=</a> <a id="2153" class="Symbol">λ</a> <a id="2155" class="Keyword">where</a>
  <a id="2163" class="Symbol">.</a><a id="2164" href="UTxO.UTxO.html#1865" class="Field">UTXO.outRef</a> <a id="2176" class="Symbol">→</a> <a id="2178" class="Symbol">(</a><a id="2179" href="UTxO.UTxO.html#2143" class="Bound">tx</a> <a id="2182" href="UTxO.UTxO.html#490" class="Postulate Operator">♯</a><a id="2183" class="Symbol">)</a> <a id="2185" href="UTxO.UTxO.html#623" class="InductiveConstructor Operator">indexed-at</a> <a id="2196" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="2200" class="Symbol">(</a><a id="2201" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="2213" href="UTxO.UTxO.html#2146" class="Bound">out∈</a><a id="2217" class="Symbol">)</a>
  <a id="2221" class="Symbol">.</a><a id="2222" href="UTxO.UTxO.html#1894" class="Field">UTXO.out</a>    <a id="2234" class="Symbol">→</a> <a id="2236" href="UTxO.UTxO.html#2138" class="Bound">out</a>

<a id="outputRefs"></a><a id="2241" href="UTxO.UTxO.html#2241" class="Function">outputRefs</a> <a id="2252" class="Symbol">:</a> <a id="2254" href="UTxO.UTxO.html#1527" class="Record">Tx</a> <a id="2257" class="Symbol">→</a> <a id="2259" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2264" href="UTxO.UTxO.html#584" class="Record">TxOutputRef</a>
<a id="2276" href="UTxO.UTxO.html#2241" class="Function">outputRefs</a> <a id="2287" class="Symbol">=</a> <a id="2289" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2293" href="UTxO.UTxO.html#1247" class="Field">outputRef</a> <a id="2303" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2305" href="UTxO.UTxO.html#1555" class="Field">inputs</a>

<a id="getSpentOutputRef"></a><a id="2313" href="UTxO.UTxO.html#2313" class="Function">getSpentOutputRef</a> <a id="2331" class="Symbol">:</a> <a id="2333" href="UTxO.UTxO.html#2052" class="Function">S</a> <a id="2335" class="Symbol">→</a> <a id="2337" href="UTxO.UTxO.html#584" class="Record">TxOutputRef</a> <a id="2349" class="Symbol">→</a> <a id="2351" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2357" href="UTxO.UTxO.html#782" class="Record">TxOutput</a>
<a id="2366" href="UTxO.UTxO.html#2313" class="Function">getSpentOutputRef</a> <a id="2384" href="UTxO.UTxO.html#2384" class="Bound">s</a> <a id="2386" href="UTxO.UTxO.html#2386" class="Bound">oRef</a> <a id="2391" class="Symbol">=</a> <a id="2393" href="UTxO.UTxO.html#2419" class="Function">go</a> <a id="2396" class="Symbol">(</a><a id="2397" href="Prelude.ToList.html#193" class="Field">toList</a> <a id="2404" href="UTxO.UTxO.html#2384" class="Bound">s</a><a id="2405" class="Symbol">)</a>
  <a id="2409" class="Keyword">where</a>
    <a id="2419" href="UTxO.UTxO.html#2419" class="Function">go</a> <a id="2422" class="Symbol">:</a> <a id="2424" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2429" href="UTxO.UTxO.html#1839" class="Record">UTXO</a> <a id="2434" class="Symbol">→</a> <a id="2436" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2442" href="UTxO.UTxO.html#782" class="Record">TxOutput</a>
    <a id="2455" href="UTxO.UTxO.html#2419" class="Function">go</a> <a id="2458" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2461" class="Symbol">=</a> <a id="2463" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
    <a id="2475" href="UTxO.UTxO.html#2419" class="Function">go</a> <a id="2478" class="Symbol">(</a><a id="2479" class="Keyword">record</a> <a id="2486" class="Symbol">{</a><a id="2487" href="UTxO.UTxO.html#1865" class="Field">outRef</a> <a id="2494" class="Symbol">=</a> <a id="2496" href="UTxO.UTxO.html#2496" class="Bound">or</a><a id="2498" class="Symbol">;</a> <a id="2500" href="UTxO.UTxO.html#1894" class="Field">out</a> <a id="2504" class="Symbol">=</a> <a id="2506" href="UTxO.UTxO.html#2506" class="Bound">o</a><a id="2507" class="Symbol">}</a> <a id="2509" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2511" href="UTxO.UTxO.html#2511" class="Bound">xs</a><a id="2513" class="Symbol">)</a> <a id="2515" class="Symbol">=</a>
      <a id="2523" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2526" href="UTxO.UTxO.html#2386" class="Bound">oRef</a> <a id="2531" href="Prelude.DecEq.Core.html#222" class="Function Operator">==</a> <a id="2534" href="UTxO.UTxO.html#2496" class="Bound">or</a> <a id="2537" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>
        <a id="2550" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2555" href="UTxO.UTxO.html#2506" class="Bound">o</a>
      <a id="2563" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
        <a id="2576" href="UTxO.UTxO.html#2419" class="Function">go</a> <a id="2579" href="UTxO.UTxO.html#2511" class="Bound">xs</a>

<a id="getSpentOutput"></a><a id="2583" href="UTxO.UTxO.html#2583" class="Function">getSpentOutput</a> <a id="2598" class="Symbol">:</a> <a id="2600" href="UTxO.UTxO.html#2052" class="Function">S</a> <a id="2602" class="Symbol">→</a> <a id="2604" href="UTxO.UTxO.html#1218" class="Record">TxInput</a> <a id="2612" class="Symbol">→</a> <a id="2614" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2620" href="UTxO.UTxO.html#782" class="Record">TxOutput</a>
<a id="2629" href="UTxO.UTxO.html#2583" class="Function">getSpentOutput</a> <a id="2644" href="UTxO.UTxO.html#2644" class="Bound">s</a> <a id="2646" href="UTxO.UTxO.html#2646" class="Bound">i</a> <a id="2648" class="Symbol">=</a> <a id="2650" href="UTxO.UTxO.html#2313" class="Function">getSpentOutputRef</a> <a id="2668" href="UTxO.UTxO.html#2644" class="Bound">s</a> <a id="2670" class="Symbol">(</a><a id="2671" href="UTxO.UTxO.html#2646" class="Bound">i</a> <a id="2673" class="Symbol">.</a><a id="2674" href="UTxO.UTxO.html#1247" class="Field">outputRef</a><a id="2683" class="Symbol">)</a>

<a id="∑"></a><a id="2686" href="UTxO.UTxO.html#2686" class="Function">∑</a> <a id="2688" class="Symbol">:</a> <a id="2690" class="Symbol">∀</a> <a id="2692" class="Symbol">{</a><a id="2693" href="UTxO.UTxO.html#2693" class="Bound">A</a> <a id="2695" class="Symbol">:</a> <a id="2697" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="2701" class="Symbol">}</a> <a id="2703" class="Symbol">→</a> <a id="2705" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2710" href="UTxO.UTxO.html#2693" class="Bound">A</a> <a id="2712" class="Symbol">→</a> <a id="2714" class="Symbol">(</a><a id="2715" href="UTxO.UTxO.html#2693" class="Bound">A</a> <a id="2717" class="Symbol">→</a> <a id="2719" href="UTxO.UTxO.html#439" class="Function">Value</a><a id="2724" class="Symbol">)</a> <a id="2726" class="Symbol">→</a> <a id="2728" href="UTxO.UTxO.html#439" class="Function">Value</a>
<a id="2734" href="UTxO.UTxO.html#2686" class="Function">∑</a> <a id="2736" href="UTxO.UTxO.html#2736" class="Bound">xs</a> <a id="2739" href="UTxO.UTxO.html#2739" class="Bound">f</a> <a id="2741" class="Symbol">=</a> <a id="2743" href="Prelude.Lists.Sums.html#295" class="Function">∑ℕ</a> <a id="2746" class="Symbol">(</a><a id="2747" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2751" href="UTxO.UTxO.html#2739" class="Bound">f</a> <a id="2753" href="UTxO.UTxO.html#2736" class="Bound">xs</a><a id="2755" class="Symbol">)</a>

<a id="∑M"></a><a id="2758" href="UTxO.UTxO.html#2758" class="Function">∑M</a> <a id="2761" class="Symbol">:</a> <a id="2763" class="Symbol">∀</a> <a id="2765" class="Symbol">{</a><a id="2766" href="UTxO.UTxO.html#2766" class="Bound">A</a> <a id="2768" class="Symbol">:</a> <a id="2770" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="2774" class="Symbol">}</a> <a id="2776" class="Symbol">→</a> <a id="2778" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2783" class="Symbol">(</a><a id="2784" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2790" href="UTxO.UTxO.html#2766" class="Bound">A</a><a id="2791" class="Symbol">)</a> <a id="2793" class="Symbol">→</a> <a id="2795" class="Symbol">(</a><a id="2796" href="UTxO.UTxO.html#2766" class="Bound">A</a> <a id="2798" class="Symbol">→</a> <a id="2800" href="UTxO.UTxO.html#439" class="Function">Value</a><a id="2805" class="Symbol">)</a> <a id="2807" class="Symbol">→</a> <a id="2809" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2815" href="UTxO.UTxO.html#439" class="Function">Value</a>
<a id="2821" href="UTxO.UTxO.html#2758" class="Function">∑M</a> <a id="2824" href="UTxO.UTxO.html#2824" class="Bound">xs</a> <a id="2827" href="UTxO.UTxO.html#2827" class="Bound">f</a> <a id="2829" class="Symbol">=</a> <a id="2831" class="Symbol">(</a><a id="2832" href="Function.Base.html#1563" class="Function">flip</a> <a id="2837" href="UTxO.UTxO.html#2686" class="Function">∑</a> <a id="2839" href="UTxO.UTxO.html#2827" class="Bound">f</a><a id="2840" class="Symbol">)</a> <a id="2842" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="2846" href="UTxO.UTxO.html#2903" class="Function">seqM</a> <a id="2851" href="UTxO.UTxO.html#2824" class="Bound">xs</a>
  <a id="2856" class="Keyword">where</a>
    <a id="2866" class="Comment">-- if one fails everything fails</a>
    <a id="2903" href="UTxO.UTxO.html#2903" class="Function">seqM</a> <a id="2908" class="Symbol">:</a> <a id="2910" class="Symbol">∀</a> <a id="2912" class="Symbol">{</a><a id="2913" href="UTxO.UTxO.html#2913" class="Bound">A</a> <a id="2915" class="Symbol">:</a> <a id="2917" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="2921" class="Symbol">}</a> <a id="2923" class="Symbol">→</a> <a id="2925" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2930" class="Symbol">(</a><a id="2931" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2937" href="UTxO.UTxO.html#2913" class="Bound">A</a><a id="2938" class="Symbol">)</a> <a id="2940" class="Symbol">→</a> <a id="2942" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2948" class="Symbol">(</a><a id="2949" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2954" href="UTxO.UTxO.html#2913" class="Bound">A</a><a id="2955" class="Symbol">)</a>
    <a id="2961" href="UTxO.UTxO.html#2903" class="Function">seqM</a> <a id="2966" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>       <a id="2975" class="Symbol">=</a> <a id="2977" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2982" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
    <a id="2989" href="UTxO.UTxO.html#2903" class="Function">seqM</a> <a id="2994" class="Symbol">(</a><a id="2995" href="UTxO.UTxO.html#2995" class="Bound">x</a> <a id="2997" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2999" href="UTxO.UTxO.html#2999" class="Bound">xs</a><a id="3001" class="Symbol">)</a> <a id="3003" class="Symbol">=</a> <a id="3005" class="Symbol">⦇</a> <a id="3007" href="UTxO.UTxO.html#2995" class="Bound">x</a> <a id="3009" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3011" href="UTxO.UTxO.html#2903" class="Function">seqM</a> <a id="3016" href="UTxO.UTxO.html#2999" class="Bound">xs</a> <a id="3019" class="Symbol">⦈</a>

<a id="3022" class="Keyword">record</a> <a id="IsValidTx"></a><a id="3029" href="UTxO.UTxO.html#3029" class="Record">IsValidTx</a> <a id="3039" class="Symbol">(</a><a id="3040" href="UTxO.UTxO.html#3040" class="Bound">tx</a> <a id="3043" class="Symbol">:</a> <a id="3045" href="UTxO.UTxO.html#1527" class="Record">Tx</a><a id="3047" class="Symbol">)</a> <a id="3049" class="Symbol">(</a><a id="3050" href="UTxO.UTxO.html#3050" class="Bound">utxos</a> <a id="3056" class="Symbol">:</a> <a id="3058" href="UTxO.UTxO.html#2052" class="Function">S</a><a id="3059" class="Symbol">)</a> <a id="3061" class="Symbol">:</a> <a id="3063" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="3068" class="Keyword">where</a>
  <a id="3076" class="Keyword">field</a>
    <a id="IsValidTx.validOutputRefs"></a><a id="3086" href="UTxO.UTxO.html#3086" class="Field">validOutputRefs</a> <a id="3102" class="Symbol">:</a>
      <a id="3110" href="UTxO.UTxO.html#2241" class="Function">outputRefs</a> <a id="3121" href="UTxO.UTxO.html#3040" class="Bound">tx</a> <a id="3124" href="Data.List.Relation.Binary.Subset.Setoid.html#748" class="Function Operator">⊆</a> <a id="3126" href="Data.List.Base.html#1553" class="Function">map</a> <a id="3130" href="UTxO.UTxO.html#1865" class="Field">UTXO.outRef</a> <a id="3142" class="Symbol">(</a><a id="3143" href="Prelude.ToList.html#193" class="Field">toList</a> <a id="3150" href="UTxO.UTxO.html#3050" class="Bound">utxos</a><a id="3155" class="Symbol">)</a>

    <a id="IsValidTx.preservesValues"></a><a id="3162" href="UTxO.UTxO.html#3162" class="Field">preservesValues</a> <a id="3178" class="Symbol">:</a>
      <a id="3186" href="Data.Maybe.Relation.Unary.Any.html#839" class="Datatype">M.Any.Any</a> <a id="3196" class="Symbol">(λ</a> <a id="3199" href="UTxO.UTxO.html#3199" class="Bound">q</a> <a id="3201" class="Symbol">→</a> <a id="3203" href="UTxO.UTxO.html#3040" class="Bound">tx</a> <a id="3206" class="Symbol">.</a><a id="3207" href="UTxO.UTxO.html#1610" class="Field">forge</a> <a id="3213" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="3215" href="UTxO.UTxO.html#3199" class="Bound">q</a> <a id="3217" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3219" href="UTxO.UTxO.html#2686" class="Function">∑</a> <a id="3221" class="Symbol">(</a><a id="3222" href="UTxO.UTxO.html#3040" class="Bound">tx</a> <a id="3225" class="Symbol">.</a><a id="3226" href="UTxO.UTxO.html#1582" class="Field">outputs</a><a id="3233" class="Symbol">)</a> <a id="3235" href="UTxO.UTxO.html#831" class="Field">value</a><a id="3240" class="Symbol">)</a>
                <a id="3258" class="Symbol">(</a><a id="3259" href="UTxO.UTxO.html#2758" class="Function">∑M</a> <a id="3262" class="Symbol">(</a><a id="3263" href="Data.List.Base.html#1553" class="Function">map</a> <a id="3267" class="Symbol">(</a><a id="3268" href="UTxO.UTxO.html#2583" class="Function">getSpentOutput</a> <a id="3283" href="UTxO.UTxO.html#3050" class="Bound">utxos</a><a id="3288" class="Symbol">)</a> <a id="3290" class="Symbol">(</a><a id="3291" href="UTxO.UTxO.html#3040" class="Bound">tx</a> <a id="3294" class="Symbol">.</a><a id="3295" href="UTxO.UTxO.html#1555" class="Field">inputs</a><a id="3301" class="Symbol">))</a> <a id="3304" href="UTxO.UTxO.html#831" class="Field">value</a><a id="3309" class="Symbol">)</a>

    <a id="IsValidTx.noDoubleSpending"></a><a id="3316" href="UTxO.UTxO.html#3316" class="Field">noDoubleSpending</a> <a id="3333" class="Symbol">:</a>
      <a id="3341" href="Data.List.Relation.Unary.Unique.Setoid.html#728" class="Datatype">Unique</a> <a id="3348" class="Symbol">(</a><a id="3349" href="UTxO.UTxO.html#2241" class="Function">outputRefs</a> <a id="3360" href="UTxO.UTxO.html#3040" class="Bound">tx</a><a id="3362" class="Symbol">)</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="3369" href="UTxO.UTxO.html#3369" class="Field">allInputsValidate</a> <a id="3387" class="Symbol">:</a>
      <a id="3395" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="3399" class="Symbol">(λ</a> <a id="3402" href="UTxO.UTxO.html#3402" class="Bound">i</a> <a id="3404" class="Symbol">→</a> <a id="3406" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="3408" class="Symbol">(</a><a id="3409" href="UTxO.UTxO.html#1279" class="Field">validator</a> <a id="3419" href="UTxO.UTxO.html#3402" class="Bound">i</a> <a id="3421" class="Symbol">(</a><a id="3422" href="UTxO.UTxO.html#1642" class="Function">mkTxInfo</a> <a id="3431" href="UTxO.UTxO.html#3040" class="Bound">tx</a><a id="3433" class="Symbol">)</a> <a id="3435" class="Symbol">(</a><a id="3436" href="UTxO.UTxO.html#3402" class="Bound">i</a> <a id="3438" class="Symbol">.</a><a id="3439" href="UTxO.UTxO.html#1320" class="Field">redeemer</a><a id="3447" class="Symbol">)))</a>
          <a id="3461" class="Symbol">(</a><a id="3462" href="UTxO.UTxO.html#3040" class="Bound">tx</a> <a id="3465" class="Symbol">.</a><a id="3466" href="UTxO.UTxO.html#1555" class="Field">inputs</a><a id="3472" class="Symbol">)</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="3479" href="UTxO.UTxO.html#3479" class="Field">validateValidHashes</a> <a id="3499" class="Symbol">:</a>
      <a id="3507" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="3511" class="Symbol">(λ</a> <a id="3514" href="UTxO.UTxO.html#3514" class="Bound">i</a> <a id="3516" class="Symbol">→</a> <a id="3518" href="Data.Maybe.Relation.Unary.Any.html#839" class="Datatype">M.Any.Any</a> <a id="3528" class="Symbol">(λ</a> <a id="3531" href="UTxO.UTxO.html#3531" class="Bound">o</a> <a id="3533" class="Symbol">→</a> <a id="3535" href="UTxO.UTxO.html#3531" class="Bound">o</a> <a id="3537" class="Symbol">.</a><a id="3538" href="UTxO.UTxO.html#856" class="Field">address</a> <a id="3546" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3548" href="UTxO.UTxO.html#3514" class="Bound">i</a> <a id="3550" class="Symbol">.</a><a id="3551" href="UTxO.UTxO.html#1279" class="Field">validator</a> <a id="3561" href="UTxO.UTxO.html#490" class="Postulate Operator">♯</a><a id="3562" class="Symbol">)</a> <a id="3564" class="Symbol">(</a><a id="3565" href="UTxO.UTxO.html#2583" class="Function">getSpentOutput</a> <a id="3580" href="UTxO.UTxO.html#3050" class="Bound">utxos</a> <a id="3586" href="UTxO.UTxO.html#3514" class="Bound">i</a><a id="3587" class="Symbol">))</a>
          <a id="3600" class="Symbol">(</a><a id="3601" href="UTxO.UTxO.html#3040" class="Bound">tx</a> <a id="3604" class="Symbol">.</a><a id="3605" href="UTxO.UTxO.html#1555" class="Field">inputs</a><a id="3611" class="Symbol">)</a>

<a id="3614" class="Keyword">open</a> <a id="3619" href="UTxO.UTxO.html#3029" class="Module">IsValidTx</a> <a id="3629" class="Keyword">public</a>

<a id="isValidTx?"></a><a id="3637" href="UTxO.UTxO.html#3637" class="Function">isValidTx?</a> <a id="3648" class="Symbol">:</a> <a id="3650" class="Symbol">∀</a> <a id="3652" href="UTxO.UTxO.html#3652" class="Bound">tx</a> <a id="3655" href="UTxO.UTxO.html#3655" class="Bound">s</a> <a id="3657" class="Symbol">→</a> <a id="3659" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="3663" class="Symbol">(</a><a id="3664" href="UTxO.UTxO.html#3029" class="Record">IsValidTx</a> <a id="3674" href="UTxO.UTxO.html#3652" class="Bound">tx</a> <a id="3677" href="UTxO.UTxO.html#3655" class="Bound">s</a><a id="3678" class="Symbol">)</a>
<a id="3680" href="UTxO.UTxO.html#3637" class="Function">isValidTx?</a> <a id="3691" href="UTxO.UTxO.html#3691" class="Bound">tx</a> <a id="3694" href="UTxO.UTxO.html#3694" class="Bound">utxos</a>
  <a id="3702" class="Keyword">with</a> <a id="3707" href="UTxO.UTxO.html#2241" class="Function">outputRefs</a> <a id="3718" href="UTxO.UTxO.html#3691" class="Bound">tx</a> <a id="3721" href="Prelude.Lists.Dec.html#1440" class="Function Operator">⊆?</a> <a id="3724" href="Data.List.Base.html#1553" class="Function">map</a> <a id="3728" href="UTxO.UTxO.html#1865" class="Field">UTXO.outRef</a> <a id="3740" class="Symbol">(</a><a id="3741" href="Prelude.ToList.html#193" class="Field">toList</a> <a id="3748" href="UTxO.UTxO.html#3694" class="Bound">utxos</a><a id="3753" class="Symbol">)</a>
<a id="3755" class="Symbol">...</a> <a id="3759" class="Symbol">|</a> <a id="3761" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3764" href="UTxO.UTxO.html#3764" class="Bound">¬p</a> <a id="3767" class="Symbol">=</a> <a id="3769" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3772" class="Symbol">(</a><a id="3773" href="UTxO.UTxO.html#3764" class="Bound">¬p</a> <a id="3776" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3778" href="UTxO.UTxO.html#3086" class="Field">validOutputRefs</a> <a id="3794" class="Symbol">)</a>
<a id="3796" class="Symbol">...</a> <a id="3800" class="Symbol">|</a> <a id="3802" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3806" href="UTxO.UTxO.html#3806" class="Bound">p₁</a>
  <a id="3811" class="Keyword">with</a> <a id="3816" href="Data.Maybe.Relation.Unary.Any.html#2137" class="Function">M.Any.dec</a> <a id="3826" class="Symbol">(λ</a> <a id="3829" href="UTxO.UTxO.html#3829" class="Bound">q</a> <a id="3831" class="Symbol">→</a> <a id="3833" class="Bound">tx</a> <a id="3836" class="Symbol">.</a><a id="3837" href="UTxO.UTxO.html#1610" class="Field">forge</a> <a id="3843" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="3845" href="UTxO.UTxO.html#3829" class="Bound">q</a> <a id="3847" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="3849" href="UTxO.UTxO.html#2686" class="Function">∑</a> <a id="3851" class="Symbol">(</a><a id="3852" class="Bound">tx</a> <a id="3855" class="Symbol">.</a><a id="3856" href="UTxO.UTxO.html#1582" class="Field">outputs</a><a id="3863" class="Symbol">)</a> <a id="3865" href="UTxO.UTxO.html#831" class="Field">value</a><a id="3870" class="Symbol">)</a>
                 <a id="3889" class="Symbol">(</a><a id="3890" href="UTxO.UTxO.html#2758" class="Function">∑M</a> <a id="3893" class="Symbol">(</a><a id="3894" href="Data.List.Base.html#1553" class="Function">map</a> <a id="3898" class="Symbol">(</a><a id="3899" href="UTxO.UTxO.html#2583" class="Function">getSpentOutput</a> <a id="3914" class="Bound">utxos</a><a id="3919" class="Symbol">)</a> <a id="3921" class="Symbol">(</a><a id="3922" class="Bound">tx</a> <a id="3925" class="Symbol">.</a><a id="3926" href="UTxO.UTxO.html#1555" class="Field">inputs</a><a id="3932" class="Symbol">))</a> <a id="3935" href="UTxO.UTxO.html#831" class="Field">value</a><a id="3940" class="Symbol">)</a>
<a id="3942" class="Symbol">...</a> <a id="3946" class="Symbol">|</a> <a id="3948" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3951" href="UTxO.UTxO.html#3951" class="Bound">¬p</a> <a id="3954" class="Symbol">=</a> <a id="3956" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3959" class="Symbol">(</a><a id="3960" href="UTxO.UTxO.html#3951" class="Bound">¬p</a> <a id="3963" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3965" href="UTxO.UTxO.html#3162" class="Field">preservesValues</a><a id="3980" class="Symbol">)</a>
<a id="3982" class="Symbol">...</a> <a id="3986" class="Symbol">|</a> <a id="3988" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3992" href="UTxO.UTxO.html#3992" class="Bound">p₂</a>
  <a id="3997" class="Keyword">with</a> <a id="4002" href="Prelude.Lists.Dec.html#1498" class="Function">unique?</a> <a id="4010" class="Symbol">(</a><a id="4011" href="UTxO.UTxO.html#2241" class="Function">outputRefs</a> <a id="4022" class="Bound">tx</a><a id="4024" class="Symbol">)</a>
<a id="4026" class="Symbol">...</a> <a id="4030" class="Symbol">|</a> <a id="4032" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4035" href="UTxO.UTxO.html#4035" class="Bound">¬p</a> <a id="4038" class="Symbol">=</a> <a id="4040" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4043" class="Symbol">(</a><a id="4044" href="UTxO.UTxO.html#4035" class="Bound">¬p</a> <a id="4047" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4049" href="UTxO.UTxO.html#3316" class="Field">noDoubleSpending</a><a id="4065" class="Symbol">)</a>
<a id="4067" class="Symbol">...</a> <a id="4071" class="Symbol">|</a> <a id="4073" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4077" href="UTxO.UTxO.html#4077" class="Bound">p₃</a>
  <a id="4082" class="Keyword">with</a> <a id="4087" href="Data.List.Relation.Unary.All.html#6249" class="Function">all?</a> <a id="4092" class="Symbol">(λ</a> <a id="4095" href="UTxO.UTxO.html#4095" class="Bound">i</a> <a id="4097" class="Symbol">→</a> <a id="4099" href="Data.Bool.Properties.html#15479" class="Function">T?</a> <a id="4102" class="Symbol">(</a><a id="4103" href="UTxO.UTxO.html#1279" class="Field">validator</a> <a id="4113" href="UTxO.UTxO.html#4095" class="Bound">i</a> <a id="4115" class="Symbol">(</a><a id="4116" href="UTxO.UTxO.html#1642" class="Function">mkTxInfo</a> <a id="4125" class="Bound">tx</a><a id="4127" class="Symbol">)</a> <a id="4129" class="Symbol">(</a><a id="4130" href="UTxO.UTxO.html#4095" class="Bound">i</a> <a id="4132" class="Symbol">.</a><a id="4133" href="UTxO.UTxO.html#1320" class="Field">redeemer</a><a id="4141" class="Symbol">)))</a>
            <a id="4157" class="Symbol">(</a><a id="4158" class="Bound">tx</a> <a id="4161" class="Symbol">.</a><a id="4162" href="UTxO.UTxO.html#1555" class="Field">inputs</a><a id="4168" class="Symbol">)</a>
<a id="4170" class="Symbol">...</a> <a id="4174" class="Symbol">|</a> <a id="4176" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4179" href="UTxO.UTxO.html#4179" class="Bound">¬p</a> <a id="4182" class="Symbol">=</a> <a id="4184" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4187" class="Symbol">(</a><a id="4188" href="UTxO.UTxO.html#4179" class="Bound">¬p</a> <a id="4191" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4193" href="UTxO.UTxO.html#3369" class="Field">allInputsValidate</a><a id="4210" class="Symbol">)</a>
<a id="4212" class="Symbol">...</a> <a id="4216" class="Symbol">|</a> <a id="4218" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4222" href="UTxO.UTxO.html#4222" class="Bound">p₄</a>
  <a id="4227" class="Keyword">with</a> <a id="4232" href="Data.List.Relation.Unary.All.html#6249" class="Function">all?</a> <a id="4237" class="Symbol">(λ</a> <a id="4240" href="UTxO.UTxO.html#4240" class="Bound">i</a> <a id="4242" class="Symbol">→</a> <a id="4244" href="Data.Maybe.Relation.Unary.Any.html#2137" class="Function">M.Any.dec</a> <a id="4254" class="Symbol">(λ</a> <a id="4257" href="UTxO.UTxO.html#4257" class="Bound">o</a> <a id="4259" class="Symbol">→</a> <a id="4261" href="UTxO.UTxO.html#4257" class="Bound">o</a> <a id="4263" class="Symbol">.</a><a id="4264" href="UTxO.UTxO.html#856" class="Field">address</a> <a id="4272" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="4274" href="UTxO.UTxO.html#4240" class="Bound">i</a> <a id="4276" class="Symbol">.</a><a id="4277" href="UTxO.UTxO.html#1279" class="Field">validator</a> <a id="4287" href="UTxO.UTxO.html#490" class="Postulate Operator">♯</a><a id="4288" class="Symbol">)</a> <a id="4290" class="Symbol">(</a><a id="4291" href="UTxO.UTxO.html#2583" class="Function">getSpentOutput</a> <a id="4306" class="Bound">utxos</a> <a id="4312" href="UTxO.UTxO.html#4240" class="Bound">i</a><a id="4313" class="Symbol">))</a>
            <a id="4328" class="Symbol">(</a><a id="4329" class="Bound">tx</a> <a id="4332" class="Symbol">.</a><a id="4333" href="UTxO.UTxO.html#1555" class="Field">inputs</a><a id="4339" class="Symbol">)</a>
<a id="4341" class="Symbol">...</a> <a id="4345" class="Symbol">|</a> <a id="4347" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4350" href="UTxO.UTxO.html#4350" class="Bound">¬p</a> <a id="4353" class="Symbol">=</a> <a id="4355" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4358" class="Symbol">(</a><a id="4359" href="UTxO.UTxO.html#4350" class="Bound">¬p</a> <a id="4362" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4364" href="UTxO.UTxO.html#3479" class="Field">validateValidHashes</a><a id="4383" class="Symbol">)</a>
<a id="4385" class="Symbol">...</a> <a id="4389" class="Symbol">|</a> <a id="4391" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4395" href="UTxO.UTxO.html#4395" class="Bound">p₅</a> <a id="4398" class="Symbol">=</a> <a id="4400" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4404" class="Keyword">record</a> <a id="4411" class="Symbol">{</a><a id="4412" href="UTxO.UTxO.html#3086" class="Field">validOutputRefs</a> <a id="4428" class="Symbol">=</a> <a id="4430" class="Bound">p₁</a><a id="4432" class="Symbol">;</a> <a id="4434" href="UTxO.UTxO.html#3162" class="Field">preservesValues</a> <a id="4450" class="Symbol">=</a> <a id="4452" class="Bound">p₂</a><a id="4454" class="Symbol">;</a> <a id="4456" href="UTxO.UTxO.html#3316" class="Field">noDoubleSpending</a> <a id="4473" class="Symbol">=</a> <a id="4475" class="Bound">p₃</a><a id="4477" class="Symbol">;</a> <a id="4479" href="UTxO.UTxO.html#3369" class="Field">allInputsValidate</a> <a id="4497" class="Symbol">=</a> <a id="4499" class="Bound">p₄</a><a id="4501" class="Symbol">;</a> <a id="4503" href="UTxO.UTxO.html#3479" class="Field">validateValidHashes</a> <a id="4523" class="Symbol">=</a> <a id="4525" href="UTxO.UTxO.html#4395" class="Bound">p₅</a><a id="4527" class="Symbol">}</a>

<a id="isValidTx"></a><a id="4530" href="UTxO.UTxO.html#4530" class="Function">isValidTx</a> <a id="4540" class="Symbol">:</a> <a id="4542" href="UTxO.UTxO.html#1527" class="Record">Tx</a> <a id="4545" class="Symbol">→</a> <a id="4547" href="UTxO.UTxO.html#2052" class="Function">S</a> <a id="4549" class="Symbol">→</a> <a id="4551" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="4556" href="UTxO.UTxO.html#4530" class="Function">isValidTx</a> <a id="4566" href="UTxO.UTxO.html#4566" class="Bound">tx</a> <a id="4569" href="UTxO.UTxO.html#4569" class="Bound">s</a> <a id="4571" class="Symbol">=</a> <a id="4573" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="4575" href="UTxO.UTxO.html#3637" class="Function">isValidTx?</a> <a id="4586" href="UTxO.UTxO.html#4566" class="Bound">tx</a> <a id="4589" href="UTxO.UTxO.html#4569" class="Bound">s</a> <a id="4591" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a>
</pre></body></html>