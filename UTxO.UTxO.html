<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO.UTxO</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">----------------------------------------------</a>
<a id="48" class="Comment">-- ** Basic definition for UTxO-based ledgers.</a>

<a id="96" class="Keyword">module</a> <a id="103" href="UTxO.UTxO.html" class="Module">UTxO.UTxO</a> <a id="113" class="Keyword">where</a>

<a id="120" class="Keyword">open</a> <a id="125" class="Keyword">import</a> <a id="132" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="199" class="Keyword">open</a> <a id="204" class="Keyword">import</a> <a id="211" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="229" class="Keyword">open</a> <a id="234" class="Keyword">import</a> <a id="241" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="254" class="Keyword">open</a> <a id="259" class="Keyword">import</a> <a id="266" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="278" class="Keyword">open</a> <a id="283" class="Keyword">import</a> <a id="290" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="361" class="Keyword">open</a> <a id="366" class="Keyword">import</a> <a id="373" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>

<a id="Value"></a><a id="394" href="UTxO.UTxO.html#394" class="Function">Value</a>   <a id="402" class="Symbol">=</a> <a id="404" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="HashId"></a><a id="406" href="UTxO.UTxO.html#406" class="Function">HashId</a>  <a id="414" class="Symbol">=</a> <a id="416" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="Address"></a><a id="418" href="UTxO.UTxO.html#418" class="Function">Address</a> <a id="426" class="Symbol">=</a> <a id="428" href="UTxO.UTxO.html#406" class="Function">HashId</a>
<a id="435" class="Keyword">postulate</a> <a id="_♯"></a><a id="445" href="UTxO.UTxO.html#445" class="Postulate Operator">_♯</a> <a id="448" class="Symbol">:</a> <a id="450" class="Symbol">∀</a> <a id="452" class="Symbol">{</a><a id="453" href="UTxO.UTxO.html#453" class="Bound">A</a> <a id="455" class="Symbol">:</a> <a id="457" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="461" href="Prelude.Init.html#330" class="Generalizable">ℓ</a><a id="462" class="Symbol">}</a> <a id="464" class="Symbol">→</a> <a id="466" href="UTxO.UTxO.html#453" class="Bound">A</a> <a id="468" class="Symbol">→</a> <a id="470" href="UTxO.UTxO.html#406" class="Function">HashId</a>

<a id="DATA"></a><a id="478" href="UTxO.UTxO.html#478" class="Function">DATA</a> <a id="483" class="Symbol">=</a> <a id="485" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="487" class="Comment">-- T0D0: more realistic data for redeemers</a>

<a id="531" class="Keyword">record</a> <a id="TxOutputRef"></a><a id="538" href="UTxO.UTxO.html#538" class="Record">TxOutputRef</a> <a id="550" class="Symbol">:</a> <a id="552" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="556" class="Keyword">where</a>
  <a id="564" class="Keyword">constructor</a> <a id="_indexed-at_"></a><a id="576" href="UTxO.UTxO.html#576" class="InductiveConstructor Operator">_indexed-at_</a>
  <a id="591" class="Keyword">field</a> <a id="TxOutputRef.txId"></a><a id="597" href="UTxO.UTxO.html#597" class="Field">txId</a>  <a id="603" class="Symbol">:</a> <a id="605" href="UTxO.UTxO.html#406" class="Function">HashId</a>
        <a id="TxOutputRef.index"></a><a id="620" href="UTxO.UTxO.html#620" class="Field">index</a> <a id="626" class="Symbol">:</a> <a id="628" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="630" class="Keyword">open</a> <a id="635" href="UTxO.UTxO.html#538" class="Module">TxOutputRef</a> <a id="647" class="Keyword">public</a>
<a id="654" class="Keyword">unquoteDecl</a> <a id="DecEq-TxOR"></a><a id="666" href="UTxO.UTxO.html#666" class="Function">DecEq-TxOR</a> <a id="677" class="Symbol">=</a> <a id="679" href="Prelude.Generics.html#9474" class="Function">DERIVE</a> <a id="686" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="692" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="694" class="Keyword">quote</a> <a id="700" href="UTxO.UTxO.html#538" class="Record">TxOutputRef</a> <a id="712" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="714" href="UTxO.UTxO.html#666" class="Function">DecEq-TxOR</a> <a id="725" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="728" class="Keyword">record</a> <a id="TxOutput"></a><a id="735" href="UTxO.UTxO.html#735" class="Record">TxOutput</a> <a id="744" class="Symbol">:</a> <a id="746" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="750" class="Keyword">where</a>
  <a id="758" class="Keyword">constructor</a> <a id="_at_"></a><a id="770" href="UTxO.UTxO.html#770" class="InductiveConstructor Operator">_at_</a>
  <a id="777" class="Keyword">field</a> <a id="TxOutput.value"></a><a id="783" href="UTxO.UTxO.html#783" class="Field">value</a>    <a id="792" class="Symbol">:</a> <a id="794" href="UTxO.UTxO.html#394" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="808" href="UTxO.UTxO.html#808" class="Field">address</a>  <a id="817" class="Symbol">:</a> <a id="819" href="UTxO.UTxO.html#418" class="Function">Address</a>
<a id="827" class="Keyword">open</a> <a id="832" href="UTxO.UTxO.html#735" class="Module">TxOutput</a> <a id="841" class="Keyword">public</a>
<a id="848" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="860" href="UTxO.UTxO.html#860" class="Function">DecEq-TxO</a> <a id="870" class="Symbol">=</a> <a id="872" href="Prelude.Generics.html#9474" class="Function">DERIVE</a> <a id="879" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="885" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="887" class="Keyword">quote</a> <a id="893" href="UTxO.UTxO.html#735" class="Record">TxOutput</a> <a id="902" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="904" href="UTxO.UTxO.html#860" class="Function">DecEq-TxO</a> <a id="914" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="917" class="Keyword">record</a> <a id="InputInfo"></a><a id="924" href="UTxO.UTxO.html#924" class="Record">InputInfo</a> <a id="934" class="Symbol">:</a> <a id="936" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="940" class="Keyword">where</a>
  <a id="948" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="954" href="UTxO.UTxO.html#954" class="Field">outputRef</a>     <a id="968" class="Symbol">:</a> <a id="970" href="UTxO.UTxO.html#538" class="Record">TxOutputRef</a>
        <a id="InputInfo.validatorHash"></a><a id="990" href="UTxO.UTxO.html#990" class="Field">validatorHash</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="UTxO.UTxO.html#406" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="1021" href="UTxO.UTxO.html#1021" class="Field">redeemerHash</a>  <a id="1035" class="Symbol">:</a> <a id="1037" href="UTxO.UTxO.html#406" class="Function">HashId</a>

<a id="1045" class="Keyword">record</a> <a id="TxInfo"></a><a id="1052" href="UTxO.UTxO.html#1052" class="Record">TxInfo</a> <a id="1059" class="Symbol">:</a> <a id="1061" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1065" class="Keyword">where</a>
  <a id="1073" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="1079" href="UTxO.UTxO.html#1079" class="Field">inputs</a>  <a id="1087" class="Symbol">:</a> <a id="1089" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1094" href="UTxO.UTxO.html#924" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="1112" href="UTxO.UTxO.html#1112" class="Field">outputs</a> <a id="1120" class="Symbol">:</a> <a id="1122" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1127" href="UTxO.UTxO.html#735" class="Record">TxOutput</a>
        <a id="TxInfo.forge"></a><a id="1144" href="UTxO.UTxO.html#1144" class="Field">forge</a>   <a id="1152" class="Symbol">:</a> <a id="1154" href="UTxO.UTxO.html#394" class="Function">Value</a>

<a id="1161" class="Keyword">record</a> <a id="TxInput"></a><a id="1168" href="UTxO.UTxO.html#1168" class="Record">TxInput</a> <a id="1176" class="Symbol">:</a> <a id="1178" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1182" class="Keyword">where</a>
  <a id="1190" class="Keyword">field</a> <a id="TxInput.outputRef"></a><a id="1196" href="UTxO.UTxO.html#1196" class="Field">outputRef</a> <a id="1206" class="Symbol">:</a> <a id="1208" href="UTxO.UTxO.html#538" class="Record">TxOutputRef</a>
        <a id="TxInput.validator"></a><a id="1228" href="UTxO.UTxO.html#1228" class="Field">validator</a> <a id="1238" class="Symbol">:</a> <a id="1240" href="UTxO.UTxO.html#1052" class="Record">TxInfo</a> <a id="1247" class="Symbol">→</a> <a id="1249" href="UTxO.UTxO.html#478" class="Function">DATA</a> <a id="1254" class="Symbol">→</a> <a id="1256" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
        <a id="TxInput.redeemer"></a><a id="1269" href="UTxO.UTxO.html#1269" class="Field">redeemer</a>  <a id="1279" class="Symbol">:</a> <a id="1281" href="UTxO.UTxO.html#478" class="Function">DATA</a>
<a id="1286" class="Keyword">open</a> <a id="1291" href="UTxO.UTxO.html#1168" class="Module">TxInput</a> <a id="1299" class="Keyword">public</a>

<a id="mkInputInfo"></a><a id="1307" href="UTxO.UTxO.html#1307" class="Function">mkInputInfo</a> <a id="1319" class="Symbol">:</a> <a id="1321" href="UTxO.UTxO.html#1168" class="Record">TxInput</a> <a id="1329" class="Symbol">→</a> <a id="1331" href="UTxO.UTxO.html#924" class="Record">InputInfo</a>
<a id="1341" href="UTxO.UTxO.html#1307" class="Function">mkInputInfo</a> <a id="1353" href="UTxO.UTxO.html#1353" class="Bound">i</a> <a id="1355" class="Symbol">=</a> <a id="1357" class="Keyword">record</a>
  <a id="1366" class="Symbol">{</a> <a id="1368" href="UTxO.UTxO.html#954" class="Field">outputRef</a>     <a id="1382" class="Symbol">=</a> <a id="1384" href="UTxO.UTxO.html#1353" class="Bound">i</a> <a id="1386" class="Symbol">.</a><a id="1387" href="UTxO.UTxO.html#1196" class="Field">outputRef</a>
  <a id="1399" class="Symbol">;</a> <a id="1401" href="UTxO.UTxO.html#990" class="Field">validatorHash</a> <a id="1415" class="Symbol">=</a> <a id="1417" href="UTxO.UTxO.html#1353" class="Bound">i</a> <a id="1419" class="Symbol">.</a><a id="1420" href="UTxO.UTxO.html#1228" class="Field">validator</a> <a id="1430" href="UTxO.UTxO.html#445" class="Postulate Operator">♯</a>
  <a id="1434" class="Symbol">;</a> <a id="1436" href="UTxO.UTxO.html#1021" class="Field">redeemerHash</a>  <a id="1450" class="Symbol">=</a> <a id="1452" href="UTxO.UTxO.html#1353" class="Bound">i</a> <a id="1454" class="Symbol">.</a><a id="1455" href="UTxO.UTxO.html#1269" class="Field">redeemer</a> <a id="1464" href="UTxO.UTxO.html#445" class="Postulate Operator">♯</a> <a id="1466" class="Symbol">}</a>

<a id="1469" class="Keyword">record</a> <a id="Tx"></a><a id="1476" href="UTxO.UTxO.html#1476" class="Record">Tx</a> <a id="1479" class="Symbol">:</a> <a id="1481" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1485" class="Keyword">where</a>
  <a id="1493" class="Keyword">field</a>
    <a id="Tx.inputs"></a><a id="1503" href="UTxO.UTxO.html#1503" class="Field">inputs</a>  <a id="1511" class="Symbol">:</a> <a id="1513" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1518" href="UTxO.UTxO.html#1168" class="Record">TxInput</a>
    <a id="Tx.outputs"></a><a id="1530" href="UTxO.UTxO.html#1530" class="Field">outputs</a> <a id="1538" class="Symbol">:</a> <a id="1540" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1545" href="UTxO.UTxO.html#735" class="Record">TxOutput</a>
    <a id="Tx.forge"></a><a id="1558" href="UTxO.UTxO.html#1558" class="Field">forge</a>   <a id="1566" class="Symbol">:</a> <a id="1568" href="UTxO.UTxO.html#394" class="Function">Value</a>
<a id="1574" class="Keyword">open</a> <a id="1579" href="UTxO.UTxO.html#1476" class="Module">Tx</a> <a id="1582" class="Keyword">public</a>

<a id="mkTxInfo"></a><a id="1590" href="UTxO.UTxO.html#1590" class="Function">mkTxInfo</a> <a id="1599" class="Symbol">:</a> <a id="1601" href="UTxO.UTxO.html#1476" class="Record">Tx</a> <a id="1604" class="Symbol">→</a> <a id="1606" href="UTxO.UTxO.html#1052" class="Record">TxInfo</a>
<a id="1613" href="UTxO.UTxO.html#1590" class="Function">mkTxInfo</a> <a id="1622" href="UTxO.UTxO.html#1622" class="Bound">tx</a> <a id="1625" class="Symbol">=</a> <a id="1627" class="Keyword">record</a>
  <a id="1636" class="Symbol">{</a> <a id="1638" href="UTxO.UTxO.html#1079" class="Field">inputs</a>  <a id="1646" class="Symbol">=</a> <a id="1648" href="UTxO.UTxO.html#1307" class="Function">mkInputInfo</a> <a id="1660" href="Prelude.Functor.html#301" class="Field Operator">&lt;$&gt;</a> <a id="1664" href="UTxO.UTxO.html#1622" class="Bound">tx</a> <a id="1667" class="Symbol">.</a><a id="1668" href="UTxO.UTxO.html#1503" class="Field">inputs</a>
  <a id="1677" class="Symbol">;</a> <a id="1679" href="UTxO.UTxO.html#1112" class="Field">outputs</a> <a id="1687" class="Symbol">=</a> <a id="1689" href="UTxO.UTxO.html#1622" class="Bound">tx</a> <a id="1692" class="Symbol">.</a><a id="1693" href="UTxO.UTxO.html#1530" class="Field">outputs</a>
  <a id="1703" class="Symbol">;</a> <a id="1705" href="UTxO.UTxO.html#1144" class="Field">forge</a>   <a id="1713" class="Symbol">=</a> <a id="1715" href="UTxO.UTxO.html#1622" class="Bound">tx</a> <a id="1718" class="Symbol">.</a><a id="1719" href="UTxO.UTxO.html#1558" class="Field">forge</a> <a id="1725" class="Symbol">}</a>

<a id="1728" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="1767" href="UTxO.UTxO.html#1767" class="Function">L</a> <a id="1769" class="Symbol">=</a> <a id="1771" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1776" href="UTxO.UTxO.html#1476" class="Record">Tx</a>

<a id="1780" class="Keyword">record</a> <a id="UTXO"></a><a id="1787" href="UTxO.UTxO.html#1787" class="Record">UTXO</a> <a id="1792" class="Symbol">:</a> <a id="1794" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1798" class="Keyword">where</a>
  <a id="1806" class="Keyword">field</a> <a id="UTXO.outRef"></a><a id="1812" href="UTxO.UTxO.html#1812" class="Field">outRef</a> <a id="1819" class="Symbol">:</a> <a id="1821" href="UTxO.UTxO.html#538" class="Record">TxOutputRef</a>
        <a id="UTXO.out"></a><a id="1841" href="UTxO.UTxO.html#1841" class="Field">out</a>    <a id="1848" class="Symbol">:</a> <a id="1850" href="UTxO.UTxO.html#735" class="Record">TxOutput</a>
<a id="1859" class="Keyword">unquoteDecl</a> <a id="DecEq-UTXO"></a><a id="1871" href="UTxO.UTxO.html#1871" class="Function">DecEq-UTXO</a> <a id="1882" class="Symbol">=</a> <a id="1884" href="Prelude.Generics.html#9474" class="Function">DERIVE</a> <a id="1891" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="1897" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1899" class="Keyword">quote</a> <a id="1905" href="UTxO.UTxO.html#1787" class="Record">UTXO</a> <a id="1910" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1912" href="UTxO.UTxO.html#1871" class="Function">DecEq-UTXO</a> <a id="1923" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="1926" class="Comment">-- The state of a ledger is a collection of unspent transaction outputs.</a>
<a id="S"></a><a id="1999" href="UTxO.UTxO.html#1999" class="Function">S</a> <a id="2001" class="Symbol">:</a> <a id="2003" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2007" href="UTxO.UTxO.html#1999" class="Function">S</a> <a id="2009" class="Symbol">=</a> <a id="2011" href="Prelude.Sets.Interface.html#444" class="Function">Set⟨</a> <a id="2016" href="UTxO.UTxO.html#1787" class="Record">UTXO</a> <a id="2021" href="Prelude.Sets.Interface.html#444" class="Function">⟩</a>

<a id="mkUtxo"></a><a id="2024" href="UTxO.UTxO.html#2024" class="Function">mkUtxo</a> <a id="2031" class="Symbol">:</a> <a id="2033" class="Symbol">∀</a> <a id="2035" class="Symbol">{</a><a id="2036" href="UTxO.UTxO.html#2036" class="Bound">out</a><a id="2039" class="Symbol">}</a> <a id="2041" href="UTxO.UTxO.html#2041" class="Bound">tx</a> <a id="2044" class="Symbol">→</a> <a id="2046" href="UTxO.UTxO.html#2036" class="Bound">out</a> <a id="2050" href="Data.List.Membership.Setoid.html#887" class="Function Operator">L.Mem.∈</a> <a id="2058" href="UTxO.UTxO.html#1530" class="Field">outputs</a> <a id="2066" href="UTxO.UTxO.html#2041" class="Bound">tx</a> <a id="2069" class="Symbol">→</a> <a id="2071" href="UTxO.UTxO.html#1787" class="Record">UTXO</a>
<a id="2076" href="UTxO.UTxO.html#2024" class="Function">mkUtxo</a> <a id="2083" class="Symbol">{</a><a id="2084" href="UTxO.UTxO.html#2084" class="Bound">out</a><a id="2087" class="Symbol">}</a> <a id="2089" href="UTxO.UTxO.html#2089" class="Bound">tx</a> <a id="2092" href="UTxO.UTxO.html#2092" class="Bound">out∈</a> <a id="2097" class="Symbol">=</a> <a id="2099" class="Symbol">λ</a> <a id="2101" class="Keyword">where</a>
  <a id="2109" class="Symbol">.</a><a id="2110" href="UTxO.UTxO.html#1812" class="Field">UTXO.outRef</a> <a id="2122" class="Symbol">→</a> <a id="2124" class="Symbol">(</a><a id="2125" href="UTxO.UTxO.html#2089" class="Bound">tx</a> <a id="2128" href="UTxO.UTxO.html#445" class="Postulate Operator">♯</a><a id="2129" class="Symbol">)</a> <a id="2131" href="UTxO.UTxO.html#576" class="InductiveConstructor Operator">indexed-at</a> <a id="2142" href="Prelude.ToN.html#102" class="Field">toℕ</a> <a id="2146" class="Symbol">(</a><a id="2147" href="Data.List.Relation.Unary.Any.html#1817" class="Function">L.Any.index</a> <a id="2159" href="UTxO.UTxO.html#2092" class="Bound">out∈</a><a id="2163" class="Symbol">)</a>
  <a id="2167" class="Symbol">.</a><a id="2168" href="UTxO.UTxO.html#1841" class="Field">UTXO.out</a>    <a id="2180" class="Symbol">→</a> <a id="2182" href="UTxO.UTxO.html#2084" class="Bound">out</a>

<a id="outputRefs"></a><a id="2187" href="UTxO.UTxO.html#2187" class="Function">outputRefs</a> <a id="2198" class="Symbol">:</a> <a id="2200" href="UTxO.UTxO.html#1476" class="Record">Tx</a> <a id="2203" class="Symbol">→</a> <a id="2205" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2210" href="UTxO.UTxO.html#538" class="Record">TxOutputRef</a>
<a id="2222" href="UTxO.UTxO.html#2187" class="Function">outputRefs</a> <a id="2233" class="Symbol">=</a> <a id="2235" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2239" href="UTxO.UTxO.html#1196" class="Field">outputRef</a> <a id="2249" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2251" href="UTxO.UTxO.html#1503" class="Field">inputs</a>

<a id="getSpentOutputRef"></a><a id="2259" href="UTxO.UTxO.html#2259" class="Function">getSpentOutputRef</a> <a id="2277" class="Symbol">:</a> <a id="2279" href="UTxO.UTxO.html#1999" class="Function">S</a> <a id="2281" class="Symbol">→</a> <a id="2283" href="UTxO.UTxO.html#538" class="Record">TxOutputRef</a> <a id="2295" class="Symbol">→</a> <a id="2297" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2303" href="UTxO.UTxO.html#735" class="Record">TxOutput</a>
<a id="2312" href="UTxO.UTxO.html#2259" class="Function">getSpentOutputRef</a> <a id="2330" href="UTxO.UTxO.html#2330" class="Bound">s</a> <a id="2332" href="UTxO.UTxO.html#2332" class="Bound">oRef</a> <a id="2337" class="Symbol">=</a> <a id="2339" href="UTxO.UTxO.html#2365" class="Function">go</a> <a id="2342" class="Symbol">(</a><a id="2343" href="Prelude.Sets.Interface.html#3991" class="Function">toList</a> <a id="2350" href="UTxO.UTxO.html#2330" class="Bound">s</a><a id="2351" class="Symbol">)</a>
  <a id="2355" class="Keyword">where</a>
    <a id="2365" href="UTxO.UTxO.html#2365" class="Function">go</a> <a id="2368" class="Symbol">:</a> <a id="2370" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2375" href="UTxO.UTxO.html#1787" class="Record">UTXO</a> <a id="2380" class="Symbol">→</a> <a id="2382" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2388" href="UTxO.UTxO.html#735" class="Record">TxOutput</a>
    <a id="2401" href="UTxO.UTxO.html#2365" class="Function">go</a> <a id="2404" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2407" class="Symbol">=</a> <a id="2409" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="2421" href="UTxO.UTxO.html#2365" class="Function">go</a> <a id="2424" class="Symbol">(</a><a id="2425" class="Keyword">record</a> <a id="2432" class="Symbol">{</a><a id="2433" href="UTxO.UTxO.html#1812" class="Field">outRef</a> <a id="2440" class="Symbol">=</a> <a id="2442" href="UTxO.UTxO.html#2442" class="Bound">or</a><a id="2444" class="Symbol">;</a> <a id="2446" href="UTxO.UTxO.html#1841" class="Field">out</a> <a id="2450" class="Symbol">=</a> <a id="2452" href="UTxO.UTxO.html#2452" class="Bound">o</a><a id="2453" class="Symbol">}</a> <a id="2455" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2457" href="UTxO.UTxO.html#2457" class="Bound">xs</a><a id="2459" class="Symbol">)</a> <a id="2461" class="Symbol">=</a>
      <a id="2469" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2472" href="UTxO.UTxO.html#2332" class="Bound">oRef</a> <a id="2477" href="Prelude.DecEq.Core.html#169" class="Function Operator">==</a> <a id="2480" href="UTxO.UTxO.html#2442" class="Bound">or</a> <a id="2483" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>
        <a id="2496" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2501" href="UTxO.UTxO.html#2452" class="Bound">o</a>
      <a id="2509" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
        <a id="2522" href="UTxO.UTxO.html#2365" class="Function">go</a> <a id="2525" href="UTxO.UTxO.html#2457" class="Bound">xs</a>

<a id="getSpentOutput"></a><a id="2529" href="UTxO.UTxO.html#2529" class="Function">getSpentOutput</a> <a id="2544" class="Symbol">:</a> <a id="2546" href="UTxO.UTxO.html#1999" class="Function">S</a> <a id="2548" class="Symbol">→</a> <a id="2550" href="UTxO.UTxO.html#1168" class="Record">TxInput</a> <a id="2558" class="Symbol">→</a> <a id="2560" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2566" href="UTxO.UTxO.html#735" class="Record">TxOutput</a>
<a id="2575" href="UTxO.UTxO.html#2529" class="Function">getSpentOutput</a> <a id="2590" href="UTxO.UTxO.html#2590" class="Bound">s</a> <a id="2592" href="UTxO.UTxO.html#2592" class="Bound">i</a> <a id="2594" class="Symbol">=</a> <a id="2596" href="UTxO.UTxO.html#2259" class="Function">getSpentOutputRef</a> <a id="2614" href="UTxO.UTxO.html#2590" class="Bound">s</a> <a id="2616" class="Symbol">(</a><a id="2617" href="UTxO.UTxO.html#2592" class="Bound">i</a> <a id="2619" class="Symbol">.</a><a id="2620" href="UTxO.UTxO.html#1196" class="Field">outputRef</a><a id="2629" class="Symbol">)</a>

<a id="∑"></a><a id="2632" href="UTxO.UTxO.html#2632" class="Function">∑</a> <a id="2634" class="Symbol">:</a> <a id="2636" class="Symbol">∀</a> <a id="2638" class="Symbol">{</a><a id="2639" href="UTxO.UTxO.html#2639" class="Bound">A</a> <a id="2641" class="Symbol">:</a> <a id="2643" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2646" class="Symbol">}</a> <a id="2648" class="Symbol">→</a> <a id="2650" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2655" href="UTxO.UTxO.html#2639" class="Bound">A</a> <a id="2657" class="Symbol">→</a> <a id="2659" class="Symbol">(</a><a id="2660" href="UTxO.UTxO.html#2639" class="Bound">A</a> <a id="2662" class="Symbol">→</a> <a id="2664" href="UTxO.UTxO.html#394" class="Function">Value</a><a id="2669" class="Symbol">)</a> <a id="2671" class="Symbol">→</a> <a id="2673" href="UTxO.UTxO.html#394" class="Function">Value</a>
<a id="2679" href="UTxO.UTxO.html#2632" class="Function">∑</a> <a id="2681" href="UTxO.UTxO.html#2681" class="Bound">xs</a> <a id="2684" href="UTxO.UTxO.html#2684" class="Bound">f</a> <a id="2686" class="Symbol">=</a> <a id="2688" href="Prelude.Lists.Sums.html#271" class="Function">∑ℕ</a> <a id="2691" class="Symbol">(</a><a id="2692" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2696" href="UTxO.UTxO.html#2684" class="Bound">f</a> <a id="2698" href="UTxO.UTxO.html#2681" class="Bound">xs</a><a id="2700" class="Symbol">)</a>

<a id="∑M"></a><a id="2703" href="UTxO.UTxO.html#2703" class="Function">∑M</a> <a id="2706" class="Symbol">:</a> <a id="2708" class="Symbol">∀</a> <a id="2710" class="Symbol">{</a><a id="2711" href="UTxO.UTxO.html#2711" class="Bound">A</a> <a id="2713" class="Symbol">:</a> <a id="2715" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2718" class="Symbol">}</a> <a id="2720" class="Symbol">→</a> <a id="2722" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2727" class="Symbol">(</a><a id="2728" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2734" href="UTxO.UTxO.html#2711" class="Bound">A</a><a id="2735" class="Symbol">)</a> <a id="2737" class="Symbol">→</a> <a id="2739" class="Symbol">(</a><a id="2740" href="UTxO.UTxO.html#2711" class="Bound">A</a> <a id="2742" class="Symbol">→</a> <a id="2744" href="UTxO.UTxO.html#394" class="Function">Value</a><a id="2749" class="Symbol">)</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2759" href="UTxO.UTxO.html#394" class="Function">Value</a>
<a id="2765" href="UTxO.UTxO.html#2703" class="Function">∑M</a> <a id="2768" href="UTxO.UTxO.html#2768" class="Bound">xs</a> <a id="2771" href="UTxO.UTxO.html#2771" class="Bound">f</a> <a id="2773" class="Symbol">=</a> <a id="2775" class="Symbol">(</a><a id="2776" href="Function.Base.html#1554" class="Function">flip</a> <a id="2781" href="UTxO.UTxO.html#2632" class="Function">∑</a> <a id="2783" href="UTxO.UTxO.html#2771" class="Bound">f</a><a id="2784" class="Symbol">)</a> <a id="2786" href="Prelude.Functor.html#301" class="Field Operator">&lt;$&gt;</a> <a id="2790" href="UTxO.UTxO.html#2847" class="Function">seqM</a> <a id="2795" href="UTxO.UTxO.html#2768" class="Bound">xs</a>
  <a id="2800" class="Keyword">where</a>
    <a id="2810" class="Comment">-- if one fails everything fails</a>
    <a id="2847" href="UTxO.UTxO.html#2847" class="Function">seqM</a> <a id="2852" class="Symbol">:</a> <a id="2854" class="Symbol">∀</a> <a id="2856" class="Symbol">{</a><a id="2857" href="UTxO.UTxO.html#2857" class="Bound">A</a> <a id="2859" class="Symbol">:</a> <a id="2861" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2864" class="Symbol">}</a> <a id="2866" class="Symbol">→</a> <a id="2868" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2873" class="Symbol">(</a><a id="2874" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2880" href="UTxO.UTxO.html#2857" class="Bound">A</a><a id="2881" class="Symbol">)</a> <a id="2883" class="Symbol">→</a> <a id="2885" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2891" class="Symbol">(</a><a id="2892" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2897" href="UTxO.UTxO.html#2857" class="Bound">A</a><a id="2898" class="Symbol">)</a>
    <a id="2904" href="UTxO.UTxO.html#2847" class="Function">seqM</a> <a id="2909" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="2918" class="Symbol">=</a> <a id="2920" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2925" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="2932" href="UTxO.UTxO.html#2847" class="Function">seqM</a> <a id="2937" class="Symbol">(</a><a id="2938" href="UTxO.UTxO.html#2938" class="Bound">x</a> <a id="2940" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2942" href="UTxO.UTxO.html#2942" class="Bound">xs</a><a id="2944" class="Symbol">)</a> <a id="2946" class="Symbol">=</a> <a id="2948" class="Symbol">⦇</a> <a id="2950" href="UTxO.UTxO.html#2938" class="Bound">x</a> <a id="2952" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2954" href="UTxO.UTxO.html#2847" class="Function">seqM</a> <a id="2959" href="UTxO.UTxO.html#2942" class="Bound">xs</a> <a id="2962" class="Symbol">⦈</a>

<a id="2965" class="Keyword">record</a> <a id="IsValidTx"></a><a id="2972" href="UTxO.UTxO.html#2972" class="Record">IsValidTx</a> <a id="2982" class="Symbol">(</a><a id="2983" href="UTxO.UTxO.html#2983" class="Bound">tx</a> <a id="2986" class="Symbol">:</a> <a id="2988" href="UTxO.UTxO.html#1476" class="Record">Tx</a><a id="2990" class="Symbol">)</a> <a id="2992" class="Symbol">(</a><a id="2993" href="UTxO.UTxO.html#2993" class="Bound">utxos</a> <a id="2999" class="Symbol">:</a> <a id="3001" href="UTxO.UTxO.html#1999" class="Function">S</a><a id="3002" class="Symbol">)</a> <a id="3004" class="Symbol">:</a> <a id="3006" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3010" class="Keyword">where</a>
  <a id="3018" class="Keyword">field</a>
    <a id="IsValidTx.validOutputRefs"></a><a id="3028" href="UTxO.UTxO.html#3028" class="Field">validOutputRefs</a> <a id="3044" class="Symbol">:</a>
      <a id="3052" href="UTxO.UTxO.html#2187" class="Function">outputRefs</a> <a id="3063" href="UTxO.UTxO.html#2983" class="Bound">tx</a> <a id="3066" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="3068" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3072" href="UTxO.UTxO.html#1812" class="Field">UTXO.outRef</a> <a id="3084" class="Symbol">(</a><a id="3085" href="Prelude.Sets.Interface.html#3991" class="Function">toList</a> <a id="3092" href="UTxO.UTxO.html#2993" class="Bound">utxos</a><a id="3097" class="Symbol">)</a>

    <a id="IsValidTx.preservesValues"></a><a id="3104" href="UTxO.UTxO.html#3104" class="Field">preservesValues</a> <a id="3120" class="Symbol">:</a>
      <a id="3128" href="Data.Maybe.Relation.Unary.Any.html#830" class="Datatype">M.Any.Any</a> <a id="3138" class="Symbol">(λ</a> <a id="3141" href="UTxO.UTxO.html#3141" class="Bound">q</a> <a id="3143" class="Symbol">→</a> <a id="3145" href="UTxO.UTxO.html#2983" class="Bound">tx</a> <a id="3148" class="Symbol">.</a><a id="3149" href="UTxO.UTxO.html#1558" class="Field">forge</a> <a id="3155" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3157" href="UTxO.UTxO.html#3141" class="Bound">q</a> <a id="3159" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3161" href="UTxO.UTxO.html#2632" class="Function">∑</a> <a id="3163" class="Symbol">(</a><a id="3164" href="UTxO.UTxO.html#2983" class="Bound">tx</a> <a id="3167" class="Symbol">.</a><a id="3168" href="UTxO.UTxO.html#1530" class="Field">outputs</a><a id="3175" class="Symbol">)</a> <a id="3177" href="UTxO.UTxO.html#783" class="Field">value</a><a id="3182" class="Symbol">)</a>
                <a id="3200" class="Symbol">(</a><a id="3201" href="UTxO.UTxO.html#2703" class="Function">∑M</a> <a id="3204" class="Symbol">(</a><a id="3205" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3209" class="Symbol">(</a><a id="3210" href="UTxO.UTxO.html#2529" class="Function">getSpentOutput</a> <a id="3225" href="UTxO.UTxO.html#2993" class="Bound">utxos</a><a id="3230" class="Symbol">)</a> <a id="3232" class="Symbol">(</a><a id="3233" href="UTxO.UTxO.html#2983" class="Bound">tx</a> <a id="3236" class="Symbol">.</a><a id="3237" href="UTxO.UTxO.html#1503" class="Field">inputs</a><a id="3243" class="Symbol">))</a> <a id="3246" href="UTxO.UTxO.html#783" class="Field">value</a><a id="3251" class="Symbol">)</a>

    <a id="IsValidTx.noDoubleSpending"></a><a id="3258" href="UTxO.UTxO.html#3258" class="Field">noDoubleSpending</a> <a id="3275" class="Symbol">:</a>
      <a id="3283" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">Unique</a> <a id="3290" class="Symbol">(</a><a id="3291" href="UTxO.UTxO.html#2187" class="Function">outputRefs</a> <a id="3302" href="UTxO.UTxO.html#2983" class="Bound">tx</a><a id="3304" class="Symbol">)</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="3311" href="UTxO.UTxO.html#3311" class="Field">allInputsValidate</a> <a id="3329" class="Symbol">:</a>
      <a id="3337" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="3341" class="Symbol">(λ</a> <a id="3344" href="UTxO.UTxO.html#3344" class="Bound">i</a> <a id="3346" class="Symbol">→</a> <a id="3348" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="3350" class="Symbol">(</a><a id="3351" href="UTxO.UTxO.html#1228" class="Field">validator</a> <a id="3361" href="UTxO.UTxO.html#3344" class="Bound">i</a> <a id="3363" class="Symbol">(</a><a id="3364" href="UTxO.UTxO.html#1590" class="Function">mkTxInfo</a> <a id="3373" href="UTxO.UTxO.html#2983" class="Bound">tx</a><a id="3375" class="Symbol">)</a> <a id="3377" class="Symbol">(</a><a id="3378" href="UTxO.UTxO.html#3344" class="Bound">i</a> <a id="3380" class="Symbol">.</a><a id="3381" href="UTxO.UTxO.html#1269" class="Field">redeemer</a><a id="3389" class="Symbol">)))</a>
          <a id="3403" class="Symbol">(</a><a id="3404" href="UTxO.UTxO.html#2983" class="Bound">tx</a> <a id="3407" class="Symbol">.</a><a id="3408" href="UTxO.UTxO.html#1503" class="Field">inputs</a><a id="3414" class="Symbol">)</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="3421" href="UTxO.UTxO.html#3421" class="Field">validateValidHashes</a> <a id="3441" class="Symbol">:</a>
      <a id="3449" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="3453" class="Symbol">(λ</a> <a id="3456" href="UTxO.UTxO.html#3456" class="Bound">i</a> <a id="3458" class="Symbol">→</a> <a id="3460" href="Data.Maybe.Relation.Unary.Any.html#830" class="Datatype">M.Any.Any</a> <a id="3470" class="Symbol">(λ</a> <a id="3473" href="UTxO.UTxO.html#3473" class="Bound">o</a> <a id="3475" class="Symbol">→</a> <a id="3477" href="UTxO.UTxO.html#3473" class="Bound">o</a> <a id="3479" class="Symbol">.</a><a id="3480" href="UTxO.UTxO.html#808" class="Field">address</a> <a id="3488" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3490" href="UTxO.UTxO.html#3456" class="Bound">i</a> <a id="3492" class="Symbol">.</a><a id="3493" href="UTxO.UTxO.html#1228" class="Field">validator</a> <a id="3503" href="UTxO.UTxO.html#445" class="Postulate Operator">♯</a><a id="3504" class="Symbol">)</a> <a id="3506" class="Symbol">(</a><a id="3507" href="UTxO.UTxO.html#2529" class="Function">getSpentOutput</a> <a id="3522" href="UTxO.UTxO.html#2993" class="Bound">utxos</a> <a id="3528" href="UTxO.UTxO.html#3456" class="Bound">i</a><a id="3529" class="Symbol">))</a>
          <a id="3542" class="Symbol">(</a><a id="3543" href="UTxO.UTxO.html#2983" class="Bound">tx</a> <a id="3546" class="Symbol">.</a><a id="3547" href="UTxO.UTxO.html#1503" class="Field">inputs</a><a id="3553" class="Symbol">)</a>

<a id="3556" class="Keyword">open</a> <a id="3561" href="UTxO.UTxO.html#2972" class="Module">IsValidTx</a> <a id="3571" class="Keyword">public</a>

<a id="isValidTx?"></a><a id="3579" href="UTxO.UTxO.html#3579" class="Function">isValidTx?</a> <a id="3590" class="Symbol">:</a> <a id="3592" class="Symbol">∀</a> <a id="3594" href="UTxO.UTxO.html#3594" class="Bound">tx</a> <a id="3597" href="UTxO.UTxO.html#3597" class="Bound">s</a> <a id="3599" class="Symbol">→</a> <a id="3601" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="3605" class="Symbol">(</a><a id="3606" href="UTxO.UTxO.html#2972" class="Record">IsValidTx</a> <a id="3616" href="UTxO.UTxO.html#3594" class="Bound">tx</a> <a id="3619" href="UTxO.UTxO.html#3597" class="Bound">s</a><a id="3620" class="Symbol">)</a>
<a id="3622" href="UTxO.UTxO.html#3579" class="Function">isValidTx?</a> <a id="3633" href="UTxO.UTxO.html#3633" class="Bound">tx</a> <a id="3636" href="UTxO.UTxO.html#3636" class="Bound">utxos</a>
  <a id="3644" class="Keyword">with</a> <a id="3649" href="UTxO.UTxO.html#2187" class="Function">outputRefs</a> <a id="3660" href="UTxO.UTxO.html#3633" class="Bound">tx</a> <a id="3663" href="Prelude.DecLists.html#1342" class="Function Operator">⊆?</a> <a id="3666" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3670" href="UTxO.UTxO.html#1812" class="Field">UTXO.outRef</a> <a id="3682" class="Symbol">(</a><a id="3683" href="Prelude.Sets.Interface.html#3991" class="Function">toList</a> <a id="3690" href="UTxO.UTxO.html#3636" class="Bound">utxos</a><a id="3695" class="Symbol">)</a>
<a id="3697" class="Symbol">...</a> <a id="3701" class="Symbol">|</a> <a id="3703" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3706" href="UTxO.UTxO.html#3706" class="Bound">¬p</a> <a id="3709" class="Symbol">=</a> <a id="3711" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3714" class="Symbol">(</a><a id="3715" href="UTxO.UTxO.html#3706" class="Bound">¬p</a> <a id="3718" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3720" href="UTxO.UTxO.html#3028" class="Field">validOutputRefs</a> <a id="3736" class="Symbol">)</a>
<a id="3738" class="Symbol">...</a> <a id="3742" class="Symbol">|</a> <a id="3744" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3748" href="UTxO.UTxO.html#3748" class="Bound">p₁</a>
  <a id="3753" class="Keyword">with</a> <a id="3758" href="Data.Maybe.Relation.Unary.Any.html#2128" class="Function">M.Any.dec</a> <a id="3768" class="Symbol">(λ</a> <a id="3771" href="UTxO.UTxO.html#3771" class="Bound">q</a> <a id="3773" class="Symbol">→</a> <a id="3775" class="Bound">tx</a> <a id="3778" class="Symbol">.</a><a id="3779" href="UTxO.UTxO.html#1558" class="Field">forge</a> <a id="3785" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3787" href="UTxO.UTxO.html#3771" class="Bound">q</a> <a id="3789" href="Prelude.DecEq.Core.html#137" class="Field Operator">≟</a> <a id="3791" href="UTxO.UTxO.html#2632" class="Function">∑</a> <a id="3793" class="Symbol">(</a><a id="3794" class="Bound">tx</a> <a id="3797" class="Symbol">.</a><a id="3798" href="UTxO.UTxO.html#1530" class="Field">outputs</a><a id="3805" class="Symbol">)</a> <a id="3807" href="UTxO.UTxO.html#783" class="Field">value</a><a id="3812" class="Symbol">)</a>
                 <a id="3831" class="Symbol">(</a><a id="3832" href="UTxO.UTxO.html#2703" class="Function">∑M</a> <a id="3835" class="Symbol">(</a><a id="3836" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3840" class="Symbol">(</a><a id="3841" href="UTxO.UTxO.html#2529" class="Function">getSpentOutput</a> <a id="3856" class="Bound">utxos</a><a id="3861" class="Symbol">)</a> <a id="3863" class="Symbol">(</a><a id="3864" class="Bound">tx</a> <a id="3867" class="Symbol">.</a><a id="3868" href="UTxO.UTxO.html#1503" class="Field">inputs</a><a id="3874" class="Symbol">))</a> <a id="3877" href="UTxO.UTxO.html#783" class="Field">value</a><a id="3882" class="Symbol">)</a>
<a id="3884" class="Symbol">...</a> <a id="3888" class="Symbol">|</a> <a id="3890" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3893" href="UTxO.UTxO.html#3893" class="Bound">¬p</a> <a id="3896" class="Symbol">=</a> <a id="3898" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3901" class="Symbol">(</a><a id="3902" href="UTxO.UTxO.html#3893" class="Bound">¬p</a> <a id="3905" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3907" href="UTxO.UTxO.html#3104" class="Field">preservesValues</a><a id="3922" class="Symbol">)</a>
<a id="3924" class="Symbol">...</a> <a id="3928" class="Symbol">|</a> <a id="3930" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3934" href="UTxO.UTxO.html#3934" class="Bound">p₂</a>
  <a id="3939" class="Keyword">with</a> <a id="3944" href="Prelude.DecLists.html#1401" class="Function">unique?</a> <a id="3952" class="Symbol">(</a><a id="3953" href="UTxO.UTxO.html#2187" class="Function">outputRefs</a> <a id="3964" class="Bound">tx</a><a id="3966" class="Symbol">)</a>
<a id="3968" class="Symbol">...</a> <a id="3972" class="Symbol">|</a> <a id="3974" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3977" href="UTxO.UTxO.html#3977" class="Bound">¬p</a> <a id="3980" class="Symbol">=</a> <a id="3982" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3985" class="Symbol">(</a><a id="3986" href="UTxO.UTxO.html#3977" class="Bound">¬p</a> <a id="3989" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3991" href="UTxO.UTxO.html#3258" class="Field">noDoubleSpending</a><a id="4007" class="Symbol">)</a>
<a id="4009" class="Symbol">...</a> <a id="4013" class="Symbol">|</a> <a id="4015" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4019" href="UTxO.UTxO.html#4019" class="Bound">p₃</a>
  <a id="4024" class="Keyword">with</a> <a id="4029" href="Data.List.Relation.Unary.All.html#6240" class="Function">all?</a> <a id="4034" class="Symbol">(λ</a> <a id="4037" href="UTxO.UTxO.html#4037" class="Bound">i</a> <a id="4039" class="Symbol">→</a> <a id="4041" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="4044" class="Symbol">(</a><a id="4045" href="UTxO.UTxO.html#1228" class="Field">validator</a> <a id="4055" href="UTxO.UTxO.html#4037" class="Bound">i</a> <a id="4057" class="Symbol">(</a><a id="4058" href="UTxO.UTxO.html#1590" class="Function">mkTxInfo</a> <a id="4067" class="Bound">tx</a><a id="4069" class="Symbol">)</a> <a id="4071" class="Symbol">(</a><a id="4072" href="UTxO.UTxO.html#4037" class="Bound">i</a> <a id="4074" class="Symbol">.</a><a id="4075" href="UTxO.UTxO.html#1269" class="Field">redeemer</a><a id="4083" class="Symbol">)))</a>
            <a id="4099" class="Symbol">(</a><a id="4100" class="Bound">tx</a> <a id="4103" class="Symbol">.</a><a id="4104" href="UTxO.UTxO.html#1503" class="Field">inputs</a><a id="4110" class="Symbol">)</a>
<a id="4112" class="Symbol">...</a> <a id="4116" class="Symbol">|</a> <a id="4118" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4121" href="UTxO.UTxO.html#4121" class="Bound">¬p</a> <a id="4124" class="Symbol">=</a> <a id="4126" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4129" class="Symbol">(</a><a id="4130" href="UTxO.UTxO.html#4121" class="Bound">¬p</a> <a id="4133" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4135" href="UTxO.UTxO.html#3311" class="Field">allInputsValidate</a><a id="4152" class="Symbol">)</a>
<a id="4154" class="Symbol">...</a> <a id="4158" class="Symbol">|</a> <a id="4160" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4164" href="UTxO.UTxO.html#4164" class="Bound">p₄</a>
  <a id="4169" class="Keyword">with</a> <a id="4174" href="Data.List.Relation.Unary.All.html#6240" class="Function">all?</a> <a id="4179" class="Symbol">(λ</a> <a id="4182" href="UTxO.UTxO.html#4182" class="Bound">i</a> <a id="4184" class="Symbol">→</a> <a id="4186" href="Data.Maybe.Relation.Unary.Any.html#2128" class="Function">M.Any.dec</a> <a id="4196" class="Symbol">(λ</a> <a id="4199" href="UTxO.UTxO.html#4199" class="Bound">o</a> <a id="4201" class="Symbol">→</a> <a id="4203" href="UTxO.UTxO.html#4199" class="Bound">o</a> <a id="4205" class="Symbol">.</a><a id="4206" href="UTxO.UTxO.html#808" class="Field">address</a> <a id="4214" href="Prelude.DecEq.Core.html#137" class="Field Operator">≟</a> <a id="4216" href="UTxO.UTxO.html#4182" class="Bound">i</a> <a id="4218" class="Symbol">.</a><a id="4219" href="UTxO.UTxO.html#1228" class="Field">validator</a> <a id="4229" href="UTxO.UTxO.html#445" class="Postulate Operator">♯</a><a id="4230" class="Symbol">)</a> <a id="4232" class="Symbol">(</a><a id="4233" href="UTxO.UTxO.html#2529" class="Function">getSpentOutput</a> <a id="4248" class="Bound">utxos</a> <a id="4254" href="UTxO.UTxO.html#4182" class="Bound">i</a><a id="4255" class="Symbol">))</a>
            <a id="4270" class="Symbol">(</a><a id="4271" class="Bound">tx</a> <a id="4274" class="Symbol">.</a><a id="4275" href="UTxO.UTxO.html#1503" class="Field">inputs</a><a id="4281" class="Symbol">)</a>
<a id="4283" class="Symbol">...</a> <a id="4287" class="Symbol">|</a> <a id="4289" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4292" href="UTxO.UTxO.html#4292" class="Bound">¬p</a> <a id="4295" class="Symbol">=</a> <a id="4297" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4300" class="Symbol">(</a><a id="4301" href="UTxO.UTxO.html#4292" class="Bound">¬p</a> <a id="4304" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4306" href="UTxO.UTxO.html#3421" class="Field">validateValidHashes</a><a id="4325" class="Symbol">)</a>
<a id="4327" class="Symbol">...</a> <a id="4331" class="Symbol">|</a> <a id="4333" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4337" href="UTxO.UTxO.html#4337" class="Bound">p₅</a> <a id="4340" class="Symbol">=</a> <a id="4342" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4346" class="Keyword">record</a> <a id="4353" class="Symbol">{</a><a id="4354" href="UTxO.UTxO.html#3028" class="Field">validOutputRefs</a> <a id="4370" class="Symbol">=</a> <a id="4372" class="Bound">p₁</a><a id="4374" class="Symbol">;</a> <a id="4376" href="UTxO.UTxO.html#3104" class="Field">preservesValues</a> <a id="4392" class="Symbol">=</a> <a id="4394" class="Bound">p₂</a><a id="4396" class="Symbol">;</a> <a id="4398" href="UTxO.UTxO.html#3258" class="Field">noDoubleSpending</a> <a id="4415" class="Symbol">=</a> <a id="4417" class="Bound">p₃</a><a id="4419" class="Symbol">;</a> <a id="4421" href="UTxO.UTxO.html#3311" class="Field">allInputsValidate</a> <a id="4439" class="Symbol">=</a> <a id="4441" class="Bound">p₄</a><a id="4443" class="Symbol">;</a> <a id="4445" href="UTxO.UTxO.html#3421" class="Field">validateValidHashes</a> <a id="4465" class="Symbol">=</a> <a id="4467" href="UTxO.UTxO.html#4337" class="Bound">p₅</a><a id="4469" class="Symbol">}</a>

<a id="isValidTx"></a><a id="4472" href="UTxO.UTxO.html#4472" class="Function">isValidTx</a> <a id="4482" class="Symbol">:</a> <a id="4484" href="UTxO.UTxO.html#1476" class="Record">Tx</a> <a id="4487" class="Symbol">→</a> <a id="4489" href="UTxO.UTxO.html#1999" class="Function">S</a> <a id="4491" class="Symbol">→</a> <a id="4493" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="4498" href="UTxO.UTxO.html#4472" class="Function">isValidTx</a> <a id="4508" href="UTxO.UTxO.html#4508" class="Bound">tx</a> <a id="4511" href="UTxO.UTxO.html#4511" class="Bound">s</a> <a id="4513" class="Symbol">=</a> <a id="4515" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="4517" href="UTxO.UTxO.html#3579" class="Function">isValidTx?</a> <a id="4528" href="UTxO.UTxO.html#4508" class="Bound">tx</a> <a id="4531" href="UTxO.UTxO.html#4511" class="Bound">s</a> <a id="4533" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
</pre></body></html>