<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO.UTxO</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">----------------------------------------------</a>
<a id="48" class="Comment">-- ** Basic definition for UTxO-based ledgers.</a>

<a id="96" class="Keyword">module</a> <a id="103" href="UTxO.UTxO.html" class="Module">UTxO.UTxO</a> <a id="113" class="Keyword">where</a>

<a id="120" class="Keyword">open</a> <a id="125" class="Keyword">import</a> <a id="132" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="144" class="Symbol">;</a> <a id="146" class="Keyword">open</a> <a id="151" href="Prelude.Init.html#397" class="Module">SetAsType</a>
<a id="161" class="Keyword">open</a> <a id="166" class="Keyword">import</a> <a id="173" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="352" class="Keyword">open</a> <a id="357" class="Keyword">import</a> <a id="364" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="Prelude.ToList.html" class="Module">Prelude.ToList</a>

<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>

<a id="Value"></a><a id="438" href="UTxO.UTxO.html#438" class="Function">Value</a>   <a id="446" class="Symbol">=</a> <a id="448" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="HashId"></a><a id="450" href="UTxO.UTxO.html#450" class="Function">HashId</a>  <a id="458" class="Symbol">=</a> <a id="460" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="Address"></a><a id="462" href="UTxO.UTxO.html#462" class="Function">Address</a> <a id="470" class="Symbol">=</a> <a id="472" href="UTxO.UTxO.html#450" class="Function">HashId</a>
<a id="479" class="Keyword">postulate</a> <a id="_♯"></a><a id="489" href="UTxO.UTxO.html#489" class="Postulate Operator">_♯</a> <a id="492" class="Symbol">:</a> <a id="494" class="Symbol">∀</a> <a id="496" class="Symbol">{</a><a id="497" href="UTxO.UTxO.html#497" class="Bound">A</a> <a id="499" class="Symbol">:</a> <a id="501" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="506" href="Prelude.Init.html#238" class="Generalizable">ℓ</a><a id="507" class="Symbol">}</a> <a id="509" class="Symbol">→</a> <a id="511" href="UTxO.UTxO.html#497" class="Bound">A</a> <a id="513" class="Symbol">→</a> <a id="515" href="UTxO.UTxO.html#450" class="Function">HashId</a>

<a id="DATA"></a><a id="523" href="UTxO.UTxO.html#523" class="Function">DATA</a> <a id="528" class="Symbol">=</a> <a id="530" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="532" class="Comment">-- T0D0: more realistic data for redeemers</a>

<a id="576" class="Keyword">record</a> <a id="TxOutputRef"></a><a id="583" href="UTxO.UTxO.html#583" class="Record">TxOutputRef</a> <a id="595" class="Symbol">:</a> <a id="597" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="602" class="Keyword">where</a>
  <a id="610" class="Keyword">constructor</a> <a id="_indexed-at_"></a><a id="622" href="UTxO.UTxO.html#622" class="InductiveConstructor Operator">_indexed-at_</a>
  <a id="637" class="Keyword">field</a> <a id="TxOutputRef.txId"></a><a id="643" href="UTxO.UTxO.html#643" class="Field">txId</a>  <a id="649" class="Symbol">:</a> <a id="651" href="UTxO.UTxO.html#450" class="Function">HashId</a>
        <a id="TxOutputRef.index"></a><a id="666" href="UTxO.UTxO.html#666" class="Field">index</a> <a id="672" class="Symbol">:</a> <a id="674" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="676" class="Keyword">open</a> <a id="681" href="UTxO.UTxO.html#583" class="Module">TxOutputRef</a> <a id="693" class="Keyword">public</a>
<a id="700" class="Keyword">unquoteDecl</a> <a id="DecEq-TxOR"></a><a id="712" href="UTxO.UTxO.html#712" class="Function">DecEq-TxOR</a> <a id="723" class="Symbol">=</a> <a id="725" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="732" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="738" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="740" class="Keyword">quote</a> <a id="746" href="UTxO.UTxO.html#583" class="Record">TxOutputRef</a> <a id="758" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="760" href="UTxO.UTxO.html#712" class="Function">DecEq-TxOR</a> <a id="771" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="774" class="Keyword">record</a> <a id="TxOutput"></a><a id="781" href="UTxO.UTxO.html#781" class="Record">TxOutput</a> <a id="790" class="Symbol">:</a> <a id="792" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="797" class="Keyword">where</a>
  <a id="805" class="Keyword">constructor</a> <a id="_at_"></a><a id="817" href="UTxO.UTxO.html#817" class="InductiveConstructor Operator">_at_</a>
  <a id="824" class="Keyword">field</a> <a id="TxOutput.value"></a><a id="830" href="UTxO.UTxO.html#830" class="Field">value</a>    <a id="839" class="Symbol">:</a> <a id="841" href="UTxO.UTxO.html#438" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="855" href="UTxO.UTxO.html#855" class="Field">address</a>  <a id="864" class="Symbol">:</a> <a id="866" href="UTxO.UTxO.html#462" class="Function">Address</a>
<a id="874" class="Keyword">open</a> <a id="879" href="UTxO.UTxO.html#781" class="Module">TxOutput</a> <a id="888" class="Keyword">public</a>
<a id="895" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="907" href="UTxO.UTxO.html#907" class="Function">DecEq-TxO</a> <a id="917" class="Symbol">=</a> <a id="919" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="926" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="932" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="934" class="Keyword">quote</a> <a id="940" href="UTxO.UTxO.html#781" class="Record">TxOutput</a> <a id="949" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="951" href="UTxO.UTxO.html#907" class="Function">DecEq-TxO</a> <a id="961" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="964" class="Keyword">record</a> <a id="InputInfo"></a><a id="971" href="UTxO.UTxO.html#971" class="Record">InputInfo</a> <a id="981" class="Symbol">:</a> <a id="983" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="988" class="Keyword">where</a>
  <a id="996" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="1002" href="UTxO.UTxO.html#1002" class="Field">outputRef</a>     <a id="1016" class="Symbol">:</a> <a id="1018" href="UTxO.UTxO.html#583" class="Record">TxOutputRef</a>
        <a id="InputInfo.validatorHash"></a><a id="1038" href="UTxO.UTxO.html#1038" class="Field">validatorHash</a> <a id="1052" class="Symbol">:</a> <a id="1054" href="UTxO.UTxO.html#450" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="1069" href="UTxO.UTxO.html#1069" class="Field">redeemerHash</a>  <a id="1083" class="Symbol">:</a> <a id="1085" href="UTxO.UTxO.html#450" class="Function">HashId</a>

<a id="1093" class="Keyword">record</a> <a id="TxInfo"></a><a id="1100" href="UTxO.UTxO.html#1100" class="Record">TxInfo</a> <a id="1107" class="Symbol">:</a> <a id="1109" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1114" class="Keyword">where</a>
  <a id="1122" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="1128" href="UTxO.UTxO.html#1128" class="Field">inputs</a>  <a id="1136" class="Symbol">:</a> <a id="1138" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1143" href="UTxO.UTxO.html#971" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="1161" href="UTxO.UTxO.html#1161" class="Field">outputs</a> <a id="1169" class="Symbol">:</a> <a id="1171" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1176" href="UTxO.UTxO.html#781" class="Record">TxOutput</a>
        <a id="TxInfo.forge"></a><a id="1193" href="UTxO.UTxO.html#1193" class="Field">forge</a>   <a id="1201" class="Symbol">:</a> <a id="1203" href="UTxO.UTxO.html#438" class="Function">Value</a>

<a id="1210" class="Keyword">record</a> <a id="TxInput"></a><a id="1217" href="UTxO.UTxO.html#1217" class="Record">TxInput</a> <a id="1225" class="Symbol">:</a> <a id="1227" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1232" class="Keyword">where</a>
  <a id="1240" class="Keyword">field</a> <a id="TxInput.outputRef"></a><a id="1246" href="UTxO.UTxO.html#1246" class="Field">outputRef</a> <a id="1256" class="Symbol">:</a> <a id="1258" href="UTxO.UTxO.html#583" class="Record">TxOutputRef</a>
        <a id="TxInput.validator"></a><a id="1278" href="UTxO.UTxO.html#1278" class="Field">validator</a> <a id="1288" class="Symbol">:</a> <a id="1290" href="UTxO.UTxO.html#1100" class="Record">TxInfo</a> <a id="1297" class="Symbol">→</a> <a id="1299" href="UTxO.UTxO.html#523" class="Function">DATA</a> <a id="1304" class="Symbol">→</a> <a id="1306" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
        <a id="TxInput.redeemer"></a><a id="1319" href="UTxO.UTxO.html#1319" class="Field">redeemer</a>  <a id="1329" class="Symbol">:</a> <a id="1331" href="UTxO.UTxO.html#523" class="Function">DATA</a>
<a id="1336" class="Keyword">open</a> <a id="1341" href="UTxO.UTxO.html#1217" class="Module">TxInput</a> <a id="1349" class="Keyword">public</a>

<a id="mkInputInfo"></a><a id="1357" href="UTxO.UTxO.html#1357" class="Function">mkInputInfo</a> <a id="1369" class="Symbol">:</a> <a id="1371" href="UTxO.UTxO.html#1217" class="Record">TxInput</a> <a id="1379" class="Symbol">→</a> <a id="1381" href="UTxO.UTxO.html#971" class="Record">InputInfo</a>
<a id="1391" href="UTxO.UTxO.html#1357" class="Function">mkInputInfo</a> <a id="1403" href="UTxO.UTxO.html#1403" class="Bound">i</a> <a id="1405" class="Symbol">=</a> <a id="1407" class="Keyword">record</a>
  <a id="1416" class="Symbol">{</a> <a id="1418" href="UTxO.UTxO.html#1002" class="Field">outputRef</a>     <a id="1432" class="Symbol">=</a> <a id="1434" href="UTxO.UTxO.html#1403" class="Bound">i</a> <a id="1436" class="Symbol">.</a><a id="1437" href="UTxO.UTxO.html#1246" class="Field">outputRef</a>
  <a id="1449" class="Symbol">;</a> <a id="1451" href="UTxO.UTxO.html#1038" class="Field">validatorHash</a> <a id="1465" class="Symbol">=</a> <a id="1467" href="UTxO.UTxO.html#1403" class="Bound">i</a> <a id="1469" class="Symbol">.</a><a id="1470" href="UTxO.UTxO.html#1278" class="Field">validator</a> <a id="1480" href="UTxO.UTxO.html#489" class="Postulate Operator">♯</a>
  <a id="1484" class="Symbol">;</a> <a id="1486" href="UTxO.UTxO.html#1069" class="Field">redeemerHash</a>  <a id="1500" class="Symbol">=</a> <a id="1502" href="UTxO.UTxO.html#1403" class="Bound">i</a> <a id="1504" class="Symbol">.</a><a id="1505" href="UTxO.UTxO.html#1319" class="Field">redeemer</a> <a id="1514" href="UTxO.UTxO.html#489" class="Postulate Operator">♯</a> <a id="1516" class="Symbol">}</a>

<a id="1519" class="Keyword">record</a> <a id="Tx"></a><a id="1526" href="UTxO.UTxO.html#1526" class="Record">Tx</a> <a id="1529" class="Symbol">:</a> <a id="1531" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1536" class="Keyword">where</a>
  <a id="1544" class="Keyword">field</a>
    <a id="Tx.inputs"></a><a id="1554" href="UTxO.UTxO.html#1554" class="Field">inputs</a>  <a id="1562" class="Symbol">:</a> <a id="1564" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1569" href="UTxO.UTxO.html#1217" class="Record">TxInput</a>
    <a id="Tx.outputs"></a><a id="1581" href="UTxO.UTxO.html#1581" class="Field">outputs</a> <a id="1589" class="Symbol">:</a> <a id="1591" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1596" href="UTxO.UTxO.html#781" class="Record">TxOutput</a>
    <a id="Tx.forge"></a><a id="1609" href="UTxO.UTxO.html#1609" class="Field">forge</a>   <a id="1617" class="Symbol">:</a> <a id="1619" href="UTxO.UTxO.html#438" class="Function">Value</a>
<a id="1625" class="Keyword">open</a> <a id="1630" href="UTxO.UTxO.html#1526" class="Module">Tx</a> <a id="1633" class="Keyword">public</a>

<a id="mkTxInfo"></a><a id="1641" href="UTxO.UTxO.html#1641" class="Function">mkTxInfo</a> <a id="1650" class="Symbol">:</a> <a id="1652" href="UTxO.UTxO.html#1526" class="Record">Tx</a> <a id="1655" class="Symbol">→</a> <a id="1657" href="UTxO.UTxO.html#1100" class="Record">TxInfo</a>
<a id="1664" href="UTxO.UTxO.html#1641" class="Function">mkTxInfo</a> <a id="1673" href="UTxO.UTxO.html#1673" class="Bound">tx</a> <a id="1676" class="Symbol">=</a> <a id="1678" class="Keyword">record</a>
  <a id="1687" class="Symbol">{</a> <a id="1689" href="UTxO.UTxO.html#1128" class="Field">inputs</a>  <a id="1697" class="Symbol">=</a> <a id="1699" href="UTxO.UTxO.html#1357" class="Function">mkInputInfo</a> <a id="1711" href="Prelude.Functor.html#361" class="Field Operator">&lt;$&gt;</a> <a id="1715" href="UTxO.UTxO.html#1673" class="Bound">tx</a> <a id="1718" class="Symbol">.</a><a id="1719" href="UTxO.UTxO.html#1554" class="Field">inputs</a>
  <a id="1728" class="Symbol">;</a> <a id="1730" href="UTxO.UTxO.html#1161" class="Field">outputs</a> <a id="1738" class="Symbol">=</a> <a id="1740" href="UTxO.UTxO.html#1673" class="Bound">tx</a> <a id="1743" class="Symbol">.</a><a id="1744" href="UTxO.UTxO.html#1581" class="Field">outputs</a>
  <a id="1754" class="Symbol">;</a> <a id="1756" href="UTxO.UTxO.html#1193" class="Field">forge</a>   <a id="1764" class="Symbol">=</a> <a id="1766" href="UTxO.UTxO.html#1673" class="Bound">tx</a> <a id="1769" class="Symbol">.</a><a id="1770" href="UTxO.UTxO.html#1609" class="Field">forge</a> <a id="1776" class="Symbol">}</a>

<a id="1779" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="1818" href="UTxO.UTxO.html#1818" class="Function">L</a> <a id="1820" class="Symbol">=</a> <a id="1822" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1827" href="UTxO.UTxO.html#1526" class="Record">Tx</a>

<a id="1831" class="Keyword">record</a> <a id="UTXO"></a><a id="1838" href="UTxO.UTxO.html#1838" class="Record">UTXO</a> <a id="1843" class="Symbol">:</a> <a id="1845" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1850" class="Keyword">where</a>
  <a id="1858" class="Keyword">field</a> <a id="UTXO.outRef"></a><a id="1864" href="UTxO.UTxO.html#1864" class="Field">outRef</a> <a id="1871" class="Symbol">:</a> <a id="1873" href="UTxO.UTxO.html#583" class="Record">TxOutputRef</a>
        <a id="UTXO.out"></a><a id="1893" href="UTxO.UTxO.html#1893" class="Field">out</a>    <a id="1900" class="Symbol">:</a> <a id="1902" href="UTxO.UTxO.html#781" class="Record">TxOutput</a>
<a id="1911" class="Keyword">unquoteDecl</a> <a id="DecEq-UTXO"></a><a id="1923" href="UTxO.UTxO.html#1923" class="Function">DecEq-UTXO</a> <a id="1934" class="Symbol">=</a> <a id="1936" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="1943" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="1949" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1951" class="Keyword">quote</a> <a id="1957" href="UTxO.UTxO.html#1838" class="Record">UTXO</a> <a id="1962" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1964" href="UTxO.UTxO.html#1923" class="Function">DecEq-UTXO</a> <a id="1975" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="1978" class="Comment">-- The state of a ledger is a collection of unspent transaction outputs.</a>
<a id="S"></a><a id="2051" href="UTxO.UTxO.html#2051" class="Function">S</a> <a id="2053" class="Symbol">:</a> <a id="2055" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="2060" href="UTxO.UTxO.html#2051" class="Function">S</a> <a id="2062" class="Symbol">=</a> <a id="2064" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="2069" href="UTxO.UTxO.html#1838" class="Record">UTXO</a> <a id="2074" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>

<a id="mkUtxo"></a><a id="2077" href="UTxO.UTxO.html#2077" class="Function">mkUtxo</a> <a id="2084" class="Symbol">:</a> <a id="2086" class="Symbol">∀</a> <a id="2088" class="Symbol">{</a><a id="2089" href="UTxO.UTxO.html#2089" class="Bound">out</a><a id="2092" class="Symbol">}</a> <a id="2094" href="UTxO.UTxO.html#2094" class="Bound">tx</a> <a id="2097" class="Symbol">→</a> <a id="2099" href="UTxO.UTxO.html#2089" class="Bound">out</a> <a id="2103" href="Data.List.Membership.Setoid.html#887" class="Function Operator">L.Mem.∈</a> <a id="2111" href="UTxO.UTxO.html#1581" class="Field">outputs</a> <a id="2119" href="UTxO.UTxO.html#2094" class="Bound">tx</a> <a id="2122" class="Symbol">→</a> <a id="2124" href="UTxO.UTxO.html#1838" class="Record">UTXO</a>
<a id="2129" href="UTxO.UTxO.html#2077" class="Function">mkUtxo</a> <a id="2136" class="Symbol">{</a><a id="2137" href="UTxO.UTxO.html#2137" class="Bound">out</a><a id="2140" class="Symbol">}</a> <a id="2142" href="UTxO.UTxO.html#2142" class="Bound">tx</a> <a id="2145" href="UTxO.UTxO.html#2145" class="Bound">out∈</a> <a id="2150" class="Symbol">=</a> <a id="2152" class="Symbol">λ</a> <a id="2154" class="Keyword">where</a>
  <a id="2162" class="Symbol">.</a><a id="2163" href="UTxO.UTxO.html#1864" class="Field">UTXO.outRef</a> <a id="2175" class="Symbol">→</a> <a id="2177" class="Symbol">(</a><a id="2178" href="UTxO.UTxO.html#2142" class="Bound">tx</a> <a id="2181" href="UTxO.UTxO.html#489" class="Postulate Operator">♯</a><a id="2182" class="Symbol">)</a> <a id="2184" href="UTxO.UTxO.html#622" class="InductiveConstructor Operator">indexed-at</a> <a id="2195" href="Prelude.ToN.html#116" class="Field">toℕ</a> <a id="2199" class="Symbol">(</a><a id="2200" href="Data.List.Relation.Unary.Any.html#1817" class="Function">L.Any.index</a> <a id="2212" href="UTxO.UTxO.html#2145" class="Bound">out∈</a><a id="2216" class="Symbol">)</a>
  <a id="2220" class="Symbol">.</a><a id="2221" href="UTxO.UTxO.html#1893" class="Field">UTXO.out</a>    <a id="2233" class="Symbol">→</a> <a id="2235" href="UTxO.UTxO.html#2137" class="Bound">out</a>

<a id="outputRefs"></a><a id="2240" href="UTxO.UTxO.html#2240" class="Function">outputRefs</a> <a id="2251" class="Symbol">:</a> <a id="2253" href="UTxO.UTxO.html#1526" class="Record">Tx</a> <a id="2256" class="Symbol">→</a> <a id="2258" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2263" href="UTxO.UTxO.html#583" class="Record">TxOutputRef</a>
<a id="2275" href="UTxO.UTxO.html#2240" class="Function">outputRefs</a> <a id="2286" class="Symbol">=</a> <a id="2288" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2292" href="UTxO.UTxO.html#1246" class="Field">outputRef</a> <a id="2302" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2304" href="UTxO.UTxO.html#1554" class="Field">inputs</a>

<a id="getSpentOutputRef"></a><a id="2312" href="UTxO.UTxO.html#2312" class="Function">getSpentOutputRef</a> <a id="2330" class="Symbol">:</a> <a id="2332" href="UTxO.UTxO.html#2051" class="Function">S</a> <a id="2334" class="Symbol">→</a> <a id="2336" href="UTxO.UTxO.html#583" class="Record">TxOutputRef</a> <a id="2348" class="Symbol">→</a> <a id="2350" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2356" href="UTxO.UTxO.html#781" class="Record">TxOutput</a>
<a id="2365" href="UTxO.UTxO.html#2312" class="Function">getSpentOutputRef</a> <a id="2383" href="UTxO.UTxO.html#2383" class="Bound">s</a> <a id="2385" href="UTxO.UTxO.html#2385" class="Bound">oRef</a> <a id="2390" class="Symbol">=</a> <a id="2392" href="UTxO.UTxO.html#2418" class="Function">go</a> <a id="2395" class="Symbol">(</a><a id="2396" href="Prelude.ToList.html#170" class="Field">toList</a> <a id="2403" href="UTxO.UTxO.html#2383" class="Bound">s</a><a id="2404" class="Symbol">)</a>
  <a id="2408" class="Keyword">where</a>
    <a id="2418" href="UTxO.UTxO.html#2418" class="Function">go</a> <a id="2421" class="Symbol">:</a> <a id="2423" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2428" href="UTxO.UTxO.html#1838" class="Record">UTXO</a> <a id="2433" class="Symbol">→</a> <a id="2435" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2441" href="UTxO.UTxO.html#781" class="Record">TxOutput</a>
    <a id="2454" href="UTxO.UTxO.html#2418" class="Function">go</a> <a id="2457" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2460" class="Symbol">=</a> <a id="2462" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="2474" href="UTxO.UTxO.html#2418" class="Function">go</a> <a id="2477" class="Symbol">(</a><a id="2478" class="Keyword">record</a> <a id="2485" class="Symbol">{</a><a id="2486" href="UTxO.UTxO.html#1864" class="Field">outRef</a> <a id="2493" class="Symbol">=</a> <a id="2495" href="UTxO.UTxO.html#2495" class="Bound">or</a><a id="2497" class="Symbol">;</a> <a id="2499" href="UTxO.UTxO.html#1893" class="Field">out</a> <a id="2503" class="Symbol">=</a> <a id="2505" href="UTxO.UTxO.html#2505" class="Bound">o</a><a id="2506" class="Symbol">}</a> <a id="2508" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2510" href="UTxO.UTxO.html#2510" class="Bound">xs</a><a id="2512" class="Symbol">)</a> <a id="2514" class="Symbol">=</a>
      <a id="2522" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2525" href="UTxO.UTxO.html#2385" class="Bound">oRef</a> <a id="2530" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="2533" href="UTxO.UTxO.html#2495" class="Bound">or</a> <a id="2536" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>
        <a id="2549" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2554" href="UTxO.UTxO.html#2505" class="Bound">o</a>
      <a id="2562" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
        <a id="2575" href="UTxO.UTxO.html#2418" class="Function">go</a> <a id="2578" href="UTxO.UTxO.html#2510" class="Bound">xs</a>

<a id="getSpentOutput"></a><a id="2582" href="UTxO.UTxO.html#2582" class="Function">getSpentOutput</a> <a id="2597" class="Symbol">:</a> <a id="2599" href="UTxO.UTxO.html#2051" class="Function">S</a> <a id="2601" class="Symbol">→</a> <a id="2603" href="UTxO.UTxO.html#1217" class="Record">TxInput</a> <a id="2611" class="Symbol">→</a> <a id="2613" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2619" href="UTxO.UTxO.html#781" class="Record">TxOutput</a>
<a id="2628" href="UTxO.UTxO.html#2582" class="Function">getSpentOutput</a> <a id="2643" href="UTxO.UTxO.html#2643" class="Bound">s</a> <a id="2645" href="UTxO.UTxO.html#2645" class="Bound">i</a> <a id="2647" class="Symbol">=</a> <a id="2649" href="UTxO.UTxO.html#2312" class="Function">getSpentOutputRef</a> <a id="2667" href="UTxO.UTxO.html#2643" class="Bound">s</a> <a id="2669" class="Symbol">(</a><a id="2670" href="UTxO.UTxO.html#2645" class="Bound">i</a> <a id="2672" class="Symbol">.</a><a id="2673" href="UTxO.UTxO.html#1246" class="Field">outputRef</a><a id="2682" class="Symbol">)</a>

<a id="∑"></a><a id="2685" href="UTxO.UTxO.html#2685" class="Function">∑</a> <a id="2687" class="Symbol">:</a> <a id="2689" class="Symbol">∀</a> <a id="2691" class="Symbol">{</a><a id="2692" href="UTxO.UTxO.html#2692" class="Bound">A</a> <a id="2694" class="Symbol">:</a> <a id="2696" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="2700" class="Symbol">}</a> <a id="2702" class="Symbol">→</a> <a id="2704" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2709" href="UTxO.UTxO.html#2692" class="Bound">A</a> <a id="2711" class="Symbol">→</a> <a id="2713" class="Symbol">(</a><a id="2714" href="UTxO.UTxO.html#2692" class="Bound">A</a> <a id="2716" class="Symbol">→</a> <a id="2718" href="UTxO.UTxO.html#438" class="Function">Value</a><a id="2723" class="Symbol">)</a> <a id="2725" class="Symbol">→</a> <a id="2727" href="UTxO.UTxO.html#438" class="Function">Value</a>
<a id="2733" href="UTxO.UTxO.html#2685" class="Function">∑</a> <a id="2735" href="UTxO.UTxO.html#2735" class="Bound">xs</a> <a id="2738" href="UTxO.UTxO.html#2738" class="Bound">f</a> <a id="2740" class="Symbol">=</a> <a id="2742" href="Prelude.Lists.Sums.html#283" class="Function">∑ℕ</a> <a id="2745" class="Symbol">(</a><a id="2746" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2750" href="UTxO.UTxO.html#2738" class="Bound">f</a> <a id="2752" href="UTxO.UTxO.html#2735" class="Bound">xs</a><a id="2754" class="Symbol">)</a>

<a id="∑M"></a><a id="2757" href="UTxO.UTxO.html#2757" class="Function">∑M</a> <a id="2760" class="Symbol">:</a> <a id="2762" class="Symbol">∀</a> <a id="2764" class="Symbol">{</a><a id="2765" href="UTxO.UTxO.html#2765" class="Bound">A</a> <a id="2767" class="Symbol">:</a> <a id="2769" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="2773" class="Symbol">}</a> <a id="2775" class="Symbol">→</a> <a id="2777" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2782" class="Symbol">(</a><a id="2783" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2789" href="UTxO.UTxO.html#2765" class="Bound">A</a><a id="2790" class="Symbol">)</a> <a id="2792" class="Symbol">→</a> <a id="2794" class="Symbol">(</a><a id="2795" href="UTxO.UTxO.html#2765" class="Bound">A</a> <a id="2797" class="Symbol">→</a> <a id="2799" href="UTxO.UTxO.html#438" class="Function">Value</a><a id="2804" class="Symbol">)</a> <a id="2806" class="Symbol">→</a> <a id="2808" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2814" href="UTxO.UTxO.html#438" class="Function">Value</a>
<a id="2820" href="UTxO.UTxO.html#2757" class="Function">∑M</a> <a id="2823" href="UTxO.UTxO.html#2823" class="Bound">xs</a> <a id="2826" href="UTxO.UTxO.html#2826" class="Bound">f</a> <a id="2828" class="Symbol">=</a> <a id="2830" class="Symbol">(</a><a id="2831" href="Function.Base.html#1554" class="Function">flip</a> <a id="2836" href="UTxO.UTxO.html#2685" class="Function">∑</a> <a id="2838" href="UTxO.UTxO.html#2826" class="Bound">f</a><a id="2839" class="Symbol">)</a> <a id="2841" href="Prelude.Functor.html#361" class="Field Operator">&lt;$&gt;</a> <a id="2845" href="UTxO.UTxO.html#2902" class="Function">seqM</a> <a id="2850" href="UTxO.UTxO.html#2823" class="Bound">xs</a>
  <a id="2855" class="Keyword">where</a>
    <a id="2865" class="Comment">-- if one fails everything fails</a>
    <a id="2902" href="UTxO.UTxO.html#2902" class="Function">seqM</a> <a id="2907" class="Symbol">:</a> <a id="2909" class="Symbol">∀</a> <a id="2911" class="Symbol">{</a><a id="2912" href="UTxO.UTxO.html#2912" class="Bound">A</a> <a id="2914" class="Symbol">:</a> <a id="2916" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="2920" class="Symbol">}</a> <a id="2922" class="Symbol">→</a> <a id="2924" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2929" class="Symbol">(</a><a id="2930" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2936" href="UTxO.UTxO.html#2912" class="Bound">A</a><a id="2937" class="Symbol">)</a> <a id="2939" class="Symbol">→</a> <a id="2941" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2947" class="Symbol">(</a><a id="2948" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2953" href="UTxO.UTxO.html#2912" class="Bound">A</a><a id="2954" class="Symbol">)</a>
    <a id="2960" href="UTxO.UTxO.html#2902" class="Function">seqM</a> <a id="2965" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="2974" class="Symbol">=</a> <a id="2976" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2981" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="2988" href="UTxO.UTxO.html#2902" class="Function">seqM</a> <a id="2993" class="Symbol">(</a><a id="2994" href="UTxO.UTxO.html#2994" class="Bound">x</a> <a id="2996" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2998" href="UTxO.UTxO.html#2998" class="Bound">xs</a><a id="3000" class="Symbol">)</a> <a id="3002" class="Symbol">=</a> <a id="3004" class="Symbol">⦇</a> <a id="3006" href="UTxO.UTxO.html#2994" class="Bound">x</a> <a id="3008" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3010" href="UTxO.UTxO.html#2902" class="Function">seqM</a> <a id="3015" href="UTxO.UTxO.html#2998" class="Bound">xs</a> <a id="3018" class="Symbol">⦈</a>

<a id="3021" class="Keyword">record</a> <a id="IsValidTx"></a><a id="3028" href="UTxO.UTxO.html#3028" class="Record">IsValidTx</a> <a id="3038" class="Symbol">(</a><a id="3039" href="UTxO.UTxO.html#3039" class="Bound">tx</a> <a id="3042" class="Symbol">:</a> <a id="3044" href="UTxO.UTxO.html#1526" class="Record">Tx</a><a id="3046" class="Symbol">)</a> <a id="3048" class="Symbol">(</a><a id="3049" href="UTxO.UTxO.html#3049" class="Bound">utxos</a> <a id="3055" class="Symbol">:</a> <a id="3057" href="UTxO.UTxO.html#2051" class="Function">S</a><a id="3058" class="Symbol">)</a> <a id="3060" class="Symbol">:</a> <a id="3062" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3067" class="Keyword">where</a>
  <a id="3075" class="Keyword">field</a>
    <a id="IsValidTx.validOutputRefs"></a><a id="3085" href="UTxO.UTxO.html#3085" class="Field">validOutputRefs</a> <a id="3101" class="Symbol">:</a>
      <a id="3109" href="UTxO.UTxO.html#2240" class="Function">outputRefs</a> <a id="3120" href="UTxO.UTxO.html#3039" class="Bound">tx</a> <a id="3123" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="3125" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3129" href="UTxO.UTxO.html#1864" class="Field">UTXO.outRef</a> <a id="3141" class="Symbol">(</a><a id="3142" href="Prelude.ToList.html#170" class="Field">toList</a> <a id="3149" href="UTxO.UTxO.html#3049" class="Bound">utxos</a><a id="3154" class="Symbol">)</a>

    <a id="IsValidTx.preservesValues"></a><a id="3161" href="UTxO.UTxO.html#3161" class="Field">preservesValues</a> <a id="3177" class="Symbol">:</a>
      <a id="3185" href="Data.Maybe.Relation.Unary.Any.html#830" class="Datatype">M.Any.Any</a> <a id="3195" class="Symbol">(λ</a> <a id="3198" href="UTxO.UTxO.html#3198" class="Bound">q</a> <a id="3200" class="Symbol">→</a> <a id="3202" href="UTxO.UTxO.html#3039" class="Bound">tx</a> <a id="3205" class="Symbol">.</a><a id="3206" href="UTxO.UTxO.html#1609" class="Field">forge</a> <a id="3212" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3214" href="UTxO.UTxO.html#3198" class="Bound">q</a> <a id="3216" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3218" href="UTxO.UTxO.html#2685" class="Function">∑</a> <a id="3220" class="Symbol">(</a><a id="3221" href="UTxO.UTxO.html#3039" class="Bound">tx</a> <a id="3224" class="Symbol">.</a><a id="3225" href="UTxO.UTxO.html#1581" class="Field">outputs</a><a id="3232" class="Symbol">)</a> <a id="3234" href="UTxO.UTxO.html#830" class="Field">value</a><a id="3239" class="Symbol">)</a>
                <a id="3257" class="Symbol">(</a><a id="3258" href="UTxO.UTxO.html#2757" class="Function">∑M</a> <a id="3261" class="Symbol">(</a><a id="3262" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3266" class="Symbol">(</a><a id="3267" href="UTxO.UTxO.html#2582" class="Function">getSpentOutput</a> <a id="3282" href="UTxO.UTxO.html#3049" class="Bound">utxos</a><a id="3287" class="Symbol">)</a> <a id="3289" class="Symbol">(</a><a id="3290" href="UTxO.UTxO.html#3039" class="Bound">tx</a> <a id="3293" class="Symbol">.</a><a id="3294" href="UTxO.UTxO.html#1554" class="Field">inputs</a><a id="3300" class="Symbol">))</a> <a id="3303" href="UTxO.UTxO.html#830" class="Field">value</a><a id="3308" class="Symbol">)</a>

    <a id="IsValidTx.noDoubleSpending"></a><a id="3315" href="UTxO.UTxO.html#3315" class="Field">noDoubleSpending</a> <a id="3332" class="Symbol">:</a>
      <a id="3340" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">Unique</a> <a id="3347" class="Symbol">(</a><a id="3348" href="UTxO.UTxO.html#2240" class="Function">outputRefs</a> <a id="3359" href="UTxO.UTxO.html#3039" class="Bound">tx</a><a id="3361" class="Symbol">)</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="3368" href="UTxO.UTxO.html#3368" class="Field">allInputsValidate</a> <a id="3386" class="Symbol">:</a>
      <a id="3394" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="3398" class="Symbol">(λ</a> <a id="3401" href="UTxO.UTxO.html#3401" class="Bound">i</a> <a id="3403" class="Symbol">→</a> <a id="3405" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="3407" class="Symbol">(</a><a id="3408" href="UTxO.UTxO.html#1278" class="Field">validator</a> <a id="3418" href="UTxO.UTxO.html#3401" class="Bound">i</a> <a id="3420" class="Symbol">(</a><a id="3421" href="UTxO.UTxO.html#1641" class="Function">mkTxInfo</a> <a id="3430" href="UTxO.UTxO.html#3039" class="Bound">tx</a><a id="3432" class="Symbol">)</a> <a id="3434" class="Symbol">(</a><a id="3435" href="UTxO.UTxO.html#3401" class="Bound">i</a> <a id="3437" class="Symbol">.</a><a id="3438" href="UTxO.UTxO.html#1319" class="Field">redeemer</a><a id="3446" class="Symbol">)))</a>
          <a id="3460" class="Symbol">(</a><a id="3461" href="UTxO.UTxO.html#3039" class="Bound">tx</a> <a id="3464" class="Symbol">.</a><a id="3465" href="UTxO.UTxO.html#1554" class="Field">inputs</a><a id="3471" class="Symbol">)</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="3478" href="UTxO.UTxO.html#3478" class="Field">validateValidHashes</a> <a id="3498" class="Symbol">:</a>
      <a id="3506" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="3510" class="Symbol">(λ</a> <a id="3513" href="UTxO.UTxO.html#3513" class="Bound">i</a> <a id="3515" class="Symbol">→</a> <a id="3517" href="Data.Maybe.Relation.Unary.Any.html#830" class="Datatype">M.Any.Any</a> <a id="3527" class="Symbol">(λ</a> <a id="3530" href="UTxO.UTxO.html#3530" class="Bound">o</a> <a id="3532" class="Symbol">→</a> <a id="3534" href="UTxO.UTxO.html#3530" class="Bound">o</a> <a id="3536" class="Symbol">.</a><a id="3537" href="UTxO.UTxO.html#855" class="Field">address</a> <a id="3545" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3547" href="UTxO.UTxO.html#3513" class="Bound">i</a> <a id="3549" class="Symbol">.</a><a id="3550" href="UTxO.UTxO.html#1278" class="Field">validator</a> <a id="3560" href="UTxO.UTxO.html#489" class="Postulate Operator">♯</a><a id="3561" class="Symbol">)</a> <a id="3563" class="Symbol">(</a><a id="3564" href="UTxO.UTxO.html#2582" class="Function">getSpentOutput</a> <a id="3579" href="UTxO.UTxO.html#3049" class="Bound">utxos</a> <a id="3585" href="UTxO.UTxO.html#3513" class="Bound">i</a><a id="3586" class="Symbol">))</a>
          <a id="3599" class="Symbol">(</a><a id="3600" href="UTxO.UTxO.html#3039" class="Bound">tx</a> <a id="3603" class="Symbol">.</a><a id="3604" href="UTxO.UTxO.html#1554" class="Field">inputs</a><a id="3610" class="Symbol">)</a>

<a id="3613" class="Keyword">open</a> <a id="3618" href="UTxO.UTxO.html#3028" class="Module">IsValidTx</a> <a id="3628" class="Keyword">public</a>

<a id="isValidTx?"></a><a id="3636" href="UTxO.UTxO.html#3636" class="Function">isValidTx?</a> <a id="3647" class="Symbol">:</a> <a id="3649" class="Symbol">∀</a> <a id="3651" href="UTxO.UTxO.html#3651" class="Bound">tx</a> <a id="3654" href="UTxO.UTxO.html#3654" class="Bound">s</a> <a id="3656" class="Symbol">→</a> <a id="3658" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="3662" class="Symbol">(</a><a id="3663" href="UTxO.UTxO.html#3028" class="Record">IsValidTx</a> <a id="3673" href="UTxO.UTxO.html#3651" class="Bound">tx</a> <a id="3676" href="UTxO.UTxO.html#3654" class="Bound">s</a><a id="3677" class="Symbol">)</a>
<a id="3679" href="UTxO.UTxO.html#3636" class="Function">isValidTx?</a> <a id="3690" href="UTxO.UTxO.html#3690" class="Bound">tx</a> <a id="3693" href="UTxO.UTxO.html#3693" class="Bound">utxos</a>
  <a id="3701" class="Keyword">with</a> <a id="3706" href="UTxO.UTxO.html#2240" class="Function">outputRefs</a> <a id="3717" href="UTxO.UTxO.html#3690" class="Bound">tx</a> <a id="3720" href="Prelude.DecLists.html#1415" class="Function Operator">⊆?</a> <a id="3723" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3727" href="UTxO.UTxO.html#1864" class="Field">UTXO.outRef</a> <a id="3739" class="Symbol">(</a><a id="3740" href="Prelude.ToList.html#170" class="Field">toList</a> <a id="3747" href="UTxO.UTxO.html#3693" class="Bound">utxos</a><a id="3752" class="Symbol">)</a>
<a id="3754" class="Symbol">...</a> <a id="3758" class="Symbol">|</a> <a id="3760" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3763" href="UTxO.UTxO.html#3763" class="Bound">¬p</a> <a id="3766" class="Symbol">=</a> <a id="3768" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3771" class="Symbol">(</a><a id="3772" href="UTxO.UTxO.html#3763" class="Bound">¬p</a> <a id="3775" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3777" href="UTxO.UTxO.html#3085" class="Field">validOutputRefs</a> <a id="3793" class="Symbol">)</a>
<a id="3795" class="Symbol">...</a> <a id="3799" class="Symbol">|</a> <a id="3801" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3805" href="UTxO.UTxO.html#3805" class="Bound">p₁</a>
  <a id="3810" class="Keyword">with</a> <a id="3815" href="Data.Maybe.Relation.Unary.Any.html#2128" class="Function">M.Any.dec</a> <a id="3825" class="Symbol">(λ</a> <a id="3828" href="UTxO.UTxO.html#3828" class="Bound">q</a> <a id="3830" class="Symbol">→</a> <a id="3832" class="Bound">tx</a> <a id="3835" class="Symbol">.</a><a id="3836" href="UTxO.UTxO.html#1609" class="Field">forge</a> <a id="3842" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3844" href="UTxO.UTxO.html#3828" class="Bound">q</a> <a id="3846" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="3848" href="UTxO.UTxO.html#2685" class="Function">∑</a> <a id="3850" class="Symbol">(</a><a id="3851" class="Bound">tx</a> <a id="3854" class="Symbol">.</a><a id="3855" href="UTxO.UTxO.html#1581" class="Field">outputs</a><a id="3862" class="Symbol">)</a> <a id="3864" href="UTxO.UTxO.html#830" class="Field">value</a><a id="3869" class="Symbol">)</a>
                 <a id="3888" class="Symbol">(</a><a id="3889" href="UTxO.UTxO.html#2757" class="Function">∑M</a> <a id="3892" class="Symbol">(</a><a id="3893" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3897" class="Symbol">(</a><a id="3898" href="UTxO.UTxO.html#2582" class="Function">getSpentOutput</a> <a id="3913" class="Bound">utxos</a><a id="3918" class="Symbol">)</a> <a id="3920" class="Symbol">(</a><a id="3921" class="Bound">tx</a> <a id="3924" class="Symbol">.</a><a id="3925" href="UTxO.UTxO.html#1554" class="Field">inputs</a><a id="3931" class="Symbol">))</a> <a id="3934" href="UTxO.UTxO.html#830" class="Field">value</a><a id="3939" class="Symbol">)</a>
<a id="3941" class="Symbol">...</a> <a id="3945" class="Symbol">|</a> <a id="3947" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3950" href="UTxO.UTxO.html#3950" class="Bound">¬p</a> <a id="3953" class="Symbol">=</a> <a id="3955" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3958" class="Symbol">(</a><a id="3959" href="UTxO.UTxO.html#3950" class="Bound">¬p</a> <a id="3962" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3964" href="UTxO.UTxO.html#3161" class="Field">preservesValues</a><a id="3979" class="Symbol">)</a>
<a id="3981" class="Symbol">...</a> <a id="3985" class="Symbol">|</a> <a id="3987" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3991" href="UTxO.UTxO.html#3991" class="Bound">p₂</a>
  <a id="3996" class="Keyword">with</a> <a id="4001" href="Prelude.DecLists.html#1474" class="Function">unique?</a> <a id="4009" class="Symbol">(</a><a id="4010" href="UTxO.UTxO.html#2240" class="Function">outputRefs</a> <a id="4021" class="Bound">tx</a><a id="4023" class="Symbol">)</a>
<a id="4025" class="Symbol">...</a> <a id="4029" class="Symbol">|</a> <a id="4031" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4034" href="UTxO.UTxO.html#4034" class="Bound">¬p</a> <a id="4037" class="Symbol">=</a> <a id="4039" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4042" class="Symbol">(</a><a id="4043" href="UTxO.UTxO.html#4034" class="Bound">¬p</a> <a id="4046" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4048" href="UTxO.UTxO.html#3315" class="Field">noDoubleSpending</a><a id="4064" class="Symbol">)</a>
<a id="4066" class="Symbol">...</a> <a id="4070" class="Symbol">|</a> <a id="4072" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4076" href="UTxO.UTxO.html#4076" class="Bound">p₃</a>
  <a id="4081" class="Keyword">with</a> <a id="4086" href="Data.List.Relation.Unary.All.html#6240" class="Function">all?</a> <a id="4091" class="Symbol">(λ</a> <a id="4094" href="UTxO.UTxO.html#4094" class="Bound">i</a> <a id="4096" class="Symbol">→</a> <a id="4098" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="4101" class="Symbol">(</a><a id="4102" href="UTxO.UTxO.html#1278" class="Field">validator</a> <a id="4112" href="UTxO.UTxO.html#4094" class="Bound">i</a> <a id="4114" class="Symbol">(</a><a id="4115" href="UTxO.UTxO.html#1641" class="Function">mkTxInfo</a> <a id="4124" class="Bound">tx</a><a id="4126" class="Symbol">)</a> <a id="4128" class="Symbol">(</a><a id="4129" href="UTxO.UTxO.html#4094" class="Bound">i</a> <a id="4131" class="Symbol">.</a><a id="4132" href="UTxO.UTxO.html#1319" class="Field">redeemer</a><a id="4140" class="Symbol">)))</a>
            <a id="4156" class="Symbol">(</a><a id="4157" class="Bound">tx</a> <a id="4160" class="Symbol">.</a><a id="4161" href="UTxO.UTxO.html#1554" class="Field">inputs</a><a id="4167" class="Symbol">)</a>
<a id="4169" class="Symbol">...</a> <a id="4173" class="Symbol">|</a> <a id="4175" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4178" href="UTxO.UTxO.html#4178" class="Bound">¬p</a> <a id="4181" class="Symbol">=</a> <a id="4183" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4186" class="Symbol">(</a><a id="4187" href="UTxO.UTxO.html#4178" class="Bound">¬p</a> <a id="4190" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4192" href="UTxO.UTxO.html#3368" class="Field">allInputsValidate</a><a id="4209" class="Symbol">)</a>
<a id="4211" class="Symbol">...</a> <a id="4215" class="Symbol">|</a> <a id="4217" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4221" href="UTxO.UTxO.html#4221" class="Bound">p₄</a>
  <a id="4226" class="Keyword">with</a> <a id="4231" href="Data.List.Relation.Unary.All.html#6240" class="Function">all?</a> <a id="4236" class="Symbol">(λ</a> <a id="4239" href="UTxO.UTxO.html#4239" class="Bound">i</a> <a id="4241" class="Symbol">→</a> <a id="4243" href="Data.Maybe.Relation.Unary.Any.html#2128" class="Function">M.Any.dec</a> <a id="4253" class="Symbol">(λ</a> <a id="4256" href="UTxO.UTxO.html#4256" class="Bound">o</a> <a id="4258" class="Symbol">→</a> <a id="4260" href="UTxO.UTxO.html#4256" class="Bound">o</a> <a id="4262" class="Symbol">.</a><a id="4263" href="UTxO.UTxO.html#855" class="Field">address</a> <a id="4271" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="4273" href="UTxO.UTxO.html#4239" class="Bound">i</a> <a id="4275" class="Symbol">.</a><a id="4276" href="UTxO.UTxO.html#1278" class="Field">validator</a> <a id="4286" href="UTxO.UTxO.html#489" class="Postulate Operator">♯</a><a id="4287" class="Symbol">)</a> <a id="4289" class="Symbol">(</a><a id="4290" href="UTxO.UTxO.html#2582" class="Function">getSpentOutput</a> <a id="4305" class="Bound">utxos</a> <a id="4311" href="UTxO.UTxO.html#4239" class="Bound">i</a><a id="4312" class="Symbol">))</a>
            <a id="4327" class="Symbol">(</a><a id="4328" class="Bound">tx</a> <a id="4331" class="Symbol">.</a><a id="4332" href="UTxO.UTxO.html#1554" class="Field">inputs</a><a id="4338" class="Symbol">)</a>
<a id="4340" class="Symbol">...</a> <a id="4344" class="Symbol">|</a> <a id="4346" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4349" href="UTxO.UTxO.html#4349" class="Bound">¬p</a> <a id="4352" class="Symbol">=</a> <a id="4354" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4357" class="Symbol">(</a><a id="4358" href="UTxO.UTxO.html#4349" class="Bound">¬p</a> <a id="4361" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4363" href="UTxO.UTxO.html#3478" class="Field">validateValidHashes</a><a id="4382" class="Symbol">)</a>
<a id="4384" class="Symbol">...</a> <a id="4388" class="Symbol">|</a> <a id="4390" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4394" href="UTxO.UTxO.html#4394" class="Bound">p₅</a> <a id="4397" class="Symbol">=</a> <a id="4399" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4403" class="Keyword">record</a> <a id="4410" class="Symbol">{</a><a id="4411" href="UTxO.UTxO.html#3085" class="Field">validOutputRefs</a> <a id="4427" class="Symbol">=</a> <a id="4429" class="Bound">p₁</a><a id="4431" class="Symbol">;</a> <a id="4433" href="UTxO.UTxO.html#3161" class="Field">preservesValues</a> <a id="4449" class="Symbol">=</a> <a id="4451" class="Bound">p₂</a><a id="4453" class="Symbol">;</a> <a id="4455" href="UTxO.UTxO.html#3315" class="Field">noDoubleSpending</a> <a id="4472" class="Symbol">=</a> <a id="4474" class="Bound">p₃</a><a id="4476" class="Symbol">;</a> <a id="4478" href="UTxO.UTxO.html#3368" class="Field">allInputsValidate</a> <a id="4496" class="Symbol">=</a> <a id="4498" class="Bound">p₄</a><a id="4500" class="Symbol">;</a> <a id="4502" href="UTxO.UTxO.html#3478" class="Field">validateValidHashes</a> <a id="4522" class="Symbol">=</a> <a id="4524" href="UTxO.UTxO.html#4394" class="Bound">p₅</a><a id="4526" class="Symbol">}</a>

<a id="isValidTx"></a><a id="4529" href="UTxO.UTxO.html#4529" class="Function">isValidTx</a> <a id="4539" class="Symbol">:</a> <a id="4541" href="UTxO.UTxO.html#1526" class="Record">Tx</a> <a id="4544" class="Symbol">→</a> <a id="4546" href="UTxO.UTxO.html#2051" class="Function">S</a> <a id="4548" class="Symbol">→</a> <a id="4550" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="4555" href="UTxO.UTxO.html#4529" class="Function">isValidTx</a> <a id="4565" href="UTxO.UTxO.html#4565" class="Bound">tx</a> <a id="4568" href="UTxO.UTxO.html#4568" class="Bound">s</a> <a id="4570" class="Symbol">=</a> <a id="4572" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="4574" href="UTxO.UTxO.html#3636" class="Function">isValidTx?</a> <a id="4585" href="UTxO.UTxO.html#4565" class="Bound">tx</a> <a id="4588" href="UTxO.UTxO.html#4568" class="Bound">s</a> <a id="4590" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
</pre></body></html>