<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Deep.Ledger</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Keyword">open</a> <a id="45" class="Keyword">import</a> <a id="52" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="64" class="Symbol">;</a> <a id="66" class="Keyword">open</a> <a id="71" href="Prelude.Init.html#397" class="Module">SetAsType</a>
<a id="81" class="Keyword">open</a> <a id="86" class="Keyword">import</a> <a id="93" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="109" class="Keyword">open</a> <a id="114" href="Prelude.Init.html#3702" class="Module">Integer</a> <a id="122" class="Keyword">using</a> <a id="128" class="Symbol">()</a> <a id="131" class="Keyword">renaming</a> <a id="140" class="Symbol">(</a><a id="141" href="Data.Integer.Base.html#5023" class="Function Operator">_-_</a> <a id="145" class="Symbol">to</a> <a id="148" class="Function Operator">_-ℤ_</a><a id="152" class="Symbol">;</a> <a id="154" href="Data.Integer.Base.html#4844" class="Function Operator">_+_</a> <a id="158" class="Symbol">to</a> <a id="161" class="Function Operator">_+ℤ_</a><a id="165" class="Symbol">)</a>
<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Prelude.Maps.Abstract.html" class="Module">Prelude.Maps.Abstract</a> <a id="252" class="Keyword">hiding</a> <a id="259" class="Symbol">(</a><a id="260" href="Prelude.Maps.Abstract.Interface.html#563" class="Function">∅</a><a id="261" class="Symbol">;</a> <a id="263" href="Prelude.Maps.Abstract.Interface.html#7326" class="Function">singleton</a><a id="272" class="Symbol">)</a> <a id="274" class="Keyword">renaming</a> <a id="283" class="Symbol">(</a><a id="284" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">_∪_</a> <a id="288" class="Symbol">to</a> <a id="291" class="Function Operator">_∪ᵐ_</a><a id="295" class="Symbol">)</a>
<a id="297" class="Keyword">open</a> <a id="302" href="Prelude.Maps.Abstract.Interface.html#15037" class="Module">CommandDSL</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="339" class="Keyword">open</a> <a id="344" class="Keyword">import</a> <a id="351" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>

<a id="427" class="Keyword">module</a> <a id="434" href="Deep.Ledger.html" class="Module">Deep.Ledger</a>
  <a id="448" class="Symbol">(</a><a id="449" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="454" class="Symbol">:</a> <a id="456" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="460" class="Symbol">)</a> <a id="462" class="Comment">-- a fixed set of participants</a>
  <a id="495" class="Symbol">⦃</a> <a id="497" href="Deep.Ledger.html#497" class="Bound">_</a> <a id="499" class="Symbol">:</a> <a id="501" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="507" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="512" class="Symbol">⦄</a>
  <a id="516" class="Keyword">where</a>

<a id="523" class="Keyword">instance</a> <a id="532" href="Deep.Ledger.html#532" class="Function">_</a> <a id="534" class="Symbol">=</a> <a id="536" href="Prelude.Semigroup.html#3032" class="Function">Semigroup-ℤ-+</a><a id="549" class="Symbol">;</a> <a id="551" href="Deep.Ledger.html#551" class="Function">_</a> <a id="553" class="Symbol">=</a> <a id="555" href="Prelude.Semigroup.html#3091" class="Function">SemigroupLaws-ℤ-+</a><a id="572" class="Symbol">;</a> <a id="574" href="Deep.Ledger.html#574" class="Function">_</a> <a id="576" class="Symbol">=</a> <a id="578" href="Prelude.Monoid.html#1802" class="Function">Monoid-ℤ-+</a><a id="588" class="Symbol">;</a> <a id="590" href="Deep.Ledger.html#590" class="Function">_</a> <a id="592" class="Symbol">=</a> <a id="594" href="Prelude.Monoid.html#1881" class="Function">MonoidLaws-ℤ-+</a>

<a id="610" class="Comment">-- The state of a ledger is a collection of participants, along with their balance.</a>
<a id="S"></a><a id="694" href="Deep.Ledger.html#694" class="Function">S</a> <a id="696" class="Symbol">:</a> <a id="698" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="703" href="Deep.Ledger.html#694" class="Function">S</a> <a id="705" class="Symbol">=</a> <a id="707" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">Map⟨</a> <a id="712" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="717" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">↦</a> <a id="719" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="721" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">⟩</a>

<a id="724" class="Comment">-- A transaction is transferring money from one participant to another</a>
<a id="795" class="Keyword">data</a> <a id="Tx"></a><a id="800" href="Deep.Ledger.html#800" class="Datatype">Tx</a> <a id="803" class="Symbol">:</a> <a id="805" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="810" class="Keyword">where</a>
  <a id="Tx._—→⟨_⟩_"></a><a id="818" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">_—→⟨_⟩_</a> <a id="826" class="Symbol">:</a> <a id="828" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="833" class="Symbol">→</a> <a id="835" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="837" class="Symbol">→</a> <a id="839" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="844" class="Symbol">→</a> <a id="846" href="Deep.Ledger.html#800" class="Datatype">Tx</a>

<a id="850" class="Comment">-- A ledger is a list of transactions</a>
<a id="L"></a><a id="888" href="Deep.Ledger.html#888" class="Function">L</a> <a id="890" class="Symbol">=</a> <a id="892" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="897" href="Deep.Ledger.html#800" class="Datatype">Tx</a>

<a id="901" class="Keyword">variable</a>
  <a id="912" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="914" href="Deep.Ledger.html#914" class="Generalizable">s′</a> <a id="917" href="Deep.Ledger.html#917" class="Generalizable">s″</a> <a id="920" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="923" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="926" class="Symbol">:</a> <a id="928" href="Deep.Ledger.html#694" class="Function">S</a>
  <a id="932" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="934" href="Deep.Ledger.html#934" class="Generalizable">t′</a> <a id="937" href="Deep.Ledger.html#937" class="Generalizable">t″</a> <a id="940" class="Symbol">:</a> <a id="942" href="Deep.Ledger.html#800" class="Datatype">Tx</a>
  <a id="947" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="949" href="Deep.Ledger.html#949" class="Generalizable">l′</a> <a id="952" href="Deep.Ledger.html#952" class="Generalizable">l″</a> <a id="955" href="Deep.Ledger.html#955" class="Generalizable">l₁</a> <a id="958" href="Deep.Ledger.html#958" class="Generalizable">l₂</a> <a id="961" class="Symbol">:</a> <a id="963" href="Deep.Ledger.html#888" class="Function">L</a>
  <a id="967" href="Deep.Ledger.html#967" class="Generalizable">ls</a> <a id="970" href="Deep.Ledger.html#970" class="Generalizable">ls′</a> <a id="974" href="Deep.Ledger.html#974" class="Generalizable">ls″</a> <a id="978" class="Symbol">:</a> <a id="980" href="Deep.Ledger.html#888" class="Function">L</a> <a id="982" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="984" href="Deep.Ledger.html#694" class="Function">S</a>

<a id="987" class="Comment">-- ** Denotational semantics</a>

<a id="Domain"></a><a id="1017" href="Deep.Ledger.html#1017" class="Function">Domain</a> <a id="1024" class="Symbol">=</a> <a id="1026" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1028" class="Symbol">→</a> <a id="1030" href="Deep.Ledger.html#694" class="Function">S</a>

<a id="1033" class="Keyword">record</a> <a id="Denotable"></a><a id="1040" href="Deep.Ledger.html#1040" class="Record">Denotable</a> <a id="1050" class="Symbol">(</a><a id="1051" href="Deep.Ledger.html#1051" class="Bound">A</a> <a id="1053" class="Symbol">:</a> <a id="1055" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="1059" class="Symbol">)</a> <a id="1061" class="Symbol">:</a> <a id="1063" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1068" class="Keyword">where</a>
  <a id="1076" class="Keyword">field</a>
    <a id="Denotable.⟦_⟧"></a><a id="1086" href="Deep.Ledger.html#1086" class="Field Operator">⟦_⟧</a> <a id="1090" class="Symbol">:</a> <a id="1092" href="Deep.Ledger.html#1051" class="Bound">A</a> <a id="1094" class="Symbol">→</a> <a id="1096" href="Deep.Ledger.html#1017" class="Function">Domain</a>
<a id="1103" class="Keyword">open</a> <a id="1108" href="Deep.Ledger.html#1040" class="Module">Denotable</a> <a id="1118" class="Symbol">{{...}}</a> <a id="1126" class="Keyword">public</a>

<a id="1134" class="Keyword">instance</a>
  <a id="⟦Tx⟧"></a><a id="1145" href="Deep.Ledger.html#1145" class="Function">⟦Tx⟧</a> <a id="1150" class="Symbol">:</a> <a id="1152" href="Deep.Ledger.html#1040" class="Record">Denotable</a> <a id="1162" href="Deep.Ledger.html#800" class="Datatype">Tx</a>
  <a id="1167" href="Deep.Ledger.html#1145" class="Function">⟦Tx⟧</a> <a id="1172" class="Symbol">.</a><a id="1173" href="Deep.Ledger.html#1086" class="Field Operator">⟦_⟧</a> <a id="1177" class="Symbol">(</a><a id="1178" href="Deep.Ledger.html#1178" class="Bound">p₁</a> <a id="1181" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">—→⟨</a> <a id="1185" href="Deep.Ledger.html#1185" class="Bound">n</a> <a id="1187" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">⟩</a> <a id="1189" href="Deep.Ledger.html#1189" class="Bound">p₂</a><a id="1191" class="Symbol">)</a> <a id="1193" href="Deep.Ledger.html#1193" class="Bound">s</a> <a id="1195" class="Symbol">=</a> <a id="1197" href="Prelude.Maps.Abstract.Interface.html#15060" class="Function">modify</a> <a id="1204" href="Deep.Ledger.html#1189" class="Bound">p₂</a> <a id="1207" class="Symbol">(</a><a id="1208" href="Deep.Ledger.html#161" class="Function Operator">_+ℤ</a> <a id="1212" href="Deep.Ledger.html#1185" class="Bound">n</a><a id="1213" class="Symbol">)</a> <a id="1215" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1217" href="Prelude.Maps.Abstract.Interface.html#15060" class="Function">modify</a> <a id="1224" href="Deep.Ledger.html#1178" class="Bound">p₁</a> <a id="1227" class="Symbol">(</a><a id="1228" href="Deep.Ledger.html#148" class="Function Operator">_-ℤ</a> <a id="1232" href="Deep.Ledger.html#1185" class="Bound">n</a><a id="1233" class="Symbol">)</a> <a id="1235" href="Deep.Ledger.html#1193" class="Bound">s</a>

  <a id="⟦L⟧"></a><a id="1240" href="Deep.Ledger.html#1240" class="Function">⟦L⟧</a> <a id="1244" class="Symbol">:</a> <a id="1246" href="Deep.Ledger.html#1040" class="Record">Denotable</a> <a id="1256" href="Deep.Ledger.html#888" class="Function">L</a>
  <a id="1260" href="Deep.Ledger.html#1240" class="Function">⟦L⟧</a> <a id="1264" class="Symbol">.</a><a id="1265" href="Deep.Ledger.html#1086" class="Field Operator">⟦_⟧</a> <a id="1269" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>      <a id="1277" class="Symbol">=</a> <a id="1279" href="Function.Base.html#615" class="Function">id</a>
  <a id="1284" href="Deep.Ledger.html#1240" class="Function">⟦L⟧</a> <a id="1288" class="Symbol">.</a><a id="1289" href="Deep.Ledger.html#1086" class="Field Operator">⟦_⟧</a> <a id="1293" class="Symbol">(</a><a id="1294" href="Deep.Ledger.html#1294" class="Bound">t</a> <a id="1296" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1298" href="Deep.Ledger.html#1298" class="Bound">l</a><a id="1299" class="Symbol">)</a> <a id="1301" class="Symbol">=</a> <a id="1303" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1305" href="Deep.Ledger.html#1298" class="Bound">l</a> <a id="1307" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1309" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1311" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1313" href="Deep.Ledger.html#1294" class="Bound">t</a> <a id="1315" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a>

<a id="comp"></a><a id="1318" href="Deep.Ledger.html#1318" class="Function">comp</a> <a id="1323" class="Symbol">:</a> <a id="1325" class="Symbol">∀</a> <a id="1327" href="Deep.Ledger.html#1327" class="Bound">x</a> <a id="1329" class="Symbol">→</a> <a id="1331" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1333" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="1335" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="1338" href="Deep.Ledger.html#949" class="Generalizable">l′</a> <a id="1341" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1343" href="Deep.Ledger.html#1327" class="Bound">x</a> <a id="1345" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1347" class="Symbol">(</a><a id="1348" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1350" href="Deep.Ledger.html#949" class="Generalizable">l′</a> <a id="1353" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1355" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1357" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1359" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="1361" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="1362" class="Symbol">)</a> <a id="1364" href="Deep.Ledger.html#1327" class="Bound">x</a>
<a id="1366" href="Deep.Ledger.html#1318" class="Function">comp</a> <a id="1371" class="Symbol">{</a><a id="1372" class="Argument">l</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1378" class="Symbol">}</a>    <a id="1383" class="Symbol">{</a><a id="1384" href="Deep.Ledger.html#1384" class="Bound">l′</a><a id="1386" class="Symbol">}</a> <a id="1388" href="Deep.Ledger.html#1388" class="Bound">x</a> <a id="1390" class="Symbol">=</a> <a id="1392" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1397" href="Deep.Ledger.html#1318" class="Function">comp</a> <a id="1402" class="Symbol">{</a><a id="1403" class="Argument">l</a> <a id="1405" class="Symbol">=</a> <a id="1407" href="Deep.Ledger.html#1407" class="Bound">t</a> <a id="1409" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1411" href="Deep.Ledger.html#1411" class="Bound">l</a><a id="1412" class="Symbol">}</a> <a id="1414" class="Symbol">{</a><a id="1415" href="Deep.Ledger.html#1415" class="Bound">l′</a><a id="1417" class="Symbol">}</a> <a id="1419" href="Deep.Ledger.html#1419" class="Bound">x</a> <a id="1421" class="Keyword">rewrite</a> <a id="1429" href="Deep.Ledger.html#1318" class="Function">comp</a> <a id="1434" class="Symbol">{</a><a id="1435" href="Deep.Ledger.html#1411" class="Bound">l</a><a id="1436" class="Symbol">}{</a><a id="1438" href="Deep.Ledger.html#1415" class="Bound">l′</a><a id="1440" class="Symbol">}</a> <a id="1442" class="Symbol">(</a><a id="1443" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1445" href="Deep.Ledger.html#1407" class="Bound">t</a> <a id="1447" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1449" href="Deep.Ledger.html#1419" class="Bound">x</a><a id="1450" class="Symbol">)</a> <a id="1452" class="Symbol">=</a> <a id="1454" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1460" class="Comment">-- ** Operational semantics</a>

<a id="1489" class="Keyword">infix</a> <a id="1495" class="Number">0</a> <a id="1497" href="Deep.Ledger.html#1521" class="Datatype Operator">_—→_</a> <a id="1502" href="Deep.Ledger.html#1729" class="Datatype Operator">_—→⋆_</a> <a id="1508" href="Deep.Ledger.html#1892" class="Function Operator">_—→⋆′_</a>

<a id="1516" class="Keyword">data</a> <a id="_—→_"></a><a id="1521" href="Deep.Ledger.html#1521" class="Datatype Operator">_—→_</a> <a id="1526" class="Symbol">:</a> <a id="1528" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1530" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1532" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1534" class="Symbol">→</a> <a id="1536" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1538" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1540" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1542" class="Symbol">→</a> <a id="1544" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1549" class="Keyword">where</a>
  <a id="_—→_.singleStep"></a><a id="1557" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="1568" class="Symbol">:</a>
     <a id="1575" class="Comment">------------------------</a>
     <a id="1605" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="1607" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1609" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="1611" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1613" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="1615" href="Deep.Ledger.html#1521" class="Datatype Operator">—→</a> <a id="1618" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="1620" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1622" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1624" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="1626" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1628" href="Deep.Ledger.html#912" class="Generalizable">s</a>

<a id="1631" class="Keyword">data</a> <a id="_—→′_"></a><a id="1636" href="Deep.Ledger.html#1636" class="Datatype Operator">_—→′_</a> <a id="1642" class="Symbol">:</a> <a id="1644" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1646" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1648" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1650" class="Symbol">→</a> <a id="1652" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1654" class="Symbol">→</a> <a id="1656" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1661" class="Keyword">where</a>
  <a id="_—→′_.finalStep"></a><a id="1669" href="Deep.Ledger.html#1669" class="InductiveConstructor">finalStep</a> <a id="1679" class="Symbol">:</a>
      <a id="1687" class="Comment">--------------</a>
      <a id="1708" class="Symbol">(</a><a id="1709" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1712" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1714" href="Deep.Ledger.html#912" class="Generalizable">s</a><a id="1715" class="Symbol">)</a> <a id="1717" href="Deep.Ledger.html#1636" class="Datatype Operator">—→′</a> <a id="1721" href="Deep.Ledger.html#912" class="Generalizable">s</a>

<a id="1724" class="Keyword">data</a> <a id="_—→⋆_"></a><a id="1729" href="Deep.Ledger.html#1729" class="Datatype Operator">_—→⋆_</a> <a id="1735" class="Symbol">:</a> <a id="1737" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1739" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1741" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1743" class="Symbol">→</a> <a id="1745" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1747" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1749" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1751" class="Symbol">→</a> <a id="1753" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1758" class="Keyword">where</a>
   <a id="_—→⋆_.base"></a><a id="1767" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a> <a id="1772" class="Symbol">:</a>
       <a id="1781" class="Comment">---------</a>
       <a id="1798" href="Deep.Ledger.html#967" class="Generalizable">ls</a> <a id="1801" href="Deep.Ledger.html#1729" class="Datatype Operator">—→⋆</a> <a id="1805" href="Deep.Ledger.html#967" class="Generalizable">ls</a>

   <a id="_—→⋆_.step"></a><a id="1812" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="1817" class="Symbol">:</a>
       <a id="1826" href="Deep.Ledger.html#967" class="Generalizable">ls</a> <a id="1829" href="Deep.Ledger.html#1521" class="Datatype Operator">—→</a> <a id="1832" href="Deep.Ledger.html#970" class="Generalizable">ls′</a>
     <a id="1841" class="Symbol">→</a> <a id="1843" href="Deep.Ledger.html#970" class="Generalizable">ls′</a> <a id="1847" href="Deep.Ledger.html#1729" class="Datatype Operator">—→⋆</a> <a id="1851" href="Deep.Ledger.html#974" class="Generalizable">ls″</a>
       <a id="1862" class="Comment">----------</a>
     <a id="1878" class="Symbol">→</a> <a id="1880" href="Deep.Ledger.html#967" class="Generalizable">ls</a> <a id="1883" href="Deep.Ledger.html#1729" class="Datatype Operator">—→⋆</a> <a id="1887" href="Deep.Ledger.html#974" class="Generalizable">ls″</a>

<a id="_—→⋆′_"></a><a id="1892" href="Deep.Ledger.html#1892" class="Function Operator">_—→⋆′_</a> <a id="1899" class="Symbol">:</a> <a id="1901" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1903" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1905" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1907" class="Symbol">→</a> <a id="1909" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1911" class="Symbol">→</a> <a id="1913" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="1918" href="Deep.Ledger.html#1918" class="Bound">ls</a> <a id="1921" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="1926" href="Deep.Ledger.html#1926" class="Bound">s</a> <a id="1928" class="Symbol">=</a> <a id="1930" href="Deep.Ledger.html#1918" class="Bound">ls</a> <a id="1933" href="Deep.Ledger.html#1729" class="Datatype Operator">—→⋆</a> <a id="1937" class="Symbol">(</a><a id="1938" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1941" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1943" href="Deep.Ledger.html#1926" class="Bound">s</a><a id="1944" class="Symbol">)</a>

<a id="comp′"></a><a id="1947" href="Deep.Ledger.html#1947" class="Function">comp′</a> <a id="1953" class="Symbol">:</a>
    <a id="1959" href="Deep.Ledger.html#947" class="Generalizable">l</a>       <a id="1967" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1969" href="Deep.Ledger.html#912" class="Generalizable">s</a>  <a id="1972" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="1977" href="Deep.Ledger.html#914" class="Generalizable">s′</a>
  <a id="1982" class="Symbol">→</a> <a id="1984" href="Deep.Ledger.html#949" class="Generalizable">l′</a>      <a id="1992" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1994" href="Deep.Ledger.html#914" class="Generalizable">s′</a> <a id="1997" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2002" href="Deep.Ledger.html#917" class="Generalizable">s″</a>
  <a id="2007" class="Symbol">→</a> <a id="2009" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2011" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2014" href="Deep.Ledger.html#949" class="Generalizable">l′</a> <a id="2017" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2019" href="Deep.Ledger.html#912" class="Generalizable">s</a>  <a id="2022" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2027" href="Deep.Ledger.html#917" class="Generalizable">s″</a>
<a id="2030" href="Deep.Ledger.html#1947" class="Function">comp′</a> <a id="2036" class="Symbol">{</a><a id="2037" class="Argument">l</a> <a id="2039" class="Symbol">=</a> <a id="2041" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2043" class="Symbol">}</a>    <a id="2048" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a>                   <a id="2071" href="Deep.Ledger.html#2071" class="Bound">s′→s″</a> <a id="2077" class="Symbol">=</a> <a id="2079" href="Deep.Ledger.html#2071" class="Bound">s′→s″</a>
<a id="2085" href="Deep.Ledger.html#1947" class="Function">comp′</a> <a id="2091" class="Symbol">{</a><a id="2092" class="Argument">l</a> <a id="2094" class="Symbol">=</a> <a id="2096" class="Symbol">_</a> <a id="2098" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2100" class="Symbol">_}</a> <a id="2103" class="Symbol">(</a><a id="2104" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2109" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2120" href="Deep.Ledger.html#2120" class="Bound">s→s′</a><a id="2124" class="Symbol">)</a> <a id="2126" href="Deep.Ledger.html#2126" class="Bound">s′→s″</a> <a id="2132" class="Symbol">=</a> <a id="2134" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2139" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2150" class="Symbol">(</a><a id="2151" href="Deep.Ledger.html#1947" class="Function">comp′</a> <a id="2157" href="Deep.Ledger.html#2120" class="Bound">s→s′</a> <a id="2162" href="Deep.Ledger.html#2126" class="Bound">s′→s″</a><a id="2167" class="Symbol">)</a>

<a id="oper-base⋆"></a><a id="2170" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a> <a id="2181" class="Symbol">:</a> <a id="2183" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2185" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2187" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2189" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2194" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="2196" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2198" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="2200" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="2202" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a> <a id="2213" class="Symbol">{</a><a id="2214" class="Argument">l</a> <a id="2216" class="Symbol">=</a> <a id="2218" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2220" class="Symbol">}</a>    <a id="2225" class="Symbol">=</a> <a id="2227" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a>
<a id="2232" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a> <a id="2243" class="Symbol">{</a><a id="2244" class="Argument">l</a> <a id="2246" class="Symbol">=</a> <a id="2248" class="Symbol">_</a> <a id="2250" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2252" class="Symbol">_}</a> <a id="2255" class="Symbol">=</a> <a id="2257" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2262" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2273" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a>

<a id="2285" class="Comment">-- ** Relating denotational and operational semantics</a>

<a id="denot⇔oper"></a><a id="2340" href="Deep.Ledger.html#2340" class="Function">denot⇔oper</a> <a id="2351" class="Symbol">:</a> <a id="2353" class="Symbol">(</a><a id="2354" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="2356" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2358" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="2360" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2362" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2364" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2366" class="Symbol">)</a> <a id="2368" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="2370" class="Symbol">(</a><a id="2371" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2373" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2375" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2377" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2382" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2384" class="Symbol">)</a>
<a id="2386" href="Deep.Ledger.html#2340" class="Function">denot⇔oper</a> <a id="2397" class="Symbol">=</a> <a id="2399" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2410" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2412" href="Deep.Ledger.html#2593" class="Function">oper→denot</a>
  <a id="2425" class="Keyword">where</a>
    <a id="2435" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2446" class="Symbol">:</a> <a id="2448" class="Symbol">(</a><a id="2449" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="2451" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2453" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="2455" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2457" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2459" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2461" class="Symbol">)</a> <a id="2463" class="Symbol">→</a> <a id="2465" class="Symbol">(</a><a id="2466" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2468" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2470" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2472" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2477" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2479" class="Symbol">)</a>
    <a id="2485" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2496" class="Symbol">{</a><a id="2497" class="Argument">l</a> <a id="2499" class="Symbol">=</a> <a id="2501" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2503" class="Symbol">}</a>    <a id="2508" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2513" class="Symbol">=</a> <a id="2515" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a>
    <a id="2524" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2535" class="Symbol">{</a><a id="2536" class="Argument">l</a> <a id="2538" class="Symbol">=</a> <a id="2540" class="Symbol">_</a> <a id="2542" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2544" class="Symbol">_}</a> <a id="2547" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2552" class="Symbol">=</a> <a id="2554" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2559" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2570" class="Symbol">(</a><a id="2571" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2582" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2586" class="Symbol">)</a>

    <a id="2593" href="Deep.Ledger.html#2593" class="Function">oper→denot</a> <a id="2604" class="Symbol">:</a> <a id="2606" class="Symbol">(</a><a id="2607" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2609" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2611" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2613" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2618" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2620" class="Symbol">)</a> <a id="2622" class="Symbol">→</a> <a id="2624" class="Symbol">(</a><a id="2625" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="2627" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2629" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="2631" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2633" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2635" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2637" class="Symbol">)</a>
    <a id="2643" href="Deep.Ledger.html#2593" class="Function">oper→denot</a> <a id="2654" class="Symbol">{</a><a id="2655" class="Argument">l</a> <a id="2657" class="Symbol">=</a> <a id="2659" class="DottedPattern Symbol">.</a><a id="2660" href="Agda.Builtin.List.html#185" class="DottedPattern InductiveConstructor">[]</a><a id="2662" class="Symbol">}</a>   <a id="2666" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a>                <a id="2686" class="Symbol">=</a> <a id="2688" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="2697" href="Deep.Ledger.html#2593" class="Function">oper→denot</a> <a id="2708" class="Symbol">{</a><a id="2709" class="Argument">l</a> <a id="2711" class="Symbol">=</a> <a id="2713" class="Symbol">_</a> <a id="2715" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2717" class="Symbol">_}</a> <a id="2720" class="Symbol">(</a><a id="2721" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2726" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2737" href="Deep.Ledger.html#2737" class="Bound">p</a><a id="2738" class="Symbol">)</a> <a id="2740" class="Symbol">=</a> <a id="2742" href="Deep.Ledger.html#2593" class="Function">oper→denot</a> <a id="2753" href="Deep.Ledger.html#2737" class="Bound">p</a>

<a id="2756" class="Comment">-- ** Axiomatic semantics</a>

<a id="Predˢ"></a><a id="2783" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="2789" class="Symbol">=</a> <a id="2791" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="2796" href="Deep.Ledger.html#694" class="Function">S</a> <a id="2798" href="Level.html#512" class="Function">0ℓ</a>
<a id="2801" class="Comment">{-
-- the shallow embedding of predicates seems to break here..
-- ..we really need to get ahold of the actual variables, i.e. from a deeply-embedded DSL
fv : Predˢ → Set⟨ Part ⟩
fv P = {!!}
-}</a>

<a id="2996" class="Keyword">data</a> <a id="Assertion"></a><a id="3001" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3011" class="Symbol">:</a> <a id="3013" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3018" class="Keyword">where</a>
  <a id="Assertion.`emp"></a><a id="3026" href="Deep.Ledger.html#3026" class="InductiveConstructor">`emp</a> <a id="Assertion.`⊥"></a><a id="3031" href="Deep.Ledger.html#3031" class="InductiveConstructor">`⊥</a> <a id="3034" class="Symbol">:</a> <a id="3036" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>
  <a id="3048" class="Comment">-- _`≡_ : ℤ → ℤ → Assertion</a>
  <a id="Assertion._`↦_"></a><a id="3078" href="Deep.Ledger.html#3078" class="InductiveConstructor Operator">_`↦_</a> <a id="3083" class="Symbol">:</a> <a id="3085" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="3090" class="Symbol">→</a> <a id="3092" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="3094" class="Symbol">→</a> <a id="3096" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>
  <a id="Assertion._`∗_"></a><a id="3108" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">_`∗_</a> <a id="Assertion._`—∗_"></a><a id="3113" href="Deep.Ledger.html#3113" class="InductiveConstructor Operator">_`—∗_</a> <a id="3119" class="Symbol">:</a> <a id="3121" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3131" class="Symbol">→</a> <a id="3133" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3143" class="Symbol">→</a> <a id="3145" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>
  <a id="Assertion._`∘_"></a><a id="3157" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">_`∘_</a> <a id="3162" class="Symbol">:</a> <a id="3164" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3174" class="Symbol">→</a> <a id="3176" class="Symbol">(</a><a id="3177" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3179" class="Symbol">→</a> <a id="3181" href="Deep.Ledger.html#694" class="Function">S</a><a id="3182" class="Symbol">)</a> <a id="3184" class="Symbol">→</a> <a id="3186" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>

<a id="3197" class="Keyword">infixr</a> <a id="3204" class="Number">9</a> <a id="3206" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">_`∘_</a>

<a id="fv"></a><a id="3212" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3215" class="Symbol">:</a> <a id="3217" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3227" class="Symbol">→</a> <a id="3229" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="3234" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="3239" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>
<a id="3241" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3244" href="Deep.Ledger.html#3026" class="InductiveConstructor">`emp</a>      <a id="3254" class="Symbol">=</a> <a id="3256" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a>
<a id="3258" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3261" href="Deep.Ledger.html#3031" class="InductiveConstructor">`⊥</a>        <a id="3271" class="Symbol">=</a> <a id="3273" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a>
<a id="3275" class="Comment">-- fv (_ `≡ _) = ∅</a>
<a id="3294" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3297" class="Symbol">(</a><a id="3298" href="Deep.Ledger.html#3298" class="Bound">p</a> <a id="3300" href="Deep.Ledger.html#3078" class="InductiveConstructor Operator">`↦</a> <a id="3303" class="Symbol">_)</a>  <a id="3307" class="Symbol">=</a> <a id="3309" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="3319" href="Deep.Ledger.html#3298" class="Bound">p</a>
<a id="3321" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3324" class="Symbol">(</a><a id="3325" href="Deep.Ledger.html#3325" class="Bound">P</a> <a id="3327" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="3330" href="Deep.Ledger.html#3330" class="Bound">Q</a><a id="3331" class="Symbol">)</a>  <a id="3334" class="Symbol">=</a> <a id="3336" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3339" href="Deep.Ledger.html#3325" class="Bound">P</a> <a id="3341" href="Prelude.Sets.AsUniqueLists.Core.html#2841" class="Function Operator">∪</a> <a id="3343" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3346" href="Deep.Ledger.html#3330" class="Bound">Q</a>
<a id="3348" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3351" class="Symbol">(</a><a id="3352" href="Deep.Ledger.html#3352" class="Bound">P</a> <a id="3354" href="Deep.Ledger.html#3113" class="InductiveConstructor Operator">`—∗</a> <a id="3358" href="Deep.Ledger.html#3358" class="Bound">Q</a><a id="3359" class="Symbol">)</a> <a id="3361" class="Symbol">=</a> <a id="3363" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3366" href="Deep.Ledger.html#3352" class="Bound">P</a> <a id="3368" href="Prelude.Sets.AsUniqueLists.Core.html#2841" class="Function Operator">∪</a> <a id="3370" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3373" href="Deep.Ledger.html#3358" class="Bound">Q</a>
<a id="3375" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3378" class="Symbol">(</a><a id="3379" href="Deep.Ledger.html#3379" class="Bound">P</a> <a id="3381" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="3384" class="Symbol">_)</a>  <a id="3388" class="Symbol">=</a> <a id="3390" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3393" href="Deep.Ledger.html#3379" class="Bound">P</a>

<a id="emp"></a><a id="3396" href="Deep.Ledger.html#3396" class="Function">emp</a> <a id="3400" class="Symbol">:</a> <a id="3402" href="Deep.Ledger.html#2783" class="Function">Predˢ</a>
<a id="3408" href="Deep.Ledger.html#3396" class="Function">emp</a> <a id="3412" href="Deep.Ledger.html#3412" class="Bound">s</a> <a id="3414" class="Symbol">=</a> <a id="3416" class="Symbol">∀</a> <a id="3418" href="Deep.Ledger.html#3418" class="Bound">k</a> <a id="3420" class="Symbol">→</a> <a id="3422" href="Deep.Ledger.html#3418" class="Bound">k</a> <a id="3424" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3427" href="Deep.Ledger.html#3412" class="Bound">s</a>

<a id="_♯_←_"></a><a id="3430" href="Deep.Ledger.html#3430" class="Function Operator">_♯_←_</a> <a id="3436" class="Symbol">:</a> <a id="3438" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3440" class="Symbol">→</a> <a id="3442" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3444" class="Symbol">→</a> <a id="3446" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3448" class="Symbol">→</a> <a id="3450" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="3455" href="Deep.Ledger.html#3455" class="Bound">s₁</a> <a id="3458" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="3460" href="Deep.Ledger.html#3460" class="Bound">s₂</a> <a id="3463" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="3465" href="Deep.Ledger.html#3465" class="Bound">s</a> <a id="3467" class="Symbol">=</a> <a id="3469" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟨</a> <a id="3471" href="Deep.Ledger.html#3455" class="Bound">s₁</a> <a id="3474" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⊎</a> <a id="3476" href="Deep.Ledger.html#3460" class="Bound">s₂</a> <a id="3479" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟩≡</a> <a id="3482" href="Deep.Ledger.html#3465" class="Bound">s</a>

<a id="_∗_"></a><a id="3485" href="Deep.Ledger.html#3485" class="Function Operator">_∗_</a> <a id="3489" class="Symbol">:</a> <a id="3491" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="3497" class="Symbol">→</a> <a id="3499" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="3505" class="Symbol">→</a> <a id="3507" href="Deep.Ledger.html#2783" class="Function">Predˢ</a>
<a id="3513" class="Symbol">(</a><a id="3514" href="Deep.Ledger.html#3514" class="Bound">P</a> <a id="3516" href="Deep.Ledger.html#3485" class="Function Operator">∗</a> <a id="3518" href="Deep.Ledger.html#3518" class="Bound">Q</a><a id="3519" class="Symbol">)</a> <a id="3521" href="Deep.Ledger.html#3521" class="Bound">s</a> <a id="3523" class="Symbol">=</a> <a id="3525" href="Data.Product.html#1369" class="Function">∃</a> <a id="3527" class="Symbol">λ</a> <a id="3529" href="Deep.Ledger.html#3529" class="Bound">s₁</a> <a id="3532" class="Symbol">→</a> <a id="3534" href="Data.Product.html#1369" class="Function">∃</a> <a id="3536" class="Symbol">λ</a> <a id="3538" href="Deep.Ledger.html#3538" class="Bound">s₂</a> <a id="3541" class="Symbol">→</a> <a id="3543" class="Symbol">(</a><a id="3544" href="Deep.Ledger.html#3529" class="Bound">s₁</a> <a id="3547" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="3549" href="Deep.Ledger.html#3538" class="Bound">s₂</a> <a id="3552" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="3554" href="Deep.Ledger.html#3521" class="Bound">s</a><a id="3555" class="Symbol">)</a> <a id="3557" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3559" href="Deep.Ledger.html#3514" class="Bound">P</a> <a id="3561" href="Deep.Ledger.html#3529" class="Bound">s₁</a> <a id="3564" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3566" href="Deep.Ledger.html#3518" class="Bound">Q</a> <a id="3568" href="Deep.Ledger.html#3538" class="Bound">s₂</a>

<a id="_—∗_"></a><a id="3572" href="Deep.Ledger.html#3572" class="Function Operator">_—∗_</a> <a id="3577" class="Symbol">:</a> <a id="3579" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="3585" class="Symbol">→</a> <a id="3587" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="3593" class="Symbol">→</a> <a id="3595" href="Deep.Ledger.html#2783" class="Function">Predˢ</a>
<a id="3601" class="Symbol">(</a><a id="3602" href="Deep.Ledger.html#3602" class="Bound">P</a> <a id="3604" href="Deep.Ledger.html#3572" class="Function Operator">—∗</a> <a id="3607" href="Deep.Ledger.html#3607" class="Bound">Q</a><a id="3608" class="Symbol">)</a> <a id="3610" href="Deep.Ledger.html#3610" class="Bound">s</a> <a id="3612" class="Symbol">=</a> <a id="3614" class="Symbol">∀</a> <a id="3616" href="Deep.Ledger.html#3616" class="Bound">s′</a> <a id="3619" class="Symbol">→</a> <a id="3621" href="Deep.Ledger.html#3616" class="Bound">s′</a> <a id="3624" href="Prelude.Apartness.html#256" class="Field Operator">♯</a> <a id="3626" href="Deep.Ledger.html#3610" class="Bound">s</a> <a id="3628" class="Symbol">→</a> <a id="3630" href="Deep.Ledger.html#3602" class="Bound">P</a> <a id="3632" href="Deep.Ledger.html#3616" class="Bound">s′</a> <a id="3635" class="Symbol">→</a> <a id="3637" href="Deep.Ledger.html#3607" class="Bound">Q</a> <a id="3639" class="Symbol">(</a><a id="3640" href="Deep.Ledger.html#3610" class="Bound">s</a> <a id="3642" href="Deep.Ledger.html#291" class="Function Operator">∪ᵐ</a> <a id="3645" href="Deep.Ledger.html#3616" class="Bound">s′</a><a id="3647" class="Symbol">)</a>

<a id="⟦_⟧ᵖ"></a><a id="3650" href="Deep.Ledger.html#3650" class="Function Operator">⟦_⟧ᵖ</a> <a id="3655" class="Symbol">:</a> <a id="3657" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3667" class="Symbol">→</a> <a id="3669" href="Deep.Ledger.html#2783" class="Function">Predˢ</a>
<a id="3675" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3677" href="Deep.Ledger.html#3026" class="InductiveConstructor">`emp</a>    <a id="3685" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3688" class="Symbol">=</a> <a id="3690" href="Deep.Ledger.html#3396" class="Function">emp</a>
<a id="3694" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3696" href="Deep.Ledger.html#3031" class="InductiveConstructor">`⊥</a>      <a id="3704" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3707" class="Symbol">=</a> <a id="3709" href="Function.Base.html#636" class="Function">const</a> <a id="3715" href="Data.Empty.html#526" class="Datatype">⊥</a>
<a id="3717" class="Comment">-- ⟦ x `≡ y  ⟧ᵖ = {!!}</a>
<a id="3740" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3742" href="Deep.Ledger.html#3742" class="Bound">p</a> <a id="3744" href="Deep.Ledger.html#3078" class="InductiveConstructor Operator">`↦</a> <a id="3747" href="Deep.Ledger.html#3747" class="Bound">n</a>  <a id="3750" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3753" class="Symbol">=</a> <a id="3755" href="Prelude.Maps.Abstract.Interface.html#1669" class="Function Operator">_[</a> <a id="3758" href="Deep.Ledger.html#3742" class="Bound">p</a> <a id="3760" href="Prelude.Maps.Abstract.Interface.html#1669" class="Function Operator">↦</a> <a id="3762" href="Deep.Ledger.html#3747" class="Bound">n</a> <a id="3764" href="Prelude.Maps.Abstract.Interface.html#1669" class="Function Operator">]</a>
<a id="3766" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3768" href="Deep.Ledger.html#3768" class="Bound">P</a> <a id="3770" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="3773" href="Deep.Ledger.html#3773" class="Bound">Q</a>  <a id="3776" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3779" class="Symbol">=</a> <a id="3781" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3783" href="Deep.Ledger.html#3768" class="Bound">P</a> <a id="3785" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3788" href="Deep.Ledger.html#3485" class="Function Operator">∗</a> <a id="3790" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3792" href="Deep.Ledger.html#3773" class="Bound">Q</a> <a id="3794" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a>
<a id="3797" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3799" href="Deep.Ledger.html#3799" class="Bound">P</a> <a id="3801" href="Deep.Ledger.html#3113" class="InductiveConstructor Operator">`—∗</a> <a id="3805" href="Deep.Ledger.html#3805" class="Bound">Q</a> <a id="3807" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3810" class="Symbol">=</a> <a id="3812" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3814" href="Deep.Ledger.html#3799" class="Bound">P</a> <a id="3816" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3819" href="Deep.Ledger.html#3572" class="Function Operator">—∗</a> <a id="3822" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3824" href="Deep.Ledger.html#3805" class="Bound">Q</a> <a id="3826" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a>
<a id="3829" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3831" href="Deep.Ledger.html#3831" class="Bound">P</a> <a id="3833" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="3836" href="Deep.Ledger.html#3836" class="Bound">f</a>  <a id="3839" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3842" class="Symbol">=</a> <a id="3844" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3846" href="Deep.Ledger.html#3831" class="Bound">P</a> <a id="3848" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3851" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3853" href="Deep.Ledger.html#3836" class="Bound">f</a>

<a id="3856" class="Keyword">infix</a> <a id="3862" class="Number">1</a> <a id="3864" href="Deep.Ledger.html#3869" class="Function Operator">_`⊢_</a>
<a id="_`⊢_"></a><a id="3869" href="Deep.Ledger.html#3869" class="Function Operator">_`⊢_</a> <a id="3874" class="Symbol">:</a> <a id="3876" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3886" class="Symbol">→</a> <a id="3888" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3898" class="Symbol">→</a> <a id="3900" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="3905" href="Deep.Ledger.html#3905" class="Bound">P</a> <a id="3907" href="Deep.Ledger.html#3869" class="Function Operator">`⊢</a> <a id="3910" href="Deep.Ledger.html#3910" class="Bound">Q</a> <a id="3912" class="Symbol">=</a> <a id="3914" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3916" href="Deep.Ledger.html#3905" class="Bound">P</a> <a id="3918" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3921" href="Prelude.General.html#1680" class="Function Operator">⊢</a> <a id="3923" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3925" href="Deep.Ledger.html#3910" class="Bound">Q</a> <a id="3927" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a>

<a id="_∙_"></a><a id="3931" href="Deep.Ledger.html#3931" class="Function Operator">_∙_</a> <a id="3935" class="Symbol">:</a> <a id="3937" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3947" class="Symbol">→</a> <a id="3949" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3951" class="Symbol">→</a> <a id="3953" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="3958" href="Deep.Ledger.html#3958" class="Bound">P</a> <a id="3960" href="Deep.Ledger.html#3931" class="Function Operator">∙</a> <a id="3962" href="Deep.Ledger.html#3962" class="Bound">s</a> <a id="3964" class="Symbol">=</a> <a id="3966" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3968" href="Deep.Ledger.html#3958" class="Bound">P</a> <a id="3970" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3973" href="Deep.Ledger.html#3962" class="Bound">s</a>

<a id="3976" class="Keyword">variable</a>
  <a id="3987" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="3989" href="Deep.Ledger.html#3989" class="Generalizable">P′</a> <a id="3992" href="Deep.Ledger.html#3992" class="Generalizable">P₁</a> <a id="3995" href="Deep.Ledger.html#3995" class="Generalizable">P₂</a> <a id="3998" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="4000" href="Deep.Ledger.html#4000" class="Generalizable">Q′</a> <a id="4003" href="Deep.Ledger.html#4003" class="Generalizable">Q₁</a> <a id="4006" href="Deep.Ledger.html#4006" class="Generalizable">Q₂</a> <a id="4009" href="Deep.Ledger.html#4009" class="Generalizable">R</a> <a id="4011" class="Symbol">:</a> <a id="4013" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>

<a id="4024" class="Keyword">data</a> <a id="⟨_⟩_⟨_⟩"></a><a id="4029" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨_⟩_⟨_⟩</a> <a id="4037" class="Symbol">:</a> <a id="4039" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="4049" class="Symbol">→</a> <a id="4051" href="Deep.Ledger.html#888" class="Function">L</a> <a id="4053" class="Symbol">→</a> <a id="4055" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="4065" class="Symbol">→</a> <a id="4067" href="Agda.Primitive.html#326" class="Primitive">Type₁</a> <a id="4073" class="Keyword">where</a>

  <a id="⟨_⟩_⟨_⟩.base"></a><a id="4082" href="Deep.Ledger.html#4082" class="InductiveConstructor">base</a> <a id="4087" class="Symbol">:</a>
    <a id="4093" class="Comment">--</a>
    <a id="4100" class="Comment">------------</a>
    <a id="4117" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4119" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="4121" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="4123" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4126" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4128" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="4130" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>
  <a id="4134" class="Comment">--   -------------------------</a>
  <a id="4167" class="Comment">--   ⟨ P ∘ ⟦ t ⟧ ⟩ [ t ] ⟨ P ⟩</a>

  <a id="⟨_⟩_⟨_⟩.step"></a><a id="4201" href="Deep.Ledger.html#4201" class="InductiveConstructor">step</a> <a id="4206" class="Symbol">:</a>
      <a id="4214" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4216" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="4218" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="4220" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4222" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4224" href="Deep.Ledger.html#4009" class="Generalizable">R</a> <a id="4226" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>
      <a id="4234" class="Comment">-------------------------</a>
    <a id="4264" class="Symbol">→</a> <a id="4266" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4268" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="4270" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="4273" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4275" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4277" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4279" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="4281" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4283" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4285" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4287" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4289" href="Deep.Ledger.html#4009" class="Generalizable">R</a> <a id="4291" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>
  <a id="4295" class="Comment">--     ⟨ P ⟩ l  ⟨ Q ⟩</a>
  <a id="4319" class="Comment">--   → ⟨ Q ⟩ l′ ⟨ R ⟩</a>
  <a id="4343" class="Comment">--     -------------------</a>
  <a id="4372" class="Comment">--   → ⟨ P ⟩ l ++ l′ ⟨ R ⟩</a>

  <a id="⟨_⟩_⟨_⟩.weaken-strengthen"></a><a id="4402" href="Deep.Ledger.html#4402" class="InductiveConstructor">weaken-strengthen</a> <a id="4420" class="Symbol">:</a>

      <a id="4429" href="Deep.Ledger.html#3989" class="Generalizable">P′</a> <a id="4432" href="Deep.Ledger.html#3869" class="Function Operator">`⊢</a> <a id="4435" href="Deep.Ledger.html#3987" class="Generalizable">P</a>
    <a id="4441" class="Symbol">→</a> <a id="4443" href="Deep.Ledger.html#3998" class="Generalizable">Q</a>  <a id="4446" href="Deep.Ledger.html#3869" class="Function Operator">`⊢</a> <a id="4449" href="Deep.Ledger.html#4000" class="Generalizable">Q′</a>
    <a id="4456" class="Symbol">→</a> <a id="4458" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4460" href="Deep.Ledger.html#3987" class="Generalizable">P</a>  <a id="4463" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="4465" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4467" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4469" href="Deep.Ledger.html#3998" class="Generalizable">Q</a>  <a id="4472" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>
      <a id="4480" class="Comment">---------------</a>
    <a id="4500" class="Symbol">→</a> <a id="4502" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4504" href="Deep.Ledger.html#3989" class="Generalizable">P′</a> <a id="4507" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="4509" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4511" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4513" href="Deep.Ledger.html#4000" class="Generalizable">Q′</a> <a id="4516" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>

<a id="4519" class="Comment">-- utilities</a>
<a id="axiom-base⋆"></a><a id="4532" href="Deep.Ledger.html#4532" class="Function">axiom-base⋆</a> <a id="4544" class="Symbol">:</a> <a id="4546" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4548" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="4550" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="4553" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4555" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4557" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4559" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="4561" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4563" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="4565" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="4567" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>
<a id="4569" href="Deep.Ledger.html#4532" class="Function">axiom-base⋆</a> <a id="4581" class="Symbol">{</a><a id="4582" class="Argument">P</a> <a id="4584" class="Symbol">=</a> <a id="4586" href="Deep.Ledger.html#4586" class="Bound">P</a><a id="4587" class="Symbol">}</a> <a id="4589" class="Symbol">{</a><a id="4590" class="Argument">l</a> <a id="4592" class="Symbol">=</a> <a id="4594" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4596" class="Symbol">}</a>    <a id="4601" class="Symbol">=</a> <a id="4603" href="Deep.Ledger.html#4402" class="InductiveConstructor">weaken-strengthen</a> <a id="4621" class="Symbol">{</a><a id="4622" class="Argument">P</a> <a id="4624" class="Symbol">=</a> <a id="4626" href="Deep.Ledger.html#4586" class="Bound">P</a><a id="4627" class="Symbol">}</a> <a id="4629" href="Function.Base.html#615" class="Function">id</a> <a id="4632" href="Function.Base.html#615" class="Function">id</a> <a id="4635" href="Deep.Ledger.html#4082" class="InductiveConstructor">base</a>
<a id="4640" href="Deep.Ledger.html#4532" class="Function">axiom-base⋆</a> <a id="4652" class="Symbol">{</a><a id="4653" class="Argument">P</a> <a id="4655" class="Symbol">=</a> <a id="4657" href="Deep.Ledger.html#4657" class="Bound">P</a><a id="4658" class="Symbol">}</a> <a id="4660" class="Symbol">{</a><a id="4661" class="Argument">l</a> <a id="4663" class="Symbol">=</a> <a id="4665" href="Deep.Ledger.html#4665" class="Bound">t</a> <a id="4667" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4669" href="Deep.Ledger.html#4669" class="Bound">l</a><a id="4670" class="Symbol">}</a> <a id="4672" class="Symbol">=</a> <a id="4674" href="Deep.Ledger.html#4402" class="InductiveConstructor">weaken-strengthen</a> <a id="4692" class="Symbol">{</a><a id="4693" class="Argument">P</a> <a id="4695" class="Symbol">=</a> <a id="4697" class="Symbol">(</a><a id="4698" href="Deep.Ledger.html#4657" class="Bound">P</a> <a id="4700" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="4703" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4705" href="Deep.Ledger.html#4669" class="Bound">l</a> <a id="4707" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4708" class="Symbol">)</a> <a id="4710" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="4713" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4715" href="Deep.Ledger.html#4665" class="Bound">t</a> <a id="4717" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4718" class="Symbol">}</a> <a id="4720" href="Function.Base.html#615" class="Function">id</a> <a id="4723" href="Function.Base.html#615" class="Function">id</a> <a id="4726" class="Symbol">(</a><a id="4727" href="Deep.Ledger.html#4201" class="InductiveConstructor">step</a> <a id="4732" href="Deep.Ledger.html#4532" class="Function">axiom-base⋆</a><a id="4743" class="Symbol">)</a>

<a id="⟦⟧-comm"></a><a id="4746" href="Deep.Ledger.html#4746" class="Function">⟦⟧-comm</a> <a id="4754" class="Symbol">:</a> <a id="4756" class="Symbol">(</a><a id="4757" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4759" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4761" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4763" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4765" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4767" href="Deep.Ledger.html#934" class="Generalizable">t′</a> <a id="4770" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4771" class="Symbol">)</a> <a id="4773" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="4775" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4777" class="Symbol">(</a><a id="4778" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4780" href="Deep.Ledger.html#934" class="Generalizable">t′</a> <a id="4783" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4785" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4787" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4789" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4791" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4792" class="Symbol">)</a> <a id="4794" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="4796" href="Deep.Ledger.html#4746" class="Function">⟦⟧-comm</a> <a id="4804" class="Symbol">{</a><a id="4805" class="Argument">t</a> <a id="4807" class="Symbol">=</a> <a id="4809" href="Deep.Ledger.html#4809" class="Bound">A</a> <a id="4811" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">—→⟨</a> <a id="4815" href="Deep.Ledger.html#4815" class="Bound">n</a> <a id="4817" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">⟩</a> <a id="4819" href="Deep.Ledger.html#4819" class="Bound">B</a><a id="4820" class="Symbol">}{</a><a id="4822" class="Argument">t′</a> <a id="4825" class="Symbol">=</a> <a id="4827" href="Deep.Ledger.html#4827" class="Bound">A′</a> <a id="4830" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">—→⟨</a> <a id="4834" href="Deep.Ledger.html#4834" class="Bound">n′</a> <a id="4837" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">⟩</a> <a id="4839" href="Deep.Ledger.html#4839" class="Bound">B′</a><a id="4841" class="Symbol">}</a> <a id="4843" class="Symbol">=</a> <a id="4845" class="Hole">{!!}</a>

<a id="denot-comm"></a><a id="4851" href="Deep.Ledger.html#4851" class="Function">denot-comm</a> <a id="4862" class="Symbol">:</a> <a id="4864" class="Symbol">(</a><a id="4865" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4867" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4869" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4871" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4873" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4875" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4877" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4878" class="Symbol">)</a> <a id="4880" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="4882" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4884" class="Symbol">(</a><a id="4885" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4887" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4889" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4891" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4893" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4895" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4897" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4898" class="Symbol">)</a> <a id="4900" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="4902" href="Deep.Ledger.html#4851" class="Function">denot-comm</a> <a id="4913" class="Symbol">{</a><a id="4914" class="Argument">t</a> <a id="4916" class="Symbol">=</a> <a id="4918" href="Deep.Ledger.html#4918" class="Bound">t</a><a id="4919" class="Symbol">}{</a><a id="4921" class="Argument">l</a> <a id="4923" class="Symbol">=</a> <a id="4925" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4927" class="Symbol">}</a>    <a id="4932" class="Symbol">{</a><a id="4933" href="Deep.Ledger.html#4933" class="Bound">s</a><a id="4934" class="Symbol">}</a> <a id="4936" class="Symbol">=</a> <a id="4938" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4943" href="Deep.Ledger.html#4851" class="Function">denot-comm</a> <a id="4954" class="Symbol">{</a><a id="4955" class="Argument">t</a> <a id="4957" class="Symbol">=</a> <a id="4959" href="Deep.Ledger.html#4959" class="Bound">t</a><a id="4960" class="Symbol">}{</a><a id="4962" class="Argument">l</a> <a id="4964" class="Symbol">=</a> <a id="4966" href="Deep.Ledger.html#4966" class="Bound">t′</a> <a id="4969" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4971" href="Deep.Ledger.html#4971" class="Bound">l</a><a id="4972" class="Symbol">}{</a><a id="4974" href="Deep.Ledger.html#4974" class="Bound">s</a><a id="4975" class="Symbol">}</a>
  <a id="4979" class="Keyword">rewrite</a> <a id="4987" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="4991" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4993" href="Deep.Ledger.html#4851" class="Function">denot-comm</a> <a id="5004" class="Symbol">{</a><a id="5005" href="Deep.Ledger.html#4966" class="Bound">t′</a><a id="5007" class="Symbol">}{</a><a id="5009" href="Deep.Ledger.html#4971" class="Bound">l</a><a id="5010" class="Symbol">}{</a><a id="5012" href="Deep.Ledger.html#4974" class="Bound">s</a><a id="5013" class="Symbol">}</a>
        <a id="5023" class="Symbol">|</a> <a id="5025" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="5029" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5031" href="Deep.Ledger.html#4851" class="Function">denot-comm</a> <a id="5042" class="Symbol">{</a><a id="5043" href="Deep.Ledger.html#4966" class="Bound">t′</a><a id="5045" class="Symbol">}{</a><a id="5047" href="Deep.Ledger.html#4971" class="Bound">l</a><a id="5048" class="Symbol">}{</a><a id="5050" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5052" href="Deep.Ledger.html#4959" class="Bound">t</a> <a id="5054" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="5056" href="Deep.Ledger.html#4974" class="Bound">s</a><a id="5057" class="Symbol">}</a>
        <a id="5067" class="Symbol">|</a> <a id="5069" href="Deep.Ledger.html#4746" class="Function">⟦⟧-comm</a> <a id="5077" class="Symbol">{</a><a id="5078" href="Deep.Ledger.html#4959" class="Bound">t</a><a id="5079" class="Symbol">}{</a><a id="5081" href="Deep.Ledger.html#4966" class="Bound">t′</a><a id="5083" class="Symbol">}{</a><a id="5085" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5087" href="Deep.Ledger.html#4971" class="Bound">l</a> <a id="5089" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="5091" href="Deep.Ledger.html#4974" class="Bound">s</a><a id="5092" class="Symbol">}</a>
        <a id="5102" class="Symbol">|</a> <a id="5104" href="Deep.Ledger.html#4851" class="Function">denot-comm</a> <a id="5115" class="Symbol">{</a><a id="5116" href="Deep.Ledger.html#4959" class="Bound">t</a><a id="5117" class="Symbol">}{</a><a id="5119" href="Deep.Ledger.html#4971" class="Bound">l</a><a id="5120" class="Symbol">}{</a><a id="5122" href="Deep.Ledger.html#4974" class="Bound">s</a><a id="5123" class="Symbol">}</a>
        <a id="5133" class="Symbol">|</a> <a id="5135" href="Deep.Ledger.html#4851" class="Function">denot-comm</a> <a id="5146" class="Symbol">{</a><a id="5147" href="Deep.Ledger.html#4959" class="Bound">t</a><a id="5148" class="Symbol">}{</a><a id="5150" href="Deep.Ledger.html#4971" class="Bound">l</a><a id="5151" class="Symbol">}{</a><a id="5153" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5155" href="Deep.Ledger.html#4966" class="Bound">t′</a> <a id="5158" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="5160" href="Deep.Ledger.html#4974" class="Bound">s</a><a id="5161" class="Symbol">}</a>
        <a id="5171" class="Symbol">=</a> <a id="5173" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="5179" class="Comment">-- equivalences</a>
<a id="axiom⇔denot"></a><a id="5195" href="Deep.Ledger.html#5195" class="Function">axiom⇔denot</a> <a id="5207" class="Symbol">:</a> <a id="5209" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="5211" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="5213" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="5215" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5217" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="5219" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="5221" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="5223" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="5225" class="Symbol">(</a><a id="5226" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="5228" href="Deep.Ledger.html#3869" class="Function Operator">`⊢</a> <a id="5231" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="5233" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="5236" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5238" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5240" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="5241" class="Symbol">)</a>
<a id="5243" href="Deep.Ledger.html#5195" class="Function">axiom⇔denot</a> <a id="5255" class="Symbol">=</a> <a id="5257" href="Deep.Ledger.html#5295" class="Function">axiom→denot</a> <a id="5269" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5271" href="Deep.Ledger.html#5556" class="Function">denot→axiom</a>
  <a id="5285" class="Keyword">where</a>
    <a id="5295" href="Deep.Ledger.html#5295" class="Function">axiom→denot</a> <a id="5307" class="Symbol">:</a> <a id="5309" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="5311" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="5313" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="5315" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5317" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="5319" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="5321" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="5323" class="Symbol">→</a> <a id="5325" class="Symbol">(</a><a id="5326" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="5328" href="Deep.Ledger.html#3869" class="Function Operator">`⊢</a> <a id="5331" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="5333" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="5336" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5338" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5340" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="5341" class="Symbol">)</a>
    <a id="5347" href="Deep.Ledger.html#5295" class="Function">axiom→denot</a> <a id="5359" href="Deep.Ledger.html#4082" class="InductiveConstructor">base</a>                              <a id="5393" href="Deep.Ledger.html#5393" class="Bound">Ps</a> <a id="5396" class="Symbol">=</a> <a id="5398" href="Deep.Ledger.html#5393" class="Bound">Ps</a>
    <a id="5405" href="Deep.Ledger.html#5295" class="Function">axiom→denot</a> <a id="5417" class="Symbol">(</a><a id="5418" href="Deep.Ledger.html#4201" class="InductiveConstructor">step</a> <a id="5423" href="Deep.Ledger.html#5423" class="Bound">PlQ</a><a id="5426" class="Symbol">)</a>                        <a id="5451" class="Symbol">=</a> <a id="5453" href="Deep.Ledger.html#5295" class="Function">axiom→denot</a> <a id="5465" href="Deep.Ledger.html#5423" class="Bound">PlQ</a>
    <a id="5473" href="Deep.Ledger.html#5295" class="Function">axiom→denot</a> <a id="5485" class="Symbol">(</a><a id="5486" href="Deep.Ledger.html#4402" class="InductiveConstructor">weaken-strengthen</a> <a id="5504" href="Deep.Ledger.html#5504" class="Bound">P⊢P′</a> <a id="5509" href="Deep.Ledger.html#5509" class="Bound">Q′⊢Q</a> <a id="5514" href="Deep.Ledger.html#5514" class="Bound">PlQ</a><a id="5517" class="Symbol">)</a> <a id="5519" class="Symbol">=</a> <a id="5521" href="Deep.Ledger.html#5509" class="Bound">Q′⊢Q</a> <a id="5526" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5528" href="Deep.Ledger.html#5295" class="Function">axiom→denot</a> <a id="5540" href="Deep.Ledger.html#5514" class="Bound">PlQ</a> <a id="5544" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5546" href="Deep.Ledger.html#5504" class="Bound">P⊢P′</a>

    <a id="5556" href="Deep.Ledger.html#5556" class="Function">denot→axiom</a> <a id="5568" class="Symbol">:</a> <a id="5570" class="Symbol">(</a><a id="5571" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="5573" href="Deep.Ledger.html#3869" class="Function Operator">`⊢</a> <a id="5576" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="5578" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="5581" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5583" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5585" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="5586" class="Symbol">)</a> <a id="5588" class="Symbol">→</a> <a id="5590" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="5592" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="5594" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="5596" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5598" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="5600" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="5602" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>
    <a id="5608" href="Deep.Ledger.html#5556" class="Function">denot→axiom</a> <a id="5620" class="Symbol">{</a><a id="5621" class="Argument">P</a> <a id="5623" class="Symbol">=</a> <a id="5625" href="Deep.Ledger.html#5625" class="Bound">P</a><a id="5626" class="Symbol">}</a> <a id="5628" class="Symbol">{</a><a id="5629" class="Argument">Q</a> <a id="5631" class="Symbol">=</a> <a id="5633" href="Deep.Ledger.html#5633" class="Bound">Q</a><a id="5634" class="Symbol">}</a> <a id="5636" class="Symbol">{</a><a id="5637" class="Argument">l</a> <a id="5639" class="Symbol">=</a> <a id="5641" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5643" class="Symbol">}</a>    <a id="5648" href="Deep.Ledger.html#5648" class="Bound">H</a>
      <a id="5656" class="Symbol">=</a> <a id="5658" href="Deep.Ledger.html#4402" class="InductiveConstructor">weaken-strengthen</a> <a id="5676" class="Symbol">{</a><a id="5677" class="Argument">P</a> <a id="5679" class="Symbol">=</a> <a id="5681" href="Deep.Ledger.html#5625" class="Bound">P</a><a id="5682" class="Symbol">}</a> <a id="5684" class="Symbol">{</a><a id="5685" class="Argument">Q</a> <a id="5687" class="Symbol">=</a> <a id="5689" href="Deep.Ledger.html#5625" class="Bound">P</a><a id="5690" class="Symbol">}</a> <a id="5692" class="Symbol">{</a><a id="5693" class="Argument">Q′</a> <a id="5696" class="Symbol">=</a> <a id="5698" href="Deep.Ledger.html#5633" class="Bound">Q</a><a id="5699" class="Symbol">}</a> <a id="5701" href="Function.Base.html#615" class="Function">id</a> <a id="5704" href="Deep.Ledger.html#5648" class="Bound">H</a> <a id="5706" href="Deep.Ledger.html#4082" class="InductiveConstructor">base</a>
    <a id="5715" href="Deep.Ledger.html#5556" class="Function">denot→axiom</a> <a id="5727" class="Symbol">{</a><a id="5728" class="Argument">P</a> <a id="5730" class="Symbol">=</a> <a id="5732" href="Deep.Ledger.html#5732" class="Bound">P</a><a id="5733" class="Symbol">}</a> <a id="5735" class="Symbol">{</a><a id="5736" class="Argument">Q</a> <a id="5738" class="Symbol">=</a> <a id="5740" href="Deep.Ledger.html#5740" class="Bound">Q</a><a id="5741" class="Symbol">}</a> <a id="5743" class="Symbol">{</a><a id="5744" class="Argument">l</a> <a id="5746" class="Symbol">=</a> <a id="5748" href="Deep.Ledger.html#5748" class="Bound">t</a> <a id="5750" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5752" href="Deep.Ledger.html#5752" class="Bound">l</a><a id="5753" class="Symbol">}</a> <a id="5755" href="Deep.Ledger.html#5755" class="Bound">H</a>
      <a id="5763" class="Symbol">=</a> <a id="5765" href="Deep.Ledger.html#4402" class="InductiveConstructor">weaken-strengthen</a> <a id="5783" class="Symbol">{</a><a id="5784" class="Argument">P′</a> <a id="5787" class="Symbol">=</a> <a id="5789" href="Deep.Ledger.html#5732" class="Bound">P</a><a id="5790" class="Symbol">}</a> <a id="5792" class="Symbol">{</a><a id="5793" class="Argument">P</a> <a id="5795" class="Symbol">=</a> <a id="5797" href="Deep.Ledger.html#5740" class="Bound">Q</a> <a id="5799" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="5802" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5804" href="Deep.Ledger.html#5748" class="Bound">t</a> <a id="5806" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5808" href="Deep.Ledger.html#5752" class="Bound">l</a> <a id="5810" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="5811" class="Symbol">}</a> <a id="5813" class="Symbol">{</a><a id="5814" class="Argument">Q</a> <a id="5816" class="Symbol">=</a> <a id="5818" href="Deep.Ledger.html#5740" class="Bound">Q</a><a id="5819" class="Symbol">}</a> <a id="5821" class="Symbol">{</a><a id="5822" class="Argument">Q′</a> <a id="5825" class="Symbol">=</a> <a id="5827" href="Deep.Ledger.html#5740" class="Bound">Q</a><a id="5828" class="Symbol">}</a> <a id="5830" href="Deep.Ledger.html#5755" class="Bound">H</a> <a id="5832" href="Function.Base.html#615" class="Function">id</a> <a id="5835" class="Symbol">(</a><a id="5836" href="Deep.Ledger.html#4532" class="Function">axiom-base⋆</a> <a id="5848" class="Symbol">{</a><a id="5849" class="Argument">P</a> <a id="5851" class="Symbol">=</a> <a id="5853" href="Deep.Ledger.html#5740" class="Bound">Q</a><a id="5854" class="Symbol">}</a> <a id="5856" class="Symbol">{</a><a id="5857" class="Argument">l</a> <a id="5859" class="Symbol">=</a> <a id="5861" href="Deep.Ledger.html#5748" class="Bound">t</a> <a id="5863" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5865" href="Deep.Ledger.html#5752" class="Bound">l</a><a id="5866" class="Symbol">})</a>

<a id="axiom⇔oper"></a><a id="5870" href="Deep.Ledger.html#5870" class="Function">axiom⇔oper</a> <a id="5881" class="Symbol">:</a> <a id="5883" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="5885" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="5887" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="5889" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5891" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="5893" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="5895" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="5897" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="5899" class="Symbol">(∀</a> <a id="5902" class="Symbol">{</a><a id="5903" href="Deep.Ledger.html#5903" class="Bound">s</a> <a id="5905" href="Deep.Ledger.html#5905" class="Bound">s′</a><a id="5907" class="Symbol">}</a> <a id="5909" class="Symbol">→</a> <a id="5911" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="5913" href="Deep.Ledger.html#3931" class="Function Operator">∙</a> <a id="5915" href="Deep.Ledger.html#5903" class="Bound">s</a> <a id="5917" class="Symbol">→</a> <a id="5919" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5921" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5923" href="Deep.Ledger.html#5903" class="Bound">s</a> <a id="5925" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="5930" href="Deep.Ledger.html#5905" class="Bound">s′</a> <a id="5933" class="Symbol">→</a> <a id="5935" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="5937" href="Deep.Ledger.html#3931" class="Function Operator">∙</a> <a id="5939" href="Deep.Ledger.html#5905" class="Bound">s′</a><a id="5941" class="Symbol">)</a>
<a id="5943" href="Deep.Ledger.html#5870" class="Function">axiom⇔oper</a>
  <a id="5956" class="Comment">{- ** 1. proving from scratch -}</a>
  <a id="5991" class="Comment">-- = axiom→oper , oper→axiom</a>
  <a id="6022" class="Comment">-- where</a>
  <a id="6033" class="Comment">--   axiom→oper : ⟨ P ⟩ l ⟨ Q ⟩ → (∀ {s s′} → P s → l , s —→⋆′ s′ → Q s′)</a>
  <a id="6109" class="Comment">--   axiom→oper base                              Ps base                   = Ps</a>
  <a id="6192" class="Comment">--   axiom→oper (step PlQ)                        Ps (step singleStep s→s′) = axiom→oper PlQ Ps s→s′</a>
  <a id="6295" class="Comment">--   axiom→oper (weaken-strengthen P⊢P′ Q′⊢Q PlQ) Ps s→s′                   = Q′⊢Q $ axiom→oper PlQ (P⊢P′ Ps) s→s′</a>

  <a id="6413" class="Comment">--   oper→axiom : (∀ {s s′} → P s → l , s —→⋆′ s′ → Q s′) → ⟨ P ⟩ l ⟨ Q ⟩</a>
  <a id="6489" class="Comment">--   oper→axiom {l = []}    H = weaken-strengthen id (flip H base) base</a>
  <a id="6563" class="Comment">--   oper→axiom {l = _ ∷ _} H = weaken-strengthen (λ Ps → H Ps oper-base⋆) id axiom-base⋆</a>

  <a id="6656" class="Comment">{- ** 2. composing axiom⇔denot ∘ denot⇔oper -}</a>
  <a id="6705" class="Symbol">=</a> <a id="6707" class="Symbol">(λ{</a> <a id="6711" href="Deep.Ledger.html#6711" class="Bound">P⊢</a> <a id="6714" href="Deep.Ledger.html#6714" class="Bound">Ps</a> <a id="6717" href="Deep.Ledger.html#6717" class="Bound">s→s′</a> <a id="6722" class="Symbol">→</a> <a id="6724" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="6730" class="Symbol">_</a> <a id="6732" class="Symbol">(</a><a id="6733" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6739" href="Deep.Ledger.html#2340" class="Function">denot⇔oper</a> <a id="6750" href="Deep.Ledger.html#6717" class="Bound">s→s′</a><a id="6754" class="Symbol">)</a> <a id="6756" class="Symbol">(</a><a id="6757" href="Deep.Ledger.html#6711" class="Bound">P⊢</a> <a id="6760" href="Deep.Ledger.html#6714" class="Bound">Ps</a><a id="6762" class="Symbol">)})</a> <a id="6766" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6768" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6774" href="Deep.Ledger.html#5195" class="Function">axiom⇔denot</a>
  <a id="6788" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6790" class="Symbol">λ</a> <a id="6792" href="Deep.Ledger.html#6792" class="Bound">H</a> <a id="6794" class="Symbol">→</a> <a id="6796" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6802" href="Deep.Ledger.html#5195" class="Function">axiom⇔denot</a> <a id="6814" class="Symbol">λ</a> <a id="6816" href="Deep.Ledger.html#6816" class="Bound">Ps</a> <a id="6819" class="Symbol">→</a> <a id="6821" href="Deep.Ledger.html#6792" class="Bound">H</a> <a id="6823" href="Deep.Ledger.html#6816" class="Bound">Ps</a> <a id="6826" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a>


<a id="6839" class="Comment">-- ** Separation logic</a>

<a id="mod"></a><a id="6863" href="Deep.Ledger.html#6863" class="Function">mod</a> <a id="6867" class="Symbol">:</a> <a id="6869" href="Deep.Ledger.html#888" class="Function">L</a> <a id="6871" class="Symbol">→</a> <a id="6873" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="6878" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="6883" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>
<a id="6885" href="Deep.Ledger.html#6863" class="Function">mod</a> <a id="6889" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6892" class="Symbol">=</a> <a id="6894" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a>
<a id="6896" href="Deep.Ledger.html#6863" class="Function">mod</a> <a id="6900" class="Symbol">(</a><a id="6901" href="Deep.Ledger.html#6901" class="Bound">p₁</a> <a id="6904" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">—→⟨</a> <a id="6908" class="Symbol">_</a> <a id="6910" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">⟩</a> <a id="6912" href="Deep.Ledger.html#6912" class="Bound">p₂</a> <a id="6915" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6917" href="Deep.Ledger.html#6917" class="Bound">l</a><a id="6918" class="Symbol">)</a> <a id="6920" class="Symbol">=</a> <a id="6922" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="6932" href="Deep.Ledger.html#6901" class="Bound">p₁</a> <a id="6935" href="Prelude.Sets.AsUniqueLists.Core.html#2841" class="Function Operator">∪</a> <a id="6937" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="6947" href="Deep.Ledger.html#6912" class="Bound">p₂</a> <a id="6950" href="Prelude.Sets.AsUniqueLists.Core.html#2841" class="Function Operator">∪</a> <a id="6952" href="Deep.Ledger.html#6863" class="Function">mod</a> <a id="6956" href="Deep.Ledger.html#6917" class="Bound">l</a>

<a id="6959" class="Comment">-- ⟦⟧-constᵗ : dom (⟦ t ⟧ s) ≡ dom s</a>
<a id="6996" class="Comment">-- ⟦⟧-constᵗ {t = p —→⟨ n ⟩ p′}    = refl</a>

<a id="7039" class="Comment">-- ⟦⟧-const : ∀ {s} {l : L} → dom (⟦ l ⟧ s) ≡ dom s</a>
<a id="7091" class="Comment">-- ⟦⟧-const {s = _} {l = []}    = refl</a>
<a id="7130" class="Comment">-- ⟦⟧-const {s = s} {l = t ∷ l} rewrite ⟦⟧-const {⟦ t ⟧ s}{l} = ⟦⟧-constᵗ {t}{s}</a>

<a id="⟦⟧-union"></a><a id="7212" href="Deep.Ledger.html#7212" class="Function">⟦⟧-union</a> <a id="7221" class="Symbol">:</a>
    <a id="7227" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟨</a> <a id="7229" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="7232" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⊎</a> <a id="7234" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="7237" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟩≡</a> <a id="7240" href="Deep.Ledger.html#912" class="Generalizable">s</a>
    <a id="7246" class="Comment">--------------------------------------</a>
  <a id="7287" class="Symbol">→</a> <a id="7289" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟨</a> <a id="7291" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7293" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7295" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7297" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="7300" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⊎</a> <a id="7302" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7304" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7306" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7308" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="7311" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟩≡</a> <a id="7314" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7316" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7318" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7320" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="7322" href="Deep.Ledger.html#7212" class="Function">⟦⟧-union</a> <a id="7331" href="Deep.Ledger.html#7331" class="Bound">s₁⊎s₂</a> <a id="7337" class="Symbol">=</a> <a id="7339" class="Hole">{!!}</a> <a id="7344" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7346" class="Hole">{!!}</a>

<a id="7352" class="Keyword">postulate</a>
  <a id="⟦⟧-♯"></a><a id="7364" href="Deep.Ledger.html#7364" class="Postulate">⟦⟧-♯</a> <a id="7369" class="Symbol">:</a>
      <a id="7377" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="7380" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="7382" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="7385" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="7387" href="Deep.Ledger.html#912" class="Generalizable">s</a>
      <a id="7395" class="Comment">-----------------------------</a>
    <a id="7429" class="Symbol">→</a> <a id="7431" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7433" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7435" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7437" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="7440" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="7442" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7444" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7446" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7448" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="7451" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="7453" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7455" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7457" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7459" href="Deep.Ledger.html#912" class="Generalizable">s</a>

<a id="7462" class="Comment">-- update-emptyᵗ : proj₁ s ≡ ∅ → ⟦ t ⟧ s ≡ s</a>
<a id="7507" class="Comment">-- update-emptyᵗ {.(⟨ [] ⟩∶- _) , snd} {x —→⟨ x₁ ⟩ x₂} refl = {!!}</a>

<a id="7575" class="Comment">-- update-empty : proj₁ s ≡ ∅ → ⟦ l ⟧ s ≡ s</a>
<a id="7619" class="Comment">-- update-empty {s}{[]}    refl = refl</a>
<a id="7658" class="Comment">-- update-empty {s}{t ∷ l} refl rewrite update-emptyᵗ {s}{t} refl = {!!}</a>
<a id="7731" class="Comment">-- rewrite update-empty {⟦ t ⟧ s}{l} (update-emptyᵗ {s}{t} refl) = refl</a>

<a id="frame"></a><a id="7804" href="Deep.Ledger.html#7804" class="Function">frame</a> <a id="7810" class="Symbol">:</a>
    <a id="7816" href="Deep.Ledger.html#6863" class="Function">mod</a> <a id="7820" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7822" href="Prelude.Apartness.html#256" class="Field Operator">♯</a> <a id="7824" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="7827" href="Deep.Ledger.html#4009" class="Generalizable">R</a>
  <a id="7831" class="Symbol">→</a> <a id="7833" href="Deep.Ledger.html#4009" class="Generalizable">R</a> <a id="7835" href="Deep.Ledger.html#3931" class="Function Operator">∙</a> <a id="7837" href="Deep.Ledger.html#912" class="Generalizable">s</a>
    <a id="7843" class="Comment">-----------</a>
  <a id="7857" class="Symbol">→</a> <a id="7859" href="Deep.Ledger.html#4009" class="Generalizable">R</a> <a id="7861" href="Deep.Ledger.html#3931" class="Function Operator">∙</a> <a id="7863" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7865" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7867" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7869" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="7871" href="Deep.Ledger.html#7804" class="Function">frame</a> <a id="7877" class="Symbol">=</a> <a id="7879" class="Hole">{!!}</a>
<a id="7884" class="Comment">-- frame {l} {`emp}    {.(⟨ [] ⟩∶- _) , _} _ refl = subst (`emp ∙_) (sym $ update-empty {l = l} refl) refl</a>
<a id="7991" class="Comment">-- frame {l} {p `↦ v} {s} mod♯ (p∈ , p≡) = {!!}</a>
<a id="8039" class="Comment">-- frame {l} {P `∗ Q}  {s} mod♯ Rs = {!!}</a>
<a id="8081" class="Comment">-- frame {l} {P `—∗ Q} {s} mod♯ Rs = {!!}</a>
<a id="8123" class="Comment">-- frame {l} {P `∘ f}  {s} mod♯ Rs = {!!}</a>
<a id="8165" class="Comment">-- frame {[]} {R} {s} mod♯fv Rs = Rs</a>
<a id="8202" class="Comment">-- frame {(p —→⟨ n ⟩ p′) ∷ l} {R} {s} mod♯fv Rs = {!!}</a>

<a id="8258" class="Comment">-- need deeply-embedded Predˢ for fv</a>
<a id="[FRAME]"></a><a id="8295" href="Deep.Ledger.html#8295" class="Function">[FRAME]</a> <a id="8303" class="Symbol">:</a>
    <a id="8309" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="8311" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="8313" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="8315" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="8317" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="8319" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="8321" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>
  <a id="8325" class="Symbol">→</a> <a id="8327" href="Deep.Ledger.html#6863" class="Function">mod</a> <a id="8331" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="8333" href="Prelude.Apartness.html#256" class="Field Operator">♯</a> <a id="8335" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="8338" href="Deep.Ledger.html#4009" class="Generalizable">R</a>
    <a id="8344" class="Comment">-----------------------</a>
  <a id="8370" class="Symbol">→</a> <a id="8372" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="8374" href="Deep.Ledger.html#3987" class="Generalizable">P</a> <a id="8376" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="8379" href="Deep.Ledger.html#4009" class="Generalizable">R</a> <a id="8381" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a> <a id="8383" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="8385" href="Deep.Ledger.html#4029" class="Datatype Operator">⟨</a> <a id="8387" href="Deep.Ledger.html#3998" class="Generalizable">Q</a> <a id="8389" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="8392" href="Deep.Ledger.html#4009" class="Generalizable">R</a> <a id="8394" href="Deep.Ledger.html#4029" class="Datatype Operator">⟩</a>
<a id="8396" href="Deep.Ledger.html#8295" class="Function">[FRAME]</a> <a id="8404" class="Symbol">{</a><a id="8405" href="Deep.Ledger.html#8405" class="Bound">P</a><a id="8406" class="Symbol">}{</a><a id="8408" href="Deep.Ledger.html#8408" class="Bound">l</a><a id="8409" class="Symbol">}{</a><a id="8411" href="Deep.Ledger.html#8411" class="Bound">Q</a><a id="8412" class="Symbol">}{</a><a id="8414" href="Deep.Ledger.html#8414" class="Bound">R</a><a id="8415" class="Symbol">}</a> <a id="8417" href="Deep.Ledger.html#8417" class="Bound">PlQ</a> <a id="8421" href="Deep.Ledger.html#8421" class="Bound">mod♯fv</a> <a id="8428" class="Symbol">=</a> <a id="8430" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8436" href="Deep.Ledger.html#5195" class="Function">axiom⇔denot</a> <a id="8448" href="Deep.Ledger.html#8462" class="Function">d</a>
  <a id="8452" class="Keyword">where</a>
    <a id="8462" href="Deep.Ledger.html#8462" class="Function">d</a> <a id="8464" class="Symbol">:</a> <a id="8466" class="Symbol">(</a><a id="8467" href="Deep.Ledger.html#8405" class="Bound">P</a> <a id="8469" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="8472" href="Deep.Ledger.html#8414" class="Bound">R</a><a id="8473" class="Symbol">)</a> <a id="8475" href="Deep.Ledger.html#3869" class="Function Operator">`⊢</a> <a id="8478" class="Symbol">(</a><a id="8479" href="Deep.Ledger.html#8411" class="Bound">Q</a> <a id="8481" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="8484" href="Deep.Ledger.html#8414" class="Bound">R</a><a id="8485" class="Symbol">)</a> <a id="8487" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="8490" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8492" href="Deep.Ledger.html#8408" class="Bound">l</a> <a id="8494" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a>
    <a id="8500" href="Deep.Ledger.html#8462" class="Function">d</a> <a id="8502" class="Symbol">{</a><a id="8503" href="Deep.Ledger.html#8503" class="Bound">s</a><a id="8504" class="Symbol">}</a> <a id="8506" class="Symbol">(</a><a id="8507" href="Deep.Ledger.html#8507" class="Bound">s₁</a> <a id="8510" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8512" href="Deep.Ledger.html#8512" class="Bound">s₂</a> <a id="8515" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8517" href="Deep.Ledger.html#8517" class="Bound">s₁♯s₂</a> <a id="8523" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8525" href="Deep.Ledger.html#8525" class="Bound">Ps₁</a> <a id="8529" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8531" href="Deep.Ledger.html#8531" class="Bound">Rs₂</a><a id="8534" class="Symbol">)</a> <a id="8536" class="Symbol">=</a> <a id="8538" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8540" href="Deep.Ledger.html#8408" class="Bound">l</a> <a id="8542" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="8544" href="Deep.Ledger.html#8507" class="Bound">s₁</a> <a id="8547" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8549" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8551" href="Deep.Ledger.html#8408" class="Bound">l</a> <a id="8553" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="8555" href="Deep.Ledger.html#8512" class="Bound">s₂</a> <a id="8558" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8560" href="Deep.Ledger.html#9024" class="Function">p</a> <a id="8562" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8564" href="Deep.Ledger.html#8868" class="Function">Qs₁′</a> <a id="8569" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8571" href="Deep.Ledger.html#8938" class="Function">Rs₂′</a>
    <a id="8580" class="Comment">{-
      s = s₁ ⊎ s₂
      —→ ⟦l⟧s = ⟦l⟧s₁ ⊎ ⟦l⟧s₂
      P s₁
      —→ Q ⟦l⟧s₁
      R s₂
      —→ R ⟦l⟧s₂

         ⟦l⟧s = ⟦l⟧s₁ ⊎ ⟦l⟧s₂     Q ⟦l⟧s₁      R ⟦l⟧s₂
      ----------------------------------------------------
                          (Q ∗ R) ⟦l⟧s
    -}</a>
      <a id="8854" class="Keyword">where</a>
        <a id="8868" href="Deep.Ledger.html#8868" class="Function">Qs₁′</a> <a id="8873" class="Symbol">:</a> <a id="8875" href="Deep.Ledger.html#8411" class="Bound">Q</a> <a id="8877" href="Deep.Ledger.html#3931" class="Function Operator">∙</a> <a id="8879" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8881" href="Deep.Ledger.html#8408" class="Bound">l</a> <a id="8883" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="8885" href="Deep.Ledger.html#8507" class="Bound">s₁</a>
        <a id="8896" href="Deep.Ledger.html#8868" class="Function">Qs₁′</a> <a id="8901" class="Symbol">=</a> <a id="8903" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8909" href="Deep.Ledger.html#5195" class="Function">axiom⇔denot</a> <a id="8921" href="Deep.Ledger.html#8417" class="Bound">PlQ</a> <a id="8925" href="Deep.Ledger.html#8525" class="Bound">Ps₁</a>

        <a id="8938" href="Deep.Ledger.html#8938" class="Function">Rs₂′</a> <a id="8943" class="Symbol">:</a> <a id="8945" href="Deep.Ledger.html#8414" class="Bound">R</a> <a id="8947" href="Deep.Ledger.html#3931" class="Function Operator">∙</a> <a id="8949" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8951" href="Deep.Ledger.html#8408" class="Bound">l</a> <a id="8953" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="8955" href="Deep.Ledger.html#8512" class="Bound">s₂</a>
        <a id="8966" href="Deep.Ledger.html#8938" class="Function">Rs₂′</a> <a id="8971" class="Symbol">=</a> <a id="8973" href="Deep.Ledger.html#7804" class="Function">frame</a> <a id="8979" class="Symbol">{</a><a id="8980" class="Argument">l</a> <a id="8982" class="Symbol">=</a> <a id="8984" href="Deep.Ledger.html#8408" class="Bound">l</a><a id="8985" class="Symbol">}</a> <a id="8987" class="Symbol">{</a><a id="8988" class="Argument">R</a> <a id="8990" class="Symbol">=</a> <a id="8992" href="Deep.Ledger.html#8414" class="Bound">R</a><a id="8993" class="Symbol">}</a> <a id="8995" class="Symbol">{</a><a id="8996" class="Argument">s</a> <a id="8998" class="Symbol">=</a> <a id="9000" href="Deep.Ledger.html#8512" class="Bound">s₂</a><a id="9002" class="Symbol">}</a> <a id="9004" href="Deep.Ledger.html#8421" class="Bound">mod♯fv</a> <a id="9011" href="Deep.Ledger.html#8531" class="Bound">Rs₂</a>

        <a id="9024" href="Deep.Ledger.html#9024" class="Function">p</a> <a id="9026" class="Symbol">:</a> <a id="9028" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="9030" href="Deep.Ledger.html#8408" class="Bound">l</a> <a id="9032" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="9034" href="Deep.Ledger.html#8507" class="Bound">s₁</a> <a id="9037" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="9039" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="9041" href="Deep.Ledger.html#8408" class="Bound">l</a> <a id="9043" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="9045" href="Deep.Ledger.html#8512" class="Bound">s₂</a> <a id="9048" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="9050" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="9052" href="Deep.Ledger.html#8408" class="Bound">l</a> <a id="9054" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="9056" href="Deep.Ledger.html#8503" class="Bound">s</a>
        <a id="9066" href="Deep.Ledger.html#9024" class="Function">p</a> <a id="9068" class="Symbol">=</a> <a id="9070" href="Deep.Ledger.html#7364" class="Postulate">⟦⟧-♯</a> <a id="9075" class="Symbol">{</a><a id="9076" href="Deep.Ledger.html#8507" class="Bound">s₁</a><a id="9078" class="Symbol">}{</a><a id="9080" href="Deep.Ledger.html#8512" class="Bound">s₂</a><a id="9082" class="Symbol">}{</a><a id="9084" href="Deep.Ledger.html#8503" class="Bound">s</a><a id="9085" class="Symbol">}{</a><a id="9087" href="Deep.Ledger.html#8408" class="Bound">l</a><a id="9088" class="Symbol">}</a> <a id="9090" href="Deep.Ledger.html#8517" class="Bound">s₁♯s₂</a>
<a id="9096" class="Comment">{-

-- ** Concurrent separation logic
open import Data.List.Relation.Ternary.Interleaving
_∥_←_ : L → L → L → Type
l₁ ∥ l₂ ← l = Interleaving _≡_ _≡_ l₁ l₂ l

h :
    s₁ ♯ s₂ ← s
  → l₁ ∥ l₂ ← l
  → mod l₁ S.♯ mod l₂
    -------------------------------
  → ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂ ← ⟦ l ⟧ s
h {s₁}{s₂}{s}{l₁}{l₂}{l} s₁♯s₂ l₁∥l₂ l₁♯l₂ = h₁ , h₂
  where
    ps₁ = proj₁ (⟦ l₁ ⟧ s₁)
    ps₂ = proj₁ (⟦ l₂ ⟧ s₂)

    All∉ : All (_∉′ ps₂) (list ps₁)
    All∉ = {!!}

    h₁ : ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂
    h₁ = let p = L.filter-none (_∈′? ps₂) {xs = list ps₁} All∉ in {!!} -- subst _ p refl

    h₂ : ⟦ l ⟧ s ≡ᵐ union (⟦ l₁ ⟧ s₁) (⟦ l₂ ⟧ s₂)
    h₂ = {!!}

[INTERLEAVE] :
    l₁ ∥ l₂ ← l
  → ⟨ P₁ ⟩ l₁ ⟨ Q₁ ⟩
  → ⟨ P₂ ⟩ l₂ ⟨ Q₂ ⟩
  → mod l₁ S.♯ mod l₂
  -- → fv P₁ ∪ fv Q₁ S.♯ mod l₂
  -- → fv P₂ ∪ fv Q₂ S.♯ mod l₁
    ---------------------------
  → ⟨ P₁ `∗ P₂ ⟩ l ⟨ Q₁ `∗ Q₂ ⟩

[INTERLEAVE] {l₁}{l₂}{l}{P₁}{Q₁}{P₂}{Q₂} l₁∥l₂ PlQ PlQ′ l₁♯l₂ = proj₂ axiom⇔denot d
  where
    d : (P₁ `∗ P₂) `⊢ (Q₁ `∗ Q₂) `∘ ⟦ l ⟧
    d {s} (s₁ , s₂ , s₁♯s₂ , Ps₁ , Ps₂) = _ , _ , q , q₁ , q₂
      where
        q₁ : Q₁ ∙ ⟦ l₁ ⟧ s₁
        q₁ = proj₁ axiom⇔denot PlQ Ps₁

        q₂ : Q₂ ∙ ⟦ l₂ ⟧ s₂
        q₂ = proj₁ axiom⇔denot PlQ′ Ps₂

        q : ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂ ← ⟦ l ⟧ s
        q = {!!} -- h s₁♯s₂ l₁∥l₂ l₁♯l₂
-}</a>
</pre></body></html>