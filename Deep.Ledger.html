<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Deep.Ledger</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Keyword">open</a> <a id="45" class="Keyword">import</a> <a id="52" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="65" class="Keyword">open</a> <a id="70" class="Keyword">import</a> <a id="77" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="93" class="Keyword">open</a> <a id="98" href="Prelude.Init.html#3577" class="Module">Integer</a> <a id="106" class="Keyword">using</a> <a id="112" class="Symbol">()</a> <a id="115" class="Keyword">renaming</a> <a id="124" class="Symbol">(</a><a id="125" href="Data.Integer.Base.html#5023" class="Function Operator">_-_</a> <a id="129" class="Symbol">to</a> <a id="132" class="Function Operator">_-ℤ_</a><a id="136" class="Symbol">;</a> <a id="138" href="Data.Integer.Base.html#4844" class="Function Operator">_+_</a> <a id="142" class="Symbol">to</a> <a id="145" class="Function Operator">_+ℤ_</a><a id="149" class="Symbol">)</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Prelude.Maps.Abstract.html" class="Module">Prelude.Maps.Abstract</a> <a id="236" class="Keyword">hiding</a> <a id="243" class="Symbol">(</a><a id="244" href="Prelude.Maps.Abstract.Interface.html#563" class="Function">∅</a><a id="245" class="Symbol">;</a> <a id="247" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a><a id="256" class="Symbol">)</a> <a id="258" class="Keyword">renaming</a> <a id="267" class="Symbol">(</a><a id="268" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">_∪_</a> <a id="272" class="Symbol">to</a> <a id="275" class="Function Operator">_∪ᵐ_</a><a id="279" class="Symbol">)</a>
<a id="281" class="Keyword">open</a> <a id="286" href="Prelude.Maps.Abstract.Interface.html#15052" class="Module">CommandDSL</a>
<a id="297" class="Keyword">open</a> <a id="302" class="Keyword">import</a> <a id="309" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>

<a id="411" class="Keyword">module</a> <a id="418" href="Deep.Ledger.html" class="Module">Deep.Ledger</a>
  <a id="432" class="Symbol">(</a><a id="433" href="Deep.Ledger.html#433" class="Bound">Part</a> <a id="438" class="Symbol">:</a> <a id="440" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="443" class="Symbol">)</a> <a id="445" class="Comment">-- a fixed set of participants</a>
  <a id="478" class="Symbol">⦃</a> <a id="480" href="Deep.Ledger.html#480" class="Bound">_</a> <a id="482" class="Symbol">:</a> <a id="484" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="490" href="Deep.Ledger.html#433" class="Bound">Part</a> <a id="495" class="Symbol">⦄</a>
  <a id="499" class="Keyword">where</a>

<a id="506" class="Keyword">instance</a> <a id="515" href="Deep.Ledger.html#515" class="Function">_</a> <a id="517" class="Symbol">=</a> <a id="519" href="Prelude.Semigroup.html#3009" class="Function">Semigroup-ℤ-+</a><a id="532" class="Symbol">;</a> <a id="534" href="Deep.Ledger.html#534" class="Function">_</a> <a id="536" class="Symbol">=</a> <a id="538" href="Prelude.Semigroup.html#3068" class="Function">SemigroupLaws-ℤ-+</a><a id="555" class="Symbol">;</a> <a id="557" href="Deep.Ledger.html#557" class="Function">_</a> <a id="559" class="Symbol">=</a> <a id="561" href="Prelude.Monoid.html#1779" class="Function">Monoid-ℤ-+</a><a id="571" class="Symbol">;</a> <a id="573" href="Deep.Ledger.html#573" class="Function">_</a> <a id="575" class="Symbol">=</a> <a id="577" href="Prelude.Monoid.html#1858" class="Function">MonoidLaws-ℤ-+</a>

<a id="593" class="Comment">-- The state of a ledger is a collection of participants, along with their balance.</a>
<a id="S"></a><a id="677" href="Deep.Ledger.html#677" class="Function">S</a> <a id="679" class="Symbol">:</a> <a id="681" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="685" href="Deep.Ledger.html#677" class="Function">S</a> <a id="687" class="Symbol">=</a> <a id="689" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">Map⟨</a> <a id="694" href="Deep.Ledger.html#433" class="Bound">Part</a> <a id="699" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">↦</a> <a id="701" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="703" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">⟩</a>

<a id="706" class="Comment">-- A transaction is transferring money from one participant to another</a>
<a id="777" class="Keyword">data</a> <a id="Tx"></a><a id="782" href="Deep.Ledger.html#782" class="Datatype">Tx</a> <a id="785" class="Symbol">:</a> <a id="787" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="791" class="Keyword">where</a>
  <a id="Tx._—→⟨_⟩_"></a><a id="799" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">_—→⟨_⟩_</a> <a id="807" class="Symbol">:</a> <a id="809" href="Deep.Ledger.html#433" class="Bound">Part</a> <a id="814" class="Symbol">→</a> <a id="816" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="818" class="Symbol">→</a> <a id="820" href="Deep.Ledger.html#433" class="Bound">Part</a> <a id="825" class="Symbol">→</a> <a id="827" href="Deep.Ledger.html#782" class="Datatype">Tx</a>

<a id="831" class="Comment">-- A ledger is a list of transactions</a>
<a id="L"></a><a id="869" href="Deep.Ledger.html#869" class="Function">L</a> <a id="871" class="Symbol">=</a> <a id="873" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="878" href="Deep.Ledger.html#782" class="Datatype">Tx</a>

<a id="882" class="Keyword">variable</a>
  <a id="893" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="895" href="Deep.Ledger.html#895" class="Generalizable">s′</a> <a id="898" href="Deep.Ledger.html#898" class="Generalizable">s″</a> <a id="901" href="Deep.Ledger.html#901" class="Generalizable">s₁</a> <a id="904" href="Deep.Ledger.html#904" class="Generalizable">s₂</a> <a id="907" class="Symbol">:</a> <a id="909" href="Deep.Ledger.html#677" class="Function">S</a>
  <a id="913" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="915" href="Deep.Ledger.html#915" class="Generalizable">t′</a> <a id="918" href="Deep.Ledger.html#918" class="Generalizable">t″</a> <a id="921" class="Symbol">:</a> <a id="923" href="Deep.Ledger.html#782" class="Datatype">Tx</a>
  <a id="928" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="930" href="Deep.Ledger.html#930" class="Generalizable">l′</a> <a id="933" href="Deep.Ledger.html#933" class="Generalizable">l″</a> <a id="936" href="Deep.Ledger.html#936" class="Generalizable">l₁</a> <a id="939" href="Deep.Ledger.html#939" class="Generalizable">l₂</a> <a id="942" class="Symbol">:</a> <a id="944" href="Deep.Ledger.html#869" class="Function">L</a>
  <a id="948" href="Deep.Ledger.html#948" class="Generalizable">ls</a> <a id="951" href="Deep.Ledger.html#951" class="Generalizable">ls′</a> <a id="955" href="Deep.Ledger.html#955" class="Generalizable">ls″</a> <a id="959" class="Symbol">:</a> <a id="961" href="Deep.Ledger.html#869" class="Function">L</a> <a id="963" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="965" href="Deep.Ledger.html#677" class="Function">S</a>

<a id="968" class="Comment">-- ** Denotational semantics</a>

<a id="Domain"></a><a id="998" href="Deep.Ledger.html#998" class="Function">Domain</a> <a id="1005" class="Symbol">=</a> <a id="1007" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1009" class="Symbol">→</a> <a id="1011" href="Deep.Ledger.html#677" class="Function">S</a>

<a id="1014" class="Keyword">record</a> <a id="Denotable"></a><a id="1021" href="Deep.Ledger.html#1021" class="Record">Denotable</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Deep.Ledger.html#1032" class="Bound">A</a> <a id="1034" class="Symbol">:</a> <a id="1036" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1039" class="Symbol">)</a> <a id="1041" class="Symbol">:</a> <a id="1043" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1047" class="Keyword">where</a>
  <a id="1055" class="Keyword">field</a>
    <a id="Denotable.⟦_⟧"></a><a id="1065" href="Deep.Ledger.html#1065" class="Field Operator">⟦_⟧</a> <a id="1069" class="Symbol">:</a> <a id="1071" href="Deep.Ledger.html#1032" class="Bound">A</a> <a id="1073" class="Symbol">→</a> <a id="1075" href="Deep.Ledger.html#998" class="Function">Domain</a>
<a id="1082" class="Keyword">open</a> <a id="1087" href="Deep.Ledger.html#1021" class="Module">Denotable</a> <a id="1097" class="Symbol">{{...}}</a> <a id="1105" class="Keyword">public</a>

<a id="1113" class="Keyword">instance</a>
  <a id="⟦Tx⟧"></a><a id="1124" href="Deep.Ledger.html#1124" class="Function">⟦Tx⟧</a> <a id="1129" class="Symbol">:</a> <a id="1131" href="Deep.Ledger.html#1021" class="Record">Denotable</a> <a id="1141" href="Deep.Ledger.html#782" class="Datatype">Tx</a>
  <a id="1146" href="Deep.Ledger.html#1124" class="Function">⟦Tx⟧</a> <a id="1151" class="Symbol">.</a><a id="1152" href="Deep.Ledger.html#1065" class="Field Operator">⟦_⟧</a> <a id="1156" class="Symbol">(</a><a id="1157" href="Deep.Ledger.html#1157" class="Bound">p₁</a> <a id="1160" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">—→⟨</a> <a id="1164" href="Deep.Ledger.html#1164" class="Bound">n</a> <a id="1166" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">⟩</a> <a id="1168" href="Deep.Ledger.html#1168" class="Bound">p₂</a><a id="1170" class="Symbol">)</a> <a id="1172" href="Deep.Ledger.html#1172" class="Bound">s</a> <a id="1174" class="Symbol">=</a> <a id="1176" href="Prelude.Maps.Abstract.Interface.html#15075" class="Function">modify</a> <a id="1183" href="Deep.Ledger.html#1168" class="Bound">p₂</a> <a id="1186" class="Symbol">(</a><a id="1187" href="Deep.Ledger.html#145" class="Function Operator">_+ℤ</a> <a id="1191" href="Deep.Ledger.html#1164" class="Bound">n</a><a id="1192" class="Symbol">)</a> <a id="1194" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1196" href="Prelude.Maps.Abstract.Interface.html#15075" class="Function">modify</a> <a id="1203" href="Deep.Ledger.html#1157" class="Bound">p₁</a> <a id="1206" class="Symbol">(</a><a id="1207" href="Deep.Ledger.html#132" class="Function Operator">_-ℤ</a> <a id="1211" href="Deep.Ledger.html#1164" class="Bound">n</a><a id="1212" class="Symbol">)</a> <a id="1214" href="Deep.Ledger.html#1172" class="Bound">s</a>

  <a id="⟦L⟧"></a><a id="1219" href="Deep.Ledger.html#1219" class="Function">⟦L⟧</a> <a id="1223" class="Symbol">:</a> <a id="1225" href="Deep.Ledger.html#1021" class="Record">Denotable</a> <a id="1235" href="Deep.Ledger.html#869" class="Function">L</a>
  <a id="1239" href="Deep.Ledger.html#1219" class="Function">⟦L⟧</a> <a id="1243" class="Symbol">.</a><a id="1244" href="Deep.Ledger.html#1065" class="Field Operator">⟦_⟧</a> <a id="1248" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>      <a id="1256" class="Symbol">=</a> <a id="1258" href="Function.Base.html#615" class="Function">id</a>
  <a id="1263" href="Deep.Ledger.html#1219" class="Function">⟦L⟧</a> <a id="1267" class="Symbol">.</a><a id="1268" href="Deep.Ledger.html#1065" class="Field Operator">⟦_⟧</a> <a id="1272" class="Symbol">(</a><a id="1273" href="Deep.Ledger.html#1273" class="Bound">t</a> <a id="1275" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1277" href="Deep.Ledger.html#1277" class="Bound">l</a><a id="1278" class="Symbol">)</a> <a id="1280" class="Symbol">=</a> <a id="1282" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="1284" href="Deep.Ledger.html#1277" class="Bound">l</a> <a id="1286" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="1288" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1290" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="1292" href="Deep.Ledger.html#1273" class="Bound">t</a> <a id="1294" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a>

<a id="comp"></a><a id="1297" href="Deep.Ledger.html#1297" class="Function">comp</a> <a id="1302" class="Symbol">:</a> <a id="1304" class="Symbol">∀</a> <a id="1306" href="Deep.Ledger.html#1306" class="Bound">x</a> <a id="1308" class="Symbol">→</a> <a id="1310" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="1312" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="1314" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="1317" href="Deep.Ledger.html#930" class="Generalizable">l′</a> <a id="1320" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="1322" href="Deep.Ledger.html#1306" class="Bound">x</a> <a id="1324" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1326" class="Symbol">(</a><a id="1327" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="1329" href="Deep.Ledger.html#930" class="Generalizable">l′</a> <a id="1332" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="1334" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1336" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="1338" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="1340" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="1341" class="Symbol">)</a> <a id="1343" href="Deep.Ledger.html#1306" class="Bound">x</a>
<a id="1345" href="Deep.Ledger.html#1297" class="Function">comp</a> <a id="1350" class="Symbol">{</a><a id="1351" class="Argument">l</a> <a id="1353" class="Symbol">=</a> <a id="1355" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1357" class="Symbol">}</a>    <a id="1362" class="Symbol">{</a><a id="1363" href="Deep.Ledger.html#1363" class="Bound">l′</a><a id="1365" class="Symbol">}</a> <a id="1367" href="Deep.Ledger.html#1367" class="Bound">x</a> <a id="1369" class="Symbol">=</a> <a id="1371" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1376" href="Deep.Ledger.html#1297" class="Function">comp</a> <a id="1381" class="Symbol">{</a><a id="1382" class="Argument">l</a> <a id="1384" class="Symbol">=</a> <a id="1386" href="Deep.Ledger.html#1386" class="Bound">t</a> <a id="1388" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1390" href="Deep.Ledger.html#1390" class="Bound">l</a><a id="1391" class="Symbol">}</a> <a id="1393" class="Symbol">{</a><a id="1394" href="Deep.Ledger.html#1394" class="Bound">l′</a><a id="1396" class="Symbol">}</a> <a id="1398" href="Deep.Ledger.html#1398" class="Bound">x</a> <a id="1400" class="Keyword">rewrite</a> <a id="1408" href="Deep.Ledger.html#1297" class="Function">comp</a> <a id="1413" class="Symbol">{</a><a id="1414" href="Deep.Ledger.html#1390" class="Bound">l</a><a id="1415" class="Symbol">}{</a><a id="1417" href="Deep.Ledger.html#1394" class="Bound">l′</a><a id="1419" class="Symbol">}</a> <a id="1421" class="Symbol">(</a><a id="1422" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="1424" href="Deep.Ledger.html#1386" class="Bound">t</a> <a id="1426" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="1428" href="Deep.Ledger.html#1398" class="Bound">x</a><a id="1429" class="Symbol">)</a> <a id="1431" class="Symbol">=</a> <a id="1433" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1439" class="Comment">-- ** Operational semantics</a>

<a id="1468" class="Keyword">infix</a> <a id="1474" class="Number">0</a> <a id="1476" href="Deep.Ledger.html#1500" class="Datatype Operator">_—→_</a> <a id="1481" href="Deep.Ledger.html#1706" class="Datatype Operator">_—→⋆_</a> <a id="1487" href="Deep.Ledger.html#1868" class="Function Operator">_—→⋆′_</a>

<a id="1495" class="Keyword">data</a> <a id="_—→_"></a><a id="1500" href="Deep.Ledger.html#1500" class="Datatype Operator">_—→_</a> <a id="1505" class="Symbol">:</a> <a id="1507" href="Deep.Ledger.html#869" class="Function">L</a> <a id="1509" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1511" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1513" class="Symbol">→</a> <a id="1515" href="Deep.Ledger.html#869" class="Function">L</a> <a id="1517" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1519" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1521" class="Symbol">→</a> <a id="1523" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1527" class="Keyword">where</a>
  <a id="_—→_.singleStep"></a><a id="1535" href="Deep.Ledger.html#1535" class="InductiveConstructor">singleStep</a> <a id="1546" class="Symbol">:</a>
     <a id="1553" class="Comment">------------------------</a>
     <a id="1583" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="1585" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1587" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="1589" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1591" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="1593" href="Deep.Ledger.html#1500" class="Datatype Operator">—→</a> <a id="1596" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="1598" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1600" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="1602" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="1604" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="1606" href="Deep.Ledger.html#893" class="Generalizable">s</a>

<a id="1609" class="Keyword">data</a> <a id="_—→′_"></a><a id="1614" href="Deep.Ledger.html#1614" class="Datatype Operator">_—→′_</a> <a id="1620" class="Symbol">:</a> <a id="1622" href="Deep.Ledger.html#869" class="Function">L</a> <a id="1624" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1626" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1628" class="Symbol">→</a> <a id="1630" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1632" class="Symbol">→</a> <a id="1634" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1638" class="Keyword">where</a>
  <a id="_—→′_.finalStep"></a><a id="1646" href="Deep.Ledger.html#1646" class="InductiveConstructor">finalStep</a> <a id="1656" class="Symbol">:</a>
      <a id="1664" class="Comment">--------------</a>
      <a id="1685" class="Symbol">(</a><a id="1686" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1689" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1691" href="Deep.Ledger.html#893" class="Generalizable">s</a><a id="1692" class="Symbol">)</a> <a id="1694" href="Deep.Ledger.html#1614" class="Datatype Operator">—→′</a> <a id="1698" href="Deep.Ledger.html#893" class="Generalizable">s</a>

<a id="1701" class="Keyword">data</a> <a id="_—→⋆_"></a><a id="1706" href="Deep.Ledger.html#1706" class="Datatype Operator">_—→⋆_</a> <a id="1712" class="Symbol">:</a> <a id="1714" href="Deep.Ledger.html#869" class="Function">L</a> <a id="1716" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1718" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1720" class="Symbol">→</a> <a id="1722" href="Deep.Ledger.html#869" class="Function">L</a> <a id="1724" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1726" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1728" class="Symbol">→</a> <a id="1730" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1734" class="Keyword">where</a>
   <a id="_—→⋆_.base"></a><a id="1743" href="Deep.Ledger.html#1743" class="InductiveConstructor">base</a> <a id="1748" class="Symbol">:</a>
       <a id="1757" class="Comment">---------</a>
       <a id="1774" href="Deep.Ledger.html#948" class="Generalizable">ls</a> <a id="1777" href="Deep.Ledger.html#1706" class="Datatype Operator">—→⋆</a> <a id="1781" href="Deep.Ledger.html#948" class="Generalizable">ls</a>

   <a id="_—→⋆_.step"></a><a id="1788" href="Deep.Ledger.html#1788" class="InductiveConstructor">step</a> <a id="1793" class="Symbol">:</a>
       <a id="1802" href="Deep.Ledger.html#948" class="Generalizable">ls</a> <a id="1805" href="Deep.Ledger.html#1500" class="Datatype Operator">—→</a> <a id="1808" href="Deep.Ledger.html#951" class="Generalizable">ls′</a>
     <a id="1817" class="Symbol">→</a> <a id="1819" href="Deep.Ledger.html#951" class="Generalizable">ls′</a> <a id="1823" href="Deep.Ledger.html#1706" class="Datatype Operator">—→⋆</a> <a id="1827" href="Deep.Ledger.html#955" class="Generalizable">ls″</a>
       <a id="1838" class="Comment">----------</a>
     <a id="1854" class="Symbol">→</a> <a id="1856" href="Deep.Ledger.html#948" class="Generalizable">ls</a> <a id="1859" href="Deep.Ledger.html#1706" class="Datatype Operator">—→⋆</a> <a id="1863" href="Deep.Ledger.html#955" class="Generalizable">ls″</a>

<a id="_—→⋆′_"></a><a id="1868" href="Deep.Ledger.html#1868" class="Function Operator">_—→⋆′_</a> <a id="1875" class="Symbol">:</a> <a id="1877" href="Deep.Ledger.html#869" class="Function">L</a> <a id="1879" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1881" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1883" class="Symbol">→</a> <a id="1885" href="Deep.Ledger.html#677" class="Function">S</a> <a id="1887" class="Symbol">→</a> <a id="1889" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1893" href="Deep.Ledger.html#1893" class="Bound">ls</a> <a id="1896" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="1901" href="Deep.Ledger.html#1901" class="Bound">s</a> <a id="1903" class="Symbol">=</a> <a id="1905" href="Deep.Ledger.html#1893" class="Bound">ls</a> <a id="1908" href="Deep.Ledger.html#1706" class="Datatype Operator">—→⋆</a> <a id="1912" class="Symbol">(</a><a id="1913" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1916" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1918" href="Deep.Ledger.html#1901" class="Bound">s</a><a id="1919" class="Symbol">)</a>

<a id="comp′"></a><a id="1922" href="Deep.Ledger.html#1922" class="Function">comp′</a> <a id="1928" class="Symbol">:</a>
    <a id="1934" href="Deep.Ledger.html#928" class="Generalizable">l</a>       <a id="1942" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1944" href="Deep.Ledger.html#893" class="Generalizable">s</a>  <a id="1947" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="1952" href="Deep.Ledger.html#895" class="Generalizable">s′</a>
  <a id="1957" class="Symbol">→</a> <a id="1959" href="Deep.Ledger.html#930" class="Generalizable">l′</a>      <a id="1967" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1969" href="Deep.Ledger.html#895" class="Generalizable">s′</a> <a id="1972" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="1977" href="Deep.Ledger.html#898" class="Generalizable">s″</a>
  <a id="1982" class="Symbol">→</a> <a id="1984" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="1986" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="1989" href="Deep.Ledger.html#930" class="Generalizable">l′</a> <a id="1992" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1994" href="Deep.Ledger.html#893" class="Generalizable">s</a>  <a id="1997" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="2002" href="Deep.Ledger.html#898" class="Generalizable">s″</a>
<a id="2005" href="Deep.Ledger.html#1922" class="Function">comp′</a> <a id="2011" class="Symbol">{</a><a id="2012" class="Argument">l</a> <a id="2014" class="Symbol">=</a> <a id="2016" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2018" class="Symbol">}</a>    <a id="2023" href="Deep.Ledger.html#1743" class="InductiveConstructor">base</a>                   <a id="2046" href="Deep.Ledger.html#2046" class="Bound">s′→s″</a> <a id="2052" class="Symbol">=</a> <a id="2054" href="Deep.Ledger.html#2046" class="Bound">s′→s″</a>
<a id="2060" href="Deep.Ledger.html#1922" class="Function">comp′</a> <a id="2066" class="Symbol">{</a><a id="2067" class="Argument">l</a> <a id="2069" class="Symbol">=</a> <a id="2071" class="Symbol">_</a> <a id="2073" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2075" class="Symbol">_}</a> <a id="2078" class="Symbol">(</a><a id="2079" href="Deep.Ledger.html#1788" class="InductiveConstructor">step</a> <a id="2084" href="Deep.Ledger.html#1535" class="InductiveConstructor">singleStep</a> <a id="2095" href="Deep.Ledger.html#2095" class="Bound">s→s′</a><a id="2099" class="Symbol">)</a> <a id="2101" href="Deep.Ledger.html#2101" class="Bound">s′→s″</a> <a id="2107" class="Symbol">=</a> <a id="2109" href="Deep.Ledger.html#1788" class="InductiveConstructor">step</a> <a id="2114" href="Deep.Ledger.html#1535" class="InductiveConstructor">singleStep</a> <a id="2125" class="Symbol">(</a><a id="2126" href="Deep.Ledger.html#1922" class="Function">comp′</a> <a id="2132" href="Deep.Ledger.html#2095" class="Bound">s→s′</a> <a id="2137" href="Deep.Ledger.html#2101" class="Bound">s′→s″</a><a id="2142" class="Symbol">)</a>

<a id="oper-base⋆"></a><a id="2145" href="Deep.Ledger.html#2145" class="Function">oper-base⋆</a> <a id="2156" class="Symbol">:</a> <a id="2158" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="2160" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2162" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="2164" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="2169" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="2171" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="2173" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="2175" href="Deep.Ledger.html#893" class="Generalizable">s</a>
<a id="2177" href="Deep.Ledger.html#2145" class="Function">oper-base⋆</a> <a id="2188" class="Symbol">{</a><a id="2189" class="Argument">l</a> <a id="2191" class="Symbol">=</a> <a id="2193" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2195" class="Symbol">}</a>    <a id="2200" class="Symbol">=</a> <a id="2202" href="Deep.Ledger.html#1743" class="InductiveConstructor">base</a>
<a id="2207" href="Deep.Ledger.html#2145" class="Function">oper-base⋆</a> <a id="2218" class="Symbol">{</a><a id="2219" class="Argument">l</a> <a id="2221" class="Symbol">=</a> <a id="2223" class="Symbol">_</a> <a id="2225" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2227" class="Symbol">_}</a> <a id="2230" class="Symbol">=</a> <a id="2232" href="Deep.Ledger.html#1788" class="InductiveConstructor">step</a> <a id="2237" href="Deep.Ledger.html#1535" class="InductiveConstructor">singleStep</a> <a id="2248" href="Deep.Ledger.html#2145" class="Function">oper-base⋆</a>

<a id="2260" class="Comment">-- ** Relating denotational and operational semantics</a>

<a id="denot⇔oper"></a><a id="2315" href="Deep.Ledger.html#2315" class="Function">denot⇔oper</a> <a id="2326" class="Symbol">:</a> <a id="2328" class="Symbol">(</a><a id="2329" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="2331" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="2333" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="2335" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="2337" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2339" href="Deep.Ledger.html#895" class="Generalizable">s′</a><a id="2341" class="Symbol">)</a> <a id="2343" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="2345" class="Symbol">(</a><a id="2346" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="2348" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2350" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="2352" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="2357" href="Deep.Ledger.html#895" class="Generalizable">s′</a><a id="2359" class="Symbol">)</a>
<a id="2361" href="Deep.Ledger.html#2315" class="Function">denot⇔oper</a> <a id="2372" class="Symbol">=</a> <a id="2374" href="Deep.Ledger.html#2410" class="Function">denot→oper</a> <a id="2385" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2387" href="Deep.Ledger.html#2568" class="Function">oper→denot</a>
  <a id="2400" class="Keyword">where</a>
    <a id="2410" href="Deep.Ledger.html#2410" class="Function">denot→oper</a> <a id="2421" class="Symbol">:</a> <a id="2423" class="Symbol">(</a><a id="2424" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="2426" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="2428" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="2430" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="2432" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2434" href="Deep.Ledger.html#895" class="Generalizable">s′</a><a id="2436" class="Symbol">)</a> <a id="2438" class="Symbol">→</a> <a id="2440" class="Symbol">(</a><a id="2441" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="2443" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2445" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="2447" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="2452" href="Deep.Ledger.html#895" class="Generalizable">s′</a><a id="2454" class="Symbol">)</a>
    <a id="2460" href="Deep.Ledger.html#2410" class="Function">denot→oper</a> <a id="2471" class="Symbol">{</a><a id="2472" class="Argument">l</a> <a id="2474" class="Symbol">=</a> <a id="2476" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2478" class="Symbol">}</a>    <a id="2483" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2488" class="Symbol">=</a> <a id="2490" href="Deep.Ledger.html#1743" class="InductiveConstructor">base</a>
    <a id="2499" href="Deep.Ledger.html#2410" class="Function">denot→oper</a> <a id="2510" class="Symbol">{</a><a id="2511" class="Argument">l</a> <a id="2513" class="Symbol">=</a> <a id="2515" class="Symbol">_</a> <a id="2517" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2519" class="Symbol">_}</a> <a id="2522" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2527" class="Symbol">=</a> <a id="2529" href="Deep.Ledger.html#1788" class="InductiveConstructor">step</a> <a id="2534" href="Deep.Ledger.html#1535" class="InductiveConstructor">singleStep</a> <a id="2545" class="Symbol">(</a><a id="2546" href="Deep.Ledger.html#2410" class="Function">denot→oper</a> <a id="2557" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2561" class="Symbol">)</a>

    <a id="2568" href="Deep.Ledger.html#2568" class="Function">oper→denot</a> <a id="2579" class="Symbol">:</a> <a id="2581" class="Symbol">(</a><a id="2582" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="2584" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2586" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="2588" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="2593" href="Deep.Ledger.html#895" class="Generalizable">s′</a><a id="2595" class="Symbol">)</a> <a id="2597" class="Symbol">→</a> <a id="2599" class="Symbol">(</a><a id="2600" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="2602" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="2604" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="2606" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="2608" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2610" href="Deep.Ledger.html#895" class="Generalizable">s′</a><a id="2612" class="Symbol">)</a>
    <a id="2618" href="Deep.Ledger.html#2568" class="Function">oper→denot</a> <a id="2629" class="Symbol">{</a><a id="2630" class="Argument">l</a> <a id="2632" class="Symbol">=</a> <a id="2634" class="DottedPattern Symbol">.</a><a id="2635" href="Agda.Builtin.List.html#185" class="DottedPattern InductiveConstructor">[]</a><a id="2637" class="Symbol">}</a>   <a id="2641" href="Deep.Ledger.html#1743" class="InductiveConstructor">base</a>                <a id="2661" class="Symbol">=</a> <a id="2663" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="2672" href="Deep.Ledger.html#2568" class="Function">oper→denot</a> <a id="2683" class="Symbol">{</a><a id="2684" class="Argument">l</a> <a id="2686" class="Symbol">=</a> <a id="2688" class="Symbol">_</a> <a id="2690" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2692" class="Symbol">_}</a> <a id="2695" class="Symbol">(</a><a id="2696" href="Deep.Ledger.html#1788" class="InductiveConstructor">step</a> <a id="2701" href="Deep.Ledger.html#1535" class="InductiveConstructor">singleStep</a> <a id="2712" href="Deep.Ledger.html#2712" class="Bound">p</a><a id="2713" class="Symbol">)</a> <a id="2715" class="Symbol">=</a> <a id="2717" href="Deep.Ledger.html#2568" class="Function">oper→denot</a> <a id="2728" href="Deep.Ledger.html#2712" class="Bound">p</a>

<a id="2731" class="Comment">-- ** Axiomatic semantics</a>

<a id="Predˢ"></a><a id="2758" href="Deep.Ledger.html#2758" class="Function">Predˢ</a> <a id="2764" class="Symbol">=</a> <a id="2766" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="2771" href="Deep.Ledger.html#677" class="Function">S</a> <a id="2773" href="Level.html#512" class="Function">0ℓ</a>
<a id="2776" class="Comment">{-
-- the shallow embedding of predicates seems to break here..
-- ..we really need to get ahold of the actual variables, i.e. from a deeply-embedded DSL
fv : Predˢ → Set⟨ Part ⟩
fv P = {!!}
-}</a>

<a id="2971" class="Keyword">data</a> <a id="Assertion"></a><a id="2976" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="2986" class="Symbol">:</a> <a id="2988" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2992" class="Keyword">where</a>
  <a id="Assertion.`emp"></a><a id="3000" href="Deep.Ledger.html#3000" class="InductiveConstructor">`emp</a> <a id="Assertion.`⊥"></a><a id="3005" href="Deep.Ledger.html#3005" class="InductiveConstructor">`⊥</a> <a id="3008" class="Symbol">:</a> <a id="3010" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a>
  <a id="3022" class="Comment">-- _`≡_ : ℤ → ℤ → Assertion</a>
  <a id="Assertion._`↦_"></a><a id="3052" href="Deep.Ledger.html#3052" class="InductiveConstructor Operator">_`↦_</a> <a id="3057" class="Symbol">:</a> <a id="3059" href="Deep.Ledger.html#433" class="Bound">Part</a> <a id="3064" class="Symbol">→</a> <a id="3066" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="3068" class="Symbol">→</a> <a id="3070" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a>
  <a id="Assertion._`∗_"></a><a id="3082" href="Deep.Ledger.html#3082" class="InductiveConstructor Operator">_`∗_</a> <a id="Assertion._`—∗_"></a><a id="3087" href="Deep.Ledger.html#3087" class="InductiveConstructor Operator">_`—∗_</a> <a id="3093" class="Symbol">:</a> <a id="3095" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="3105" class="Symbol">→</a> <a id="3107" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="3117" class="Symbol">→</a> <a id="3119" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a>
  <a id="Assertion._`∘_"></a><a id="3131" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">_`∘_</a> <a id="3136" class="Symbol">:</a> <a id="3138" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="3148" class="Symbol">→</a> <a id="3150" class="Symbol">(</a><a id="3151" href="Deep.Ledger.html#677" class="Function">S</a> <a id="3153" class="Symbol">→</a> <a id="3155" href="Deep.Ledger.html#677" class="Function">S</a><a id="3156" class="Symbol">)</a> <a id="3158" class="Symbol">→</a> <a id="3160" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a>

<a id="3171" class="Keyword">infixr</a> <a id="3178" class="Number">9</a> <a id="3180" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">_`∘_</a>

<a id="fv"></a><a id="3186" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3189" class="Symbol">:</a> <a id="3191" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="3201" class="Symbol">→</a> <a id="3203" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="3208" href="Deep.Ledger.html#433" class="Bound">Part</a> <a id="3213" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>
<a id="3215" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3218" href="Deep.Ledger.html#3000" class="InductiveConstructor">`emp</a>      <a id="3228" class="Symbol">=</a> <a id="3230" href="Prelude.Sets.AsUniqueLists.Core.html#2455" class="InductiveConstructor">∅</a>
<a id="3232" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3235" href="Deep.Ledger.html#3005" class="InductiveConstructor">`⊥</a>        <a id="3245" class="Symbol">=</a> <a id="3247" href="Prelude.Sets.AsUniqueLists.Core.html#2455" class="InductiveConstructor">∅</a>
<a id="3249" class="Comment">-- fv (_ `≡ _) = ∅</a>
<a id="3268" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3271" class="Symbol">(</a><a id="3272" href="Deep.Ledger.html#3272" class="Bound">p</a> <a id="3274" href="Deep.Ledger.html#3052" class="InductiveConstructor Operator">`↦</a> <a id="3277" class="Symbol">_)</a>  <a id="3281" class="Symbol">=</a> <a id="3283" href="Prelude.Sets.AsUniqueLists.Core.html#2468" class="Function">singleton</a> <a id="3293" href="Deep.Ledger.html#3272" class="Bound">p</a>
<a id="3295" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3298" class="Symbol">(</a><a id="3299" href="Deep.Ledger.html#3299" class="Bound">P</a> <a id="3301" href="Deep.Ledger.html#3082" class="InductiveConstructor Operator">`∗</a> <a id="3304" href="Deep.Ledger.html#3304" class="Bound">Q</a><a id="3305" class="Symbol">)</a>  <a id="3308" class="Symbol">=</a> <a id="3310" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3313" href="Deep.Ledger.html#3299" class="Bound">P</a> <a id="3315" href="Prelude.Sets.AsUniqueLists.Core.html#2765" class="Function Operator">∪</a> <a id="3317" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3320" href="Deep.Ledger.html#3304" class="Bound">Q</a>
<a id="3322" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3325" class="Symbol">(</a><a id="3326" href="Deep.Ledger.html#3326" class="Bound">P</a> <a id="3328" href="Deep.Ledger.html#3087" class="InductiveConstructor Operator">`—∗</a> <a id="3332" href="Deep.Ledger.html#3332" class="Bound">Q</a><a id="3333" class="Symbol">)</a> <a id="3335" class="Symbol">=</a> <a id="3337" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3340" href="Deep.Ledger.html#3326" class="Bound">P</a> <a id="3342" href="Prelude.Sets.AsUniqueLists.Core.html#2765" class="Function Operator">∪</a> <a id="3344" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3347" href="Deep.Ledger.html#3332" class="Bound">Q</a>
<a id="3349" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3352" class="Symbol">(</a><a id="3353" href="Deep.Ledger.html#3353" class="Bound">P</a> <a id="3355" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="3358" class="Symbol">_)</a>  <a id="3362" class="Symbol">=</a> <a id="3364" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="3367" href="Deep.Ledger.html#3353" class="Bound">P</a>

<a id="emp"></a><a id="3370" href="Deep.Ledger.html#3370" class="Function">emp</a> <a id="3374" class="Symbol">:</a> <a id="3376" href="Deep.Ledger.html#2758" class="Function">Predˢ</a>
<a id="3382" href="Deep.Ledger.html#3370" class="Function">emp</a> <a id="3386" href="Deep.Ledger.html#3386" class="Bound">s</a> <a id="3388" class="Symbol">=</a> <a id="3390" class="Symbol">∀</a> <a id="3392" href="Deep.Ledger.html#3392" class="Bound">k</a> <a id="3394" class="Symbol">→</a> <a id="3396" href="Deep.Ledger.html#3392" class="Bound">k</a> <a id="3398" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3401" href="Deep.Ledger.html#3386" class="Bound">s</a>

<a id="_♯_←_"></a><a id="3404" href="Deep.Ledger.html#3404" class="Function Operator">_♯_←_</a> <a id="3410" class="Symbol">:</a> <a id="3412" href="Deep.Ledger.html#677" class="Function">S</a> <a id="3414" class="Symbol">→</a> <a id="3416" href="Deep.Ledger.html#677" class="Function">S</a> <a id="3418" class="Symbol">→</a> <a id="3420" href="Deep.Ledger.html#677" class="Function">S</a> <a id="3422" class="Symbol">→</a> <a id="3424" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3428" href="Deep.Ledger.html#3428" class="Bound">s₁</a> <a id="3431" href="Deep.Ledger.html#3404" class="Function Operator">♯</a> <a id="3433" href="Deep.Ledger.html#3433" class="Bound">s₂</a> <a id="3436" href="Deep.Ledger.html#3404" class="Function Operator">←</a> <a id="3438" href="Deep.Ledger.html#3438" class="Bound">s</a> <a id="3440" class="Symbol">=</a> <a id="3442" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟨</a> <a id="3444" href="Deep.Ledger.html#3428" class="Bound">s₁</a> <a id="3447" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⊎</a> <a id="3449" href="Deep.Ledger.html#3433" class="Bound">s₂</a> <a id="3452" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟩≡</a> <a id="3455" href="Deep.Ledger.html#3438" class="Bound">s</a>

<a id="_∗_"></a><a id="3458" href="Deep.Ledger.html#3458" class="Function Operator">_∗_</a> <a id="3462" class="Symbol">:</a> <a id="3464" href="Deep.Ledger.html#2758" class="Function">Predˢ</a> <a id="3470" class="Symbol">→</a> <a id="3472" href="Deep.Ledger.html#2758" class="Function">Predˢ</a> <a id="3478" class="Symbol">→</a> <a id="3480" href="Deep.Ledger.html#2758" class="Function">Predˢ</a>
<a id="3486" class="Symbol">(</a><a id="3487" href="Deep.Ledger.html#3487" class="Bound">P</a> <a id="3489" href="Deep.Ledger.html#3458" class="Function Operator">∗</a> <a id="3491" href="Deep.Ledger.html#3491" class="Bound">Q</a><a id="3492" class="Symbol">)</a> <a id="3494" href="Deep.Ledger.html#3494" class="Bound">s</a> <a id="3496" class="Symbol">=</a> <a id="3498" href="Data.Product.html#1369" class="Function">∃</a> <a id="3500" class="Symbol">λ</a> <a id="3502" href="Deep.Ledger.html#3502" class="Bound">s₁</a> <a id="3505" class="Symbol">→</a> <a id="3507" href="Data.Product.html#1369" class="Function">∃</a> <a id="3509" class="Symbol">λ</a> <a id="3511" href="Deep.Ledger.html#3511" class="Bound">s₂</a> <a id="3514" class="Symbol">→</a> <a id="3516" class="Symbol">(</a><a id="3517" href="Deep.Ledger.html#3502" class="Bound">s₁</a> <a id="3520" href="Deep.Ledger.html#3404" class="Function Operator">♯</a> <a id="3522" href="Deep.Ledger.html#3511" class="Bound">s₂</a> <a id="3525" href="Deep.Ledger.html#3404" class="Function Operator">←</a> <a id="3527" href="Deep.Ledger.html#3494" class="Bound">s</a><a id="3528" class="Symbol">)</a> <a id="3530" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3532" href="Deep.Ledger.html#3487" class="Bound">P</a> <a id="3534" href="Deep.Ledger.html#3502" class="Bound">s₁</a> <a id="3537" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3539" href="Deep.Ledger.html#3491" class="Bound">Q</a> <a id="3541" href="Deep.Ledger.html#3511" class="Bound">s₂</a>

<a id="_—∗_"></a><a id="3545" href="Deep.Ledger.html#3545" class="Function Operator">_—∗_</a> <a id="3550" class="Symbol">:</a> <a id="3552" href="Deep.Ledger.html#2758" class="Function">Predˢ</a> <a id="3558" class="Symbol">→</a> <a id="3560" href="Deep.Ledger.html#2758" class="Function">Predˢ</a> <a id="3566" class="Symbol">→</a> <a id="3568" href="Deep.Ledger.html#2758" class="Function">Predˢ</a>
<a id="3574" class="Symbol">(</a><a id="3575" href="Deep.Ledger.html#3575" class="Bound">P</a> <a id="3577" href="Deep.Ledger.html#3545" class="Function Operator">—∗</a> <a id="3580" href="Deep.Ledger.html#3580" class="Bound">Q</a><a id="3581" class="Symbol">)</a> <a id="3583" href="Deep.Ledger.html#3583" class="Bound">s</a> <a id="3585" class="Symbol">=</a> <a id="3587" class="Symbol">∀</a> <a id="3589" href="Deep.Ledger.html#3589" class="Bound">s′</a> <a id="3592" class="Symbol">→</a> <a id="3594" href="Deep.Ledger.html#3589" class="Bound">s′</a> <a id="3597" href="Prelude.Apartness.html#237" class="Field Operator">♯</a> <a id="3599" href="Deep.Ledger.html#3583" class="Bound">s</a> <a id="3601" class="Symbol">→</a> <a id="3603" href="Deep.Ledger.html#3575" class="Bound">P</a> <a id="3605" href="Deep.Ledger.html#3589" class="Bound">s′</a> <a id="3608" class="Symbol">→</a> <a id="3610" href="Deep.Ledger.html#3580" class="Bound">Q</a> <a id="3612" class="Symbol">(</a><a id="3613" href="Deep.Ledger.html#3583" class="Bound">s</a> <a id="3615" href="Deep.Ledger.html#275" class="Function Operator">∪ᵐ</a> <a id="3618" href="Deep.Ledger.html#3589" class="Bound">s′</a><a id="3620" class="Symbol">)</a>

<a id="⟦_⟧ᵖ"></a><a id="3623" href="Deep.Ledger.html#3623" class="Function Operator">⟦_⟧ᵖ</a> <a id="3628" class="Symbol">:</a> <a id="3630" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="3640" class="Symbol">→</a> <a id="3642" href="Deep.Ledger.html#2758" class="Function">Predˢ</a>
<a id="3648" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3650" href="Deep.Ledger.html#3000" class="InductiveConstructor">`emp</a>    <a id="3658" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3661" class="Symbol">=</a> <a id="3663" href="Deep.Ledger.html#3370" class="Function">emp</a>
<a id="3667" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3669" href="Deep.Ledger.html#3005" class="InductiveConstructor">`⊥</a>      <a id="3677" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3680" class="Symbol">=</a> <a id="3682" href="Function.Base.html#636" class="Function">const</a> <a id="3688" href="Data.Empty.html#526" class="Datatype">⊥</a>
<a id="3690" class="Comment">-- ⟦ x `≡ y  ⟧ᵖ = {!!}</a>
<a id="3713" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3715" href="Deep.Ledger.html#3715" class="Bound">p</a> <a id="3717" href="Deep.Ledger.html#3052" class="InductiveConstructor Operator">`↦</a> <a id="3720" href="Deep.Ledger.html#3720" class="Bound">n</a>  <a id="3723" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3726" class="Symbol">=</a> <a id="3728" href="Prelude.Maps.Abstract.Interface.html#1682" class="Function Operator">_[</a> <a id="3731" href="Deep.Ledger.html#3715" class="Bound">p</a> <a id="3733" href="Prelude.Maps.Abstract.Interface.html#1682" class="Function Operator">↦</a> <a id="3735" href="Deep.Ledger.html#3720" class="Bound">n</a> <a id="3737" href="Prelude.Maps.Abstract.Interface.html#1682" class="Function Operator">]</a>
<a id="3739" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3741" href="Deep.Ledger.html#3741" class="Bound">P</a> <a id="3743" href="Deep.Ledger.html#3082" class="InductiveConstructor Operator">`∗</a> <a id="3746" href="Deep.Ledger.html#3746" class="Bound">Q</a>  <a id="3749" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3752" class="Symbol">=</a> <a id="3754" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3756" href="Deep.Ledger.html#3741" class="Bound">P</a> <a id="3758" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3761" href="Deep.Ledger.html#3458" class="Function Operator">∗</a> <a id="3763" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3765" href="Deep.Ledger.html#3746" class="Bound">Q</a> <a id="3767" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a>
<a id="3770" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3772" href="Deep.Ledger.html#3772" class="Bound">P</a> <a id="3774" href="Deep.Ledger.html#3087" class="InductiveConstructor Operator">`—∗</a> <a id="3778" href="Deep.Ledger.html#3778" class="Bound">Q</a> <a id="3780" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3783" class="Symbol">=</a> <a id="3785" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3787" href="Deep.Ledger.html#3772" class="Bound">P</a> <a id="3789" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3792" href="Deep.Ledger.html#3545" class="Function Operator">—∗</a> <a id="3795" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3797" href="Deep.Ledger.html#3778" class="Bound">Q</a> <a id="3799" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a>
<a id="3802" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3804" href="Deep.Ledger.html#3804" class="Bound">P</a> <a id="3806" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="3809" href="Deep.Ledger.html#3809" class="Bound">f</a>  <a id="3812" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3815" class="Symbol">=</a> <a id="3817" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3819" href="Deep.Ledger.html#3804" class="Bound">P</a> <a id="3821" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3824" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3826" href="Deep.Ledger.html#3809" class="Bound">f</a>

<a id="3829" class="Keyword">infix</a> <a id="3835" class="Number">1</a> <a id="3837" href="Deep.Ledger.html#3842" class="Function Operator">_`⊢_</a>
<a id="_`⊢_"></a><a id="3842" href="Deep.Ledger.html#3842" class="Function Operator">_`⊢_</a> <a id="3847" class="Symbol">:</a> <a id="3849" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="3859" class="Symbol">→</a> <a id="3861" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="3871" class="Symbol">→</a> <a id="3873" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3877" href="Deep.Ledger.html#3877" class="Bound">P</a> <a id="3879" href="Deep.Ledger.html#3842" class="Function Operator">`⊢</a> <a id="3882" href="Deep.Ledger.html#3882" class="Bound">Q</a> <a id="3884" class="Symbol">=</a> <a id="3886" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3888" href="Deep.Ledger.html#3877" class="Bound">P</a> <a id="3890" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3893" href="Prelude.General.html#1347" class="Function Operator">⊢</a> <a id="3895" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3897" href="Deep.Ledger.html#3882" class="Bound">Q</a> <a id="3899" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a>

<a id="_∙_"></a><a id="3903" href="Deep.Ledger.html#3903" class="Function Operator">_∙_</a> <a id="3907" class="Symbol">:</a> <a id="3909" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="3919" class="Symbol">→</a> <a id="3921" href="Deep.Ledger.html#677" class="Function">S</a> <a id="3923" class="Symbol">→</a> <a id="3925" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3929" href="Deep.Ledger.html#3929" class="Bound">P</a> <a id="3931" href="Deep.Ledger.html#3903" class="Function Operator">∙</a> <a id="3933" href="Deep.Ledger.html#3933" class="Bound">s</a> <a id="3935" class="Symbol">=</a> <a id="3937" href="Deep.Ledger.html#3623" class="Function Operator">⟦</a> <a id="3939" href="Deep.Ledger.html#3929" class="Bound">P</a> <a id="3941" href="Deep.Ledger.html#3623" class="Function Operator">⟧ᵖ</a> <a id="3944" href="Deep.Ledger.html#3933" class="Bound">s</a>

<a id="3947" class="Keyword">variable</a>
  <a id="3958" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="3960" href="Deep.Ledger.html#3960" class="Generalizable">P′</a> <a id="3963" href="Deep.Ledger.html#3963" class="Generalizable">P₁</a> <a id="3966" href="Deep.Ledger.html#3966" class="Generalizable">P₂</a> <a id="3969" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="3971" href="Deep.Ledger.html#3971" class="Generalizable">Q′</a> <a id="3974" href="Deep.Ledger.html#3974" class="Generalizable">Q₁</a> <a id="3977" href="Deep.Ledger.html#3977" class="Generalizable">Q₂</a> <a id="3980" href="Deep.Ledger.html#3980" class="Generalizable">R</a> <a id="3982" class="Symbol">:</a> <a id="3984" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a>

<a id="3995" class="Keyword">data</a> <a id="⟨_⟩_⟨_⟩"></a><a id="4000" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨_⟩_⟨_⟩</a> <a id="4008" class="Symbol">:</a> <a id="4010" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="4020" class="Symbol">→</a> <a id="4022" href="Deep.Ledger.html#869" class="Function">L</a> <a id="4024" class="Symbol">→</a> <a id="4026" href="Deep.Ledger.html#2976" class="Datatype">Assertion</a> <a id="4036" class="Symbol">→</a> <a id="4038" href="Agda.Primitive.html#326" class="Primitive">Set₁</a> <a id="4043" class="Keyword">where</a>

  <a id="⟨_⟩_⟨_⟩.base"></a><a id="4052" href="Deep.Ledger.html#4052" class="InductiveConstructor">base</a> <a id="4057" class="Symbol">:</a>
    <a id="4063" class="Comment">--</a>
    <a id="4070" class="Comment">------------</a>
    <a id="4087" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4089" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="4091" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="4093" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4096" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4098" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="4100" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>
  <a id="4104" class="Comment">--   -------------------------</a>
  <a id="4137" class="Comment">--   ⟨ P ∘ ⟦ t ⟧ ⟩ [ t ] ⟨ P ⟩</a>

  <a id="⟨_⟩_⟨_⟩.step"></a><a id="4171" href="Deep.Ledger.html#4171" class="InductiveConstructor">step</a> <a id="4176" class="Symbol">:</a>
      <a id="4184" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4186" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="4188" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="4190" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="4192" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4194" href="Deep.Ledger.html#3980" class="Generalizable">R</a> <a id="4196" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>
      <a id="4204" class="Comment">-------------------------</a>
    <a id="4234" class="Symbol">→</a> <a id="4236" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4238" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="4240" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="4243" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4245" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="4247" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="4249" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="4251" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="4253" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4255" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="4257" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4259" href="Deep.Ledger.html#3980" class="Generalizable">R</a> <a id="4261" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>
  <a id="4265" class="Comment">--     ⟨ P ⟩ l  ⟨ Q ⟩</a>
  <a id="4289" class="Comment">--   → ⟨ Q ⟩ l′ ⟨ R ⟩</a>
  <a id="4313" class="Comment">--     -------------------</a>
  <a id="4342" class="Comment">--   → ⟨ P ⟩ l ++ l′ ⟨ R ⟩</a>

  <a id="⟨_⟩_⟨_⟩.weaken-strengthen"></a><a id="4372" href="Deep.Ledger.html#4372" class="InductiveConstructor">weaken-strengthen</a> <a id="4390" class="Symbol">:</a>

      <a id="4399" href="Deep.Ledger.html#3960" class="Generalizable">P′</a> <a id="4402" href="Deep.Ledger.html#3842" class="Function Operator">`⊢</a> <a id="4405" href="Deep.Ledger.html#3958" class="Generalizable">P</a>
    <a id="4411" class="Symbol">→</a> <a id="4413" href="Deep.Ledger.html#3969" class="Generalizable">Q</a>  <a id="4416" href="Deep.Ledger.html#3842" class="Function Operator">`⊢</a> <a id="4419" href="Deep.Ledger.html#3971" class="Generalizable">Q′</a>
    <a id="4426" class="Symbol">→</a> <a id="4428" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4430" href="Deep.Ledger.html#3958" class="Generalizable">P</a>  <a id="4433" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="4435" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="4437" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4439" href="Deep.Ledger.html#3969" class="Generalizable">Q</a>  <a id="4442" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>
      <a id="4450" class="Comment">---------------</a>
    <a id="4470" class="Symbol">→</a> <a id="4472" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4474" href="Deep.Ledger.html#3960" class="Generalizable">P′</a> <a id="4477" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="4479" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="4481" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4483" href="Deep.Ledger.html#3971" class="Generalizable">Q′</a> <a id="4486" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>

<a id="4489" class="Comment">-- utilities</a>
<a id="axiom-base⋆"></a><a id="4502" href="Deep.Ledger.html#4502" class="Function">axiom-base⋆</a> <a id="4514" class="Symbol">:</a> <a id="4516" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4518" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="4520" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="4523" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4525" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="4527" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="4529" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="4531" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="4533" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="4535" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="4537" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>
<a id="4539" href="Deep.Ledger.html#4502" class="Function">axiom-base⋆</a> <a id="4551" class="Symbol">{</a><a id="4552" class="Argument">P</a> <a id="4554" class="Symbol">=</a> <a id="4556" href="Deep.Ledger.html#4556" class="Bound">P</a><a id="4557" class="Symbol">}</a> <a id="4559" class="Symbol">{</a><a id="4560" class="Argument">l</a> <a id="4562" class="Symbol">=</a> <a id="4564" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4566" class="Symbol">}</a>    <a id="4571" class="Symbol">=</a> <a id="4573" href="Deep.Ledger.html#4372" class="InductiveConstructor">weaken-strengthen</a> <a id="4591" class="Symbol">{</a><a id="4592" class="Argument">P</a> <a id="4594" class="Symbol">=</a> <a id="4596" href="Deep.Ledger.html#4556" class="Bound">P</a><a id="4597" class="Symbol">}</a> <a id="4599" href="Function.Base.html#615" class="Function">id</a> <a id="4602" href="Function.Base.html#615" class="Function">id</a> <a id="4605" href="Deep.Ledger.html#4052" class="InductiveConstructor">base</a>
<a id="4610" href="Deep.Ledger.html#4502" class="Function">axiom-base⋆</a> <a id="4622" class="Symbol">{</a><a id="4623" class="Argument">P</a> <a id="4625" class="Symbol">=</a> <a id="4627" href="Deep.Ledger.html#4627" class="Bound">P</a><a id="4628" class="Symbol">}</a> <a id="4630" class="Symbol">{</a><a id="4631" class="Argument">l</a> <a id="4633" class="Symbol">=</a> <a id="4635" href="Deep.Ledger.html#4635" class="Bound">t</a> <a id="4637" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4639" href="Deep.Ledger.html#4639" class="Bound">l</a><a id="4640" class="Symbol">}</a> <a id="4642" class="Symbol">=</a> <a id="4644" href="Deep.Ledger.html#4372" class="InductiveConstructor">weaken-strengthen</a> <a id="4662" class="Symbol">{</a><a id="4663" class="Argument">P</a> <a id="4665" class="Symbol">=</a> <a id="4667" class="Symbol">(</a><a id="4668" href="Deep.Ledger.html#4627" class="Bound">P</a> <a id="4670" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="4673" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4675" href="Deep.Ledger.html#4639" class="Bound">l</a> <a id="4677" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="4678" class="Symbol">)</a> <a id="4680" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="4683" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4685" href="Deep.Ledger.html#4635" class="Bound">t</a> <a id="4687" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="4688" class="Symbol">}</a> <a id="4690" href="Function.Base.html#615" class="Function">id</a> <a id="4693" href="Function.Base.html#615" class="Function">id</a> <a id="4696" class="Symbol">(</a><a id="4697" href="Deep.Ledger.html#4171" class="InductiveConstructor">step</a> <a id="4702" href="Deep.Ledger.html#4502" class="Function">axiom-base⋆</a><a id="4713" class="Symbol">)</a>

<a id="⟦⟧-comm"></a><a id="4716" href="Deep.Ledger.html#4716" class="Function">⟦⟧-comm</a> <a id="4724" class="Symbol">:</a> <a id="4726" class="Symbol">(</a><a id="4727" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4729" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="4731" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="4733" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4735" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4737" href="Deep.Ledger.html#915" class="Generalizable">t′</a> <a id="4740" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="4741" class="Symbol">)</a> <a id="4743" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="4745" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4747" class="Symbol">(</a><a id="4748" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4750" href="Deep.Ledger.html#915" class="Generalizable">t′</a> <a id="4753" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="4755" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4757" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4759" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="4761" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="4762" class="Symbol">)</a> <a id="4764" href="Deep.Ledger.html#893" class="Generalizable">s</a>
<a id="4766" href="Deep.Ledger.html#4716" class="Function">⟦⟧-comm</a> <a id="4774" class="Symbol">{</a><a id="4775" class="Argument">t</a> <a id="4777" class="Symbol">=</a> <a id="4779" href="Deep.Ledger.html#4779" class="Bound">A</a> <a id="4781" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">—→⟨</a> <a id="4785" href="Deep.Ledger.html#4785" class="Bound">n</a> <a id="4787" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">⟩</a> <a id="4789" href="Deep.Ledger.html#4789" class="Bound">B</a><a id="4790" class="Symbol">}{</a><a id="4792" class="Argument">t′</a> <a id="4795" class="Symbol">=</a> <a id="4797" href="Deep.Ledger.html#4797" class="Bound">A′</a> <a id="4800" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">—→⟨</a> <a id="4804" href="Deep.Ledger.html#4804" class="Bound">n′</a> <a id="4807" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">⟩</a> <a id="4809" href="Deep.Ledger.html#4809" class="Bound">B′</a><a id="4811" class="Symbol">}</a> <a id="4813" class="Symbol">=</a> <a id="4815" class="Hole">{!!}</a>

<a id="denot-comm"></a><a id="4821" href="Deep.Ledger.html#4821" class="Function">denot-comm</a> <a id="4832" class="Symbol">:</a> <a id="4834" class="Symbol">(</a><a id="4835" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4837" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="4839" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="4841" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4843" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4845" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="4847" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="4848" class="Symbol">)</a> <a id="4850" href="Deep.Ledger.html#893" class="Generalizable">s</a> <a id="4852" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4854" class="Symbol">(</a><a id="4855" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4857" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="4859" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="4861" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4863" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="4865" href="Deep.Ledger.html#913" class="Generalizable">t</a> <a id="4867" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="4868" class="Symbol">)</a> <a id="4870" href="Deep.Ledger.html#893" class="Generalizable">s</a>
<a id="4872" href="Deep.Ledger.html#4821" class="Function">denot-comm</a> <a id="4883" class="Symbol">{</a><a id="4884" class="Argument">t</a> <a id="4886" class="Symbol">=</a> <a id="4888" href="Deep.Ledger.html#4888" class="Bound">t</a><a id="4889" class="Symbol">}{</a><a id="4891" class="Argument">l</a> <a id="4893" class="Symbol">=</a> <a id="4895" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4897" class="Symbol">}</a>    <a id="4902" class="Symbol">{</a><a id="4903" href="Deep.Ledger.html#4903" class="Bound">s</a><a id="4904" class="Symbol">}</a> <a id="4906" class="Symbol">=</a> <a id="4908" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4913" href="Deep.Ledger.html#4821" class="Function">denot-comm</a> <a id="4924" class="Symbol">{</a><a id="4925" class="Argument">t</a> <a id="4927" class="Symbol">=</a> <a id="4929" href="Deep.Ledger.html#4929" class="Bound">t</a><a id="4930" class="Symbol">}{</a><a id="4932" class="Argument">l</a> <a id="4934" class="Symbol">=</a> <a id="4936" href="Deep.Ledger.html#4936" class="Bound">t′</a> <a id="4939" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4941" href="Deep.Ledger.html#4941" class="Bound">l</a><a id="4942" class="Symbol">}{</a><a id="4944" href="Deep.Ledger.html#4944" class="Bound">s</a><a id="4945" class="Symbol">}</a>
  <a id="4949" class="Keyword">rewrite</a> <a id="4957" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="4961" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4963" href="Deep.Ledger.html#4821" class="Function">denot-comm</a> <a id="4974" class="Symbol">{</a><a id="4975" href="Deep.Ledger.html#4936" class="Bound">t′</a><a id="4977" class="Symbol">}{</a><a id="4979" href="Deep.Ledger.html#4941" class="Bound">l</a><a id="4980" class="Symbol">}{</a><a id="4982" href="Deep.Ledger.html#4944" class="Bound">s</a><a id="4983" class="Symbol">}</a>
        <a id="4993" class="Symbol">|</a> <a id="4995" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="4999" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5001" href="Deep.Ledger.html#4821" class="Function">denot-comm</a> <a id="5012" class="Symbol">{</a><a id="5013" href="Deep.Ledger.html#4936" class="Bound">t′</a><a id="5015" class="Symbol">}{</a><a id="5017" href="Deep.Ledger.html#4941" class="Bound">l</a><a id="5018" class="Symbol">}{</a><a id="5020" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="5022" href="Deep.Ledger.html#4929" class="Bound">t</a> <a id="5024" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="5026" href="Deep.Ledger.html#4944" class="Bound">s</a><a id="5027" class="Symbol">}</a>
        <a id="5037" class="Symbol">|</a> <a id="5039" href="Deep.Ledger.html#4716" class="Function">⟦⟧-comm</a> <a id="5047" class="Symbol">{</a><a id="5048" href="Deep.Ledger.html#4929" class="Bound">t</a><a id="5049" class="Symbol">}{</a><a id="5051" href="Deep.Ledger.html#4936" class="Bound">t′</a><a id="5053" class="Symbol">}{</a><a id="5055" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="5057" href="Deep.Ledger.html#4941" class="Bound">l</a> <a id="5059" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="5061" href="Deep.Ledger.html#4944" class="Bound">s</a><a id="5062" class="Symbol">}</a>
        <a id="5072" class="Symbol">|</a> <a id="5074" href="Deep.Ledger.html#4821" class="Function">denot-comm</a> <a id="5085" class="Symbol">{</a><a id="5086" href="Deep.Ledger.html#4929" class="Bound">t</a><a id="5087" class="Symbol">}{</a><a id="5089" href="Deep.Ledger.html#4941" class="Bound">l</a><a id="5090" class="Symbol">}{</a><a id="5092" href="Deep.Ledger.html#4944" class="Bound">s</a><a id="5093" class="Symbol">}</a>
        <a id="5103" class="Symbol">|</a> <a id="5105" href="Deep.Ledger.html#4821" class="Function">denot-comm</a> <a id="5116" class="Symbol">{</a><a id="5117" href="Deep.Ledger.html#4929" class="Bound">t</a><a id="5118" class="Symbol">}{</a><a id="5120" href="Deep.Ledger.html#4941" class="Bound">l</a><a id="5121" class="Symbol">}{</a><a id="5123" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="5125" href="Deep.Ledger.html#4936" class="Bound">t′</a> <a id="5128" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="5130" href="Deep.Ledger.html#4944" class="Bound">s</a><a id="5131" class="Symbol">}</a>
        <a id="5141" class="Symbol">=</a> <a id="5143" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="5149" class="Comment">-- equivalences</a>
<a id="axiom⇔denot"></a><a id="5165" href="Deep.Ledger.html#5165" class="Function">axiom⇔denot</a> <a id="5177" class="Symbol">:</a> <a id="5179" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="5181" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="5183" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="5185" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="5187" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="5189" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="5191" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="5193" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="5195" class="Symbol">(</a><a id="5196" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="5198" href="Deep.Ledger.html#3842" class="Function Operator">`⊢</a> <a id="5201" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="5203" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="5206" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="5208" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="5210" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="5211" class="Symbol">)</a>
<a id="5213" href="Deep.Ledger.html#5165" class="Function">axiom⇔denot</a> <a id="5225" class="Symbol">=</a> <a id="5227" href="Deep.Ledger.html#5265" class="Function">axiom→denot</a> <a id="5239" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5241" href="Deep.Ledger.html#5526" class="Function">denot→axiom</a>
  <a id="5255" class="Keyword">where</a>
    <a id="5265" href="Deep.Ledger.html#5265" class="Function">axiom→denot</a> <a id="5277" class="Symbol">:</a> <a id="5279" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="5281" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="5283" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="5285" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="5287" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="5289" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="5291" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="5293" class="Symbol">→</a> <a id="5295" class="Symbol">(</a><a id="5296" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="5298" href="Deep.Ledger.html#3842" class="Function Operator">`⊢</a> <a id="5301" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="5303" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="5306" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="5308" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="5310" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="5311" class="Symbol">)</a>
    <a id="5317" href="Deep.Ledger.html#5265" class="Function">axiom→denot</a> <a id="5329" href="Deep.Ledger.html#4052" class="InductiveConstructor">base</a>                              <a id="5363" href="Deep.Ledger.html#5363" class="Bound">Ps</a> <a id="5366" class="Symbol">=</a> <a id="5368" href="Deep.Ledger.html#5363" class="Bound">Ps</a>
    <a id="5375" href="Deep.Ledger.html#5265" class="Function">axiom→denot</a> <a id="5387" class="Symbol">(</a><a id="5388" href="Deep.Ledger.html#4171" class="InductiveConstructor">step</a> <a id="5393" href="Deep.Ledger.html#5393" class="Bound">PlQ</a><a id="5396" class="Symbol">)</a>                        <a id="5421" class="Symbol">=</a> <a id="5423" href="Deep.Ledger.html#5265" class="Function">axiom→denot</a> <a id="5435" href="Deep.Ledger.html#5393" class="Bound">PlQ</a>
    <a id="5443" href="Deep.Ledger.html#5265" class="Function">axiom→denot</a> <a id="5455" class="Symbol">(</a><a id="5456" href="Deep.Ledger.html#4372" class="InductiveConstructor">weaken-strengthen</a> <a id="5474" href="Deep.Ledger.html#5474" class="Bound">P⊢P′</a> <a id="5479" href="Deep.Ledger.html#5479" class="Bound">Q′⊢Q</a> <a id="5484" href="Deep.Ledger.html#5484" class="Bound">PlQ</a><a id="5487" class="Symbol">)</a> <a id="5489" class="Symbol">=</a> <a id="5491" href="Deep.Ledger.html#5479" class="Bound">Q′⊢Q</a> <a id="5496" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5498" href="Deep.Ledger.html#5265" class="Function">axiom→denot</a> <a id="5510" href="Deep.Ledger.html#5484" class="Bound">PlQ</a> <a id="5514" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5516" href="Deep.Ledger.html#5474" class="Bound">P⊢P′</a>

    <a id="5526" href="Deep.Ledger.html#5526" class="Function">denot→axiom</a> <a id="5538" class="Symbol">:</a> <a id="5540" class="Symbol">(</a><a id="5541" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="5543" href="Deep.Ledger.html#3842" class="Function Operator">`⊢</a> <a id="5546" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="5548" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="5551" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="5553" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="5555" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="5556" class="Symbol">)</a> <a id="5558" class="Symbol">→</a> <a id="5560" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="5562" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="5564" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="5566" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="5568" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="5570" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="5572" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>
    <a id="5578" href="Deep.Ledger.html#5526" class="Function">denot→axiom</a> <a id="5590" class="Symbol">{</a><a id="5591" class="Argument">P</a> <a id="5593" class="Symbol">=</a> <a id="5595" href="Deep.Ledger.html#5595" class="Bound">P</a><a id="5596" class="Symbol">}</a> <a id="5598" class="Symbol">{</a><a id="5599" class="Argument">Q</a> <a id="5601" class="Symbol">=</a> <a id="5603" href="Deep.Ledger.html#5603" class="Bound">Q</a><a id="5604" class="Symbol">}</a> <a id="5606" class="Symbol">{</a><a id="5607" class="Argument">l</a> <a id="5609" class="Symbol">=</a> <a id="5611" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5613" class="Symbol">}</a>    <a id="5618" href="Deep.Ledger.html#5618" class="Bound">H</a>
      <a id="5626" class="Symbol">=</a> <a id="5628" href="Deep.Ledger.html#4372" class="InductiveConstructor">weaken-strengthen</a> <a id="5646" class="Symbol">{</a><a id="5647" class="Argument">P</a> <a id="5649" class="Symbol">=</a> <a id="5651" href="Deep.Ledger.html#5595" class="Bound">P</a><a id="5652" class="Symbol">}</a> <a id="5654" class="Symbol">{</a><a id="5655" class="Argument">Q</a> <a id="5657" class="Symbol">=</a> <a id="5659" href="Deep.Ledger.html#5595" class="Bound">P</a><a id="5660" class="Symbol">}</a> <a id="5662" class="Symbol">{</a><a id="5663" class="Argument">Q′</a> <a id="5666" class="Symbol">=</a> <a id="5668" href="Deep.Ledger.html#5603" class="Bound">Q</a><a id="5669" class="Symbol">}</a> <a id="5671" href="Function.Base.html#615" class="Function">id</a> <a id="5674" href="Deep.Ledger.html#5618" class="Bound">H</a> <a id="5676" href="Deep.Ledger.html#4052" class="InductiveConstructor">base</a>
    <a id="5685" href="Deep.Ledger.html#5526" class="Function">denot→axiom</a> <a id="5697" class="Symbol">{</a><a id="5698" class="Argument">P</a> <a id="5700" class="Symbol">=</a> <a id="5702" href="Deep.Ledger.html#5702" class="Bound">P</a><a id="5703" class="Symbol">}</a> <a id="5705" class="Symbol">{</a><a id="5706" class="Argument">Q</a> <a id="5708" class="Symbol">=</a> <a id="5710" href="Deep.Ledger.html#5710" class="Bound">Q</a><a id="5711" class="Symbol">}</a> <a id="5713" class="Symbol">{</a><a id="5714" class="Argument">l</a> <a id="5716" class="Symbol">=</a> <a id="5718" href="Deep.Ledger.html#5718" class="Bound">t</a> <a id="5720" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5722" href="Deep.Ledger.html#5722" class="Bound">l</a><a id="5723" class="Symbol">}</a> <a id="5725" href="Deep.Ledger.html#5725" class="Bound">H</a>
      <a id="5733" class="Symbol">=</a> <a id="5735" href="Deep.Ledger.html#4372" class="InductiveConstructor">weaken-strengthen</a> <a id="5753" class="Symbol">{</a><a id="5754" class="Argument">P′</a> <a id="5757" class="Symbol">=</a> <a id="5759" href="Deep.Ledger.html#5702" class="Bound">P</a><a id="5760" class="Symbol">}</a> <a id="5762" class="Symbol">{</a><a id="5763" class="Argument">P</a> <a id="5765" class="Symbol">=</a> <a id="5767" href="Deep.Ledger.html#5710" class="Bound">Q</a> <a id="5769" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="5772" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="5774" href="Deep.Ledger.html#5718" class="Bound">t</a> <a id="5776" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5778" href="Deep.Ledger.html#5722" class="Bound">l</a> <a id="5780" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a><a id="5781" class="Symbol">}</a> <a id="5783" class="Symbol">{</a><a id="5784" class="Argument">Q</a> <a id="5786" class="Symbol">=</a> <a id="5788" href="Deep.Ledger.html#5710" class="Bound">Q</a><a id="5789" class="Symbol">}</a> <a id="5791" class="Symbol">{</a><a id="5792" class="Argument">Q′</a> <a id="5795" class="Symbol">=</a> <a id="5797" href="Deep.Ledger.html#5710" class="Bound">Q</a><a id="5798" class="Symbol">}</a> <a id="5800" href="Deep.Ledger.html#5725" class="Bound">H</a> <a id="5802" href="Function.Base.html#615" class="Function">id</a> <a id="5805" class="Symbol">(</a><a id="5806" href="Deep.Ledger.html#4502" class="Function">axiom-base⋆</a> <a id="5818" class="Symbol">{</a><a id="5819" class="Argument">P</a> <a id="5821" class="Symbol">=</a> <a id="5823" href="Deep.Ledger.html#5710" class="Bound">Q</a><a id="5824" class="Symbol">}</a> <a id="5826" class="Symbol">{</a><a id="5827" class="Argument">l</a> <a id="5829" class="Symbol">=</a> <a id="5831" href="Deep.Ledger.html#5718" class="Bound">t</a> <a id="5833" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5835" href="Deep.Ledger.html#5722" class="Bound">l</a><a id="5836" class="Symbol">})</a>

<a id="axiom⇔oper"></a><a id="5840" href="Deep.Ledger.html#5840" class="Function">axiom⇔oper</a> <a id="5851" class="Symbol">:</a> <a id="5853" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="5855" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="5857" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="5859" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="5861" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="5863" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="5865" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="5867" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="5869" class="Symbol">(∀</a> <a id="5872" class="Symbol">{</a><a id="5873" href="Deep.Ledger.html#5873" class="Bound">s</a> <a id="5875" href="Deep.Ledger.html#5875" class="Bound">s′</a><a id="5877" class="Symbol">}</a> <a id="5879" class="Symbol">→</a> <a id="5881" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="5883" href="Deep.Ledger.html#3903" class="Function Operator">∙</a> <a id="5885" href="Deep.Ledger.html#5873" class="Bound">s</a> <a id="5887" class="Symbol">→</a> <a id="5889" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="5891" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5893" href="Deep.Ledger.html#5873" class="Bound">s</a> <a id="5895" href="Deep.Ledger.html#1868" class="Function Operator">—→⋆′</a> <a id="5900" href="Deep.Ledger.html#5875" class="Bound">s′</a> <a id="5903" class="Symbol">→</a> <a id="5905" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="5907" href="Deep.Ledger.html#3903" class="Function Operator">∙</a> <a id="5909" href="Deep.Ledger.html#5875" class="Bound">s′</a><a id="5911" class="Symbol">)</a>
<a id="5913" href="Deep.Ledger.html#5840" class="Function">axiom⇔oper</a>
  <a id="5926" class="Comment">{- ** 1. proving from scratch -}</a>
  <a id="5961" class="Comment">-- = axiom→oper , oper→axiom</a>
  <a id="5992" class="Comment">-- where</a>
  <a id="6003" class="Comment">--   axiom→oper : ⟨ P ⟩ l ⟨ Q ⟩ → (∀ {s s′} → P s → l , s —→⋆′ s′ → Q s′)</a>
  <a id="6079" class="Comment">--   axiom→oper base                              Ps base                   = Ps</a>
  <a id="6162" class="Comment">--   axiom→oper (step PlQ)                        Ps (step singleStep s→s′) = axiom→oper PlQ Ps s→s′</a>
  <a id="6265" class="Comment">--   axiom→oper (weaken-strengthen P⊢P′ Q′⊢Q PlQ) Ps s→s′                   = Q′⊢Q $ axiom→oper PlQ (P⊢P′ Ps) s→s′</a>

  <a id="6383" class="Comment">--   oper→axiom : (∀ {s s′} → P s → l , s —→⋆′ s′ → Q s′) → ⟨ P ⟩ l ⟨ Q ⟩</a>
  <a id="6459" class="Comment">--   oper→axiom {l = []}    H = weaken-strengthen id (flip H base) base</a>
  <a id="6533" class="Comment">--   oper→axiom {l = _ ∷ _} H = weaken-strengthen (λ Ps → H Ps oper-base⋆) id axiom-base⋆</a>

  <a id="6626" class="Comment">{- ** 2. composing axiom⇔denot ∘ denot⇔oper -}</a>
  <a id="6675" class="Symbol">=</a> <a id="6677" class="Symbol">(λ{</a> <a id="6681" href="Deep.Ledger.html#6681" class="Bound">P⊢</a> <a id="6684" href="Deep.Ledger.html#6684" class="Bound">Ps</a> <a id="6687" href="Deep.Ledger.html#6687" class="Bound">s→s′</a> <a id="6692" class="Symbol">→</a> <a id="6694" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="6700" class="Symbol">_</a> <a id="6702" class="Symbol">(</a><a id="6703" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6709" href="Deep.Ledger.html#2315" class="Function">denot⇔oper</a> <a id="6720" href="Deep.Ledger.html#6687" class="Bound">s→s′</a><a id="6724" class="Symbol">)</a> <a id="6726" class="Symbol">(</a><a id="6727" href="Deep.Ledger.html#6681" class="Bound">P⊢</a> <a id="6730" href="Deep.Ledger.html#6684" class="Bound">Ps</a><a id="6732" class="Symbol">)})</a> <a id="6736" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6738" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6744" href="Deep.Ledger.html#5165" class="Function">axiom⇔denot</a>
  <a id="6758" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6760" class="Symbol">λ</a> <a id="6762" href="Deep.Ledger.html#6762" class="Bound">H</a> <a id="6764" class="Symbol">→</a> <a id="6766" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6772" href="Deep.Ledger.html#5165" class="Function">axiom⇔denot</a> <a id="6784" class="Symbol">λ</a> <a id="6786" href="Deep.Ledger.html#6786" class="Bound">Ps</a> <a id="6789" class="Symbol">→</a> <a id="6791" href="Deep.Ledger.html#6762" class="Bound">H</a> <a id="6793" href="Deep.Ledger.html#6786" class="Bound">Ps</a> <a id="6796" href="Deep.Ledger.html#2145" class="Function">oper-base⋆</a>


<a id="6809" class="Comment">-- ** Separation logic</a>

<a id="mod"></a><a id="6833" href="Deep.Ledger.html#6833" class="Function">mod</a> <a id="6837" class="Symbol">:</a> <a id="6839" href="Deep.Ledger.html#869" class="Function">L</a> <a id="6841" class="Symbol">→</a> <a id="6843" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="6848" href="Deep.Ledger.html#433" class="Bound">Part</a> <a id="6853" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>
<a id="6855" href="Deep.Ledger.html#6833" class="Function">mod</a> <a id="6859" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6862" class="Symbol">=</a> <a id="6864" href="Prelude.Sets.AsUniqueLists.Core.html#2455" class="InductiveConstructor">∅</a>
<a id="6866" href="Deep.Ledger.html#6833" class="Function">mod</a> <a id="6870" class="Symbol">(</a><a id="6871" href="Deep.Ledger.html#6871" class="Bound">p₁</a> <a id="6874" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">—→⟨</a> <a id="6878" class="Symbol">_</a> <a id="6880" href="Deep.Ledger.html#799" class="InductiveConstructor Operator">⟩</a> <a id="6882" href="Deep.Ledger.html#6882" class="Bound">p₂</a> <a id="6885" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6887" href="Deep.Ledger.html#6887" class="Bound">l</a><a id="6888" class="Symbol">)</a> <a id="6890" class="Symbol">=</a> <a id="6892" href="Prelude.Sets.AsUniqueLists.Core.html#2468" class="Function">singleton</a> <a id="6902" href="Deep.Ledger.html#6871" class="Bound">p₁</a> <a id="6905" href="Prelude.Sets.AsUniqueLists.Core.html#2765" class="Function Operator">∪</a> <a id="6907" href="Prelude.Sets.AsUniqueLists.Core.html#2468" class="Function">singleton</a> <a id="6917" href="Deep.Ledger.html#6882" class="Bound">p₂</a> <a id="6920" href="Prelude.Sets.AsUniqueLists.Core.html#2765" class="Function Operator">∪</a> <a id="6922" href="Deep.Ledger.html#6833" class="Function">mod</a> <a id="6926" href="Deep.Ledger.html#6887" class="Bound">l</a>

<a id="6929" class="Comment">-- ⟦⟧-constᵗ : dom (⟦ t ⟧ s) ≡ dom s</a>
<a id="6966" class="Comment">-- ⟦⟧-constᵗ {t = p —→⟨ n ⟩ p′}    = refl</a>

<a id="7009" class="Comment">-- ⟦⟧-const : ∀ {s} {l : L} → dom (⟦ l ⟧ s) ≡ dom s</a>
<a id="7061" class="Comment">-- ⟦⟧-const {s = _} {l = []}    = refl</a>
<a id="7100" class="Comment">-- ⟦⟧-const {s = s} {l = t ∷ l} rewrite ⟦⟧-const {⟦ t ⟧ s}{l} = ⟦⟧-constᵗ {t}{s}</a>

<a id="⟦⟧-union"></a><a id="7182" href="Deep.Ledger.html#7182" class="Function">⟦⟧-union</a> <a id="7191" class="Symbol">:</a>
    <a id="7197" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟨</a> <a id="7199" href="Deep.Ledger.html#901" class="Generalizable">s₁</a> <a id="7202" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⊎</a> <a id="7204" href="Deep.Ledger.html#904" class="Generalizable">s₂</a> <a id="7207" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟩≡</a> <a id="7210" href="Deep.Ledger.html#893" class="Generalizable">s</a>
    <a id="7216" class="Comment">--------------------------------------</a>
  <a id="7257" class="Symbol">→</a> <a id="7259" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟨</a> <a id="7261" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="7263" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="7265" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="7267" href="Deep.Ledger.html#901" class="Generalizable">s₁</a> <a id="7270" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⊎</a> <a id="7272" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="7274" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="7276" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="7278" href="Deep.Ledger.html#904" class="Generalizable">s₂</a> <a id="7281" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟩≡</a> <a id="7284" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="7286" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="7288" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="7290" href="Deep.Ledger.html#893" class="Generalizable">s</a>
<a id="7292" href="Deep.Ledger.html#7182" class="Function">⟦⟧-union</a> <a id="7301" href="Deep.Ledger.html#7301" class="Bound">s₁⊎s₂</a> <a id="7307" class="Symbol">=</a> <a id="7309" class="Hole">{!!}</a> <a id="7314" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7316" class="Hole">{!!}</a>

<a id="7322" class="Keyword">postulate</a>
  <a id="⟦⟧-♯"></a><a id="7334" href="Deep.Ledger.html#7334" class="Postulate">⟦⟧-♯</a> <a id="7339" class="Symbol">:</a>
      <a id="7347" href="Deep.Ledger.html#901" class="Generalizable">s₁</a> <a id="7350" href="Deep.Ledger.html#3404" class="Function Operator">♯</a> <a id="7352" href="Deep.Ledger.html#904" class="Generalizable">s₂</a> <a id="7355" href="Deep.Ledger.html#3404" class="Function Operator">←</a> <a id="7357" href="Deep.Ledger.html#893" class="Generalizable">s</a>
      <a id="7365" class="Comment">-----------------------------</a>
    <a id="7399" class="Symbol">→</a> <a id="7401" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="7403" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="7405" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="7407" href="Deep.Ledger.html#901" class="Generalizable">s₁</a> <a id="7410" href="Deep.Ledger.html#3404" class="Function Operator">♯</a> <a id="7412" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="7414" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="7416" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="7418" href="Deep.Ledger.html#904" class="Generalizable">s₂</a> <a id="7421" href="Deep.Ledger.html#3404" class="Function Operator">←</a> <a id="7423" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="7425" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="7427" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="7429" href="Deep.Ledger.html#893" class="Generalizable">s</a>

<a id="7432" class="Comment">-- update-emptyᵗ : proj₁ s ≡ ∅ → ⟦ t ⟧ s ≡ s</a>
<a id="7477" class="Comment">-- update-emptyᵗ {.(⟨ [] ⟩∶- _) , snd} {x —→⟨ x₁ ⟩ x₂} refl = {!!}</a>

<a id="7545" class="Comment">-- update-empty : proj₁ s ≡ ∅ → ⟦ l ⟧ s ≡ s</a>
<a id="7589" class="Comment">-- update-empty {s}{[]}    refl = refl</a>
<a id="7628" class="Comment">-- update-empty {s}{t ∷ l} refl rewrite update-emptyᵗ {s}{t} refl = {!!}</a>
<a id="7701" class="Comment">-- rewrite update-empty {⟦ t ⟧ s}{l} (update-emptyᵗ {s}{t} refl) = refl</a>

<a id="frame"></a><a id="7774" href="Deep.Ledger.html#7774" class="Function">frame</a> <a id="7780" class="Symbol">:</a>
    <a id="7786" href="Deep.Ledger.html#6833" class="Function">mod</a> <a id="7790" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="7792" href="Prelude.Apartness.html#237" class="Field Operator">♯</a> <a id="7794" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="7797" href="Deep.Ledger.html#3980" class="Generalizable">R</a>
  <a id="7801" class="Symbol">→</a> <a id="7803" href="Deep.Ledger.html#3980" class="Generalizable">R</a> <a id="7805" href="Deep.Ledger.html#3903" class="Function Operator">∙</a> <a id="7807" href="Deep.Ledger.html#893" class="Generalizable">s</a>
    <a id="7813" class="Comment">-----------</a>
  <a id="7827" class="Symbol">→</a> <a id="7829" href="Deep.Ledger.html#3980" class="Generalizable">R</a> <a id="7831" href="Deep.Ledger.html#3903" class="Function Operator">∙</a> <a id="7833" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="7835" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="7837" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="7839" href="Deep.Ledger.html#893" class="Generalizable">s</a>
<a id="7841" href="Deep.Ledger.html#7774" class="Function">frame</a> <a id="7847" class="Symbol">=</a> <a id="7849" class="Hole">{!!}</a>
<a id="7854" class="Comment">-- frame {l} {`emp}    {.(⟨ [] ⟩∶- _) , _} _ refl = subst (`emp ∙_) (sym $ update-empty {l = l} refl) refl</a>
<a id="7961" class="Comment">-- frame {l} {p `↦ v} {s} mod♯ (p∈ , p≡) = {!!}</a>
<a id="8009" class="Comment">-- frame {l} {P `∗ Q}  {s} mod♯ Rs = {!!}</a>
<a id="8051" class="Comment">-- frame {l} {P `—∗ Q} {s} mod♯ Rs = {!!}</a>
<a id="8093" class="Comment">-- frame {l} {P `∘ f}  {s} mod♯ Rs = {!!}</a>
<a id="8135" class="Comment">-- frame {[]} {R} {s} mod♯fv Rs = Rs</a>
<a id="8172" class="Comment">-- frame {(p —→⟨ n ⟩ p′) ∷ l} {R} {s} mod♯fv Rs = {!!}</a>

<a id="8228" class="Comment">-- need deeply-embedded Predˢ for fv</a>
<a id="[FRAME]"></a><a id="8265" href="Deep.Ledger.html#8265" class="Function">[FRAME]</a> <a id="8273" class="Symbol">:</a>
    <a id="8279" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="8281" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="8283" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="8285" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="8287" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="8289" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="8291" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>
  <a id="8295" class="Symbol">→</a> <a id="8297" href="Deep.Ledger.html#6833" class="Function">mod</a> <a id="8301" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="8303" href="Prelude.Apartness.html#237" class="Field Operator">♯</a> <a id="8305" href="Deep.Ledger.html#3186" class="Function">fv</a> <a id="8308" href="Deep.Ledger.html#3980" class="Generalizable">R</a>
    <a id="8314" class="Comment">-----------------------</a>
  <a id="8340" class="Symbol">→</a> <a id="8342" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="8344" href="Deep.Ledger.html#3958" class="Generalizable">P</a> <a id="8346" href="Deep.Ledger.html#3082" class="InductiveConstructor Operator">`∗</a> <a id="8349" href="Deep.Ledger.html#3980" class="Generalizable">R</a> <a id="8351" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a> <a id="8353" href="Deep.Ledger.html#928" class="Generalizable">l</a> <a id="8355" href="Deep.Ledger.html#4000" class="Datatype Operator">⟨</a> <a id="8357" href="Deep.Ledger.html#3969" class="Generalizable">Q</a> <a id="8359" href="Deep.Ledger.html#3082" class="InductiveConstructor Operator">`∗</a> <a id="8362" href="Deep.Ledger.html#3980" class="Generalizable">R</a> <a id="8364" href="Deep.Ledger.html#4000" class="Datatype Operator">⟩</a>
<a id="8366" href="Deep.Ledger.html#8265" class="Function">[FRAME]</a> <a id="8374" class="Symbol">{</a><a id="8375" href="Deep.Ledger.html#8375" class="Bound">P</a><a id="8376" class="Symbol">}{</a><a id="8378" href="Deep.Ledger.html#8378" class="Bound">l</a><a id="8379" class="Symbol">}{</a><a id="8381" href="Deep.Ledger.html#8381" class="Bound">Q</a><a id="8382" class="Symbol">}{</a><a id="8384" href="Deep.Ledger.html#8384" class="Bound">R</a><a id="8385" class="Symbol">}</a> <a id="8387" href="Deep.Ledger.html#8387" class="Bound">PlQ</a> <a id="8391" href="Deep.Ledger.html#8391" class="Bound">mod♯fv</a> <a id="8398" class="Symbol">=</a> <a id="8400" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8406" href="Deep.Ledger.html#5165" class="Function">axiom⇔denot</a> <a id="8418" href="Deep.Ledger.html#8432" class="Function">d</a>
  <a id="8422" class="Keyword">where</a>
    <a id="8432" href="Deep.Ledger.html#8432" class="Function">d</a> <a id="8434" class="Symbol">:</a> <a id="8436" class="Symbol">(</a><a id="8437" href="Deep.Ledger.html#8375" class="Bound">P</a> <a id="8439" href="Deep.Ledger.html#3082" class="InductiveConstructor Operator">`∗</a> <a id="8442" href="Deep.Ledger.html#8384" class="Bound">R</a><a id="8443" class="Symbol">)</a> <a id="8445" href="Deep.Ledger.html#3842" class="Function Operator">`⊢</a> <a id="8448" class="Symbol">(</a><a id="8449" href="Deep.Ledger.html#8381" class="Bound">Q</a> <a id="8451" href="Deep.Ledger.html#3082" class="InductiveConstructor Operator">`∗</a> <a id="8454" href="Deep.Ledger.html#8384" class="Bound">R</a><a id="8455" class="Symbol">)</a> <a id="8457" href="Deep.Ledger.html#3131" class="InductiveConstructor Operator">`∘</a> <a id="8460" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="8462" href="Deep.Ledger.html#8378" class="Bound">l</a> <a id="8464" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a>
    <a id="8470" href="Deep.Ledger.html#8432" class="Function">d</a> <a id="8472" class="Symbol">{</a><a id="8473" href="Deep.Ledger.html#8473" class="Bound">s</a><a id="8474" class="Symbol">}</a> <a id="8476" class="Symbol">(</a><a id="8477" href="Deep.Ledger.html#8477" class="Bound">s₁</a> <a id="8480" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8482" href="Deep.Ledger.html#8482" class="Bound">s₂</a> <a id="8485" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8487" href="Deep.Ledger.html#8487" class="Bound">s₁♯s₂</a> <a id="8493" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8495" href="Deep.Ledger.html#8495" class="Bound">Ps₁</a> <a id="8499" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8501" href="Deep.Ledger.html#8501" class="Bound">Rs₂</a><a id="8504" class="Symbol">)</a> <a id="8506" class="Symbol">=</a> <a id="8508" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="8510" href="Deep.Ledger.html#8378" class="Bound">l</a> <a id="8512" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="8514" href="Deep.Ledger.html#8477" class="Bound">s₁</a> <a id="8517" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8519" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="8521" href="Deep.Ledger.html#8378" class="Bound">l</a> <a id="8523" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="8525" href="Deep.Ledger.html#8482" class="Bound">s₂</a> <a id="8528" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8530" href="Deep.Ledger.html#8994" class="Function">p</a> <a id="8532" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8534" href="Deep.Ledger.html#8838" class="Function">Qs₁′</a> <a id="8539" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8541" href="Deep.Ledger.html#8908" class="Function">Rs₂′</a>
    <a id="8550" class="Comment">{-
      s = s₁ ⊎ s₂
      —→ ⟦l⟧s = ⟦l⟧s₁ ⊎ ⟦l⟧s₂
      P s₁
      —→ Q ⟦l⟧s₁
      R s₂
      —→ R ⟦l⟧s₂

         ⟦l⟧s = ⟦l⟧s₁ ⊎ ⟦l⟧s₂     Q ⟦l⟧s₁      R ⟦l⟧s₂
      ----------------------------------------------------
                          (Q ∗ R) ⟦l⟧s
    -}</a>
      <a id="8824" class="Keyword">where</a>
        <a id="8838" href="Deep.Ledger.html#8838" class="Function">Qs₁′</a> <a id="8843" class="Symbol">:</a> <a id="8845" href="Deep.Ledger.html#8381" class="Bound">Q</a> <a id="8847" href="Deep.Ledger.html#3903" class="Function Operator">∙</a> <a id="8849" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="8851" href="Deep.Ledger.html#8378" class="Bound">l</a> <a id="8853" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="8855" href="Deep.Ledger.html#8477" class="Bound">s₁</a>
        <a id="8866" href="Deep.Ledger.html#8838" class="Function">Qs₁′</a> <a id="8871" class="Symbol">=</a> <a id="8873" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8879" href="Deep.Ledger.html#5165" class="Function">axiom⇔denot</a> <a id="8891" href="Deep.Ledger.html#8387" class="Bound">PlQ</a> <a id="8895" href="Deep.Ledger.html#8495" class="Bound">Ps₁</a>

        <a id="8908" href="Deep.Ledger.html#8908" class="Function">Rs₂′</a> <a id="8913" class="Symbol">:</a> <a id="8915" href="Deep.Ledger.html#8384" class="Bound">R</a> <a id="8917" href="Deep.Ledger.html#3903" class="Function Operator">∙</a> <a id="8919" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="8921" href="Deep.Ledger.html#8378" class="Bound">l</a> <a id="8923" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="8925" href="Deep.Ledger.html#8482" class="Bound">s₂</a>
        <a id="8936" href="Deep.Ledger.html#8908" class="Function">Rs₂′</a> <a id="8941" class="Symbol">=</a> <a id="8943" href="Deep.Ledger.html#7774" class="Function">frame</a> <a id="8949" class="Symbol">{</a><a id="8950" class="Argument">l</a> <a id="8952" class="Symbol">=</a> <a id="8954" href="Deep.Ledger.html#8378" class="Bound">l</a><a id="8955" class="Symbol">}</a> <a id="8957" class="Symbol">{</a><a id="8958" class="Argument">R</a> <a id="8960" class="Symbol">=</a> <a id="8962" href="Deep.Ledger.html#8384" class="Bound">R</a><a id="8963" class="Symbol">}</a> <a id="8965" class="Symbol">{</a><a id="8966" class="Argument">s</a> <a id="8968" class="Symbol">=</a> <a id="8970" href="Deep.Ledger.html#8482" class="Bound">s₂</a><a id="8972" class="Symbol">}</a> <a id="8974" href="Deep.Ledger.html#8391" class="Bound">mod♯fv</a> <a id="8981" href="Deep.Ledger.html#8501" class="Bound">Rs₂</a>

        <a id="8994" href="Deep.Ledger.html#8994" class="Function">p</a> <a id="8996" class="Symbol">:</a> <a id="8998" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="9000" href="Deep.Ledger.html#8378" class="Bound">l</a> <a id="9002" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="9004" href="Deep.Ledger.html#8477" class="Bound">s₁</a> <a id="9007" href="Deep.Ledger.html#3404" class="Function Operator">♯</a> <a id="9009" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="9011" href="Deep.Ledger.html#8378" class="Bound">l</a> <a id="9013" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="9015" href="Deep.Ledger.html#8482" class="Bound">s₂</a> <a id="9018" href="Deep.Ledger.html#3404" class="Function Operator">←</a> <a id="9020" href="Deep.Ledger.html#1065" class="Field Operator">⟦</a> <a id="9022" href="Deep.Ledger.html#8378" class="Bound">l</a> <a id="9024" href="Deep.Ledger.html#1065" class="Field Operator">⟧</a> <a id="9026" href="Deep.Ledger.html#8473" class="Bound">s</a>
        <a id="9036" href="Deep.Ledger.html#8994" class="Function">p</a> <a id="9038" class="Symbol">=</a> <a id="9040" href="Deep.Ledger.html#7334" class="Postulate">⟦⟧-♯</a> <a id="9045" class="Symbol">{</a><a id="9046" href="Deep.Ledger.html#8477" class="Bound">s₁</a><a id="9048" class="Symbol">}{</a><a id="9050" href="Deep.Ledger.html#8482" class="Bound">s₂</a><a id="9052" class="Symbol">}{</a><a id="9054" href="Deep.Ledger.html#8473" class="Bound">s</a><a id="9055" class="Symbol">}{</a><a id="9057" href="Deep.Ledger.html#8378" class="Bound">l</a><a id="9058" class="Symbol">}</a> <a id="9060" href="Deep.Ledger.html#8487" class="Bound">s₁♯s₂</a>
<a id="9066" class="Comment">{-

-- ** Concurrent separation logic
open import Data.List.Relation.Ternary.Interleaving
_∥_←_ : L → L → L → Set
l₁ ∥ l₂ ← l = Interleaving _≡_ _≡_ l₁ l₂ l

h :
    s₁ ♯ s₂ ← s
  → l₁ ∥ l₂ ← l
  → mod l₁ S.♯ mod l₂
    -------------------------------
  → ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂ ← ⟦ l ⟧ s
h {s₁}{s₂}{s}{l₁}{l₂}{l} s₁♯s₂ l₁∥l₂ l₁♯l₂ = h₁ , h₂
  where
    ps₁ = proj₁ (⟦ l₁ ⟧ s₁)
    ps₂ = proj₁ (⟦ l₂ ⟧ s₂)

    All∉ : All (_∉′ ps₂) (list ps₁)
    All∉ = {!!}

    h₁ : ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂
    h₁ = let p = L.filter-none (_∈′? ps₂) {xs = list ps₁} All∉ in {!!} -- subst _ p refl

    h₂ : ⟦ l ⟧ s ≡ᵐ union (⟦ l₁ ⟧ s₁) (⟦ l₂ ⟧ s₂)
    h₂ = {!!}

[INTERLEAVE] :
    l₁ ∥ l₂ ← l
  → ⟨ P₁ ⟩ l₁ ⟨ Q₁ ⟩
  → ⟨ P₂ ⟩ l₂ ⟨ Q₂ ⟩
  → mod l₁ S.♯ mod l₂
  -- → fv P₁ ∪ fv Q₁ S.♯ mod l₂
  -- → fv P₂ ∪ fv Q₂ S.♯ mod l₁
    ---------------------------
  → ⟨ P₁ `∗ P₂ ⟩ l ⟨ Q₁ `∗ Q₂ ⟩

[INTERLEAVE] {l₁}{l₂}{l}{P₁}{Q₁}{P₂}{Q₂} l₁∥l₂ PlQ PlQ′ l₁♯l₂ = proj₂ axiom⇔denot d
  where
    d : (P₁ `∗ P₂) `⊢ (Q₁ `∗ Q₂) `∘ ⟦ l ⟧
    d {s} (s₁ , s₂ , s₁♯s₂ , Ps₁ , Ps₂) = _ , _ , q , q₁ , q₂
      where
        q₁ : Q₁ ∙ ⟦ l₁ ⟧ s₁
        q₁ = proj₁ axiom⇔denot PlQ Ps₁

        q₂ : Q₂ ∙ ⟦ l₂ ⟧ s₂
        q₂ = proj₁ axiom⇔denot PlQ′ Ps₂

        q : ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂ ← ⟦ l ⟧ s
        q = {!!} -- h s₁♯s₂ l₁∥l₂ l₁♯l₂
-}</a>
</pre></body></html>