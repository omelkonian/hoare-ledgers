<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Deep.Ledger</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/hoare-ledgers/tree/master///Deep/Ledger.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Keyword">open</a> <a id="45" class="Keyword">import</a> <a id="52" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="64" class="Symbol">;</a> <a id="66" class="Keyword">open</a> <a id="71" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="81" class="Keyword">open</a> <a id="86" class="Keyword">import</a> <a id="93" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="109" class="Keyword">open</a> <a id="114" href="Prelude.Init.html#3792" class="Module">Integer</a> <a id="122" class="Keyword">using</a> <a id="128" class="Symbol">()</a> <a id="131" class="Keyword">renaming</a> <a id="140" class="Symbol">(</a><a id="141" href="Data.Integer.Base.html#5032" class="Function Operator">_-_</a> <a id="145" class="Symbol">to</a> <a id="148" class="Function Operator">_-ℤ_</a><a id="152" class="Symbol">;</a> <a id="154" href="Data.Integer.Base.html#4853" class="Function Operator">_+_</a> <a id="158" class="Symbol">to</a> <a id="161" class="Function Operator">_+ℤ_</a><a id="165" class="Symbol">)</a>
<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Prelude.Maps.Abstract.html" class="Module">Prelude.Maps.Abstract</a> <a id="252" class="Keyword">hiding</a> <a id="259" class="Symbol">(</a><a id="260" href="Prelude.Maps.Abstract.Interface.html#615" class="Function">∅</a><a id="261" class="Symbol">;</a> <a id="263" href="Prelude.Maps.Abstract.Interface.html#7377" class="Function">singleton</a><a id="272" class="Symbol">)</a> <a id="274" class="Keyword">renaming</a> <a id="283" class="Symbol">(</a><a id="284" href="Prelude.Maps.Abstract.Interface.html#627" class="Function Operator">_∪_</a> <a id="288" class="Symbol">to</a> <a id="291" class="Function Operator">_∪ᵐ_</a><a id="295" class="Symbol">)</a>
<a id="297" class="Keyword">open</a> <a id="302" href="Prelude.Maps.Abstract.Interface.html#15119" class="Module">CommandDSL</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="339" class="Keyword">open</a> <a id="344" class="Keyword">import</a> <a id="351" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>

<a id="427" class="Keyword">module</a> <a id="434" href="Deep.Ledger.html" class="Module">Deep.Ledger</a>
  <a id="448" class="Symbol">(</a><a id="449" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="454" class="Symbol">:</a> <a id="456" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="460" class="Symbol">)</a> <a id="462" class="Comment">-- a fixed set of participants</a>
  <a id="495" class="Symbol">⦃</a> <a id="497" href="Deep.Ledger.html#497" class="Bound">_</a> <a id="499" class="Symbol">:</a> <a id="501" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="507" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="512" class="Symbol">⦄</a>
  <a id="516" class="Keyword">where</a>

<a id="523" class="Keyword">instance</a> <a id="532" href="Deep.Ledger.html#532" class="Function">_</a> <a id="534" class="Symbol">=</a> <a id="536" href="Prelude.Semigroup.html#5215" class="Function">Semigroup-ℤ-+</a><a id="549" class="Symbol">;</a> <a id="551" href="Deep.Ledger.html#551" class="Function">_</a> <a id="553" class="Symbol">=</a> <a id="555" href="Prelude.Semigroup.html#5274" class="Function">SemigroupLaws-ℤ-+</a><a id="572" class="Symbol">;</a> <a id="574" href="Deep.Ledger.html#574" class="Function">_</a> <a id="576" class="Symbol">=</a> <a id="578" href="Prelude.Monoid.html#3574" class="Function">Monoid-ℤ-+</a><a id="588" class="Symbol">;</a> <a id="590" href="Deep.Ledger.html#590" class="Function">_</a> <a id="592" class="Symbol">=</a> <a id="594" href="Prelude.Monoid.html#3646" class="Function">MonoidLaws-ℤ-+</a>

<a id="610" class="Comment">-- The state of a ledger is a collection of participants, along with their balance.</a>
<a id="S"></a><a id="694" href="Deep.Ledger.html#694" class="Function">S</a> <a id="696" class="Symbol">:</a> <a id="698" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="703" href="Deep.Ledger.html#694" class="Function">S</a> <a id="705" class="Symbol">=</a> <a id="707" href="Prelude.Maps.Abstract.Interface.html#598" class="Function">Map⟨</a> <a id="712" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="717" href="Prelude.Maps.Abstract.Interface.html#598" class="Function">↦</a> <a id="719" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="721" href="Prelude.Maps.Abstract.Interface.html#598" class="Function">⟩</a>

<a id="724" class="Comment">-- A transaction is transferring money from one participant to another</a>
<a id="795" class="Keyword">data</a> <a id="Tx"></a><a id="800" href="Deep.Ledger.html#800" class="Datatype">Tx</a> <a id="803" class="Symbol">:</a> <a id="805" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="810" class="Keyword">where</a>
  <a id="Tx._—→⟨_⟩_"></a><a id="818" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">_—→⟨_⟩_</a> <a id="826" class="Symbol">:</a> <a id="828" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="833" class="Symbol">→</a> <a id="835" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="837" class="Symbol">→</a> <a id="839" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="844" class="Symbol">→</a> <a id="846" href="Deep.Ledger.html#800" class="Datatype">Tx</a>

<a id="850" class="Comment">-- A ledger is a list of transactions</a>
<a id="L"></a><a id="888" href="Deep.Ledger.html#888" class="Function">L</a> <a id="890" class="Symbol">=</a> <a id="892" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="897" href="Deep.Ledger.html#800" class="Datatype">Tx</a>

<a id="901" class="Keyword">variable</a>
  <a id="912" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="914" href="Deep.Ledger.html#914" class="Generalizable">s′</a> <a id="917" href="Deep.Ledger.html#917" class="Generalizable">s″</a> <a id="920" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="923" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="926" class="Symbol">:</a> <a id="928" href="Deep.Ledger.html#694" class="Function">S</a>
  <a id="932" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="934" href="Deep.Ledger.html#934" class="Generalizable">t′</a> <a id="937" href="Deep.Ledger.html#937" class="Generalizable">t″</a> <a id="940" class="Symbol">:</a> <a id="942" href="Deep.Ledger.html#800" class="Datatype">Tx</a>
  <a id="947" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="949" href="Deep.Ledger.html#949" class="Generalizable">l′</a> <a id="952" href="Deep.Ledger.html#952" class="Generalizable">l″</a> <a id="955" href="Deep.Ledger.html#955" class="Generalizable">l₁</a> <a id="958" href="Deep.Ledger.html#958" class="Generalizable">l₂</a> <a id="961" class="Symbol">:</a> <a id="963" href="Deep.Ledger.html#888" class="Function">L</a>
  <a id="967" href="Deep.Ledger.html#967" class="Generalizable">ls</a> <a id="970" href="Deep.Ledger.html#970" class="Generalizable">ls′</a> <a id="974" href="Deep.Ledger.html#974" class="Generalizable">ls″</a> <a id="978" class="Symbol">:</a> <a id="980" href="Deep.Ledger.html#888" class="Function">L</a> <a id="982" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="984" href="Deep.Ledger.html#694" class="Function">S</a>

<a id="987" class="Comment">-- ** Denotational semantics</a>

<a id="Domain"></a><a id="1017" href="Deep.Ledger.html#1017" class="Function">Domain</a> <a id="1024" class="Symbol">=</a> <a id="1026" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1028" class="Symbol">→</a> <a id="1030" href="Deep.Ledger.html#694" class="Function">S</a>

<a id="1033" class="Keyword">record</a> <a id="Denotable"></a><a id="1040" href="Deep.Ledger.html#1040" class="Record">Denotable</a> <a id="1050" class="Symbol">(</a><a id="1051" href="Deep.Ledger.html#1051" class="Bound">A</a> <a id="1053" class="Symbol">:</a> <a id="1055" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="1059" class="Symbol">)</a> <a id="1061" class="Symbol">:</a> <a id="1063" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1068" class="Keyword">where</a>
  <a id="1076" class="Keyword">field</a>
    <a id="Denotable.⟦_⟧"></a><a id="1086" href="Deep.Ledger.html#1086" class="Field Operator">⟦_⟧</a> <a id="1090" class="Symbol">:</a> <a id="1092" href="Deep.Ledger.html#1051" class="Bound">A</a> <a id="1094" class="Symbol">→</a> <a id="1096" href="Deep.Ledger.html#1017" class="Function">Domain</a>
<a id="1103" class="Keyword">open</a> <a id="1108" href="Deep.Ledger.html#1040" class="Module">Denotable</a> <a id="1118" class="Symbol">{{...}}</a> <a id="1126" class="Keyword">public</a>

<a id="1134" class="Keyword">instance</a>
  <a id="⟦Tx⟧"></a><a id="1145" href="Deep.Ledger.html#1145" class="Function">⟦Tx⟧</a> <a id="1150" class="Symbol">:</a> <a id="1152" href="Deep.Ledger.html#1040" class="Record">Denotable</a> <a id="1162" href="Deep.Ledger.html#800" class="Datatype">Tx</a>
  <a id="1167" href="Deep.Ledger.html#1145" class="Function">⟦Tx⟧</a> <a id="1172" class="Symbol">.</a><a id="1173" href="Deep.Ledger.html#1086" class="Field Operator">⟦_⟧</a> <a id="1177" class="Symbol">(</a><a id="1178" href="Deep.Ledger.html#1178" class="Bound">p₁</a> <a id="1181" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">—→⟨</a> <a id="1185" href="Deep.Ledger.html#1185" class="Bound">n</a> <a id="1187" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">⟩</a> <a id="1189" href="Deep.Ledger.html#1189" class="Bound">p₂</a><a id="1191" class="Symbol">)</a> <a id="1193" href="Deep.Ledger.html#1193" class="Bound">s</a> <a id="1195" class="Symbol">=</a> <a id="1197" href="Prelude.Maps.Abstract.Interface.html#15142" class="Function">modify</a> <a id="1204" href="Deep.Ledger.html#1189" class="Bound">p₂</a> <a id="1207" class="Symbol">(</a><a id="1208" href="Deep.Ledger.html#161" class="Function Operator">_+ℤ</a> <a id="1212" href="Deep.Ledger.html#1185" class="Bound">n</a><a id="1213" class="Symbol">)</a> <a id="1215" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1217" href="Prelude.Maps.Abstract.Interface.html#15142" class="Function">modify</a> <a id="1224" href="Deep.Ledger.html#1178" class="Bound">p₁</a> <a id="1227" class="Symbol">(</a><a id="1228" href="Deep.Ledger.html#148" class="Function Operator">_-ℤ</a> <a id="1232" href="Deep.Ledger.html#1185" class="Bound">n</a><a id="1233" class="Symbol">)</a> <a id="1235" href="Deep.Ledger.html#1193" class="Bound">s</a>

  <a id="⟦L⟧"></a><a id="1240" href="Deep.Ledger.html#1240" class="Function">⟦L⟧</a> <a id="1244" class="Symbol">:</a> <a id="1246" href="Deep.Ledger.html#1040" class="Record">Denotable</a> <a id="1256" href="Deep.Ledger.html#888" class="Function">L</a>
  <a id="1260" href="Deep.Ledger.html#1240" class="Function">⟦L⟧</a> <a id="1264" class="Symbol">.</a><a id="1265" href="Deep.Ledger.html#1086" class="Field Operator">⟦_⟧</a> <a id="1269" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>      <a id="1277" class="Symbol">=</a> <a id="1279" href="Function.Base.html#624" class="Function">id</a>
  <a id="1284" href="Deep.Ledger.html#1240" class="Function">⟦L⟧</a> <a id="1288" class="Symbol">.</a><a id="1289" href="Deep.Ledger.html#1086" class="Field Operator">⟦_⟧</a> <a id="1293" class="Symbol">(</a><a id="1294" href="Deep.Ledger.html#1294" class="Bound">t</a> <a id="1296" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1298" href="Deep.Ledger.html#1298" class="Bound">l</a><a id="1299" class="Symbol">)</a> <a id="1301" class="Symbol">=</a> <a id="1303" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1305" href="Deep.Ledger.html#1298" class="Bound">l</a> <a id="1307" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1309" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1311" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1313" href="Deep.Ledger.html#1294" class="Bound">t</a> <a id="1315" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a>

<a id="comp"></a><a id="1318" href="Deep.Ledger.html#1318" class="Function">comp</a> <a id="1323" class="Symbol">:</a> <a id="1325" class="Symbol">∀</a> <a id="1327" href="Deep.Ledger.html#1327" class="Bound">x</a> <a id="1329" class="Symbol">→</a> <a id="1331" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1333" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="1335" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="1338" href="Deep.Ledger.html#949" class="Generalizable">l′</a> <a id="1341" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1343" href="Deep.Ledger.html#1327" class="Bound">x</a> <a id="1345" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1347" class="Symbol">(</a><a id="1348" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1350" href="Deep.Ledger.html#949" class="Generalizable">l′</a> <a id="1353" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1355" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1357" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1359" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="1361" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="1362" class="Symbol">)</a> <a id="1364" href="Deep.Ledger.html#1327" class="Bound">x</a>
<a id="1366" href="Deep.Ledger.html#1318" class="Function">comp</a> <a id="1371" class="Symbol">{</a><a id="1372" class="Argument">l</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1378" class="Symbol">}</a>    <a id="1383" class="Symbol">{</a><a id="1384" href="Deep.Ledger.html#1384" class="Bound">l′</a><a id="1386" class="Symbol">}</a> <a id="1388" href="Deep.Ledger.html#1388" class="Bound">x</a> <a id="1390" class="Symbol">=</a> <a id="1392" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="1397" href="Deep.Ledger.html#1318" class="Function">comp</a> <a id="1402" class="Symbol">{</a><a id="1403" class="Argument">l</a> <a id="1405" class="Symbol">=</a> <a id="1407" href="Deep.Ledger.html#1407" class="Bound">t</a> <a id="1409" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1411" href="Deep.Ledger.html#1411" class="Bound">l</a><a id="1412" class="Symbol">}</a> <a id="1414" class="Symbol">{</a><a id="1415" href="Deep.Ledger.html#1415" class="Bound">l′</a><a id="1417" class="Symbol">}</a> <a id="1419" href="Deep.Ledger.html#1419" class="Bound">x</a> <a id="1421" class="Keyword">rewrite</a> <a id="1429" href="Deep.Ledger.html#1318" class="Function">comp</a> <a id="1434" class="Symbol">{</a><a id="1435" href="Deep.Ledger.html#1411" class="Bound">l</a><a id="1436" class="Symbol">}{</a><a id="1438" href="Deep.Ledger.html#1415" class="Bound">l′</a><a id="1440" class="Symbol">}</a> <a id="1442" class="Symbol">(</a><a id="1443" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1445" href="Deep.Ledger.html#1407" class="Bound">t</a> <a id="1447" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1449" href="Deep.Ledger.html#1419" class="Bound">x</a><a id="1450" class="Symbol">)</a> <a id="1452" class="Symbol">=</a> <a id="1454" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="1460" class="Comment">-- ** Operational semantics</a>

<a id="1489" class="Keyword">infix</a> <a id="1495" class="Number">0</a> <a id="1497" href="Deep.Ledger.html#1521" class="Datatype Operator">_—→_</a> <a id="1502" href="Deep.Ledger.html#1729" class="Datatype Operator">_—→⋆_</a> <a id="1508" href="Deep.Ledger.html#1892" class="Function Operator">_—→⋆′_</a>

<a id="1516" class="Keyword">data</a> <a id="_—→_"></a><a id="1521" href="Deep.Ledger.html#1521" class="Datatype Operator">_—→_</a> <a id="1526" class="Symbol">:</a> <a id="1528" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1530" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1532" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1534" class="Symbol">→</a> <a id="1536" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1538" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1540" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1542" class="Symbol">→</a> <a id="1544" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1549" class="Keyword">where</a>
  <a id="_—→_.singleStep"></a><a id="1557" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="1568" class="Symbol">:</a>
     <a id="1575" class="Comment">------------------------</a>
     <a id="1605" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="1607" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1609" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="1611" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1613" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="1615" href="Deep.Ledger.html#1521" class="Datatype Operator">—→</a> <a id="1618" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="1620" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1622" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="1624" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="1626" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="1628" href="Deep.Ledger.html#912" class="Generalizable">s</a>

<a id="1631" class="Keyword">data</a> <a id="_—→′_"></a><a id="1636" href="Deep.Ledger.html#1636" class="Datatype Operator">_—→′_</a> <a id="1642" class="Symbol">:</a> <a id="1644" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1646" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1648" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1650" class="Symbol">→</a> <a id="1652" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1654" class="Symbol">→</a> <a id="1656" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1661" class="Keyword">where</a>
  <a id="_—→′_.finalStep"></a><a id="1669" href="Deep.Ledger.html#1669" class="InductiveConstructor">finalStep</a> <a id="1679" class="Symbol">:</a>
      <a id="1687" class="Comment">--------------</a>
      <a id="1708" class="Symbol">(</a><a id="1709" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1712" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1714" href="Deep.Ledger.html#912" class="Generalizable">s</a><a id="1715" class="Symbol">)</a> <a id="1717" href="Deep.Ledger.html#1636" class="Datatype Operator">—→′</a> <a id="1721" href="Deep.Ledger.html#912" class="Generalizable">s</a>

<a id="1724" class="Keyword">data</a> <a id="_—→⋆_"></a><a id="1729" href="Deep.Ledger.html#1729" class="Datatype Operator">_—→⋆_</a> <a id="1735" class="Symbol">:</a> <a id="1737" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1739" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1741" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1743" class="Symbol">→</a> <a id="1745" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1747" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1749" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1751" class="Symbol">→</a> <a id="1753" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1758" class="Keyword">where</a>
   <a id="_—→⋆_.base"></a><a id="1767" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a> <a id="1772" class="Symbol">:</a>
       <a id="1781" class="Comment">---------</a>
       <a id="1798" href="Deep.Ledger.html#967" class="Generalizable">ls</a> <a id="1801" href="Deep.Ledger.html#1729" class="Datatype Operator">—→⋆</a> <a id="1805" href="Deep.Ledger.html#967" class="Generalizable">ls</a>

   <a id="_—→⋆_.step"></a><a id="1812" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="1817" class="Symbol">:</a>
       <a id="1826" href="Deep.Ledger.html#967" class="Generalizable">ls</a> <a id="1829" href="Deep.Ledger.html#1521" class="Datatype Operator">—→</a> <a id="1832" href="Deep.Ledger.html#970" class="Generalizable">ls′</a>
     <a id="1841" class="Symbol">→</a> <a id="1843" href="Deep.Ledger.html#970" class="Generalizable">ls′</a> <a id="1847" href="Deep.Ledger.html#1729" class="Datatype Operator">—→⋆</a> <a id="1851" href="Deep.Ledger.html#974" class="Generalizable">ls″</a>
       <a id="1862" class="Comment">----------</a>
     <a id="1878" class="Symbol">→</a> <a id="1880" href="Deep.Ledger.html#967" class="Generalizable">ls</a> <a id="1883" href="Deep.Ledger.html#1729" class="Datatype Operator">—→⋆</a> <a id="1887" href="Deep.Ledger.html#974" class="Generalizable">ls″</a>

<a id="_—→⋆′_"></a><a id="1892" href="Deep.Ledger.html#1892" class="Function Operator">_—→⋆′_</a> <a id="1899" class="Symbol">:</a> <a id="1901" href="Deep.Ledger.html#888" class="Function">L</a> <a id="1903" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1905" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1907" class="Symbol">→</a> <a id="1909" href="Deep.Ledger.html#694" class="Function">S</a> <a id="1911" class="Symbol">→</a> <a id="1913" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="1918" href="Deep.Ledger.html#1918" class="Bound">ls</a> <a id="1921" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="1926" href="Deep.Ledger.html#1926" class="Bound">s</a> <a id="1928" class="Symbol">=</a> <a id="1930" href="Deep.Ledger.html#1918" class="Bound">ls</a> <a id="1933" href="Deep.Ledger.html#1729" class="Datatype Operator">—→⋆</a> <a id="1937" class="Symbol">(</a><a id="1938" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1941" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1943" href="Deep.Ledger.html#1926" class="Bound">s</a><a id="1944" class="Symbol">)</a>

<a id="comp′"></a><a id="1947" href="Deep.Ledger.html#1947" class="Function">comp′</a> <a id="1953" class="Symbol">:</a>
    <a id="1959" href="Deep.Ledger.html#947" class="Generalizable">l</a>       <a id="1967" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1969" href="Deep.Ledger.html#912" class="Generalizable">s</a>  <a id="1972" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="1977" href="Deep.Ledger.html#914" class="Generalizable">s′</a>
  <a id="1982" class="Symbol">→</a> <a id="1984" href="Deep.Ledger.html#949" class="Generalizable">l′</a>      <a id="1992" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1994" href="Deep.Ledger.html#914" class="Generalizable">s′</a> <a id="1997" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2002" href="Deep.Ledger.html#917" class="Generalizable">s″</a>
  <a id="2007" class="Symbol">→</a> <a id="2009" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2011" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2014" href="Deep.Ledger.html#949" class="Generalizable">l′</a> <a id="2017" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2019" href="Deep.Ledger.html#912" class="Generalizable">s</a>  <a id="2022" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2027" href="Deep.Ledger.html#917" class="Generalizable">s″</a>
<a id="2030" href="Deep.Ledger.html#1947" class="Function">comp′</a> <a id="2036" class="Symbol">{</a><a id="2037" class="Argument">l</a> <a id="2039" class="Symbol">=</a> <a id="2041" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2043" class="Symbol">}</a>    <a id="2048" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a>                   <a id="2071" href="Deep.Ledger.html#2071" class="Bound">s′→s″</a> <a id="2077" class="Symbol">=</a> <a id="2079" href="Deep.Ledger.html#2071" class="Bound">s′→s″</a>
<a id="2085" href="Deep.Ledger.html#1947" class="Function">comp′</a> <a id="2091" class="Symbol">{</a><a id="2092" class="Argument">l</a> <a id="2094" class="Symbol">=</a> <a id="2096" class="Symbol">_</a> <a id="2098" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2100" class="Symbol">_}</a> <a id="2103" class="Symbol">(</a><a id="2104" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2109" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2120" href="Deep.Ledger.html#2120" class="Bound">s→s′</a><a id="2124" class="Symbol">)</a> <a id="2126" href="Deep.Ledger.html#2126" class="Bound">s′→s″</a> <a id="2132" class="Symbol">=</a> <a id="2134" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2139" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2150" class="Symbol">(</a><a id="2151" href="Deep.Ledger.html#1947" class="Function">comp′</a> <a id="2157" href="Deep.Ledger.html#2120" class="Bound">s→s′</a> <a id="2162" href="Deep.Ledger.html#2126" class="Bound">s′→s″</a><a id="2167" class="Symbol">)</a>

<a id="oper-base⋆"></a><a id="2170" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a> <a id="2181" class="Symbol">:</a> <a id="2183" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2185" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2187" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2189" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2194" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="2196" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2198" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="2200" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="2202" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a> <a id="2213" class="Symbol">{</a><a id="2214" class="Argument">l</a> <a id="2216" class="Symbol">=</a> <a id="2218" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2220" class="Symbol">}</a>    <a id="2225" class="Symbol">=</a> <a id="2227" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a>
<a id="2232" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a> <a id="2243" class="Symbol">{</a><a id="2244" class="Argument">l</a> <a id="2246" class="Symbol">=</a> <a id="2248" class="Symbol">_</a> <a id="2250" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2252" class="Symbol">_}</a> <a id="2255" class="Symbol">=</a> <a id="2257" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2262" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2273" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a>

<a id="2285" class="Comment">-- ** Relating denotational and operational semantics</a>

<a id="denot⇔oper"></a><a id="2340" href="Deep.Ledger.html#2340" class="Function">denot⇔oper</a> <a id="2351" class="Symbol">:</a> <a id="2353" class="Symbol">(</a><a id="2354" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="2356" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2358" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="2360" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2362" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2364" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2366" class="Symbol">)</a> <a id="2368" href="Prelude.General.html#551" class="Function Operator">⇔</a> <a id="2370" class="Symbol">(</a><a id="2371" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2373" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2375" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2377" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2382" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2384" class="Symbol">)</a>
<a id="2386" href="Deep.Ledger.html#2340" class="Function">denot⇔oper</a> <a id="2397" class="Symbol">=</a> <a id="2399" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2410" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2412" href="Deep.Ledger.html#2593" class="Function">oper→denot</a>
  <a id="2425" class="Keyword">where</a>
    <a id="2435" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2446" class="Symbol">:</a> <a id="2448" class="Symbol">(</a><a id="2449" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="2451" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2453" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="2455" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2457" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2459" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2461" class="Symbol">)</a> <a id="2463" class="Symbol">→</a> <a id="2465" class="Symbol">(</a><a id="2466" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2468" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2470" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2472" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2477" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2479" class="Symbol">)</a>
    <a id="2485" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2496" class="Symbol">{</a><a id="2497" class="Argument">l</a> <a id="2499" class="Symbol">=</a> <a id="2501" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2503" class="Symbol">}</a>    <a id="2508" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2513" class="Symbol">=</a> <a id="2515" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a>
    <a id="2524" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2535" class="Symbol">{</a><a id="2536" class="Argument">l</a> <a id="2538" class="Symbol">=</a> <a id="2540" class="Symbol">_</a> <a id="2542" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2544" class="Symbol">_}</a> <a id="2547" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2552" class="Symbol">=</a> <a id="2554" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2559" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2570" class="Symbol">(</a><a id="2571" href="Deep.Ledger.html#2435" class="Function">denot→oper</a> <a id="2582" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2586" class="Symbol">)</a>

    <a id="2593" href="Deep.Ledger.html#2593" class="Function">oper→denot</a> <a id="2604" class="Symbol">:</a> <a id="2606" class="Symbol">(</a><a id="2607" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2609" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2611" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2613" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="2618" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2620" class="Symbol">)</a> <a id="2622" class="Symbol">→</a> <a id="2624" class="Symbol">(</a><a id="2625" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="2627" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="2629" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="2631" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="2633" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2635" href="Deep.Ledger.html#914" class="Generalizable">s′</a><a id="2637" class="Symbol">)</a>
    <a id="2643" href="Deep.Ledger.html#2593" class="Function">oper→denot</a> <a id="2654" class="Symbol">{</a><a id="2655" class="Argument">l</a> <a id="2657" class="Symbol">=</a> <a id="2659" class="DottedPattern Symbol">.</a><a id="2660" href="Agda.Builtin.List.html#167" class="DottedPattern InductiveConstructor">[]</a><a id="2662" class="Symbol">}</a>   <a id="2666" href="Deep.Ledger.html#1767" class="InductiveConstructor">base</a>                <a id="2686" class="Symbol">=</a> <a id="2688" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
    <a id="2697" href="Deep.Ledger.html#2593" class="Function">oper→denot</a> <a id="2708" class="Symbol">{</a><a id="2709" class="Argument">l</a> <a id="2711" class="Symbol">=</a> <a id="2713" class="Symbol">_</a> <a id="2715" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2717" class="Symbol">_}</a> <a id="2720" class="Symbol">(</a><a id="2721" href="Deep.Ledger.html#1812" class="InductiveConstructor">step</a> <a id="2726" href="Deep.Ledger.html#1557" class="InductiveConstructor">singleStep</a> <a id="2737" href="Deep.Ledger.html#2737" class="Bound">p</a><a id="2738" class="Symbol">)</a> <a id="2740" class="Symbol">=</a> <a id="2742" href="Deep.Ledger.html#2593" class="Function">oper→denot</a> <a id="2753" href="Deep.Ledger.html#2737" class="Bound">p</a>

<a id="2756" class="Comment">-- ** Axiomatic semantics</a>

<a id="Predˢ"></a><a id="2783" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="2789" class="Symbol">=</a> <a id="2791" href="Relation.Unary.html#1110" class="Function">Pred</a> <a id="2796" href="Deep.Ledger.html#694" class="Function">S</a> <a id="2798" href="Level.html#521" class="Function">0ℓ</a>
<a id="2801" class="Comment">{-
-- the shallow embedding of predicates seems to break here..
-- ..we really need to get ahold of the actual variables, i.e. from a deeply-embedded DSL
fv : Predˢ → Set⟨ Part ⟩
fv P = {!!}
-}</a>

<a id="2996" class="Keyword">data</a> <a id="Assertion"></a><a id="3001" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3011" class="Symbol">:</a> <a id="3013" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="3018" class="Keyword">where</a>
  <a id="Assertion.`emp"></a><a id="3026" href="Deep.Ledger.html#3026" class="InductiveConstructor">`emp</a> <a id="Assertion.`⊥"></a><a id="3031" href="Deep.Ledger.html#3031" class="InductiveConstructor">`⊥</a> <a id="3034" class="Symbol">:</a> <a id="3036" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>
  <a id="3048" class="Comment">-- _`≡_ : ℤ → ℤ → Assertion</a>
  <a id="Assertion._`↦_"></a><a id="3078" href="Deep.Ledger.html#3078" class="InductiveConstructor Operator">_`↦_</a> <a id="3083" class="Symbol">:</a> <a id="3085" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="3090" class="Symbol">→</a> <a id="3092" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="3094" class="Symbol">→</a> <a id="3096" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>
  <a id="Assertion._`∗_"></a><a id="3108" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">_`∗_</a> <a id="Assertion._`—∗_"></a><a id="3113" href="Deep.Ledger.html#3113" class="InductiveConstructor Operator">_`—∗_</a> <a id="3119" class="Symbol">:</a> <a id="3121" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3131" class="Symbol">→</a> <a id="3133" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3143" class="Symbol">→</a> <a id="3145" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>
  <a id="Assertion._`∘_"></a><a id="3157" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">_`∘_</a> <a id="3162" class="Symbol">:</a> <a id="3164" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3174" class="Symbol">→</a> <a id="3176" class="Symbol">(</a><a id="3177" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3179" class="Symbol">→</a> <a id="3181" href="Deep.Ledger.html#694" class="Function">S</a><a id="3182" class="Symbol">)</a> <a id="3184" class="Symbol">→</a> <a id="3186" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>

<a id="3197" class="Keyword">infixr</a> <a id="3204" class="Number">9</a> <a id="3206" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">_`∘_</a>

<a id="fv"></a><a id="3212" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3215" class="Symbol">:</a> <a id="3217" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3227" class="Symbol">→</a> <a id="3229" href="Prelude.Sets.AsUniqueLists.Core.html#1060" class="Record">Set⟨</a> <a id="3234" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="3239" href="Prelude.Sets.AsUniqueLists.Core.html#1060" class="Record">⟩</a>
<a id="3241" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3244" href="Deep.Ledger.html#3026" class="InductiveConstructor">`emp</a>      <a id="3254" class="Symbol">=</a> <a id="3256" href="Prelude.Sets.AsUniqueLists.Core.html#2885" class="InductiveConstructor">∅</a>
<a id="3258" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3261" href="Deep.Ledger.html#3031" class="InductiveConstructor">`⊥</a>        <a id="3271" class="Symbol">=</a> <a id="3273" href="Prelude.Sets.AsUniqueLists.Core.html#2885" class="InductiveConstructor">∅</a>
<a id="3275" class="Comment">-- fv (_ `≡ _) = ∅</a>
<a id="3294" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3297" class="Symbol">(</a><a id="3298" href="Deep.Ledger.html#3298" class="Bound">p</a> <a id="3300" href="Deep.Ledger.html#3078" class="InductiveConstructor Operator">`↦</a> <a id="3303" class="Symbol">_)</a>  <a id="3307" class="Symbol">=</a> <a id="3309" href="Prelude.Sets.AsUniqueLists.Core.html#2898" class="Function">singleton</a> <a id="3319" href="Deep.Ledger.html#3298" class="Bound">p</a>
<a id="3321" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3324" class="Symbol">(</a><a id="3325" href="Deep.Ledger.html#3325" class="Bound">P</a> <a id="3327" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="3330" href="Deep.Ledger.html#3330" class="Bound">Q</a><a id="3331" class="Symbol">)</a>  <a id="3334" class="Symbol">=</a> <a id="3336" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3339" href="Deep.Ledger.html#3325" class="Bound">P</a> <a id="3341" href="Prelude.Sets.AsUniqueLists.Core.html#3203" class="Function Operator">∪</a> <a id="3343" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3346" href="Deep.Ledger.html#3330" class="Bound">Q</a>
<a id="3348" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3351" class="Symbol">(</a><a id="3352" href="Deep.Ledger.html#3352" class="Bound">P</a> <a id="3354" href="Deep.Ledger.html#3113" class="InductiveConstructor Operator">`—∗</a> <a id="3358" href="Deep.Ledger.html#3358" class="Bound">Q</a><a id="3359" class="Symbol">)</a> <a id="3361" class="Symbol">=</a> <a id="3363" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3366" href="Deep.Ledger.html#3352" class="Bound">P</a> <a id="3368" href="Prelude.Sets.AsUniqueLists.Core.html#3203" class="Function Operator">∪</a> <a id="3370" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3373" href="Deep.Ledger.html#3358" class="Bound">Q</a>
<a id="3375" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3378" class="Symbol">(</a><a id="3379" href="Deep.Ledger.html#3379" class="Bound">P</a> <a id="3381" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="3384" class="Symbol">_)</a>  <a id="3388" class="Symbol">=</a> <a id="3390" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="3393" href="Deep.Ledger.html#3379" class="Bound">P</a>

<a id="emp"></a><a id="3396" href="Deep.Ledger.html#3396" class="Function">emp</a> <a id="3400" class="Symbol">:</a> <a id="3402" href="Deep.Ledger.html#2783" class="Function">Predˢ</a>
<a id="3408" href="Deep.Ledger.html#3396" class="Function">emp</a> <a id="3412" href="Deep.Ledger.html#3412" class="Bound">s</a> <a id="3414" class="Symbol">=</a> <a id="3416" class="Symbol">∀</a> <a id="3418" href="Deep.Ledger.html#3418" class="Bound">k</a> <a id="3420" class="Symbol">→</a> <a id="3422" href="Deep.Ledger.html#3418" class="Bound">k</a> <a id="3424" href="Prelude.Maps.Abstract.Interface.html#1001" class="Function Operator">∉ᵈ</a> <a id="3427" href="Deep.Ledger.html#3412" class="Bound">s</a>

<a id="_♯_←_"></a><a id="3430" href="Deep.Ledger.html#3430" class="Function Operator">_♯_←_</a> <a id="3436" class="Symbol">:</a> <a id="3438" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3440" class="Symbol">→</a> <a id="3442" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3444" class="Symbol">→</a> <a id="3446" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3448" class="Symbol">→</a> <a id="3450" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="3455" href="Deep.Ledger.html#3455" class="Bound">s₁</a> <a id="3458" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="3460" href="Deep.Ledger.html#3460" class="Bound">s₂</a> <a id="3463" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="3465" href="Deep.Ledger.html#3465" class="Bound">s</a> <a id="3467" class="Symbol">=</a> <a id="3469" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⟨</a> <a id="3471" href="Deep.Ledger.html#3455" class="Bound">s₁</a> <a id="3474" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⊎</a> <a id="3476" href="Deep.Ledger.html#3460" class="Bound">s₂</a> <a id="3479" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⟩≡</a> <a id="3482" href="Deep.Ledger.html#3465" class="Bound">s</a>

<a id="_∗_"></a><a id="3485" href="Deep.Ledger.html#3485" class="Function Operator">_∗_</a> <a id="3489" class="Symbol">:</a> <a id="3491" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="3497" class="Symbol">→</a> <a id="3499" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="3505" class="Symbol">→</a> <a id="3507" href="Deep.Ledger.html#2783" class="Function">Predˢ</a>
<a id="3513" class="Symbol">(</a><a id="3514" href="Deep.Ledger.html#3514" class="Bound">P</a> <a id="3516" href="Deep.Ledger.html#3485" class="Function Operator">∗</a> <a id="3518" href="Deep.Ledger.html#3518" class="Bound">Q</a><a id="3519" class="Symbol">)</a> <a id="3521" href="Deep.Ledger.html#3521" class="Bound">s</a> <a id="3523" class="Symbol">=</a> <a id="3525" href="Data.Product.html#1378" class="Function">∃</a> <a id="3527" class="Symbol">λ</a> <a id="3529" href="Deep.Ledger.html#3529" class="Bound">s₁</a> <a id="3532" class="Symbol">→</a> <a id="3534" href="Data.Product.html#1378" class="Function">∃</a> <a id="3536" class="Symbol">λ</a> <a id="3538" href="Deep.Ledger.html#3538" class="Bound">s₂</a> <a id="3541" class="Symbol">→</a> <a id="3543" class="Symbol">(</a><a id="3544" href="Deep.Ledger.html#3529" class="Bound">s₁</a> <a id="3547" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="3549" href="Deep.Ledger.html#3538" class="Bound">s₂</a> <a id="3552" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="3554" href="Deep.Ledger.html#3521" class="Bound">s</a><a id="3555" class="Symbol">)</a> <a id="3557" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3559" href="Deep.Ledger.html#3514" class="Bound">P</a> <a id="3561" href="Deep.Ledger.html#3529" class="Bound">s₁</a> <a id="3564" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3566" href="Deep.Ledger.html#3518" class="Bound">Q</a> <a id="3568" href="Deep.Ledger.html#3538" class="Bound">s₂</a>

<a id="_—∗_"></a><a id="3572" href="Deep.Ledger.html#3572" class="Function Operator">_—∗_</a> <a id="3577" class="Symbol">:</a> <a id="3579" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="3585" class="Symbol">→</a> <a id="3587" href="Deep.Ledger.html#2783" class="Function">Predˢ</a> <a id="3593" class="Symbol">→</a> <a id="3595" href="Deep.Ledger.html#2783" class="Function">Predˢ</a>
<a id="3601" class="Symbol">(</a><a id="3602" href="Deep.Ledger.html#3602" class="Bound">P</a> <a id="3604" href="Deep.Ledger.html#3572" class="Function Operator">—∗</a> <a id="3607" href="Deep.Ledger.html#3607" class="Bound">Q</a><a id="3608" class="Symbol">)</a> <a id="3610" href="Deep.Ledger.html#3610" class="Bound">s</a> <a id="3612" class="Symbol">=</a> <a id="3614" class="Symbol">∀</a> <a id="3616" href="Deep.Ledger.html#3616" class="Bound">s′</a> <a id="3619" class="Symbol">→</a> <a id="3621" href="Deep.Ledger.html#3616" class="Bound">s′</a> <a id="3624" href="Prelude.Apartness.html#255" class="Field Operator">♯</a> <a id="3626" href="Deep.Ledger.html#3610" class="Bound">s</a> <a id="3628" class="Symbol">→</a> <a id="3630" href="Deep.Ledger.html#3602" class="Bound">P</a> <a id="3632" href="Deep.Ledger.html#3616" class="Bound">s′</a> <a id="3635" class="Symbol">→</a> <a id="3637" href="Deep.Ledger.html#3607" class="Bound">Q</a> <a id="3639" class="Symbol">(</a><a id="3640" href="Deep.Ledger.html#3610" class="Bound">s</a> <a id="3642" href="Deep.Ledger.html#291" class="Function Operator">∪ᵐ</a> <a id="3645" href="Deep.Ledger.html#3616" class="Bound">s′</a><a id="3647" class="Symbol">)</a>

<a id="⟦_⟧ᵖ"></a><a id="3650" href="Deep.Ledger.html#3650" class="Function Operator">⟦_⟧ᵖ</a> <a id="3655" class="Symbol">:</a> <a id="3657" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3667" class="Symbol">→</a> <a id="3669" href="Deep.Ledger.html#2783" class="Function">Predˢ</a>
<a id="3675" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3677" href="Deep.Ledger.html#3026" class="InductiveConstructor">`emp</a>    <a id="3685" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3688" class="Symbol">=</a> <a id="3690" href="Deep.Ledger.html#3396" class="Function">emp</a>
<a id="3694" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3696" href="Deep.Ledger.html#3031" class="InductiveConstructor">`⊥</a>      <a id="3704" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3707" class="Symbol">=</a> <a id="3709" href="Function.Base.html#645" class="Function">const</a> <a id="3715" href="Data.Empty.html#535" class="Datatype">⊥</a>
<a id="3717" class="Comment">-- ⟦ x `≡ y  ⟧ᵖ = {!!}</a>
<a id="3740" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3742" href="Deep.Ledger.html#3742" class="Bound">p</a> <a id="3744" href="Deep.Ledger.html#3078" class="InductiveConstructor Operator">`↦</a> <a id="3747" href="Deep.Ledger.html#3747" class="Bound">n</a>  <a id="3750" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3753" class="Symbol">=</a> <a id="3755" href="Prelude.Maps.Abstract.Interface.html#1782" class="Function Operator">_[</a> <a id="3758" href="Deep.Ledger.html#3742" class="Bound">p</a> <a id="3760" href="Prelude.Maps.Abstract.Interface.html#1782" class="Function Operator">↦</a> <a id="3762" href="Deep.Ledger.html#3747" class="Bound">n</a> <a id="3764" href="Prelude.Maps.Abstract.Interface.html#1782" class="Function Operator">]∅</a>
<a id="3767" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3769" href="Deep.Ledger.html#3769" class="Bound">P</a> <a id="3771" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="3774" href="Deep.Ledger.html#3774" class="Bound">Q</a>  <a id="3777" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3780" class="Symbol">=</a> <a id="3782" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3784" href="Deep.Ledger.html#3769" class="Bound">P</a> <a id="3786" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3789" href="Deep.Ledger.html#3485" class="Function Operator">∗</a> <a id="3791" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3793" href="Deep.Ledger.html#3774" class="Bound">Q</a> <a id="3795" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a>
<a id="3798" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3800" href="Deep.Ledger.html#3800" class="Bound">P</a> <a id="3802" href="Deep.Ledger.html#3113" class="InductiveConstructor Operator">`—∗</a> <a id="3806" href="Deep.Ledger.html#3806" class="Bound">Q</a> <a id="3808" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3811" class="Symbol">=</a> <a id="3813" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3815" href="Deep.Ledger.html#3800" class="Bound">P</a> <a id="3817" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3820" href="Deep.Ledger.html#3572" class="Function Operator">—∗</a> <a id="3823" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3825" href="Deep.Ledger.html#3806" class="Bound">Q</a> <a id="3827" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a>
<a id="3830" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3832" href="Deep.Ledger.html#3832" class="Bound">P</a> <a id="3834" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="3837" href="Deep.Ledger.html#3837" class="Bound">f</a>  <a id="3840" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3843" class="Symbol">=</a> <a id="3845" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3847" href="Deep.Ledger.html#3832" class="Bound">P</a> <a id="3849" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3852" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3854" href="Deep.Ledger.html#3837" class="Bound">f</a>

<a id="3857" class="Keyword">infix</a> <a id="3863" class="Number">1</a> <a id="3865" href="Deep.Ledger.html#3870" class="Function Operator">_`⊢_</a>
<a id="_`⊢_"></a><a id="3870" href="Deep.Ledger.html#3870" class="Function Operator">_`⊢_</a> <a id="3875" class="Symbol">:</a> <a id="3877" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3887" class="Symbol">→</a> <a id="3889" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3899" class="Symbol">→</a> <a id="3901" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="3906" href="Deep.Ledger.html#3906" class="Bound">P</a> <a id="3908" href="Deep.Ledger.html#3870" class="Function Operator">`⊢</a> <a id="3911" href="Deep.Ledger.html#3911" class="Bound">Q</a> <a id="3913" class="Symbol">=</a> <a id="3915" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3917" href="Deep.Ledger.html#3906" class="Bound">P</a> <a id="3919" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3922" href="Prelude.General.html#1709" class="Function Operator">⊢</a> <a id="3924" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3926" href="Deep.Ledger.html#3911" class="Bound">Q</a> <a id="3928" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a>

<a id="_∙_"></a><a id="3932" href="Deep.Ledger.html#3932" class="Function Operator">_∙_</a> <a id="3936" class="Symbol">:</a> <a id="3938" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="3948" class="Symbol">→</a> <a id="3950" href="Deep.Ledger.html#694" class="Function">S</a> <a id="3952" class="Symbol">→</a> <a id="3954" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="3959" href="Deep.Ledger.html#3959" class="Bound">P</a> <a id="3961" href="Deep.Ledger.html#3932" class="Function Operator">∙</a> <a id="3963" href="Deep.Ledger.html#3963" class="Bound">s</a> <a id="3965" class="Symbol">=</a> <a id="3967" href="Deep.Ledger.html#3650" class="Function Operator">⟦</a> <a id="3969" href="Deep.Ledger.html#3959" class="Bound">P</a> <a id="3971" href="Deep.Ledger.html#3650" class="Function Operator">⟧ᵖ</a> <a id="3974" href="Deep.Ledger.html#3963" class="Bound">s</a>

<a id="3977" class="Keyword">variable</a>
  <a id="3988" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="3990" href="Deep.Ledger.html#3990" class="Generalizable">P′</a> <a id="3993" href="Deep.Ledger.html#3993" class="Generalizable">P₁</a> <a id="3996" href="Deep.Ledger.html#3996" class="Generalizable">P₂</a> <a id="3999" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="4001" href="Deep.Ledger.html#4001" class="Generalizable">Q′</a> <a id="4004" href="Deep.Ledger.html#4004" class="Generalizable">Q₁</a> <a id="4007" href="Deep.Ledger.html#4007" class="Generalizable">Q₂</a> <a id="4010" href="Deep.Ledger.html#4010" class="Generalizable">R</a> <a id="4012" class="Symbol">:</a> <a id="4014" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a>

<a id="4025" class="Keyword">data</a> <a id="⟨_⟩_⟨_⟩"></a><a id="4030" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨_⟩_⟨_⟩</a> <a id="4038" class="Symbol">:</a> <a id="4040" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="4050" class="Symbol">→</a> <a id="4052" href="Deep.Ledger.html#888" class="Function">L</a> <a id="4054" class="Symbol">→</a> <a id="4056" href="Deep.Ledger.html#3001" class="Datatype">Assertion</a> <a id="4066" class="Symbol">→</a> <a id="4068" href="Agda.Primitive.html#320" class="Primitive">Type₁</a> <a id="4074" class="Keyword">where</a>

  <a id="⟨_⟩_⟨_⟩.base"></a><a id="4083" href="Deep.Ledger.html#4083" class="InductiveConstructor">base</a> <a id="4088" class="Symbol">:</a>
    <a id="4094" class="Comment">--</a>
    <a id="4101" class="Comment">------------</a>
    <a id="4118" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4120" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="4122" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="4124" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="4127" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4129" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="4131" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>
  <a id="4135" class="Comment">--   -------------------------</a>
  <a id="4168" class="Comment">--   ⟨ P ∘ ⟦ t ⟧ ⟩ [ t ] ⟨ P ⟩</a>

  <a id="⟨_⟩_⟨_⟩.step"></a><a id="4202" href="Deep.Ledger.html#4202" class="InductiveConstructor">step</a> <a id="4207" class="Symbol">:</a>
      <a id="4215" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4217" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="4219" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="4221" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4223" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4225" href="Deep.Ledger.html#4010" class="Generalizable">R</a> <a id="4227" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>
      <a id="4235" class="Comment">-------------------------</a>
    <a id="4265" class="Symbol">→</a> <a id="4267" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4269" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="4271" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="4274" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4276" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4278" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4280" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="4282" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4284" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4286" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4288" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4290" href="Deep.Ledger.html#4010" class="Generalizable">R</a> <a id="4292" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>
  <a id="4296" class="Comment">--     ⟨ P ⟩ l  ⟨ Q ⟩</a>
  <a id="4320" class="Comment">--   → ⟨ Q ⟩ l′ ⟨ R ⟩</a>
  <a id="4344" class="Comment">--     -------------------</a>
  <a id="4373" class="Comment">--   → ⟨ P ⟩ l ++ l′ ⟨ R ⟩</a>

  <a id="⟨_⟩_⟨_⟩.weaken-strengthen"></a><a id="4403" href="Deep.Ledger.html#4403" class="InductiveConstructor">weaken-strengthen</a> <a id="4421" class="Symbol">:</a>

      <a id="4430" href="Deep.Ledger.html#3990" class="Generalizable">P′</a> <a id="4433" href="Deep.Ledger.html#3870" class="Function Operator">`⊢</a> <a id="4436" href="Deep.Ledger.html#3988" class="Generalizable">P</a>
    <a id="4442" class="Symbol">→</a> <a id="4444" href="Deep.Ledger.html#3999" class="Generalizable">Q</a>  <a id="4447" href="Deep.Ledger.html#3870" class="Function Operator">`⊢</a> <a id="4450" href="Deep.Ledger.html#4001" class="Generalizable">Q′</a>
    <a id="4457" class="Symbol">→</a> <a id="4459" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4461" href="Deep.Ledger.html#3988" class="Generalizable">P</a>  <a id="4464" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="4466" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4468" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4470" href="Deep.Ledger.html#3999" class="Generalizable">Q</a>  <a id="4473" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>
      <a id="4481" class="Comment">---------------</a>
    <a id="4501" class="Symbol">→</a> <a id="4503" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4505" href="Deep.Ledger.html#3990" class="Generalizable">P′</a> <a id="4508" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="4510" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4512" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4514" href="Deep.Ledger.html#4001" class="Generalizable">Q′</a> <a id="4517" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>

<a id="4520" class="Comment">-- utilities</a>
<a id="axiom-base⋆"></a><a id="4533" href="Deep.Ledger.html#4533" class="Function">axiom-base⋆</a> <a id="4545" class="Symbol">:</a> <a id="4547" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4549" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="4551" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="4554" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4556" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4558" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4560" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="4562" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4564" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="4566" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="4568" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>
<a id="4570" href="Deep.Ledger.html#4533" class="Function">axiom-base⋆</a> <a id="4582" class="Symbol">{</a><a id="4583" class="Argument">P</a> <a id="4585" class="Symbol">=</a> <a id="4587" href="Deep.Ledger.html#4587" class="Bound">P</a><a id="4588" class="Symbol">}</a> <a id="4590" class="Symbol">{</a><a id="4591" class="Argument">l</a> <a id="4593" class="Symbol">=</a> <a id="4595" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4597" class="Symbol">}</a>    <a id="4602" class="Symbol">=</a> <a id="4604" href="Deep.Ledger.html#4403" class="InductiveConstructor">weaken-strengthen</a> <a id="4622" class="Symbol">{</a><a id="4623" class="Argument">P</a> <a id="4625" class="Symbol">=</a> <a id="4627" href="Deep.Ledger.html#4587" class="Bound">P</a><a id="4628" class="Symbol">}</a> <a id="4630" href="Function.Base.html#624" class="Function">id</a> <a id="4633" href="Function.Base.html#624" class="Function">id</a> <a id="4636" href="Deep.Ledger.html#4083" class="InductiveConstructor">base</a>
<a id="4641" href="Deep.Ledger.html#4533" class="Function">axiom-base⋆</a> <a id="4653" class="Symbol">{</a><a id="4654" class="Argument">P</a> <a id="4656" class="Symbol">=</a> <a id="4658" href="Deep.Ledger.html#4658" class="Bound">P</a><a id="4659" class="Symbol">}</a> <a id="4661" class="Symbol">{</a><a id="4662" class="Argument">l</a> <a id="4664" class="Symbol">=</a> <a id="4666" href="Deep.Ledger.html#4666" class="Bound">t</a> <a id="4668" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4670" href="Deep.Ledger.html#4670" class="Bound">l</a><a id="4671" class="Symbol">}</a> <a id="4673" class="Symbol">=</a> <a id="4675" href="Deep.Ledger.html#4403" class="InductiveConstructor">weaken-strengthen</a> <a id="4693" class="Symbol">{</a><a id="4694" class="Argument">P</a> <a id="4696" class="Symbol">=</a> <a id="4698" class="Symbol">(</a><a id="4699" href="Deep.Ledger.html#4658" class="Bound">P</a> <a id="4701" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="4704" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4706" href="Deep.Ledger.html#4670" class="Bound">l</a> <a id="4708" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4709" class="Symbol">)</a> <a id="4711" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="4714" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4716" href="Deep.Ledger.html#4666" class="Bound">t</a> <a id="4718" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4719" class="Symbol">}</a> <a id="4721" href="Function.Base.html#624" class="Function">id</a> <a id="4724" href="Function.Base.html#624" class="Function">id</a> <a id="4727" class="Symbol">(</a><a id="4728" href="Deep.Ledger.html#4202" class="InductiveConstructor">step</a> <a id="4733" href="Deep.Ledger.html#4533" class="Function">axiom-base⋆</a><a id="4744" class="Symbol">)</a>

<a id="⟦⟧-comm"></a><a id="4747" href="Deep.Ledger.html#4747" class="Function">⟦⟧-comm</a> <a id="4755" class="Symbol">:</a> <a id="4757" class="Symbol">(</a><a id="4758" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4760" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4762" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4764" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4766" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4768" href="Deep.Ledger.html#934" class="Generalizable">t′</a> <a id="4771" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4772" class="Symbol">)</a> <a id="4774" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="4776" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4778" class="Symbol">(</a><a id="4779" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4781" href="Deep.Ledger.html#934" class="Generalizable">t′</a> <a id="4784" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4786" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4788" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4790" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4792" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4793" class="Symbol">)</a> <a id="4795" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="4797" href="Deep.Ledger.html#4747" class="Function">⟦⟧-comm</a> <a id="4805" class="Symbol">{</a><a id="4806" class="Argument">t</a> <a id="4808" class="Symbol">=</a> <a id="4810" href="Deep.Ledger.html#4810" class="Bound">A</a> <a id="4812" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">—→⟨</a> <a id="4816" href="Deep.Ledger.html#4816" class="Bound">n</a> <a id="4818" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">⟩</a> <a id="4820" href="Deep.Ledger.html#4820" class="Bound">B</a><a id="4821" class="Symbol">}{</a><a id="4823" class="Argument">t′</a> <a id="4826" class="Symbol">=</a> <a id="4828" href="Deep.Ledger.html#4828" class="Bound">A′</a> <a id="4831" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">—→⟨</a> <a id="4835" href="Deep.Ledger.html#4835" class="Bound">n′</a> <a id="4838" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">⟩</a> <a id="4840" href="Deep.Ledger.html#4840" class="Bound">B′</a><a id="4842" class="Symbol">}</a> <a id="4844" class="Symbol">=</a> <a id="4846" class="Hole">{!!}</a>

<a id="denot-comm"></a><a id="4852" href="Deep.Ledger.html#4852" class="Function">denot-comm</a> <a id="4863" class="Symbol">:</a> <a id="4865" class="Symbol">(</a><a id="4866" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4868" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4870" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4872" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4874" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4876" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4878" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4879" class="Symbol">)</a> <a id="4881" href="Deep.Ledger.html#912" class="Generalizable">s</a> <a id="4883" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4885" class="Symbol">(</a><a id="4886" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4888" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="4890" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="4892" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4894" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="4896" href="Deep.Ledger.html#932" class="Generalizable">t</a> <a id="4898" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="4899" class="Symbol">)</a> <a id="4901" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="4903" href="Deep.Ledger.html#4852" class="Function">denot-comm</a> <a id="4914" class="Symbol">{</a><a id="4915" class="Argument">t</a> <a id="4917" class="Symbol">=</a> <a id="4919" href="Deep.Ledger.html#4919" class="Bound">t</a><a id="4920" class="Symbol">}{</a><a id="4922" class="Argument">l</a> <a id="4924" class="Symbol">=</a> <a id="4926" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4928" class="Symbol">}</a>    <a id="4933" class="Symbol">{</a><a id="4934" href="Deep.Ledger.html#4934" class="Bound">s</a><a id="4935" class="Symbol">}</a> <a id="4937" class="Symbol">=</a> <a id="4939" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="4944" href="Deep.Ledger.html#4852" class="Function">denot-comm</a> <a id="4955" class="Symbol">{</a><a id="4956" class="Argument">t</a> <a id="4958" class="Symbol">=</a> <a id="4960" href="Deep.Ledger.html#4960" class="Bound">t</a><a id="4961" class="Symbol">}{</a><a id="4963" class="Argument">l</a> <a id="4965" class="Symbol">=</a> <a id="4967" href="Deep.Ledger.html#4967" class="Bound">t′</a> <a id="4970" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4972" href="Deep.Ledger.html#4972" class="Bound">l</a><a id="4973" class="Symbol">}{</a><a id="4975" href="Deep.Ledger.html#4975" class="Bound">s</a><a id="4976" class="Symbol">}</a>
  <a id="4980" class="Keyword">rewrite</a> <a id="4988" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="4992" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4994" href="Deep.Ledger.html#4852" class="Function">denot-comm</a> <a id="5005" class="Symbol">{</a><a id="5006" href="Deep.Ledger.html#4967" class="Bound">t′</a><a id="5008" class="Symbol">}{</a><a id="5010" href="Deep.Ledger.html#4972" class="Bound">l</a><a id="5011" class="Symbol">}{</a><a id="5013" href="Deep.Ledger.html#4975" class="Bound">s</a><a id="5014" class="Symbol">}</a>
        <a id="5024" class="Symbol">|</a> <a id="5026" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="5030" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5032" href="Deep.Ledger.html#4852" class="Function">denot-comm</a> <a id="5043" class="Symbol">{</a><a id="5044" href="Deep.Ledger.html#4967" class="Bound">t′</a><a id="5046" class="Symbol">}{</a><a id="5048" href="Deep.Ledger.html#4972" class="Bound">l</a><a id="5049" class="Symbol">}{</a><a id="5051" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5053" href="Deep.Ledger.html#4960" class="Bound">t</a> <a id="5055" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="5057" href="Deep.Ledger.html#4975" class="Bound">s</a><a id="5058" class="Symbol">}</a>
        <a id="5068" class="Symbol">|</a> <a id="5070" href="Deep.Ledger.html#4747" class="Function">⟦⟧-comm</a> <a id="5078" class="Symbol">{</a><a id="5079" href="Deep.Ledger.html#4960" class="Bound">t</a><a id="5080" class="Symbol">}{</a><a id="5082" href="Deep.Ledger.html#4967" class="Bound">t′</a><a id="5084" class="Symbol">}{</a><a id="5086" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5088" href="Deep.Ledger.html#4972" class="Bound">l</a> <a id="5090" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="5092" href="Deep.Ledger.html#4975" class="Bound">s</a><a id="5093" class="Symbol">}</a>
        <a id="5103" class="Symbol">|</a> <a id="5105" href="Deep.Ledger.html#4852" class="Function">denot-comm</a> <a id="5116" class="Symbol">{</a><a id="5117" href="Deep.Ledger.html#4960" class="Bound">t</a><a id="5118" class="Symbol">}{</a><a id="5120" href="Deep.Ledger.html#4972" class="Bound">l</a><a id="5121" class="Symbol">}{</a><a id="5123" href="Deep.Ledger.html#4975" class="Bound">s</a><a id="5124" class="Symbol">}</a>
        <a id="5134" class="Symbol">|</a> <a id="5136" href="Deep.Ledger.html#4852" class="Function">denot-comm</a> <a id="5147" class="Symbol">{</a><a id="5148" href="Deep.Ledger.html#4960" class="Bound">t</a><a id="5149" class="Symbol">}{</a><a id="5151" href="Deep.Ledger.html#4972" class="Bound">l</a><a id="5152" class="Symbol">}{</a><a id="5154" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5156" href="Deep.Ledger.html#4967" class="Bound">t′</a> <a id="5159" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="5161" href="Deep.Ledger.html#4975" class="Bound">s</a><a id="5162" class="Symbol">}</a>
        <a id="5172" class="Symbol">=</a> <a id="5174" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="5180" class="Comment">-- equivalences</a>
<a id="axiom⇔denot"></a><a id="5196" href="Deep.Ledger.html#5196" class="Function">axiom⇔denot</a> <a id="5208" class="Symbol">:</a> <a id="5210" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="5212" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="5214" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="5216" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5218" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="5220" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="5222" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="5224" href="Prelude.General.html#551" class="Function Operator">⇔</a> <a id="5226" class="Symbol">(</a><a id="5227" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="5229" href="Deep.Ledger.html#3870" class="Function Operator">`⊢</a> <a id="5232" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="5234" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="5237" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5239" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5241" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="5242" class="Symbol">)</a>
<a id="5244" href="Deep.Ledger.html#5196" class="Function">axiom⇔denot</a> <a id="5256" class="Symbol">=</a> <a id="5258" href="Deep.Ledger.html#5296" class="Function">axiom→denot</a> <a id="5270" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5272" href="Deep.Ledger.html#5557" class="Function">denot→axiom</a>
  <a id="5286" class="Keyword">where</a>
    <a id="5296" href="Deep.Ledger.html#5296" class="Function">axiom→denot</a> <a id="5308" class="Symbol">:</a> <a id="5310" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="5312" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="5314" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="5316" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5318" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="5320" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="5322" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="5324" class="Symbol">→</a> <a id="5326" class="Symbol">(</a><a id="5327" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="5329" href="Deep.Ledger.html#3870" class="Function Operator">`⊢</a> <a id="5332" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="5334" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="5337" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5339" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5341" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="5342" class="Symbol">)</a>
    <a id="5348" href="Deep.Ledger.html#5296" class="Function">axiom→denot</a> <a id="5360" href="Deep.Ledger.html#4083" class="InductiveConstructor">base</a>                              <a id="5394" href="Deep.Ledger.html#5394" class="Bound">Ps</a> <a id="5397" class="Symbol">=</a> <a id="5399" href="Deep.Ledger.html#5394" class="Bound">Ps</a>
    <a id="5406" href="Deep.Ledger.html#5296" class="Function">axiom→denot</a> <a id="5418" class="Symbol">(</a><a id="5419" href="Deep.Ledger.html#4202" class="InductiveConstructor">step</a> <a id="5424" href="Deep.Ledger.html#5424" class="Bound">PlQ</a><a id="5427" class="Symbol">)</a>                        <a id="5452" class="Symbol">=</a> <a id="5454" href="Deep.Ledger.html#5296" class="Function">axiom→denot</a> <a id="5466" href="Deep.Ledger.html#5424" class="Bound">PlQ</a>
    <a id="5474" href="Deep.Ledger.html#5296" class="Function">axiom→denot</a> <a id="5486" class="Symbol">(</a><a id="5487" href="Deep.Ledger.html#4403" class="InductiveConstructor">weaken-strengthen</a> <a id="5505" href="Deep.Ledger.html#5505" class="Bound">P⊢P′</a> <a id="5510" href="Deep.Ledger.html#5510" class="Bound">Q′⊢Q</a> <a id="5515" href="Deep.Ledger.html#5515" class="Bound">PlQ</a><a id="5518" class="Symbol">)</a> <a id="5520" class="Symbol">=</a> <a id="5522" href="Deep.Ledger.html#5510" class="Bound">Q′⊢Q</a> <a id="5527" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="5529" href="Deep.Ledger.html#5296" class="Function">axiom→denot</a> <a id="5541" href="Deep.Ledger.html#5515" class="Bound">PlQ</a> <a id="5545" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="5547" href="Deep.Ledger.html#5505" class="Bound">P⊢P′</a>

    <a id="5557" href="Deep.Ledger.html#5557" class="Function">denot→axiom</a> <a id="5569" class="Symbol">:</a> <a id="5571" class="Symbol">(</a><a id="5572" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="5574" href="Deep.Ledger.html#3870" class="Function Operator">`⊢</a> <a id="5577" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="5579" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="5582" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5584" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5586" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="5587" class="Symbol">)</a> <a id="5589" class="Symbol">→</a> <a id="5591" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="5593" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="5595" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="5597" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5599" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="5601" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="5603" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>
    <a id="5609" href="Deep.Ledger.html#5557" class="Function">denot→axiom</a> <a id="5621" class="Symbol">{</a><a id="5622" class="Argument">P</a> <a id="5624" class="Symbol">=</a> <a id="5626" href="Deep.Ledger.html#5626" class="Bound">P</a><a id="5627" class="Symbol">}</a> <a id="5629" class="Symbol">{</a><a id="5630" class="Argument">Q</a> <a id="5632" class="Symbol">=</a> <a id="5634" href="Deep.Ledger.html#5634" class="Bound">Q</a><a id="5635" class="Symbol">}</a> <a id="5637" class="Symbol">{</a><a id="5638" class="Argument">l</a> <a id="5640" class="Symbol">=</a> <a id="5642" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="5644" class="Symbol">}</a>    <a id="5649" href="Deep.Ledger.html#5649" class="Bound">H</a>
      <a id="5657" class="Symbol">=</a> <a id="5659" href="Deep.Ledger.html#4403" class="InductiveConstructor">weaken-strengthen</a> <a id="5677" class="Symbol">{</a><a id="5678" class="Argument">P</a> <a id="5680" class="Symbol">=</a> <a id="5682" href="Deep.Ledger.html#5626" class="Bound">P</a><a id="5683" class="Symbol">}</a> <a id="5685" class="Symbol">{</a><a id="5686" class="Argument">Q</a> <a id="5688" class="Symbol">=</a> <a id="5690" href="Deep.Ledger.html#5626" class="Bound">P</a><a id="5691" class="Symbol">}</a> <a id="5693" class="Symbol">{</a><a id="5694" class="Argument">Q′</a> <a id="5697" class="Symbol">=</a> <a id="5699" href="Deep.Ledger.html#5634" class="Bound">Q</a><a id="5700" class="Symbol">}</a> <a id="5702" href="Function.Base.html#624" class="Function">id</a> <a id="5705" href="Deep.Ledger.html#5649" class="Bound">H</a> <a id="5707" href="Deep.Ledger.html#4083" class="InductiveConstructor">base</a>
    <a id="5716" href="Deep.Ledger.html#5557" class="Function">denot→axiom</a> <a id="5728" class="Symbol">{</a><a id="5729" class="Argument">P</a> <a id="5731" class="Symbol">=</a> <a id="5733" href="Deep.Ledger.html#5733" class="Bound">P</a><a id="5734" class="Symbol">}</a> <a id="5736" class="Symbol">{</a><a id="5737" class="Argument">Q</a> <a id="5739" class="Symbol">=</a> <a id="5741" href="Deep.Ledger.html#5741" class="Bound">Q</a><a id="5742" class="Symbol">}</a> <a id="5744" class="Symbol">{</a><a id="5745" class="Argument">l</a> <a id="5747" class="Symbol">=</a> <a id="5749" href="Deep.Ledger.html#5749" class="Bound">t</a> <a id="5751" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5753" href="Deep.Ledger.html#5753" class="Bound">l</a><a id="5754" class="Symbol">}</a> <a id="5756" href="Deep.Ledger.html#5756" class="Bound">H</a>
      <a id="5764" class="Symbol">=</a> <a id="5766" href="Deep.Ledger.html#4403" class="InductiveConstructor">weaken-strengthen</a> <a id="5784" class="Symbol">{</a><a id="5785" class="Argument">P′</a> <a id="5788" class="Symbol">=</a> <a id="5790" href="Deep.Ledger.html#5733" class="Bound">P</a><a id="5791" class="Symbol">}</a> <a id="5793" class="Symbol">{</a><a id="5794" class="Argument">P</a> <a id="5796" class="Symbol">=</a> <a id="5798" href="Deep.Ledger.html#5741" class="Bound">Q</a> <a id="5800" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="5803" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="5805" href="Deep.Ledger.html#5749" class="Bound">t</a> <a id="5807" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5809" href="Deep.Ledger.html#5753" class="Bound">l</a> <a id="5811" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a><a id="5812" class="Symbol">}</a> <a id="5814" class="Symbol">{</a><a id="5815" class="Argument">Q</a> <a id="5817" class="Symbol">=</a> <a id="5819" href="Deep.Ledger.html#5741" class="Bound">Q</a><a id="5820" class="Symbol">}</a> <a id="5822" class="Symbol">{</a><a id="5823" class="Argument">Q′</a> <a id="5826" class="Symbol">=</a> <a id="5828" href="Deep.Ledger.html#5741" class="Bound">Q</a><a id="5829" class="Symbol">}</a> <a id="5831" href="Deep.Ledger.html#5756" class="Bound">H</a> <a id="5833" href="Function.Base.html#624" class="Function">id</a> <a id="5836" class="Symbol">(</a><a id="5837" href="Deep.Ledger.html#4533" class="Function">axiom-base⋆</a> <a id="5849" class="Symbol">{</a><a id="5850" class="Argument">P</a> <a id="5852" class="Symbol">=</a> <a id="5854" href="Deep.Ledger.html#5741" class="Bound">Q</a><a id="5855" class="Symbol">}</a> <a id="5857" class="Symbol">{</a><a id="5858" class="Argument">l</a> <a id="5860" class="Symbol">=</a> <a id="5862" href="Deep.Ledger.html#5749" class="Bound">t</a> <a id="5864" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5866" href="Deep.Ledger.html#5753" class="Bound">l</a><a id="5867" class="Symbol">})</a>

<a id="axiom⇔oper"></a><a id="5871" href="Deep.Ledger.html#5871" class="Function">axiom⇔oper</a> <a id="5882" class="Symbol">:</a> <a id="5884" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="5886" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="5888" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="5890" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5892" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="5894" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="5896" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="5898" href="Prelude.General.html#551" class="Function Operator">⇔</a> <a id="5900" class="Symbol">(∀</a> <a id="5903" class="Symbol">{</a><a id="5904" href="Deep.Ledger.html#5904" class="Bound">s</a> <a id="5906" href="Deep.Ledger.html#5906" class="Bound">s′</a><a id="5908" class="Symbol">}</a> <a id="5910" class="Symbol">→</a> <a id="5912" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="5914" href="Deep.Ledger.html#3932" class="Function Operator">∙</a> <a id="5916" href="Deep.Ledger.html#5904" class="Bound">s</a> <a id="5918" class="Symbol">→</a> <a id="5920" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="5922" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5924" href="Deep.Ledger.html#5904" class="Bound">s</a> <a id="5926" href="Deep.Ledger.html#1892" class="Function Operator">—→⋆′</a> <a id="5931" href="Deep.Ledger.html#5906" class="Bound">s′</a> <a id="5934" class="Symbol">→</a> <a id="5936" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="5938" href="Deep.Ledger.html#3932" class="Function Operator">∙</a> <a id="5940" href="Deep.Ledger.html#5906" class="Bound">s′</a><a id="5942" class="Symbol">)</a>
<a id="5944" href="Deep.Ledger.html#5871" class="Function">axiom⇔oper</a>
  <a id="5957" class="Comment">{- ** 1. proving from scratch -}</a>
  <a id="5992" class="Comment">-- = axiom→oper , oper→axiom</a>
  <a id="6023" class="Comment">-- where</a>
  <a id="6034" class="Comment">--   axiom→oper : ⟨ P ⟩ l ⟨ Q ⟩ → (∀ {s s′} → P s → l , s —→⋆′ s′ → Q s′)</a>
  <a id="6110" class="Comment">--   axiom→oper base                              Ps base                   = Ps</a>
  <a id="6193" class="Comment">--   axiom→oper (step PlQ)                        Ps (step singleStep s→s′) = axiom→oper PlQ Ps s→s′</a>
  <a id="6296" class="Comment">--   axiom→oper (weaken-strengthen P⊢P′ Q′⊢Q PlQ) Ps s→s′                   = Q′⊢Q $ axiom→oper PlQ (P⊢P′ Ps) s→s′</a>

  <a id="6414" class="Comment">--   oper→axiom : (∀ {s s′} → P s → l , s —→⋆′ s′ → Q s′) → ⟨ P ⟩ l ⟨ Q ⟩</a>
  <a id="6490" class="Comment">--   oper→axiom {l = []}    H = weaken-strengthen id (flip H base) base</a>
  <a id="6564" class="Comment">--   oper→axiom {l = _ ∷ _} H = weaken-strengthen (λ Ps → H Ps oper-base⋆) id axiom-base⋆</a>

  <a id="6657" class="Comment">{- ** 2. composing axiom⇔denot ∘ denot⇔oper -}</a>
  <a id="6706" class="Symbol">=</a> <a id="6708" class="Symbol">(λ{</a> <a id="6712" href="Deep.Ledger.html#6712" class="Bound">P⊢</a> <a id="6715" href="Deep.Ledger.html#6715" class="Bound">Ps</a> <a id="6718" href="Deep.Ledger.html#6718" class="Bound">s→s′</a> <a id="6723" class="Symbol">→</a> <a id="6725" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">subst</a> <a id="6731" class="Symbol">_</a> <a id="6733" class="Symbol">(</a><a id="6734" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="6740" href="Deep.Ledger.html#2340" class="Function">denot⇔oper</a> <a id="6751" href="Deep.Ledger.html#6718" class="Bound">s→s′</a><a id="6755" class="Symbol">)</a> <a id="6757" class="Symbol">(</a><a id="6758" href="Deep.Ledger.html#6712" class="Bound">P⊢</a> <a id="6761" href="Deep.Ledger.html#6715" class="Bound">Ps</a><a id="6763" class="Symbol">)})</a> <a id="6767" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="6769" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="6775" href="Deep.Ledger.html#5196" class="Function">axiom⇔denot</a>
  <a id="6789" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6791" class="Symbol">λ</a> <a id="6793" href="Deep.Ledger.html#6793" class="Bound">H</a> <a id="6795" class="Symbol">→</a> <a id="6797" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="6803" href="Deep.Ledger.html#5196" class="Function">axiom⇔denot</a> <a id="6815" class="Symbol">λ</a> <a id="6817" href="Deep.Ledger.html#6817" class="Bound">Ps</a> <a id="6820" class="Symbol">→</a> <a id="6822" href="Deep.Ledger.html#6793" class="Bound">H</a> <a id="6824" href="Deep.Ledger.html#6817" class="Bound">Ps</a> <a id="6827" href="Deep.Ledger.html#2170" class="Function">oper-base⋆</a>


<a id="6840" class="Comment">-- ** Separation logic</a>

<a id="mod"></a><a id="6864" href="Deep.Ledger.html#6864" class="Function">mod</a> <a id="6868" class="Symbol">:</a> <a id="6870" href="Deep.Ledger.html#888" class="Function">L</a> <a id="6872" class="Symbol">→</a> <a id="6874" href="Prelude.Sets.AsUniqueLists.Core.html#1060" class="Record">Set⟨</a> <a id="6879" href="Deep.Ledger.html#449" class="Bound">Part</a> <a id="6884" href="Prelude.Sets.AsUniqueLists.Core.html#1060" class="Record">⟩</a>
<a id="6886" href="Deep.Ledger.html#6864" class="Function">mod</a> <a id="6890" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="6893" class="Symbol">=</a> <a id="6895" href="Prelude.Sets.AsUniqueLists.Core.html#2885" class="InductiveConstructor">∅</a>
<a id="6897" href="Deep.Ledger.html#6864" class="Function">mod</a> <a id="6901" class="Symbol">(</a><a id="6902" href="Deep.Ledger.html#6902" class="Bound">p₁</a> <a id="6905" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">—→⟨</a> <a id="6909" class="Symbol">_</a> <a id="6911" href="Deep.Ledger.html#818" class="InductiveConstructor Operator">⟩</a> <a id="6913" href="Deep.Ledger.html#6913" class="Bound">p₂</a> <a id="6916" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="6918" href="Deep.Ledger.html#6918" class="Bound">l</a><a id="6919" class="Symbol">)</a> <a id="6921" class="Symbol">=</a> <a id="6923" href="Prelude.Sets.AsUniqueLists.Core.html#2898" class="Function">singleton</a> <a id="6933" href="Deep.Ledger.html#6902" class="Bound">p₁</a> <a id="6936" href="Prelude.Sets.AsUniqueLists.Core.html#3203" class="Function Operator">∪</a> <a id="6938" href="Prelude.Sets.AsUniqueLists.Core.html#2898" class="Function">singleton</a> <a id="6948" href="Deep.Ledger.html#6913" class="Bound">p₂</a> <a id="6951" href="Prelude.Sets.AsUniqueLists.Core.html#3203" class="Function Operator">∪</a> <a id="6953" href="Deep.Ledger.html#6864" class="Function">mod</a> <a id="6957" href="Deep.Ledger.html#6918" class="Bound">l</a>

<a id="6960" class="Comment">-- ⟦⟧-constᵗ : dom (⟦ t ⟧ s) ≡ dom s</a>
<a id="6997" class="Comment">-- ⟦⟧-constᵗ {t = p —→⟨ n ⟩ p′}    = refl</a>

<a id="7040" class="Comment">-- ⟦⟧-const : ∀ {s} {l : L} → dom (⟦ l ⟧ s) ≡ dom s</a>
<a id="7092" class="Comment">-- ⟦⟧-const {s = _} {l = []}    = refl</a>
<a id="7131" class="Comment">-- ⟦⟧-const {s = s} {l = t ∷ l} rewrite ⟦⟧-const {⟦ t ⟧ s}{l} = ⟦⟧-constᵗ {t}{s}</a>

<a id="⟦⟧-union"></a><a id="7213" href="Deep.Ledger.html#7213" class="Function">⟦⟧-union</a> <a id="7222" class="Symbol">:</a>
    <a id="7228" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⟨</a> <a id="7230" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="7233" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⊎</a> <a id="7235" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="7238" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⟩≡</a> <a id="7241" href="Deep.Ledger.html#912" class="Generalizable">s</a>
    <a id="7247" class="Comment">--------------------------------------</a>
  <a id="7288" class="Symbol">→</a> <a id="7290" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⟨</a> <a id="7292" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7294" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7296" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7298" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="7301" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⊎</a> <a id="7303" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7305" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7307" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7309" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="7312" href="Prelude.Maps.Abstract.Interface.html#1651" class="Function Operator">⟩≡</a> <a id="7315" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7317" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7319" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7321" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="7323" href="Deep.Ledger.html#7213" class="Function">⟦⟧-union</a> <a id="7332" href="Deep.Ledger.html#7332" class="Bound">s₁⊎s₂</a> <a id="7338" class="Symbol">=</a> <a id="7340" class="Hole">{!!}</a> <a id="7345" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="7347" class="Hole">{!!}</a>

<a id="7353" class="Keyword">postulate</a>
  <a id="⟦⟧-♯"></a><a id="7365" href="Deep.Ledger.html#7365" class="Postulate">⟦⟧-♯</a> <a id="7370" class="Symbol">:</a>
      <a id="7378" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="7381" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="7383" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="7386" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="7388" href="Deep.Ledger.html#912" class="Generalizable">s</a>
      <a id="7396" class="Comment">-----------------------------</a>
    <a id="7430" class="Symbol">→</a> <a id="7432" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7434" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7436" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7438" href="Deep.Ledger.html#920" class="Generalizable">s₁</a> <a id="7441" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="7443" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7445" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7447" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7449" href="Deep.Ledger.html#923" class="Generalizable">s₂</a> <a id="7452" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="7454" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7456" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7458" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7460" href="Deep.Ledger.html#912" class="Generalizable">s</a>

<a id="7463" class="Comment">-- update-emptyᵗ : proj₁ s ≡ ∅ → ⟦ t ⟧ s ≡ s</a>
<a id="7508" class="Comment">-- update-emptyᵗ {.(⟨ [] ⟩∶- _) , snd} {x —→⟨ x₁ ⟩ x₂} refl = {!!}</a>

<a id="7576" class="Comment">-- update-empty : proj₁ s ≡ ∅ → ⟦ l ⟧ s ≡ s</a>
<a id="7620" class="Comment">-- update-empty {s}{[]}    refl = refl</a>
<a id="7659" class="Comment">-- update-empty {s}{t ∷ l} refl rewrite update-emptyᵗ {s}{t} refl = {!!}</a>
<a id="7732" class="Comment">-- rewrite update-empty {⟦ t ⟧ s}{l} (update-emptyᵗ {s}{t} refl) = refl</a>

<a id="frame"></a><a id="7805" href="Deep.Ledger.html#7805" class="Function">frame</a> <a id="7811" class="Symbol">:</a>
    <a id="7817" href="Deep.Ledger.html#6864" class="Function">mod</a> <a id="7821" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7823" href="Prelude.Apartness.html#255" class="Field Operator">♯</a> <a id="7825" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="7828" href="Deep.Ledger.html#4010" class="Generalizable">R</a>
  <a id="7832" class="Symbol">→</a> <a id="7834" href="Deep.Ledger.html#4010" class="Generalizable">R</a> <a id="7836" href="Deep.Ledger.html#3932" class="Function Operator">∙</a> <a id="7838" href="Deep.Ledger.html#912" class="Generalizable">s</a>
    <a id="7844" class="Comment">-----------</a>
  <a id="7858" class="Symbol">→</a> <a id="7860" href="Deep.Ledger.html#4010" class="Generalizable">R</a> <a id="7862" href="Deep.Ledger.html#3932" class="Function Operator">∙</a> <a id="7864" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="7866" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="7868" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="7870" href="Deep.Ledger.html#912" class="Generalizable">s</a>
<a id="7872" href="Deep.Ledger.html#7805" class="Function">frame</a> <a id="7878" class="Symbol">=</a> <a id="7880" class="Hole">{!!}</a>
<a id="7885" class="Comment">-- frame {l} {`emp}    {.(⟨ [] ⟩∶- _) , _} _ refl = subst (`emp ∙_) (sym $ update-empty {l = l} refl) refl</a>
<a id="7992" class="Comment">-- frame {l} {p `↦ v} {s} mod♯ (p∈ , p≡) = {!!}</a>
<a id="8040" class="Comment">-- frame {l} {P `∗ Q}  {s} mod♯ Rs = {!!}</a>
<a id="8082" class="Comment">-- frame {l} {P `—∗ Q} {s} mod♯ Rs = {!!}</a>
<a id="8124" class="Comment">-- frame {l} {P `∘ f}  {s} mod♯ Rs = {!!}</a>
<a id="8166" class="Comment">-- frame {[]} {R} {s} mod♯fv Rs = Rs</a>
<a id="8203" class="Comment">-- frame {(p —→⟨ n ⟩ p′) ∷ l} {R} {s} mod♯fv Rs = {!!}</a>

<a id="8259" class="Comment">-- need deeply-embedded Predˢ for fv</a>
<a id="[FRAME]"></a><a id="8296" href="Deep.Ledger.html#8296" class="Function">[FRAME]</a> <a id="8304" class="Symbol">:</a>
    <a id="8310" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="8312" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="8314" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="8316" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="8318" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="8320" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="8322" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>
  <a id="8326" class="Symbol">→</a> <a id="8328" href="Deep.Ledger.html#6864" class="Function">mod</a> <a id="8332" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="8334" href="Prelude.Apartness.html#255" class="Field Operator">♯</a> <a id="8336" href="Deep.Ledger.html#3212" class="Function">fv</a> <a id="8339" href="Deep.Ledger.html#4010" class="Generalizable">R</a>
    <a id="8345" class="Comment">-----------------------</a>
  <a id="8371" class="Symbol">→</a> <a id="8373" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="8375" href="Deep.Ledger.html#3988" class="Generalizable">P</a> <a id="8377" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="8380" href="Deep.Ledger.html#4010" class="Generalizable">R</a> <a id="8382" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a> <a id="8384" href="Deep.Ledger.html#947" class="Generalizable">l</a> <a id="8386" href="Deep.Ledger.html#4030" class="Datatype Operator">⟨</a> <a id="8388" href="Deep.Ledger.html#3999" class="Generalizable">Q</a> <a id="8390" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="8393" href="Deep.Ledger.html#4010" class="Generalizable">R</a> <a id="8395" href="Deep.Ledger.html#4030" class="Datatype Operator">⟩</a>
<a id="8397" href="Deep.Ledger.html#8296" class="Function">[FRAME]</a> <a id="8405" class="Symbol">{</a><a id="8406" href="Deep.Ledger.html#8406" class="Bound">P</a><a id="8407" class="Symbol">}{</a><a id="8409" href="Deep.Ledger.html#8409" class="Bound">l</a><a id="8410" class="Symbol">}{</a><a id="8412" href="Deep.Ledger.html#8412" class="Bound">Q</a><a id="8413" class="Symbol">}{</a><a id="8415" href="Deep.Ledger.html#8415" class="Bound">R</a><a id="8416" class="Symbol">}</a> <a id="8418" href="Deep.Ledger.html#8418" class="Bound">PlQ</a> <a id="8422" href="Deep.Ledger.html#8422" class="Bound">mod♯fv</a> <a id="8429" class="Symbol">=</a> <a id="8431" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="8437" href="Deep.Ledger.html#5196" class="Function">axiom⇔denot</a> <a id="8449" href="Deep.Ledger.html#8463" class="Function">d</a>
  <a id="8453" class="Keyword">where</a>
    <a id="8463" href="Deep.Ledger.html#8463" class="Function">d</a> <a id="8465" class="Symbol">:</a> <a id="8467" class="Symbol">(</a><a id="8468" href="Deep.Ledger.html#8406" class="Bound">P</a> <a id="8470" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="8473" href="Deep.Ledger.html#8415" class="Bound">R</a><a id="8474" class="Symbol">)</a> <a id="8476" href="Deep.Ledger.html#3870" class="Function Operator">`⊢</a> <a id="8479" class="Symbol">(</a><a id="8480" href="Deep.Ledger.html#8412" class="Bound">Q</a> <a id="8482" href="Deep.Ledger.html#3108" class="InductiveConstructor Operator">`∗</a> <a id="8485" href="Deep.Ledger.html#8415" class="Bound">R</a><a id="8486" class="Symbol">)</a> <a id="8488" href="Deep.Ledger.html#3157" class="InductiveConstructor Operator">`∘</a> <a id="8491" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8493" href="Deep.Ledger.html#8409" class="Bound">l</a> <a id="8495" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a>
    <a id="8501" href="Deep.Ledger.html#8463" class="Function">d</a> <a id="8503" class="Symbol">{</a><a id="8504" href="Deep.Ledger.html#8504" class="Bound">s</a><a id="8505" class="Symbol">}</a> <a id="8507" class="Symbol">(</a><a id="8508" href="Deep.Ledger.html#8508" class="Bound">s₁</a> <a id="8511" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8513" href="Deep.Ledger.html#8513" class="Bound">s₂</a> <a id="8516" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8518" href="Deep.Ledger.html#8518" class="Bound">s₁♯s₂</a> <a id="8524" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8526" href="Deep.Ledger.html#8526" class="Bound">Ps₁</a> <a id="8530" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8532" href="Deep.Ledger.html#8532" class="Bound">Rs₂</a><a id="8535" class="Symbol">)</a> <a id="8537" class="Symbol">=</a> <a id="8539" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8541" href="Deep.Ledger.html#8409" class="Bound">l</a> <a id="8543" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="8545" href="Deep.Ledger.html#8508" class="Bound">s₁</a> <a id="8548" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8550" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8552" href="Deep.Ledger.html#8409" class="Bound">l</a> <a id="8554" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="8556" href="Deep.Ledger.html#8513" class="Bound">s₂</a> <a id="8559" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8561" href="Deep.Ledger.html#9025" class="Function">p</a> <a id="8563" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8565" href="Deep.Ledger.html#8869" class="Function">Qs₁′</a> <a id="8570" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8572" href="Deep.Ledger.html#8939" class="Function">Rs₂′</a>
    <a id="8581" class="Comment">{-
      s = s₁ ⊎ s₂
      —→ ⟦l⟧s = ⟦l⟧s₁ ⊎ ⟦l⟧s₂
      P s₁
      —→ Q ⟦l⟧s₁
      R s₂
      —→ R ⟦l⟧s₂

         ⟦l⟧s = ⟦l⟧s₁ ⊎ ⟦l⟧s₂     Q ⟦l⟧s₁      R ⟦l⟧s₂
      ----------------------------------------------------
                          (Q ∗ R) ⟦l⟧s
    -}</a>
      <a id="8855" class="Keyword">where</a>
        <a id="8869" href="Deep.Ledger.html#8869" class="Function">Qs₁′</a> <a id="8874" class="Symbol">:</a> <a id="8876" href="Deep.Ledger.html#8412" class="Bound">Q</a> <a id="8878" href="Deep.Ledger.html#3932" class="Function Operator">∙</a> <a id="8880" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8882" href="Deep.Ledger.html#8409" class="Bound">l</a> <a id="8884" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="8886" href="Deep.Ledger.html#8508" class="Bound">s₁</a>
        <a id="8897" href="Deep.Ledger.html#8869" class="Function">Qs₁′</a> <a id="8902" class="Symbol">=</a> <a id="8904" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="8910" href="Deep.Ledger.html#5196" class="Function">axiom⇔denot</a> <a id="8922" href="Deep.Ledger.html#8418" class="Bound">PlQ</a> <a id="8926" href="Deep.Ledger.html#8526" class="Bound">Ps₁</a>

        <a id="8939" href="Deep.Ledger.html#8939" class="Function">Rs₂′</a> <a id="8944" class="Symbol">:</a> <a id="8946" href="Deep.Ledger.html#8415" class="Bound">R</a> <a id="8948" href="Deep.Ledger.html#3932" class="Function Operator">∙</a> <a id="8950" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="8952" href="Deep.Ledger.html#8409" class="Bound">l</a> <a id="8954" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="8956" href="Deep.Ledger.html#8513" class="Bound">s₂</a>
        <a id="8967" href="Deep.Ledger.html#8939" class="Function">Rs₂′</a> <a id="8972" class="Symbol">=</a> <a id="8974" href="Deep.Ledger.html#7805" class="Function">frame</a> <a id="8980" class="Symbol">{</a><a id="8981" class="Argument">l</a> <a id="8983" class="Symbol">=</a> <a id="8985" href="Deep.Ledger.html#8409" class="Bound">l</a><a id="8986" class="Symbol">}</a> <a id="8988" class="Symbol">{</a><a id="8989" class="Argument">R</a> <a id="8991" class="Symbol">=</a> <a id="8993" href="Deep.Ledger.html#8415" class="Bound">R</a><a id="8994" class="Symbol">}</a> <a id="8996" class="Symbol">{</a><a id="8997" class="Argument">s</a> <a id="8999" class="Symbol">=</a> <a id="9001" href="Deep.Ledger.html#8513" class="Bound">s₂</a><a id="9003" class="Symbol">}</a> <a id="9005" href="Deep.Ledger.html#8422" class="Bound">mod♯fv</a> <a id="9012" href="Deep.Ledger.html#8532" class="Bound">Rs₂</a>

        <a id="9025" href="Deep.Ledger.html#9025" class="Function">p</a> <a id="9027" class="Symbol">:</a> <a id="9029" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="9031" href="Deep.Ledger.html#8409" class="Bound">l</a> <a id="9033" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="9035" href="Deep.Ledger.html#8508" class="Bound">s₁</a> <a id="9038" href="Deep.Ledger.html#3430" class="Function Operator">♯</a> <a id="9040" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="9042" href="Deep.Ledger.html#8409" class="Bound">l</a> <a id="9044" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="9046" href="Deep.Ledger.html#8513" class="Bound">s₂</a> <a id="9049" href="Deep.Ledger.html#3430" class="Function Operator">←</a> <a id="9051" href="Deep.Ledger.html#1086" class="Field Operator">⟦</a> <a id="9053" href="Deep.Ledger.html#8409" class="Bound">l</a> <a id="9055" href="Deep.Ledger.html#1086" class="Field Operator">⟧</a> <a id="9057" href="Deep.Ledger.html#8504" class="Bound">s</a>
        <a id="9067" href="Deep.Ledger.html#9025" class="Function">p</a> <a id="9069" class="Symbol">=</a> <a id="9071" href="Deep.Ledger.html#7365" class="Postulate">⟦⟧-♯</a> <a id="9076" class="Symbol">{</a><a id="9077" href="Deep.Ledger.html#8508" class="Bound">s₁</a><a id="9079" class="Symbol">}{</a><a id="9081" href="Deep.Ledger.html#8513" class="Bound">s₂</a><a id="9083" class="Symbol">}{</a><a id="9085" href="Deep.Ledger.html#8504" class="Bound">s</a><a id="9086" class="Symbol">}{</a><a id="9088" href="Deep.Ledger.html#8409" class="Bound">l</a><a id="9089" class="Symbol">}</a> <a id="9091" href="Deep.Ledger.html#8518" class="Bound">s₁♯s₂</a>
<a id="9097" class="Comment">{-

-- ** Concurrent separation logic
open import Data.List.Relation.Ternary.Interleaving
_∥_←_ : L → L → L → Type
l₁ ∥ l₂ ← l = Interleaving _≡_ _≡_ l₁ l₂ l

h :
    s₁ ♯ s₂ ← s
  → l₁ ∥ l₂ ← l
  → mod l₁ S.♯ mod l₂
    -------------------------------
  → ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂ ← ⟦ l ⟧ s
h {s₁}{s₂}{s}{l₁}{l₂}{l} s₁♯s₂ l₁∥l₂ l₁♯l₂ = h₁ , h₂
  where
    ps₁ = proj₁ (⟦ l₁ ⟧ s₁)
    ps₂ = proj₁ (⟦ l₂ ⟧ s₂)

    All∉ : All (_∉′ ps₂) (list ps₁)
    All∉ = {!!}

    h₁ : ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂
    h₁ = let p = L.filter-none (_∈′? ps₂) {xs = list ps₁} All∉ in {!!} -- subst _ p refl

    h₂ : ⟦ l ⟧ s ≡ᵐ union (⟦ l₁ ⟧ s₁) (⟦ l₂ ⟧ s₂)
    h₂ = {!!}

[INTERLEAVE] :
    l₁ ∥ l₂ ← l
  → ⟨ P₁ ⟩ l₁ ⟨ Q₁ ⟩
  → ⟨ P₂ ⟩ l₂ ⟨ Q₂ ⟩
  → mod l₁ S.♯ mod l₂
  -- → fv P₁ ∪ fv Q₁ S.♯ mod l₂
  -- → fv P₂ ∪ fv Q₂ S.♯ mod l₁
    ---------------------------
  → ⟨ P₁ `∗ P₂ ⟩ l ⟨ Q₁ `∗ Q₂ ⟩

[INTERLEAVE] {l₁}{l₂}{l}{P₁}{Q₁}{P₂}{Q₂} l₁∥l₂ PlQ PlQ′ l₁♯l₂ = proj₂ axiom⇔denot d
  where
    d : (P₁ `∗ P₂) `⊢ (Q₁ `∗ Q₂) `∘ ⟦ l ⟧
    d {s} (s₁ , s₂ , s₁♯s₂ , Ps₁ , Ps₂) = _ , _ , q , q₁ , q₂
      where
        q₁ : Q₁ ∙ ⟦ l₁ ⟧ s₁
        q₁ = proj₁ axiom⇔denot PlQ Ps₁

        q₂ : Q₂ ∙ ⟦ l₂ ⟧ s₂
        q₂ = proj₁ axiom⇔denot PlQ′ Ps₂

        q : ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂ ← ⟦ l ⟧ s
        q = {!!} -- h s₁♯s₂ l₁∥l₂ l₁♯l₂
-}</a>
</pre></body></html>