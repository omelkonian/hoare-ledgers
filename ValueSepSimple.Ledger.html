<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ValueSepSimple.Ledger</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------</a>
<a id="44" class="Comment">-- ** Denotational &amp; operational semantics</a>

<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="113" class="Keyword">open</a> <a id="118" class="Keyword">import</a> <a id="125" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="221" class="Keyword">open</a> <a id="226" class="Keyword">import</a> <a id="233" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="251" class="Keyword">open</a> <a id="256" class="Keyword">import</a> <a id="263" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="278" class="Keyword">open</a> <a id="283" class="Keyword">import</a> <a id="290" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="398" class="Keyword">module</a> <a id="405" href="ValueSepSimple.Ledger.html" class="Module">ValueSepSimple.Ledger</a>
  <a id="429" class="Symbol">(</a><a id="430" href="ValueSepSimple.Ledger.html#430" class="Bound">Part</a> <a id="435" class="Symbol">:</a> <a id="437" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="440" class="Symbol">)</a> <a id="442" class="Comment">-- a fixed set of participants</a>
  <a id="475" class="Symbol">⦃</a> <a id="477" href="ValueSepSimple.Ledger.html#477" class="Bound">_</a> <a id="479" class="Symbol">:</a> <a id="481" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="487" href="ValueSepSimple.Ledger.html#430" class="Bound">Part</a> <a id="492" class="Symbol">⦄</a>
  <a id="496" class="Keyword">where</a>

<a id="503" class="Keyword">variable</a>
  <a id="514" href="ValueSepSimple.Ledger.html#514" class="Generalizable">A</a> <a id="516" href="ValueSepSimple.Ledger.html#516" class="Generalizable">B</a> <a id="518" href="ValueSepSimple.Ledger.html#518" class="Generalizable">C</a> <a id="520" href="ValueSepSimple.Ledger.html#520" class="Generalizable">D</a> <a id="522" class="Symbol">:</a> <a id="524" href="ValueSepSimple.Ledger.html#430" class="Bound">Part</a>
  <a id="531" href="ValueSepSimple.Ledger.html#531" class="Generalizable">v</a> <a id="533" href="ValueSepSimple.Ledger.html#533" class="Generalizable">v′</a> <a id="536" href="ValueSepSimple.Ledger.html#536" class="Generalizable">v″</a> <a id="539" class="Symbol">:</a> <a id="541" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="544" class="Keyword">open</a> <a id="549" class="Keyword">import</a> <a id="556" href="ValueSepSimple.Maps.html" class="Module">ValueSepSimple.Maps</a>

<a id="577" class="Comment">-- The state of a ledger is a collection of participants, along with their balance.</a>
<a id="S"></a><a id="661" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="663" class="Symbol">:</a> <a id="665" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="669" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="671" class="Symbol">=</a> <a id="673" href="ValueSepSimple.Maps.html#307" class="Function">Map⟨</a> <a id="678" href="ValueSepSimple.Ledger.html#430" class="Bound">Part</a> <a id="683" href="ValueSepSimple.Maps.html#307" class="Function">↦ℕ⟩</a>

<a id="688" class="Comment">-- A transaction is transferring money from one participant to another.</a>
<a id="760" class="Keyword">record</a> <a id="Tx"></a><a id="767" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a> <a id="770" class="Symbol">:</a> <a id="772" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="776" class="Keyword">where</a>
  <a id="784" class="Keyword">constructor</a> <a id="_—→⟨_⟩_"></a><a id="796" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">_—→⟨_⟩_</a>
  <a id="806" class="Keyword">field</a>
    <a id="Tx.sender"></a><a id="816" href="ValueSepSimple.Ledger.html#816" class="Field">sender</a>   <a id="825" class="Symbol">:</a> <a id="827" href="ValueSepSimple.Ledger.html#430" class="Bound">Part</a>
    <a id="Tx.value"></a><a id="836" href="ValueSepSimple.Ledger.html#836" class="Field">value</a>    <a id="845" class="Symbol">:</a> <a id="847" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Tx.receiver"></a><a id="853" href="ValueSepSimple.Ledger.html#853" class="Field">receiver</a> <a id="862" class="Symbol">:</a> <a id="864" href="ValueSepSimple.Ledger.html#430" class="Bound">Part</a>
<a id="869" class="Keyword">open</a> <a id="874" href="ValueSepSimple.Ledger.html#767" class="Module">Tx</a> <a id="877" class="Keyword">public</a>
<a id="884" class="Keyword">unquoteDecl</a> <a id="DecEq-Tx"></a><a id="896" href="ValueSepSimple.Ledger.html#896" class="Function">DecEq-Tx</a> <a id="905" class="Symbol">=</a> <a id="907" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="914" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="920" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="922" class="Keyword">quote</a> <a id="928" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a> <a id="931" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="933" href="ValueSepSimple.Ledger.html#896" class="Function">DecEq-Tx</a> <a id="942" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="945" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="984" href="ValueSepSimple.Ledger.html#984" class="Function">L</a> <a id="986" class="Symbol">=</a> <a id="988" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="993" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a>

<a id="997" class="Keyword">variable</a>
  <a id="1008" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="1010" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a> <a id="1013" href="ValueSepSimple.Ledger.html#1013" class="Generalizable">s″</a> <a id="1016" href="ValueSepSimple.Ledger.html#1016" class="Generalizable">s₁</a> <a id="1019" href="ValueSepSimple.Ledger.html#1019" class="Generalizable">s₁′</a> <a id="1023" href="ValueSepSimple.Ledger.html#1023" class="Generalizable">s₁″</a> <a id="1027" href="ValueSepSimple.Ledger.html#1027" class="Generalizable">s₂</a> <a id="1030" href="ValueSepSimple.Ledger.html#1030" class="Generalizable">s₂′</a> <a id="1034" href="ValueSepSimple.Ledger.html#1034" class="Generalizable">s₂″</a> <a id="1038" href="ValueSepSimple.Ledger.html#1038" class="Generalizable">s₃</a> <a id="1041" href="ValueSepSimple.Ledger.html#1041" class="Generalizable">s₃′</a> <a id="1045" href="ValueSepSimple.Ledger.html#1045" class="Generalizable">s₃″</a> <a id="1049" href="ValueSepSimple.Ledger.html#1049" class="Generalizable">s₂₃</a> <a id="1053" href="ValueSepSimple.Ledger.html#1053" class="Generalizable">s₂₃′</a> <a id="1058" href="ValueSepSimple.Ledger.html#1058" class="Generalizable">s₂₃″</a> <a id="1063" class="Symbol">:</a> <a id="1065" href="ValueSepSimple.Ledger.html#661" class="Function">S</a>
  <a id="1069" href="ValueSepSimple.Ledger.html#1069" class="Generalizable">t</a> <a id="1071" href="ValueSepSimple.Ledger.html#1071" class="Generalizable">t′</a> <a id="1074" href="ValueSepSimple.Ledger.html#1074" class="Generalizable">t″</a> <a id="1077" class="Symbol">:</a> <a id="1079" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a>
  <a id="1084" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="1086" href="ValueSepSimple.Ledger.html#1086" class="Generalizable">l′</a> <a id="1089" href="ValueSepSimple.Ledger.html#1089" class="Generalizable">l″</a> <a id="1092" href="ValueSepSimple.Ledger.html#1092" class="Generalizable">l₁</a> <a id="1095" href="ValueSepSimple.Ledger.html#1095" class="Generalizable">l₂</a> <a id="1098" class="Symbol">:</a> <a id="1100" href="ValueSepSimple.Ledger.html#984" class="Function">L</a>
  <a id="1104" href="ValueSepSimple.Ledger.html#1104" class="Generalizable">ls</a> <a id="1107" href="ValueSepSimple.Ledger.html#1107" class="Generalizable">ls′</a> <a id="1111" href="ValueSepSimple.Ledger.html#1111" class="Generalizable">ls″</a> <a id="1115" class="Symbol">:</a> <a id="1117" href="ValueSepSimple.Ledger.html#984" class="Function">L</a> <a id="1119" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1121" href="ValueSepSimple.Ledger.html#661" class="Function">S</a>

  <a id="1126" href="ValueSepSimple.Ledger.html#1126" class="Generalizable">ms</a> <a id="1129" href="ValueSepSimple.Ledger.html#1129" class="Generalizable">ms′</a> <a id="1133" href="ValueSepSimple.Ledger.html#1133" class="Generalizable">ms″</a> <a id="1137" class="Symbol">:</a> <a id="1139" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1145" href="ValueSepSimple.Ledger.html#661" class="Function">S</a>
  <a id="1149" href="ValueSepSimple.Ledger.html#1149" class="Generalizable">mls</a> <a id="1153" href="ValueSepSimple.Ledger.html#1153" class="Generalizable">mls′</a> <a id="1158" href="ValueSepSimple.Ledger.html#1158" class="Generalizable">mls″</a> <a id="1163" class="Symbol">:</a> <a id="1165" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1171" class="Symbol">(</a><a id="1172" href="ValueSepSimple.Ledger.html#984" class="Function">L</a> <a id="1174" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1176" href="ValueSepSimple.Ledger.html#661" class="Function">S</a><a id="1177" class="Symbol">)</a>

<a id="1180" class="Comment">-- ** Denotational semantics</a>

<a id="1210" class="Comment">-- The meaning of a transaction or a whole ledger will be denoted by state transformers,</a>
<a id="1299" class="Comment">-- i.e. a function from the current state to the updated one that may produce an error.</a>
<a id="Domain"></a><a id="1387" href="ValueSepSimple.Ledger.html#1387" class="Function">Domain</a> <a id="1394" class="Symbol">=</a> <a id="1396" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="1398" class="Symbol">→</a> <a id="1400" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1406" href="ValueSepSimple.Ledger.html#661" class="Function">S</a>

<a id="1409" class="Keyword">record</a> <a id="Denotable"></a><a id="1416" href="ValueSepSimple.Ledger.html#1416" class="Record">Denotable</a> <a id="1426" class="Symbol">(</a><a id="1427" href="ValueSepSimple.Ledger.html#1427" class="Bound">A</a> <a id="1429" class="Symbol">:</a> <a id="1431" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1434" class="Symbol">)</a> <a id="1436" class="Symbol">:</a> <a id="1438" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1442" class="Keyword">where</a>
  <a id="1450" class="Keyword">field</a> <a id="Denotable.⟦_⟧"></a><a id="1456" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦_⟧</a> <a id="1460" class="Symbol">:</a> <a id="1462" href="ValueSepSimple.Ledger.html#1427" class="Bound">A</a> <a id="1464" class="Symbol">→</a> <a id="1466" href="ValueSepSimple.Ledger.html#1387" class="Function">Domain</a>
<a id="1473" class="Keyword">open</a> <a id="1478" href="ValueSepSimple.Ledger.html#1416" class="Module">Denotable</a> <a id="1488" class="Symbol">⦃...⦄</a> <a id="1494" class="Keyword">public</a>

<a id="1502" class="Comment">-- pure fragment without error-handling</a>
<a id="Domain₀"></a><a id="1542" href="ValueSepSimple.Ledger.html#1542" class="Function">Domain₀</a> <a id="1550" class="Symbol">=</a> <a id="1552" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="1554" class="Symbol">→</a> <a id="1556" href="ValueSepSimple.Ledger.html#661" class="Function">S</a>

<a id="1559" class="Keyword">record</a> <a id="Denotable₀"></a><a id="1566" href="ValueSepSimple.Ledger.html#1566" class="Record">Denotable₀</a> <a id="1577" class="Symbol">(</a><a id="1578" href="ValueSepSimple.Ledger.html#1578" class="Bound">A</a> <a id="1580" class="Symbol">:</a> <a id="1582" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1585" class="Symbol">)</a> <a id="1587" class="Symbol">:</a> <a id="1589" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1593" class="Keyword">where</a>
  <a id="1601" class="Keyword">field</a> <a id="Denotable₀.⟦_⟧₀"></a><a id="1607" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦_⟧₀</a> <a id="1612" class="Symbol">:</a> <a id="1614" href="ValueSepSimple.Ledger.html#1578" class="Bound">A</a> <a id="1616" class="Symbol">→</a> <a id="1618" href="ValueSepSimple.Ledger.html#1542" class="Function">Domain₀</a>
<a id="1626" class="Keyword">open</a> <a id="1631" href="ValueSepSimple.Ledger.html#1566" class="Module">Denotable₀</a> <a id="1642" class="Symbol">⦃...⦄</a> <a id="1648" class="Keyword">public</a>

<a id="IsValidTx"></a><a id="1656" href="ValueSepSimple.Ledger.html#1656" class="Function">IsValidTx</a> <a id="1666" class="Symbol">:</a> <a id="1668" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a> <a id="1671" class="Symbol">→</a> <a id="1673" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="1675" class="Symbol">→</a> <a id="1677" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1681" href="ValueSepSimple.Ledger.html#1656" class="Function">IsValidTx</a> <a id="1691" class="Symbol">(</a><a id="1692" href="ValueSepSimple.Ledger.html#1692" class="Bound">A</a> <a id="1694" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">—→⟨</a> <a id="1698" href="ValueSepSimple.Ledger.html#1698" class="Bound">v</a> <a id="1700" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">⟩</a> <a id="1702" class="Symbol">_)</a> <a id="1705" href="ValueSepSimple.Ledger.html#1705" class="Bound">s</a> <a id="1707" class="Symbol">=</a> <a id="1709" href="ValueSepSimple.Ledger.html#1698" class="Bound">v</a> <a id="1711" href="Prelude.Ord.html#267" class="Field Operator">≤</a> <a id="1713" href="ValueSepSimple.Ledger.html#1705" class="Bound">s</a> <a id="1715" href="ValueSepSimple.Ledger.html#1692" class="Bound">A</a>

<a id="1718" class="Keyword">data</a> <a id="IsValidTx′"></a><a id="1723" href="ValueSepSimple.Ledger.html#1723" class="Datatype">IsValidTx′</a> <a id="1734" class="Symbol">:</a> <a id="1736" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a> <a id="1739" class="Symbol">→</a> <a id="1741" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="1743" class="Symbol">→</a> <a id="1745" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1749" class="Keyword">where</a>

  <a id="IsValidTx′.mkValid"></a><a id="1758" href="ValueSepSimple.Ledger.html#1758" class="InductiveConstructor">mkValid</a> <a id="1766" class="Symbol">:</a>

    <a id="1773" href="ValueSepSimple.Ledger.html#531" class="Generalizable">v</a> <a id="1775" href="Prelude.Ord.html#267" class="Field Operator">≤</a> <a id="1777" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="1779" href="ValueSepSimple.Ledger.html#514" class="Generalizable">A</a>
    <a id="1785" href="Prelude.InferenceRules.html#13944" class="Function Operator">──────────────────────────</a>
    <a id="1816" href="ValueSepSimple.Ledger.html#1723" class="Datatype">IsValidTx′</a> <a id="1827" class="Symbol">(</a><a id="1828" href="ValueSepSimple.Ledger.html#514" class="Generalizable">A</a> <a id="1830" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">—→⟨</a> <a id="1834" href="ValueSepSimple.Ledger.html#531" class="Generalizable">v</a> <a id="1836" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">⟩</a> <a id="1838" href="ValueSepSimple.Ledger.html#516" class="Generalizable">B</a><a id="1839" class="Symbol">)</a> <a id="1841" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a>

<a id="isValidTx?"></a><a id="1844" href="ValueSepSimple.Ledger.html#1844" class="Function">isValidTx?</a> <a id="1855" class="Symbol">:</a> <a id="1857" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable²</a> <a id="1868" href="ValueSepSimple.Ledger.html#1656" class="Function">IsValidTx</a>
<a id="1878" href="ValueSepSimple.Ledger.html#1844" class="Function">isValidTx?</a> <a id="1889" class="Symbol">=</a> <a id="1891" href="Prelude.Decidable.Base.html#828" class="Function">dec²</a>

<a id="isValidTx"></a><a id="1897" href="ValueSepSimple.Ledger.html#1897" class="Function">isValidTx</a> <a id="1907" class="Symbol">:</a> <a id="1909" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a> <a id="1912" class="Symbol">→</a> <a id="1914" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="1916" class="Symbol">→</a> <a id="1918" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1923" href="ValueSepSimple.Ledger.html#1897" class="Function">isValidTx</a> <a id="1933" href="ValueSepSimple.Ledger.html#1933" class="Bound">t</a> <a id="1935" href="ValueSepSimple.Ledger.html#1935" class="Bound">s</a> <a id="1937" class="Symbol">=</a> <a id="1939" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="1941" href="ValueSepSimple.Ledger.html#1844" class="Function">isValidTx?</a> <a id="1952" href="ValueSepSimple.Ledger.html#1933" class="Bound">t</a> <a id="1954" href="ValueSepSimple.Ledger.html#1935" class="Bound">s</a> <a id="1956" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>

<a id="1959" class="Comment">-- Express the action of tranferring values between keys in a map.</a>
<a id="2026" class="Comment">-- NB: a transaction goes through only when:</a>
<a id="2071" class="Comment">--   1. both participants are present in the domain</a>
<a id="2123" class="Comment">--   2. the sender holds sufficient funds</a>
<a id="2165" class="Keyword">instance</a>
  <a id="2176" class="Comment">-- we denote a transaction as the map transformation that implements the transfer</a>
  <a id="⟦Tx⟧₀"></a><a id="2260" href="ValueSepSimple.Ledger.html#2260" class="Function">⟦Tx⟧₀</a> <a id="2266" class="Symbol">:</a> <a id="2268" href="ValueSepSimple.Ledger.html#1566" class="Record">Denotable₀</a> <a id="2279" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a>
  <a id="2284" href="ValueSepSimple.Ledger.html#2260" class="Function">⟦Tx⟧₀</a> <a id="2290" class="Symbol">.</a><a id="2291" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦_⟧₀</a> <a id="2296" class="Symbol">(</a><a id="2297" href="ValueSepSimple.Ledger.html#2297" class="Bound">A</a> <a id="2299" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">—→⟨</a> <a id="2303" href="ValueSepSimple.Ledger.html#2303" class="Bound">v</a> <a id="2305" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">⟩</a> <a id="2307" href="ValueSepSimple.Ledger.html#2307" class="Bound">B</a><a id="2308" class="Symbol">)</a> <a id="2310" href="ValueSepSimple.Ledger.html#2310" class="Bound">s</a> <a id="2312" class="Symbol">=</a> <a id="2314" href="ValueSepSimple.Ledger.html#2310" class="Bound">s</a> <a id="2316" href="ValueSepSimple.Maps.html#1104" class="Function Operator">[</a> <a id="2318" href="ValueSepSimple.Ledger.html#2297" class="Bound">A</a> <a id="2320" href="ValueSepSimple.Maps.html#1104" class="Function Operator">↝</a> <a id="2322" class="Symbol">(</a><a id="2323" href="Data.Nat.Base.html#2874" class="Primitive Operator">_∸</a> <a id="2326" href="ValueSepSimple.Ledger.html#2303" class="Bound">v</a><a id="2327" class="Symbol">)</a> <a id="2329" href="ValueSepSimple.Maps.html#1104" class="Function Operator">]</a> <a id="2331" href="ValueSepSimple.Maps.html#1104" class="Function Operator">[</a> <a id="2333" href="ValueSepSimple.Ledger.html#2307" class="Bound">B</a> <a id="2335" href="ValueSepSimple.Maps.html#1104" class="Function Operator">↝</a> <a id="2337" class="Symbol">(</a><a id="2338" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="2341" href="ValueSepSimple.Ledger.html#2303" class="Bound">v</a><a id="2342" class="Symbol">)</a> <a id="2344" href="ValueSepSimple.Maps.html#1104" class="Function Operator">]</a>

  <a id="⟦Tx⟧"></a><a id="2349" href="ValueSepSimple.Ledger.html#2349" class="Function">⟦Tx⟧</a> <a id="2354" class="Symbol">:</a> <a id="2356" href="ValueSepSimple.Ledger.html#1416" class="Record">Denotable</a> <a id="2366" href="ValueSepSimple.Ledger.html#767" class="Record">Tx</a>
  <a id="2371" href="ValueSepSimple.Ledger.html#2349" class="Function">⟦Tx⟧</a> <a id="2376" class="Symbol">.</a><a id="2377" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦_⟧</a> <a id="2381" href="ValueSepSimple.Ledger.html#2381" class="Bound">t</a> <a id="2383" href="ValueSepSimple.Ledger.html#2383" class="Bound">s</a> <a id="2385" class="Symbol">=</a> <a id="2387" href="Data.Maybe.Base.html#2450" class="Function">M.when</a> <a id="2394" class="Symbol">(</a><a id="2395" href="ValueSepSimple.Ledger.html#1897" class="Function">isValidTx</a> <a id="2405" href="ValueSepSimple.Ledger.html#2381" class="Bound">t</a> <a id="2407" href="ValueSepSimple.Ledger.html#2383" class="Bound">s</a><a id="2408" class="Symbol">)</a> <a id="2410" class="Symbol">(</a><a id="2411" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦</a> <a id="2413" href="ValueSepSimple.Ledger.html#2381" class="Bound">t</a> <a id="2415" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟧₀</a> <a id="2418" href="ValueSepSimple.Ledger.html#2383" class="Bound">s</a><a id="2419" class="Symbol">)</a>

  <a id="2424" class="Comment">-- we denote a ledger as the composition of the denotations of its transactions,</a>
  <a id="2507" class="Comment">-- i.e. we run all transactions in sequence</a>
  <a id="⟦L⟧₀"></a><a id="2553" href="ValueSepSimple.Ledger.html#2553" class="Function">⟦L⟧₀</a> <a id="2558" class="Symbol">:</a> <a id="2560" href="ValueSepSimple.Ledger.html#1566" class="Record">Denotable₀</a> <a id="2571" href="ValueSepSimple.Ledger.html#984" class="Function">L</a>
  <a id="2575" href="ValueSepSimple.Ledger.html#2553" class="Function">⟦L⟧₀</a> <a id="2580" class="Symbol">.</a><a id="2581" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦_⟧₀</a> <a id="2586" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>      <a id="2594" class="Symbol">=</a> <a id="2596" href="Function.Base.html#615" class="Function">id</a>
  <a id="2601" href="ValueSepSimple.Ledger.html#2553" class="Function">⟦L⟧₀</a> <a id="2606" class="Symbol">.</a><a id="2607" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦_⟧₀</a> <a id="2612" class="Symbol">(</a><a id="2613" href="ValueSepSimple.Ledger.html#2613" class="Bound">t</a> <a id="2615" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2617" href="ValueSepSimple.Ledger.html#2617" class="Bound">l</a><a id="2618" class="Symbol">)</a> <a id="2620" class="Symbol">=</a> <a id="2622" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦</a> <a id="2624" href="ValueSepSimple.Ledger.html#2617" class="Bound">l</a> <a id="2626" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟧₀</a> <a id="2629" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2631" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦</a> <a id="2633" href="ValueSepSimple.Ledger.html#2613" class="Bound">t</a> <a id="2635" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟧₀</a>

  <a id="⟦L⟧"></a><a id="2641" href="ValueSepSimple.Ledger.html#2641" class="Function">⟦L⟧</a> <a id="2645" class="Symbol">:</a> <a id="2647" href="ValueSepSimple.Ledger.html#1416" class="Record">Denotable</a> <a id="2657" href="ValueSepSimple.Ledger.html#984" class="Function">L</a>
  <a id="2661" href="ValueSepSimple.Ledger.html#2641" class="Function">⟦L⟧</a> <a id="2665" class="Symbol">.</a><a id="2666" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦_⟧</a> <a id="2670" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>      <a id="2678" href="ValueSepSimple.Ledger.html#2678" class="Bound">s</a> <a id="2680" class="Symbol">=</a> <a id="2682" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2687" href="ValueSepSimple.Ledger.html#2678" class="Bound">s</a>
  <a id="2691" href="ValueSepSimple.Ledger.html#2641" class="Function">⟦L⟧</a> <a id="2695" class="Symbol">.</a><a id="2696" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦_⟧</a> <a id="2700" class="Symbol">(</a><a id="2701" href="ValueSepSimple.Ledger.html#2701" class="Bound">t</a> <a id="2703" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2705" href="ValueSepSimple.Ledger.html#2705" class="Bound">l</a><a id="2706" class="Symbol">)</a> <a id="2708" class="Symbol">=</a> <a id="2710" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="2712" href="ValueSepSimple.Ledger.html#2701" class="Bound">t</a> <a id="2714" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a> <a id="2716" href="Prelude.Monad.html#754" class="Function Operator">&gt;=&gt;</a> <a id="2720" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="2722" href="ValueSepSimple.Ledger.html#2705" class="Bound">l</a> <a id="2724" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a>

<a id="comp₀"></a><a id="2727" href="ValueSepSimple.Ledger.html#2727" class="Function">comp₀</a> <a id="2733" class="Symbol">:</a> <a id="2735" class="Symbol">∀</a> <a id="2737" href="ValueSepSimple.Ledger.html#2737" class="Bound">x</a> <a id="2739" class="Symbol">→</a> <a id="2741" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦</a> <a id="2743" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="2745" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2748" href="ValueSepSimple.Ledger.html#1086" class="Generalizable">l′</a> <a id="2751" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟧₀</a> <a id="2754" href="ValueSepSimple.Ledger.html#2737" class="Bound">x</a> <a id="2756" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2758" class="Symbol">(</a><a id="2759" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦</a> <a id="2761" href="ValueSepSimple.Ledger.html#1086" class="Generalizable">l′</a> <a id="2764" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟧₀</a> <a id="2767" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2769" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦</a> <a id="2771" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="2773" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟧₀</a><a id="2775" class="Symbol">)</a> <a id="2777" href="ValueSepSimple.Ledger.html#2737" class="Bound">x</a>
<a id="2779" href="ValueSepSimple.Ledger.html#2727" class="Function">comp₀</a> <a id="2785" class="Symbol">{</a><a id="2786" class="Argument">l</a> <a id="2788" class="Symbol">=</a> <a id="2790" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2792" class="Symbol">}</a>    <a id="2797" class="Symbol">_</a> <a id="2799" class="Symbol">=</a> <a id="2801" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="2806" href="ValueSepSimple.Ledger.html#2727" class="Function">comp₀</a> <a id="2812" class="Symbol">{</a><a id="2813" class="Argument">l</a> <a id="2815" class="Symbol">=</a> <a id="2817" href="ValueSepSimple.Ledger.html#2817" class="Bound">t</a> <a id="2819" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2821" href="ValueSepSimple.Ledger.html#2821" class="Bound">l</a><a id="2822" class="Symbol">}</a> <a id="2824" href="ValueSepSimple.Ledger.html#2824" class="Bound">x</a> <a id="2826" class="Symbol">=</a> <a id="2828" href="ValueSepSimple.Ledger.html#2727" class="Function">comp₀</a> <a id="2834" class="Symbol">{</a><a id="2835" href="ValueSepSimple.Ledger.html#2821" class="Bound">l</a><a id="2836" class="Symbol">}</a> <a id="2838" class="Symbol">(</a><a id="2839" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦</a> <a id="2841" href="ValueSepSimple.Ledger.html#2817" class="Bound">t</a> <a id="2843" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟧₀</a> <a id="2846" href="ValueSepSimple.Ledger.html#2824" class="Bound">x</a><a id="2847" class="Symbol">)</a>

<a id="comp"></a><a id="2850" href="ValueSepSimple.Ledger.html#2850" class="Function">comp</a> <a id="2855" class="Symbol">:</a> <a id="2857" class="Symbol">∀</a> <a id="2859" href="ValueSepSimple.Ledger.html#2859" class="Bound">x</a> <a id="2861" class="Symbol">→</a> <a id="2863" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="2865" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="2867" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2870" href="ValueSepSimple.Ledger.html#1086" class="Generalizable">l′</a> <a id="2873" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a> <a id="2875" href="ValueSepSimple.Ledger.html#2859" class="Bound">x</a> <a id="2877" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2879" class="Symbol">(</a><a id="2880" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="2882" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="2884" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a> <a id="2886" href="Prelude.Monad.html#754" class="Function Operator">&gt;=&gt;</a> <a id="2890" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="2892" href="ValueSepSimple.Ledger.html#1086" class="Generalizable">l′</a> <a id="2895" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a><a id="2896" class="Symbol">)</a> <a id="2898" href="ValueSepSimple.Ledger.html#2859" class="Bound">x</a>
<a id="2900" href="ValueSepSimple.Ledger.html#2850" class="Function">comp</a> <a id="2905" class="Symbol">{</a><a id="2906" class="Argument">l</a> <a id="2908" class="Symbol">=</a> <a id="2910" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2912" class="Symbol">}</a>    <a id="2917" href="ValueSepSimple.Ledger.html#2917" class="Bound">x</a> <a id="2919" class="Symbol">=</a> <a id="2921" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="2926" href="ValueSepSimple.Ledger.html#2850" class="Function">comp</a> <a id="2931" class="Symbol">{</a><a id="2932" class="Argument">l</a> <a id="2934" class="Symbol">=</a> <a id="2936" href="ValueSepSimple.Ledger.html#2936" class="Bound">t</a> <a id="2938" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2940" href="ValueSepSimple.Ledger.html#2940" class="Bound">l</a><a id="2941" class="Symbol">}</a> <a id="2943" href="ValueSepSimple.Ledger.html#2943" class="Bound">x</a> <a id="2945" class="Keyword">with</a> <a id="2950" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="2952" href="ValueSepSimple.Ledger.html#2936" class="Bound">t</a> <a id="2954" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a> <a id="2956" href="ValueSepSimple.Ledger.html#2943" class="Bound">x</a>
<a id="2958" class="Symbol">...</a> <a id="2962" class="Symbol">|</a> <a id="2964" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="2972" class="Symbol">=</a> <a id="2974" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="2979" class="Symbol">...</a> <a id="2983" class="Symbol">|</a> <a id="2985" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2990" href="ValueSepSimple.Ledger.html#2990" class="Bound">s</a>  <a id="2993" class="Symbol">=</a> <a id="2995" href="ValueSepSimple.Ledger.html#2850" class="Function">comp</a> <a id="3000" class="Symbol">{</a><a id="3001" class="Bound">l</a><a id="3002" class="Symbol">}</a> <a id="3004" href="ValueSepSimple.Ledger.html#2990" class="Bound">s</a>

<a id="3007" class="Comment">-- Executing transactions never introduces new keys in the resulting map out-of-thin-air.</a>
<a id="3097" class="Comment">-- ** Operational semantics</a>
<a id="3125" class="Comment">-- We model configurations of the transition system as pairs of a ledger and its current state.</a>

<a id="3222" class="Keyword">infix</a> <a id="3228" class="Number">0</a> <a id="3230" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">_—→_</a>
<a id="3235" class="Keyword">data</a> <a id="_—→_"></a><a id="3240" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">_—→_</a> <a id="3245" class="Symbol">:</a> <a id="3247" href="ValueSepSimple.Ledger.html#984" class="Function">L</a> <a id="3249" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3251" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="3253" class="Symbol">→</a> <a id="3255" href="ValueSepSimple.Ledger.html#661" class="Function">S</a> <a id="3257" class="Symbol">→</a> <a id="3259" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3263" class="Keyword">where</a>

  <a id="_—→_.base"></a><a id="3272" href="ValueSepSimple.Ledger.html#3272" class="InductiveConstructor">base</a> <a id="3277" class="Symbol">:</a>
    <a id="3283" href="Prelude.InferenceRules.html#47618" class="Function Operator">────────────</a>
    <a id="3300" href="Prelude.Monoid.html#196" class="Field">ε</a> <a id="3302" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3304" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="3306" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="3309" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a>

  <a id="_—→_.step"></a><a id="3314" href="ValueSepSimple.Ledger.html#3314" class="InductiveConstructor">step</a> <a id="3319" class="Symbol">:</a> <a id="3321" class="Keyword">let</a> <a id="3325" href="ValueSepSimple.Ledger.html#3325" class="Bound">t</a> <a id="3327" class="Symbol">=</a> <a id="3329" href="ValueSepSimple.Ledger.html#514" class="Generalizable">A</a> <a id="3331" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">—→⟨</a> <a id="3335" href="ValueSepSimple.Ledger.html#531" class="Generalizable">v</a> <a id="3337" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">⟩</a> <a id="3339" href="ValueSepSimple.Ledger.html#516" class="Generalizable">B</a> <a id="3341" class="Keyword">in</a>

    <a id="3349" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="3351" href="ValueSepSimple.Ledger.html#531" class="Generalizable">v</a> <a id="3353" href="Prelude.Ord.html#267" class="Field Operator">≤</a> <a id="3355" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="3357" href="ValueSepSimple.Ledger.html#514" class="Generalizable">A</a>
    <a id="3363" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3365" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="3367" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3369" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟦</a> <a id="3371" href="ValueSepSimple.Ledger.html#3325" class="Bound">t</a> <a id="3373" href="ValueSepSimple.Ledger.html#1607" class="Field Operator">⟧₀</a> <a id="3376" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="3378" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="3381" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>
      <a id="3390" href="Prelude.InferenceRules.html#14164" class="Function Operator">──────────────────</a>
      <a id="3415" href="ValueSepSimple.Ledger.html#3325" class="Bound">t</a> <a id="3417" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3419" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="3421" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3423" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="3425" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="3428" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>

<a id="oper-comp"></a><a id="3432" href="ValueSepSimple.Ledger.html#3432" class="Function">oper-comp</a> <a id="3442" class="Symbol">:</a>
  <a id="3446" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="3448" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a>       <a id="3456" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3458" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a>  <a id="3461" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="3464" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>
  <a id="3469" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3471" href="ValueSepSimple.Ledger.html#1086" class="Generalizable">l′</a>      <a id="3479" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3481" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a> <a id="3484" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="3487" href="ValueSepSimple.Ledger.html#1013" class="Generalizable">s″</a>
    <a id="3494" href="Prelude.InferenceRules.html#14115" class="Function Operator">────────────────────</a>
    <a id="3519" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="3521" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="3524" href="ValueSepSimple.Ledger.html#1086" class="Generalizable">l′</a> <a id="3527" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3529" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a>  <a id="3532" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="3535" href="ValueSepSimple.Ledger.html#1013" class="Generalizable">s″</a>
<a id="3538" href="ValueSepSimple.Ledger.html#3432" class="Function">oper-comp</a> <a id="3548" class="Symbol">{</a><a id="3549" class="Argument">l</a> <a id="3551" class="Symbol">=</a> <a id="3553" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3555" class="Symbol">}</a>    <a id="3560" href="ValueSepSimple.Ledger.html#3272" class="InductiveConstructor">base</a>                   <a id="3583" href="ValueSepSimple.Ledger.html#3583" class="Bound">s′→s″</a> <a id="3589" class="Symbol">=</a> <a id="3591" href="ValueSepSimple.Ledger.html#3583" class="Bound">s′→s″</a>
<a id="3597" href="ValueSepSimple.Ledger.html#3432" class="Function">oper-comp</a> <a id="3607" class="Symbol">{</a><a id="3608" class="Argument">l</a> <a id="3610" class="Symbol">=</a> <a id="3612" class="Symbol">_</a> <a id="3614" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3616" class="Symbol">_}</a> <a id="3619" class="Symbol">(</a><a id="3620" href="ValueSepSimple.Ledger.html#3314" class="InductiveConstructor">step</a> <a id="3625" href="ValueSepSimple.Ledger.html#3625" class="Bound">v≤</a> <a id="3628" href="ValueSepSimple.Ledger.html#3628" class="Bound">s→s′</a><a id="3632" class="Symbol">)</a> <a id="3634" href="ValueSepSimple.Ledger.html#3634" class="Bound">s′→s″</a> <a id="3640" class="Symbol">=</a> <a id="3642" href="ValueSepSimple.Ledger.html#3314" class="InductiveConstructor">step</a> <a id="3647" href="ValueSepSimple.Ledger.html#3625" class="Bound">v≤</a> <a id="3650" class="Symbol">(</a><a id="3651" href="ValueSepSimple.Ledger.html#3432" class="Function">oper-comp</a> <a id="3661" href="ValueSepSimple.Ledger.html#3628" class="Bound">s→s′</a> <a id="3666" href="ValueSepSimple.Ledger.html#3634" class="Bound">s′→s″</a><a id="3671" class="Symbol">)</a>

<a id="3674" class="Comment">-- ** Relating denotational and operational semantics.</a>
<a id="denot⇒oper"></a><a id="3729" href="ValueSepSimple.Ledger.html#3729" class="Function">denot⇒oper</a> <a id="3740" class="Symbol">:</a>
  <a id="3744" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="3746" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="3748" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a> <a id="3750" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="3752" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3754" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3759" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>
  <a id="3764" href="Prelude.InferenceRules.html#14187" class="Function Operator">─────────────────</a>
  <a id="3784" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="3786" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3788" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="3790" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="3793" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>
<a id="3796" href="ValueSepSimple.Ledger.html#3729" class="Function">denot⇒oper</a> <a id="3807" class="Symbol">{</a><a id="3808" class="Argument">l</a> <a id="3810" class="Symbol">=</a> <a id="3812" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3814" class="Symbol">}</a> <a id="3816" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3821" class="Symbol">=</a> <a id="3823" href="ValueSepSimple.Ledger.html#3272" class="InductiveConstructor">base</a>
<a id="3828" href="ValueSepSimple.Ledger.html#3729" class="Function">denot⇒oper</a> <a id="3839" class="Symbol">{</a><a id="3840" class="Argument">l</a> <a id="3842" class="Symbol">=</a> <a id="3844" href="ValueSepSimple.Ledger.html#3844" class="Bound">A</a> <a id="3846" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">—→⟨</a> <a id="3850" href="ValueSepSimple.Ledger.html#3850" class="Bound">v</a> <a id="3852" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">⟩</a> <a id="3854" href="ValueSepSimple.Ledger.html#3854" class="Bound">B</a> <a id="3856" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3858" href="ValueSepSimple.Ledger.html#3858" class="Bound">l</a><a id="3859" class="Symbol">}{</a><a id="3861" href="ValueSepSimple.Ledger.html#3861" class="Bound">s</a><a id="3862" class="Symbol">}</a> <a id="3864" href="ValueSepSimple.Ledger.html#3864" class="Bound">l≡</a>
  <a id="3869" class="Keyword">with</a> <a id="3874" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3878" href="ValueSepSimple.Ledger.html#3878" class="Bound">v≤</a> ← <a id="3883" href="ValueSepSimple.Ledger.html#3850" class="Bound">v</a> <a id="3885" href="Prelude.Ord.html#540" class="Function Operator">≤?</a> <a id="3888" href="ValueSepSimple.Ledger.html#3861" class="Bound">s</a> <a id="3890" href="ValueSepSimple.Ledger.html#3844" class="Bound">A</a>
  <a id="3894" class="Symbol">=</a> <a id="3896" href="ValueSepSimple.Ledger.html#3314" class="InductiveConstructor">step</a> <a id="3901" href="ValueSepSimple.Ledger.html#3878" class="Bound">v≤</a> <a id="3904" class="Symbol">(</a><a id="3905" href="ValueSepSimple.Ledger.html#3729" class="Function">denot⇒oper</a> <a id="3916" href="ValueSepSimple.Ledger.html#3864" class="Bound">l≡</a><a id="3918" class="Symbol">)</a>

<a id="oper⇒denot"></a><a id="3921" href="ValueSepSimple.Ledger.html#3921" class="Function">oper⇒denot</a> <a id="3932" class="Symbol">:</a>
  <a id="3936" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="3938" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3940" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="3942" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="3945" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>
  <a id="3950" href="Prelude.InferenceRules.html#14187" class="Function Operator">─────────────────</a>
  <a id="3970" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="3972" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="3974" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a> <a id="3976" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="3978" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3980" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3985" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>
<a id="3988" href="ValueSepSimple.Ledger.html#3921" class="Function">oper⇒denot</a> <a id="3999" class="Symbol">{</a><a id="4000" class="Argument">l</a> <a id="4002" class="Symbol">=</a> <a id="4004" class="DottedPattern Symbol">.</a><a id="4005" href="Agda.Builtin.List.html#185" class="DottedPattern InductiveConstructor">[]</a><a id="4007" class="Symbol">}</a> <a id="4009" href="ValueSepSimple.Ledger.html#3272" class="InductiveConstructor">base</a> <a id="4014" class="Symbol">=</a> <a id="4016" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4021" href="ValueSepSimple.Ledger.html#3921" class="Function">oper⇒denot</a> <a id="4032" class="Symbol">{</a><a id="4033" class="Argument">l</a> <a id="4035" class="Symbol">=</a> <a id="4037" href="ValueSepSimple.Ledger.html#4037" class="Bound">A</a> <a id="4039" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">—→⟨</a> <a id="4043" href="ValueSepSimple.Ledger.html#4043" class="Bound">v</a> <a id="4045" href="ValueSepSimple.Ledger.html#796" class="InductiveConstructor Operator">⟩</a> <a id="4047" href="ValueSepSimple.Ledger.html#4047" class="Bound">B</a> <a id="4049" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4051" class="Symbol">_}{</a><a id="4054" href="ValueSepSimple.Ledger.html#4054" class="Bound">s</a><a id="4055" class="Symbol">}</a> <a id="4057" class="Symbol">(</a><a id="4058" href="ValueSepSimple.Ledger.html#3314" class="InductiveConstructor">step</a> <a id="4063" href="ValueSepSimple.Ledger.html#4063" class="Bound">v≤</a> <a id="4066" href="ValueSepSimple.Ledger.html#4066" class="Bound">p</a><a id="4067" class="Symbol">)</a>
  <a id="4071" class="Keyword">rewrite</a> <a id="4079" href="Relation.Nullary.Decidable.Core.html#3166" class="Function">dec-yes</a> <a id="4087" class="Symbol">(</a><a id="4088" href="ValueSepSimple.Ledger.html#4043" class="Bound">v</a> <a id="4090" href="Prelude.Ord.html#540" class="Function Operator">≤?</a> <a id="4093" href="ValueSepSimple.Ledger.html#4054" class="Bound">s</a> <a id="4095" href="ValueSepSimple.Ledger.html#4037" class="Bound">A</a><a id="4096" class="Symbol">)</a> <a id="4098" href="ValueSepSimple.Ledger.html#4063" class="Bound">v≤</a> <a id="4101" class="Symbol">.</a><a id="4102" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a>
  <a id="4110" class="Symbol">=</a> <a id="4112" href="ValueSepSimple.Ledger.html#3921" class="Function">oper⇒denot</a> <a id="4123" href="ValueSepSimple.Ledger.html#4066" class="Bound">p</a>

<a id="denot⇔oper"></a><a id="4126" href="ValueSepSimple.Ledger.html#4126" class="Function">denot⇔oper</a> <a id="4137" class="Symbol">:</a>
  <a id="4141" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟦</a> <a id="4143" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="4145" href="ValueSepSimple.Ledger.html#1456" class="Field Operator">⟧</a> <a id="4147" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="4149" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4151" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4156" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>
  <a id="4161" href="Prelude.InferenceRules.html#70247" class="Function Operator">═════════════════</a>
  <a id="4181" href="ValueSepSimple.Ledger.html#1084" class="Generalizable">l</a> <a id="4183" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4185" href="ValueSepSimple.Ledger.html#1008" class="Generalizable">s</a> <a id="4187" href="ValueSepSimple.Ledger.html#3240" class="Datatype Operator">—→</a> <a id="4190" href="ValueSepSimple.Ledger.html#1010" class="Generalizable">s′</a>
<a id="4193" href="ValueSepSimple.Ledger.html#4126" class="Function">denot⇔oper</a> <a id="4204" class="Symbol">=</a> <a id="4206" href="ValueSepSimple.Ledger.html#3729" class="Function">denot⇒oper</a> <a id="4217" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4219" href="ValueSepSimple.Ledger.html#3921" class="Function">oper⇒denot</a>
</pre></body></html>