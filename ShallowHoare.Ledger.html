<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ShallowHoare.Ledger</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------</a>
<a id="44" class="Comment">-- ** Denotational &amp; operational semantics</a>

<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="112" class="Symbol">;</a> <a id="114" class="Keyword">open</a> <a id="119" href="Prelude.Init.html#35" class="Module">SetAsType</a>
<a id="129" class="Keyword">open</a> <a id="134" class="Keyword">import</a> <a id="141" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="183" class="Keyword">open</a> <a id="188" class="Keyword">import</a> <a id="195" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="237" class="Keyword">open</a> <a id="242" class="Keyword">import</a> <a id="249" href="Prelude.Maps.Abstract.html" class="Module">Prelude.Maps.Abstract</a><a id="270" class="Symbol">;</a> <a id="272" class="Keyword">open</a> <a id="277" href="Prelude.Maps.Abstract.Interface.html#15052" class="Module">CommandDSL</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>
<a id="345" class="Keyword">open</a> <a id="350" class="Keyword">import</a> <a id="357" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>

<a id="373" class="Keyword">module</a> <a id="380" href="ShallowHoare.Ledger.html" class="Module">ShallowHoare.Ledger</a>
  <a id="402" class="Symbol">(</a><a id="403" href="ShallowHoare.Ledger.html#403" class="Bound">Part</a> <a id="408" class="Symbol">:</a> <a id="410" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="414" class="Symbol">)</a> <a id="416" class="Comment">-- a fixed set of participants</a>
  <a id="449" class="Symbol">⦃</a> <a id="451" href="ShallowHoare.Ledger.html#451" class="Bound">_</a> <a id="453" class="Symbol">:</a> <a id="455" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="461" href="ShallowHoare.Ledger.html#403" class="Bound">Part</a> <a id="466" class="Symbol">⦄</a>
  <a id="470" class="Keyword">where</a>

<a id="477" class="Keyword">variable</a>
  <a id="488" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="490" href="ShallowHoare.Ledger.html#490" class="Generalizable">B</a> <a id="492" href="ShallowHoare.Ledger.html#492" class="Generalizable">C</a> <a id="494" href="ShallowHoare.Ledger.html#494" class="Generalizable">D</a> <a id="496" class="Symbol">:</a> <a id="498" href="ShallowHoare.Ledger.html#403" class="Bound">Part</a>
  <a id="505" href="ShallowHoare.Ledger.html#505" class="Generalizable">v</a> <a id="507" href="ShallowHoare.Ledger.html#507" class="Generalizable">v′</a> <a id="510" href="ShallowHoare.Ledger.html#510" class="Generalizable">v″</a> <a id="513" class="Symbol">:</a> <a id="515" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="518" class="Keyword">instance</a> <a id="527" href="ShallowHoare.Ledger.html#527" class="Function">_</a> <a id="529" class="Symbol">=</a> <a id="531" href="Prelude.Semigroup.html#2115" class="Function">Semigroup-ℕ-+</a><a id="544" class="Symbol">;</a> <a id="546" href="ShallowHoare.Ledger.html#546" class="Function">_</a> <a id="548" class="Symbol">=</a> <a id="550" href="Prelude.Semigroup.html#2408" class="Function">SemigroupLaws-ℕ-+</a><a id="567" class="Symbol">;</a> <a id="569" href="ShallowHoare.Ledger.html#569" class="Function">_</a> <a id="571" class="Symbol">=</a> <a id="573" href="Prelude.Monoid.html#1342" class="Function">Monoid-ℕ-+</a><a id="583" class="Symbol">;</a> <a id="585" href="ShallowHoare.Ledger.html#585" class="Function">_</a> <a id="587" class="Symbol">=</a> <a id="589" href="Prelude.Monoid.html#1420" class="Function">MonoidLaws-ℕ-+</a>

<a id="605" class="Comment">-- The state of a ledger is a collection of participants, along with their balance.</a>
<a id="S"></a><a id="689" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="691" class="Symbol">:</a> <a id="693" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="698" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="700" class="Symbol">=</a> <a id="702" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">Map⟨</a> <a id="707" href="ShallowHoare.Ledger.html#403" class="Bound">Part</a> <a id="712" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">↦</a> <a id="714" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="716" href="Prelude.Maps.Abstract.Interface.html#546" class="Function">⟩</a>

<a id="719" class="Comment">-- A transaction is transferring money from one participant to another.</a>
<a id="791" class="Keyword">record</a> <a id="Tx"></a><a id="798" href="ShallowHoare.Ledger.html#798" class="Record">Tx</a> <a id="801" class="Symbol">:</a> <a id="803" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="808" class="Keyword">where</a>
  <a id="816" class="Keyword">constructor</a> <a id="_—→⟨_⟩_"></a><a id="828" href="ShallowHoare.Ledger.html#828" class="InductiveConstructor Operator">_—→⟨_⟩_</a>
  <a id="838" class="Keyword">field</a>
    <a id="Tx.sender"></a><a id="848" href="ShallowHoare.Ledger.html#848" class="Field">sender</a>   <a id="857" class="Symbol">:</a> <a id="859" href="ShallowHoare.Ledger.html#403" class="Bound">Part</a>
    <a id="Tx.value"></a><a id="868" href="ShallowHoare.Ledger.html#868" class="Field">value</a>    <a id="877" class="Symbol">:</a> <a id="879" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Tx.receiver"></a><a id="885" href="ShallowHoare.Ledger.html#885" class="Field">receiver</a> <a id="894" class="Symbol">:</a> <a id="896" href="ShallowHoare.Ledger.html#403" class="Bound">Part</a>
<a id="901" class="Keyword">open</a> <a id="906" href="ShallowHoare.Ledger.html#798" class="Module">Tx</a> <a id="909" class="Keyword">public</a>

<a id="917" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="956" href="ShallowHoare.Ledger.html#956" class="Function">L</a> <a id="958" class="Symbol">=</a> <a id="960" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="965" href="ShallowHoare.Ledger.html#798" class="Record">Tx</a>

<a id="969" class="Keyword">variable</a>
  <a id="980" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="982" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a> <a id="985" href="ShallowHoare.Ledger.html#985" class="Generalizable">s″</a> <a id="988" href="ShallowHoare.Ledger.html#988" class="Generalizable">s₁</a> <a id="991" href="ShallowHoare.Ledger.html#991" class="Generalizable">s₂</a> <a id="994" class="Symbol">:</a> <a id="996" href="ShallowHoare.Ledger.html#689" class="Function">S</a>
  <a id="1000" href="ShallowHoare.Ledger.html#1000" class="Generalizable">t</a> <a id="1002" href="ShallowHoare.Ledger.html#1002" class="Generalizable">t′</a> <a id="1005" href="ShallowHoare.Ledger.html#1005" class="Generalizable">t″</a> <a id="1008" class="Symbol">:</a> <a id="1010" href="ShallowHoare.Ledger.html#798" class="Record">Tx</a>
  <a id="1015" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="1017" href="ShallowHoare.Ledger.html#1017" class="Generalizable">l′</a> <a id="1020" href="ShallowHoare.Ledger.html#1020" class="Generalizable">l″</a> <a id="1023" href="ShallowHoare.Ledger.html#1023" class="Generalizable">l₁</a> <a id="1026" href="ShallowHoare.Ledger.html#1026" class="Generalizable">l₂</a> <a id="1029" class="Symbol">:</a> <a id="1031" href="ShallowHoare.Ledger.html#956" class="Function">L</a>
  <a id="1035" href="ShallowHoare.Ledger.html#1035" class="Generalizable">ls</a> <a id="1038" href="ShallowHoare.Ledger.html#1038" class="Generalizable">ls′</a> <a id="1042" href="ShallowHoare.Ledger.html#1042" class="Generalizable">ls″</a> <a id="1046" class="Symbol">:</a> <a id="1048" href="ShallowHoare.Ledger.html#956" class="Function">L</a> <a id="1050" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1052" href="ShallowHoare.Ledger.html#689" class="Function">S</a>

<a id="1055" class="Comment">-- ** Denotational semantics</a>

<a id="1085" class="Comment">-- The meaning of a transaction or a whole ledger will be denoted by state transformers,</a>
<a id="1174" class="Comment">-- i.e. function from the current state to the updated one.</a>
<a id="Domain"></a><a id="1234" href="ShallowHoare.Ledger.html#1234" class="Function">Domain</a> <a id="1241" class="Symbol">=</a> <a id="1243" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="1245" class="Symbol">→</a> <a id="1247" href="ShallowHoare.Ledger.html#689" class="Function">S</a>

<a id="1250" class="Keyword">record</a> <a id="Denotable"></a><a id="1257" href="ShallowHoare.Ledger.html#1257" class="Record">Denotable</a> <a id="1267" class="Symbol">(</a><a id="1268" href="ShallowHoare.Ledger.html#1268" class="Bound">A</a> <a id="1270" class="Symbol">:</a> <a id="1272" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="1276" class="Symbol">)</a> <a id="1278" class="Symbol">:</a> <a id="1280" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1285" class="Keyword">where</a>
  <a id="1293" class="Keyword">field</a>
    <a id="Denotable.⟦_⟧"></a><a id="1303" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦_⟧</a> <a id="1307" class="Symbol">:</a> <a id="1309" href="ShallowHoare.Ledger.html#1268" class="Bound">A</a> <a id="1311" class="Symbol">→</a> <a id="1313" href="ShallowHoare.Ledger.html#1234" class="Function">Domain</a>
<a id="1320" class="Keyword">open</a> <a id="1325" href="ShallowHoare.Ledger.html#1257" class="Module">Denotable</a> <a id="1335" class="Symbol">⦃...⦄</a> <a id="1341" class="Keyword">public</a>

<a id="1349" class="Comment">-- Express the action of tranferring values between keys in a map.</a>
<a id="1416" class="Comment">-- NB: a transaction goes through only when:</a>
<a id="1461" class="Comment">--   1. both participants are present in the domain</a>
<a id="1513" class="Comment">--   2. the sender holds sufficient funds</a>
<a id="1555" class="Comment">--</a>
<a id="1558" class="Comment">-- Since Prelude.Maps exposes only an *abstract* interface, it would quickly get tedious to write</a>
<a id="1656" class="Comment">-- Hence we utilize a simple command language from Prelude.Maps that:</a>
<a id="1726" class="Comment">--   * lets us write our operation concisely</a>
<a id="1771" class="Comment">--   * re-use existing lemmas from the prelude library</a>
<a id="1826" class="Comment">--   * T0D0: investigate connection with algebraic-effects/effect-handlers??</a>
<a id="1903" class="Comment">--           e.g. ——⟨ alg.effects  ⟩—→ Denotational Semantics</a>
<a id="1965" class="Comment">--                ——⟨ eff.handlers ⟩—→ Practical effectful FP</a>
<a id="2027" class="Comment">--                ——⟨     ???      ⟩—→ Ergonomic dependently-typed FP / theorem-proving</a>
<a id="[_∣_↦_]"></a><a id="2115" href="ShallowHoare.Ledger.html#2115" class="Function Operator">[_∣_↦_]</a> <a id="2123" class="Symbol">:</a> <a id="2125" href="ShallowHoare.Ledger.html#403" class="Bound">Part</a> <a id="2130" class="Symbol">→</a> <a id="2132" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2134" class="Symbol">→</a> <a id="2136" href="ShallowHoare.Ledger.html#403" class="Bound">Part</a> <a id="2141" class="Symbol">→</a> <a id="2143" href="Prelude.Maps.Abstract.Interface.html#20974" class="Datatype">Cmd</a>
<a id="2147" href="ShallowHoare.Ledger.html#2115" class="Function Operator">[</a> <a id="2149" href="ShallowHoare.Ledger.html#2149" class="Bound">A</a> <a id="2151" href="ShallowHoare.Ledger.html#2115" class="Function Operator">∣</a> <a id="2153" href="ShallowHoare.Ledger.html#2153" class="Bound">v</a> <a id="2155" href="ShallowHoare.Ledger.html#2115" class="Function Operator">↦</a> <a id="2157" href="ShallowHoare.Ledger.html#2157" class="Bound">B</a> <a id="2159" href="ShallowHoare.Ledger.html#2115" class="Function Operator">]</a> <a id="2161" class="Symbol">=</a>
  <a id="2165" href="Prelude.Maps.Abstract.Interface.html#21081" class="InductiveConstructor">just?</a> <a id="2171" href="ShallowHoare.Ledger.html#2149" class="Bound">A</a> <a id="2173" class="Symbol">λ</a> <a id="2175" href="ShallowHoare.Ledger.html#2175" class="Bound">vᵃ</a> <a id="2178" class="Symbol">→</a>
  <a id="2182" href="Prelude.Maps.Abstract.Interface.html#21081" class="InductiveConstructor">just?</a> <a id="2188" href="ShallowHoare.Ledger.html#2157" class="Bound">B</a> <a id="2190" class="Symbol">λ</a> <a id="2192" href="ShallowHoare.Ledger.html#2192" class="Bound">vᵇ</a> <a id="2195" class="Symbol">→</a>
  <a id="2199" href="Prelude.Maps.Abstract.Interface.html#21176" class="Function Operator">iff¿</a> <a id="2204" href="ShallowHoare.Ledger.html#2153" class="Bound">v</a> <a id="2206" href="Prelude.Ord.html#249" class="Field Operator">≤</a> <a id="2208" href="ShallowHoare.Ledger.html#2175" class="Bound">vᵃ</a> <a id="2211" href="Prelude.Maps.Abstract.Interface.html#21176" class="Function Operator">¿</a>
  <a id="2215" class="Symbol">((</a><a id="2217" href="ShallowHoare.Ledger.html#2149" class="Bound">A</a> <a id="2219" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="2221" href="ShallowHoare.Ledger.html#2175" class="Bound">vᵃ</a> <a id="2224" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="2226" href="ShallowHoare.Ledger.html#2153" class="Bound">v</a><a id="2227" class="Symbol">)</a> <a id="2229" href="Prelude.Maps.Abstract.Interface.html#21000" class="InductiveConstructor Operator">∶</a> <a id="2231" class="Symbol">(</a><a id="2232" href="ShallowHoare.Ledger.html#2157" class="Bound">B</a> <a id="2234" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="2236" href="ShallowHoare.Ledger.html#2192" class="Bound">vᵇ</a> <a id="2239" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2241" href="ShallowHoare.Ledger.html#2153" class="Bound">v</a><a id="2242" class="Symbol">))</a>


<a id="2247" class="Keyword">instance</a>
  <a id="2258" class="Comment">-- we denote a transaction as simply running the transaction based on the transfer operation above</a>
  <a id="⟦Tx⟧"></a><a id="2359" href="ShallowHoare.Ledger.html#2359" class="Function">⟦Tx⟧</a> <a id="2364" class="Symbol">:</a> <a id="2366" href="ShallowHoare.Ledger.html#1257" class="Record">Denotable</a> <a id="2376" href="ShallowHoare.Ledger.html#798" class="Record">Tx</a>
  <a id="2381" href="ShallowHoare.Ledger.html#2359" class="Function">⟦Tx⟧</a> <a id="2386" class="Symbol">.</a><a id="2387" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦_⟧</a> <a id="2391" class="Symbol">(</a><a id="2392" href="ShallowHoare.Ledger.html#2392" class="Bound">A</a> <a id="2394" href="ShallowHoare.Ledger.html#828" class="InductiveConstructor Operator">—→⟨</a> <a id="2398" href="ShallowHoare.Ledger.html#2398" class="Bound">v</a> <a id="2400" href="ShallowHoare.Ledger.html#828" class="InductiveConstructor Operator">⟩</a> <a id="2402" href="ShallowHoare.Ledger.html#2402" class="Bound">B</a><a id="2403" class="Symbol">)</a> <a id="2405" class="Symbol">=</a> <a id="2407" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="2411" href="ShallowHoare.Ledger.html#2115" class="Function Operator">[</a> <a id="2413" href="ShallowHoare.Ledger.html#2392" class="Bound">A</a> <a id="2415" href="ShallowHoare.Ledger.html#2115" class="Function Operator">∣</a> <a id="2417" href="ShallowHoare.Ledger.html#2398" class="Bound">v</a> <a id="2419" href="ShallowHoare.Ledger.html#2115" class="Function Operator">↦</a> <a id="2421" href="ShallowHoare.Ledger.html#2402" class="Bound">B</a> <a id="2423" href="ShallowHoare.Ledger.html#2115" class="Function Operator">]</a>

  <a id="2428" class="Comment">-- we denote a ledger as the composition of the denotations of its transactions,</a>
  <a id="2511" class="Comment">-- i.e. we run all transactions in sequence</a>
  <a id="⟦L⟧"></a><a id="2557" href="ShallowHoare.Ledger.html#2557" class="Function">⟦L⟧</a> <a id="2561" class="Symbol">:</a> <a id="2563" href="ShallowHoare.Ledger.html#1257" class="Record">Denotable</a> <a id="2573" href="ShallowHoare.Ledger.html#956" class="Function">L</a>
  <a id="2577" href="ShallowHoare.Ledger.html#2557" class="Function">⟦L⟧</a> <a id="2581" class="Symbol">.</a><a id="2582" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦_⟧</a> <a id="2586" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>      <a id="2594" href="ShallowHoare.Ledger.html#2594" class="Bound">s</a> <a id="2596" class="Symbol">=</a> <a id="2598" href="ShallowHoare.Ledger.html#2594" class="Bound">s</a>
  <a id="2602" href="ShallowHoare.Ledger.html#2557" class="Function">⟦L⟧</a> <a id="2606" class="Symbol">.</a><a id="2607" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦_⟧</a> <a id="2611" class="Symbol">(</a><a id="2612" href="ShallowHoare.Ledger.html#2612" class="Bound">t</a> <a id="2614" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2616" href="ShallowHoare.Ledger.html#2616" class="Bound">l</a><a id="2617" class="Symbol">)</a> <a id="2619" class="Symbol">=</a> <a id="2621" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="2623" href="ShallowHoare.Ledger.html#2616" class="Bound">l</a> <a id="2625" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="2627" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2629" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="2631" href="ShallowHoare.Ledger.html#2612" class="Bound">t</a> <a id="2633" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a>

<a id="comp"></a><a id="2636" href="ShallowHoare.Ledger.html#2636" class="Function">comp</a> <a id="2641" class="Symbol">:</a> <a id="2643" class="Symbol">∀</a> <a id="2645" href="ShallowHoare.Ledger.html#2645" class="Bound">x</a> <a id="2647" class="Symbol">→</a> <a id="2649" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="2651" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="2653" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2656" href="ShallowHoare.Ledger.html#1017" class="Generalizable">l′</a> <a id="2659" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="2661" href="ShallowHoare.Ledger.html#2645" class="Bound">x</a> <a id="2663" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2665" class="Symbol">(</a><a id="2666" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="2668" href="ShallowHoare.Ledger.html#1017" class="Generalizable">l′</a> <a id="2671" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="2673" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2675" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="2677" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="2679" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a><a id="2680" class="Symbol">)</a> <a id="2682" href="ShallowHoare.Ledger.html#2645" class="Bound">x</a>
<a id="2684" href="ShallowHoare.Ledger.html#2636" class="Function">comp</a> <a id="2689" class="Symbol">{</a><a id="2690" class="Argument">l</a> <a id="2692" class="Symbol">=</a> <a id="2694" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2696" class="Symbol">}</a>    <a id="2701" class="Symbol">{</a><a id="2702" href="ShallowHoare.Ledger.html#2702" class="Bound">l′</a><a id="2704" class="Symbol">}</a> <a id="2706" href="ShallowHoare.Ledger.html#2706" class="Bound">x</a> <a id="2708" class="Symbol">=</a> <a id="2710" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="2715" href="ShallowHoare.Ledger.html#2636" class="Function">comp</a> <a id="2720" class="Symbol">{</a><a id="2721" class="Argument">l</a> <a id="2723" class="Symbol">=</a> <a id="2725" href="ShallowHoare.Ledger.html#2725" class="Bound">t</a> <a id="2727" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2729" href="ShallowHoare.Ledger.html#2729" class="Bound">l</a><a id="2730" class="Symbol">}</a> <a id="2732" class="Symbol">{</a><a id="2733" href="ShallowHoare.Ledger.html#2733" class="Bound">l′</a><a id="2735" class="Symbol">}</a> <a id="2737" href="ShallowHoare.Ledger.html#2737" class="Bound">x</a> <a id="2739" class="Keyword">rewrite</a> <a id="2747" href="ShallowHoare.Ledger.html#2636" class="Function">comp</a> <a id="2752" class="Symbol">{</a><a id="2753" href="ShallowHoare.Ledger.html#2729" class="Bound">l</a><a id="2754" class="Symbol">}{</a><a id="2756" href="ShallowHoare.Ledger.html#2733" class="Bound">l′</a><a id="2758" class="Symbol">}</a> <a id="2760" class="Symbol">(</a><a id="2761" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="2763" href="ShallowHoare.Ledger.html#2725" class="Bound">t</a> <a id="2765" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="2767" href="ShallowHoare.Ledger.html#2737" class="Bound">x</a><a id="2768" class="Symbol">)</a> <a id="2770" class="Symbol">=</a> <a id="2772" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="2778" class="Comment">-- Executing transactions never introduces new keys in the resulting map out-of-thin-air.</a>
<a id="⟦⟧ₗ-mono"></a><a id="2868" href="ShallowHoare.Ledger.html#2868" class="Function">⟦⟧ₗ-mono</a> <a id="2877" class="Symbol">:</a> <a id="2879" href="Prelude.Maps.Abstract.Interface.html#5024" class="Function">KeyMonotonic</a> <a id="2892" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="2894" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="2896" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a>
<a id="2898" href="ShallowHoare.Ledger.html#2868" class="Function">⟦⟧ₗ-mono</a> <a id="2907" class="Symbol">{</a><a id="2908" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2910" class="Symbol">}</a>    <a id="2915" class="Symbol">_</a> <a id="2917" class="Symbol">=</a> <a id="2919" href="Function.Base.html#615" class="Function">id</a>
<a id="2922" href="ShallowHoare.Ledger.html#2868" class="Function">⟦⟧ₗ-mono</a> <a id="2931" class="Symbol">{</a><a id="2932" href="ShallowHoare.Ledger.html#2932" class="Bound">t</a> <a id="2934" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2936" href="ShallowHoare.Ledger.html#2936" class="Bound">l</a><a id="2937" class="Symbol">}</a> <a id="2939" href="ShallowHoare.Ledger.html#2939" class="Bound">s</a> <a id="2941" class="Symbol">=</a> <a id="2943" href="ShallowHoare.Ledger.html#2868" class="Function">⟦⟧ₗ-mono</a> <a id="2952" class="Symbol">{</a><a id="2953" class="Argument">l</a> <a id="2955" class="Symbol">=</a> <a id="2957" href="ShallowHoare.Ledger.html#2936" class="Bound">l</a><a id="2958" class="Symbol">}</a> <a id="2960" class="Symbol">(</a><a id="2961" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="2963" href="ShallowHoare.Ledger.html#2932" class="Bound">t</a> <a id="2965" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="2967" href="ShallowHoare.Ledger.html#2939" class="Bound">s</a><a id="2968" class="Symbol">)</a>
                   <a id="2989" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2991" href="Prelude.Maps.Abstract.Interface.html#22244" class="Function">cmd-mon</a> <a id="2999" href="ShallowHoare.Ledger.html#2115" class="Function Operator">[</a> <a id="3001" href="ShallowHoare.Ledger.html#848" class="Field">sender</a> <a id="3008" href="ShallowHoare.Ledger.html#2932" class="Bound">t</a> <a id="3010" href="ShallowHoare.Ledger.html#2115" class="Function Operator">∣</a> <a id="3012" href="ShallowHoare.Ledger.html#868" class="Field">value</a> <a id="3018" href="ShallowHoare.Ledger.html#2932" class="Bound">t</a> <a id="3020" href="ShallowHoare.Ledger.html#2115" class="Function Operator">↦</a> <a id="3022" href="ShallowHoare.Ledger.html#885" class="Field">receiver</a> <a id="3031" href="ShallowHoare.Ledger.html#2932" class="Bound">t</a> <a id="3033" href="ShallowHoare.Ledger.html#2115" class="Function Operator">]</a> <a id="3035" href="ShallowHoare.Ledger.html#2939" class="Bound">s</a>

<a id="3038" class="Comment">-- Executing a transaction never removes existing keys.</a>
<a id="[∣↦]-pre"></a><a id="3094" href="ShallowHoare.Ledger.html#3094" class="Function">[∣↦]-pre</a> <a id="3103" class="Symbol">:</a> <a id="3105" href="Prelude.Maps.Abstract.Interface.html#5037" class="Function">KeyPreserving</a> <a id="3119" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="3121" href="ShallowHoare.Ledger.html#1000" class="Generalizable">t</a> <a id="3123" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a>
<a id="3125" href="ShallowHoare.Ledger.html#3094" class="Function">[∣↦]-pre</a> <a id="3134" class="Symbol">{</a><a id="3135" class="Argument">t</a> <a id="3137" class="Symbol">=</a> <a id="3139" href="ShallowHoare.Ledger.html#3139" class="Bound">A</a> <a id="3141" href="ShallowHoare.Ledger.html#828" class="InductiveConstructor Operator">—→⟨</a> <a id="3145" href="ShallowHoare.Ledger.html#3145" class="Bound">v</a> <a id="3147" href="ShallowHoare.Ledger.html#828" class="InductiveConstructor Operator">⟩</a> <a id="3149" href="ShallowHoare.Ledger.html#3149" class="Bound">B</a><a id="3150" class="Symbol">}</a> <a id="3152" href="ShallowHoare.Ledger.html#3152" class="Bound">s</a> <a id="3154" class="Symbol">{</a><a id="3155" href="ShallowHoare.Ledger.html#3155" class="Bound">k</a><a id="3156" class="Symbol">}</a> <a id="3158" href="ShallowHoare.Ledger.html#3158" class="Bound">k∈</a>
  <a id="3163" class="Keyword">with</a> <a id="3168" href="ShallowHoare.Ledger.html#3152" class="Bound">s</a> <a id="3170" href="Prelude.Maps.Abstract.Interface.html#608" class="Function Operator">⁉</a> <a id="3172" href="ShallowHoare.Ledger.html#3139" class="Bound">A</a> <a id="3174" class="Symbol">|</a> <a id="3176" href="Prelude.Maps.Abstract.Interface.html#1841" class="Function">⁉⇒∈ᵈ</a> <a id="3181" href="ShallowHoare.Ledger.html#3152" class="Bound">s</a> <a id="3183" class="Symbol">{</a><a id="3184" href="ShallowHoare.Ledger.html#3139" class="Bound">A</a><a id="3185" class="Symbol">}</a>
<a id="3187" class="Symbol">...</a> <a id="3191" class="Symbol">|</a> <a id="3193" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="3201" class="Symbol">|</a> <a id="3203" class="Symbol">_</a> <a id="3205" class="Symbol">=</a> <a id="3207" class="Bound">k∈</a>
<a id="3210" class="Symbol">...</a> <a id="3214" class="Symbol">|</a> <a id="3216" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3221" href="ShallowHoare.Ledger.html#3221" class="Bound">vᵃ</a> <a id="3224" class="Symbol">|</a> <a id="3226" href="ShallowHoare.Ledger.html#3226" class="Bound">A∈</a>
  <a id="3231" class="Keyword">with</a> <a id="3236" class="Bound">s</a> <a id="3238" href="Prelude.Maps.Abstract.Interface.html#608" class="Function Operator">⁉</a> <a id="3240" class="Bound">B</a> <a id="3242" class="Symbol">|</a> <a id="3244" href="Prelude.Maps.Abstract.Interface.html#1841" class="Function">⁉⇒∈ᵈ</a> <a id="3249" class="Bound">s</a> <a id="3251" class="Symbol">{</a><a id="3252" class="Bound">B</a><a id="3253" class="Symbol">}</a>
<a id="3255" class="Symbol">...</a> <a id="3259" class="Symbol">|</a> <a id="3261" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="3269" class="Symbol">|</a> <a id="3271" class="Symbol">_</a> <a id="3273" class="Symbol">=</a> <a id="3275" class="Bound">k∈</a>
<a id="3278" class="Symbol">...</a> <a id="3282" class="Symbol">|</a> <a id="3284" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3289" href="ShallowHoare.Ledger.html#3289" class="Bound">vᵇ</a> <a id="3292" class="Symbol">|</a> <a id="3294" href="ShallowHoare.Ledger.html#3294" class="Bound">B∈</a>
  <a id="3299" class="Keyword">with</a> <a id="3304" class="Bound">v</a> <a id="3306" href="Prelude.Ord.html#522" class="Function Operator">≤?</a> <a id="3309" class="Bound">vᵃ</a>
<a id="3312" class="Symbol">...</a> <a id="3316" class="Symbol">|</a> <a id="3318" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="3322" class="Symbol">_</a> <a id="3324" class="Symbol">=</a> <a id="3326" class="Bound">k∈</a>
<a id="3329" class="Symbol">...</a> <a id="3333" class="Symbol">|</a> <a id="3335" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3339" class="Symbol">_</a>
  <a id="3343" class="Keyword">with</a> <a id="3348" href="Prelude.Maps.Abstract.Interface.html#2424" class="Function">∈ᵈ-∪⁻</a> <a id="3354" class="Symbol">_</a> <a id="3356" class="Symbol">_</a> <a id="3358" class="Symbol">_</a> <a id="3360" class="Bound">k∈</a>
<a id="3363" class="Symbol">...</a> <a id="3367" class="Symbol">|</a> <a id="3369" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="3374" href="ShallowHoare.Ledger.html#3374" class="Bound">k∈ˡ</a> <a id="3378" class="Keyword">rewrite</a> <a id="3386" href="Prelude.Maps.Abstract.Interface.html#7426" class="Function">singleton∈</a> <a id="3397" href="ShallowHoare.Ledger.html#3374" class="Bound">k∈ˡ</a> <a id="3401" class="Symbol">=</a> <a id="3403" class="Bound">B∈</a> <a id="3406" href="Prelude.Decidable.Base.html#140" class="Function">auto</a>
<a id="3411" class="Symbol">...</a> <a id="3415" class="Symbol">|</a> <a id="3417" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="3422" href="ShallowHoare.Ledger.html#3422" class="Bound">k∈ʳ</a>
  <a id="3428" class="Keyword">with</a> <a id="3433" href="Prelude.Maps.Abstract.Interface.html#2424" class="Function">∈ᵈ-∪⁻</a> <a id="3439" class="Symbol">_</a> <a id="3441" class="Symbol">_</a> <a id="3443" class="Symbol">_</a> <a id="3445" href="ShallowHoare.Ledger.html#3422" class="Bound">k∈ʳ</a>
<a id="3449" class="Symbol">...</a> <a id="3453" class="Symbol">|</a> <a id="3455" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="3460" href="ShallowHoare.Ledger.html#3460" class="Bound">k∈ˡ</a> <a id="3464" class="Keyword">rewrite</a> <a id="3472" href="Prelude.Maps.Abstract.Interface.html#7426" class="Function">singleton∈</a> <a id="3483" href="ShallowHoare.Ledger.html#3460" class="Bound">k∈ˡ</a> <a id="3487" class="Symbol">=</a> <a id="3489" class="Bound">A∈</a> <a id="3492" href="Prelude.Decidable.Base.html#140" class="Function">auto</a>
<a id="3497" class="Symbol">...</a> <a id="3501" class="Symbol">|</a> <a id="3503" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="3508" href="ShallowHoare.Ledger.html#3508" class="Bound">k∈ʳ′</a> <a id="3513" class="Symbol">=</a> <a id="3515" href="ShallowHoare.Ledger.html#3508" class="Bound">k∈ʳ′</a>

<a id="3521" class="Comment">-- ** Utility lemmas about membership/transfer/maps.</a>
<a id="∉-⟦⟧ₜ"></a><a id="3574" href="ShallowHoare.Ledger.html#3574" class="Function">∉-⟦⟧ₜ</a> <a id="3580" class="Symbol">:</a> <a id="3582" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="3584" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3587" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="3589" class="Symbol">→</a> <a id="3591" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="3593" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3596" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="3598" href="ShallowHoare.Ledger.html#1000" class="Generalizable">t</a> <a id="3600" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="3602" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a>
<a id="3604" href="ShallowHoare.Ledger.html#3574" class="Function">∉-⟦⟧ₜ</a> <a id="3610" href="ShallowHoare.Ledger.html#3610" class="Bound">A∉s</a> <a id="3614" class="Symbol">=</a> <a id="3616" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="3623" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3625" href="ShallowHoare.Ledger.html#3610" class="Bound">A∉s</a> <a id="3629" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3631" href="ShallowHoare.Ledger.html#3094" class="Function">[∣↦]-pre</a> <a id="3640" class="Symbol">_</a>

<a id="∉-⟦⟧ₗ"></a><a id="3643" href="ShallowHoare.Ledger.html#3643" class="Function">∉-⟦⟧ₗ</a> <a id="3649" class="Symbol">:</a> <a id="3651" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="3653" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3656" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="3658" class="Symbol">→</a> <a id="3660" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="3662" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3665" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="3667" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="3669" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="3671" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a>
<a id="3673" href="ShallowHoare.Ledger.html#3643" class="Function">∉-⟦⟧ₗ</a> <a id="3679" class="Symbol">{</a><a id="3680" href="ShallowHoare.Ledger.html#3680" class="Bound">A</a><a id="3681" class="Symbol">}{</a><a id="3683" href="ShallowHoare.Ledger.html#3683" class="Bound">s</a><a id="3684" class="Symbol">}{</a><a id="3686" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3688" class="Symbol">}</a> <a id="3690" href="ShallowHoare.Ledger.html#3690" class="Bound">A∉</a> <a id="3693" class="Symbol">=</a> <a id="3695" href="ShallowHoare.Ledger.html#3690" class="Bound">A∉</a>
<a id="3698" href="ShallowHoare.Ledger.html#3643" class="Function">∉-⟦⟧ₗ</a> <a id="3704" class="Symbol">{</a><a id="3705" href="ShallowHoare.Ledger.html#3705" class="Bound">A</a><a id="3706" class="Symbol">}{</a><a id="3708" href="ShallowHoare.Ledger.html#3708" class="Bound">s</a><a id="3709" class="Symbol">}{</a><a id="3711" href="ShallowHoare.Ledger.html#3711" class="Bound">t</a> <a id="3713" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3715" href="ShallowHoare.Ledger.html#3715" class="Bound">l</a><a id="3716" class="Symbol">}</a> <a id="3718" href="ShallowHoare.Ledger.html#3718" class="Bound">A∉</a> <a id="3721" class="Symbol">=</a> <a id="3723" href="ShallowHoare.Ledger.html#3643" class="Function">∉-⟦⟧ₗ</a> <a id="3729" class="Symbol">{</a><a id="3730" class="Argument">l</a> <a id="3732" class="Symbol">=</a> <a id="3734" href="ShallowHoare.Ledger.html#3715" class="Bound">l</a><a id="3735" class="Symbol">}</a> <a id="3737" class="Symbol">(</a><a id="3738" href="ShallowHoare.Ledger.html#3574" class="Function">∉-⟦⟧ₜ</a> <a id="3744" class="Symbol">{</a><a id="3745" class="Argument">s</a> <a id="3747" class="Symbol">=</a> <a id="3749" href="ShallowHoare.Ledger.html#3708" class="Bound">s</a><a id="3750" class="Symbol">}{</a><a id="3752" class="Argument">t</a> <a id="3754" class="Symbol">=</a> <a id="3756" href="ShallowHoare.Ledger.html#3711" class="Bound">t</a><a id="3757" class="Symbol">}</a> <a id="3759" href="ShallowHoare.Ledger.html#3718" class="Bound">A∉</a><a id="3761" class="Symbol">)</a>

<a id="∉-splits"></a><a id="3764" href="ShallowHoare.Ledger.html#3764" class="Function">∉-splits</a> <a id="3773" class="Symbol">:</a> <a id="3775" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟨</a> <a id="3777" href="ShallowHoare.Ledger.html#988" class="Generalizable">s₁</a> <a id="3780" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⊎</a> <a id="3782" href="ShallowHoare.Ledger.html#991" class="Generalizable">s₂</a> <a id="3785" href="Prelude.Maps.Abstract.Interface.html#1600" class="Function Operator">⟩≡</a> <a id="3788" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="3790" class="Symbol">→</a> <a id="3792" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="3794" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3797" href="ShallowHoare.Ledger.html#988" class="Generalizable">s₁</a> <a id="3800" class="Symbol">→</a> <a id="3802" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="3804" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3807" href="ShallowHoare.Ledger.html#991" class="Generalizable">s₂</a> <a id="3810" class="Symbol">→</a> <a id="3812" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="3814" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="3817" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a>
<a id="3819" href="ShallowHoare.Ledger.html#3764" class="Function">∉-splits</a> <a id="3828" class="Symbol">{</a><a id="3829" class="Argument">s₁</a> <a id="3832" class="Symbol">=</a> <a id="3834" href="ShallowHoare.Ledger.html#3834" class="Bound">s₁</a><a id="3836" class="Symbol">}{</a><a id="3838" href="ShallowHoare.Ledger.html#3838" class="Bound">s₂</a><a id="3840" class="Symbol">}{</a><a id="3842" href="ShallowHoare.Ledger.html#3842" class="Bound">s</a><a id="3843" class="Symbol">}{</a><a id="3845" href="ShallowHoare.Ledger.html#3845" class="Bound">A</a><a id="3846" class="Symbol">}</a> <a id="3848" class="Symbol">(</a><a id="3849" href="ShallowHoare.Ledger.html#3849" class="Bound">s₁♯s₂</a> <a id="3855" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3857" href="ShallowHoare.Ledger.html#3857" class="Bound">p</a><a id="3858" class="Symbol">)</a> <a id="3860" href="ShallowHoare.Ledger.html#3860" class="Bound">A∉₁</a> <a id="3864" href="ShallowHoare.Ledger.html#3864" class="Bound">A∉₂</a> <a id="3868" href="ShallowHoare.Ledger.html#3868" class="Bound">A∈</a>
  <a id="3873" class="Keyword">with</a> <a id="3878" href="Prelude.Maps.Abstract.Interface.html#2424" class="Function">∈ᵈ-∪⁻</a> <a id="3884" class="Symbol">_</a> <a id="3886" class="Symbol">_</a> <a id="3888" class="Symbol">_</a> <a id="3890" class="Symbol">(</a><a id="3891" href="Prelude.Maps.Abstract.Interface.html#2328" class="Function">∈ᵈ-cong</a> <a id="3899" class="Symbol">_</a> <a id="3901" class="Symbol">_</a> <a id="3903" class="Symbol">_</a> <a id="3905" class="Symbol">(</a><a id="3906" href="Prelude.Setoid.html#711" class="Function">≈-sym</a> <a id="3912" href="ShallowHoare.Ledger.html#3857" class="Bound">p</a><a id="3913" class="Symbol">)</a> <a id="3915" href="ShallowHoare.Ledger.html#3868" class="Bound">A∈</a><a id="3917" class="Symbol">)</a>
<a id="3919" class="Symbol">...</a> <a id="3923" class="Symbol">|</a> <a id="3925" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="3930" href="ShallowHoare.Ledger.html#3930" class="Bound">A∈₁</a> <a id="3934" class="Symbol">=</a> <a id="3936" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="3943" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3945" class="Bound">A∉₁</a> <a id="3949" href="ShallowHoare.Ledger.html#3930" class="Bound">A∈₁</a>
<a id="3953" class="Symbol">...</a> <a id="3957" class="Symbol">|</a> <a id="3959" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="3964" href="ShallowHoare.Ledger.html#3964" class="Bound">A∈₂</a> <a id="3968" class="Symbol">=</a> <a id="3970" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="3977" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3979" class="Bound">A∉₂</a> <a id="3983" href="ShallowHoare.Ledger.html#3964" class="Bound">A∈₂</a>

<a id="3988" class="Comment">-- ** Lemmas about the transfer operation on maps.</a>
<a id="transfer-helper"></a><a id="4039" href="ShallowHoare.Ledger.html#4039" class="Function">transfer-helper</a> <a id="4055" class="Symbol">:</a> <a id="4057" href="ShallowHoare.Ledger.html#988" class="Generalizable">s₁</a> <a id="4060" href="Prelude.Apartness.html#237" class="Field Operator">♯</a> <a id="4062" href="ShallowHoare.Ledger.html#991" class="Generalizable">s₂</a> <a id="4065" class="Symbol">→</a> <a id="4067" href="ShallowHoare.Ledger.html#490" class="Generalizable">B</a> <a id="4069" href="Prelude.Maps.Abstract.Interface.html#949" class="Function Operator">∉ᵈ</a> <a id="4072" href="ShallowHoare.Ledger.html#991" class="Generalizable">s₂</a> <a id="4075" class="Symbol">→</a> <a id="4077" class="Symbol">(</a><a id="4078" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="4082" href="ShallowHoare.Ledger.html#2115" class="Function Operator">[</a> <a id="4084" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="4086" href="ShallowHoare.Ledger.html#2115" class="Function Operator">∣</a> <a id="4088" href="ShallowHoare.Ledger.html#505" class="Generalizable">v</a> <a id="4090" href="ShallowHoare.Ledger.html#2115" class="Function Operator">↦</a> <a id="4092" href="ShallowHoare.Ledger.html#490" class="Generalizable">B</a> <a id="4094" href="ShallowHoare.Ledger.html#2115" class="Function Operator">]</a> <a id="4096" href="ShallowHoare.Ledger.html#988" class="Generalizable">s₁</a><a id="4098" class="Symbol">)</a> <a id="4100" href="Prelude.Apartness.html#237" class="Field Operator">♯</a> <a id="4102" href="ShallowHoare.Ledger.html#991" class="Generalizable">s₂</a>
<a id="4105" href="ShallowHoare.Ledger.html#4039" class="Function">transfer-helper</a> <a id="4121" class="Symbol">{</a><a id="4122" class="Argument">s₁</a> <a id="4125" class="Symbol">=</a> <a id="4127" href="ShallowHoare.Ledger.html#4127" class="Bound">s₁</a><a id="4129" class="Symbol">}{</a><a id="4131" href="ShallowHoare.Ledger.html#4131" class="Bound">s₂</a><a id="4133" class="Symbol">}{</a><a id="4135" href="ShallowHoare.Ledger.html#4135" class="Bound">B</a><a id="4136" class="Symbol">}{</a><a id="4138" href="ShallowHoare.Ledger.html#4138" class="Bound">A</a><a id="4139" class="Symbol">}{</a><a id="4141" href="ShallowHoare.Ledger.html#4141" class="Bound">v</a><a id="4142" class="Symbol">}</a> <a id="4144" href="ShallowHoare.Ledger.html#4144" class="Bound">s₁♯s₂</a> <a id="4150" href="ShallowHoare.Ledger.html#4150" class="Bound">B∉</a> <a id="4153" class="Symbol">=</a> <a id="4155" href="Prelude.Maps.Abstract.Interface.html#7983" class="Function">♯-cong-pre</a> <a id="4166" class="Symbol">_</a> <a id="4168" class="Symbol">_</a> <a id="4170" class="Symbol">_</a> <a id="4172" href="ShallowHoare.Ledger.html#3094" class="Function">[∣↦]-pre</a> <a id="4181" href="ShallowHoare.Ledger.html#4144" class="Bound">s₁♯s₂</a>

<a id="drop-[∣↦]"></a><a id="4188" href="ShallowHoare.Ledger.html#4188" class="Function">drop-[∣↦]</a> <a id="4198" class="Symbol">:</a> <a id="4200" class="Symbol">∀</a> <a id="4202" href="ShallowHoare.Ledger.html#4202" class="Bound">k</a> <a id="4204" class="Symbol">→</a> <a id="4206" href="ShallowHoare.Ledger.html#4202" class="Bound">k</a> <a id="4208" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="4210" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="4212" class="Symbol">→</a> <a id="4214" href="ShallowHoare.Ledger.html#4202" class="Bound">k</a> <a id="4216" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="4218" href="ShallowHoare.Ledger.html#490" class="Generalizable">B</a> <a id="4220" class="Symbol">→</a> <a id="4222" class="Symbol">(</a><a id="4223" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="4227" href="ShallowHoare.Ledger.html#2115" class="Function Operator">[</a> <a id="4229" href="ShallowHoare.Ledger.html#488" class="Generalizable">A</a> <a id="4231" href="ShallowHoare.Ledger.html#2115" class="Function Operator">∣</a> <a id="4233" href="ShallowHoare.Ledger.html#505" class="Generalizable">v</a> <a id="4235" href="ShallowHoare.Ledger.html#2115" class="Function Operator">↦</a> <a id="4237" href="ShallowHoare.Ledger.html#490" class="Generalizable">B</a> <a id="4239" href="ShallowHoare.Ledger.html#2115" class="Function Operator">]</a> <a id="4241" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a><a id="4242" class="Symbol">)</a> <a id="4244" href="Prelude.Maps.Abstract.Interface.html#608" class="Function Operator">⁉</a> <a id="4246" href="ShallowHoare.Ledger.html#4202" class="Bound">k</a> <a id="4248" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4250" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="4252" href="Prelude.Maps.Abstract.Interface.html#608" class="Function Operator">⁉</a> <a id="4254" href="ShallowHoare.Ledger.html#4202" class="Bound">k</a>
<a id="4256" href="ShallowHoare.Ledger.html#4188" class="Function">drop-[∣↦]</a> <a id="4266" class="Symbol">{</a><a id="4267" href="ShallowHoare.Ledger.html#4267" class="Bound">A</a><a id="4268" class="Symbol">}{</a><a id="4270" href="ShallowHoare.Ledger.html#4270" class="Bound">B</a><a id="4271" class="Symbol">}{</a><a id="4273" href="ShallowHoare.Ledger.html#4273" class="Bound">v</a><a id="4274" class="Symbol">}{</a><a id="4276" href="ShallowHoare.Ledger.html#4276" class="Bound">s</a><a id="4277" class="Symbol">}</a> <a id="4279" href="ShallowHoare.Ledger.html#4279" class="Bound">k</a> <a id="4281" href="ShallowHoare.Ledger.html#4281" class="Bound">k≢A</a> <a id="4285" href="ShallowHoare.Ledger.html#4285" class="Bound">k≢B</a>
  <a id="4291" class="Keyword">with</a> <a id="4296" href="ShallowHoare.Ledger.html#4276" class="Bound">s</a> <a id="4298" href="Prelude.Maps.Abstract.Interface.html#608" class="Function Operator">⁉</a> <a id="4300" href="ShallowHoare.Ledger.html#4267" class="Bound">A</a> <a id="4302" class="Symbol">|</a> <a id="4304" href="Relation.Binary.PropositionalEquality.html#2382" class="Function">inspect</a> <a id="4312" class="Symbol">(</a><a id="4313" href="ShallowHoare.Ledger.html#4276" class="Bound">s</a> <a id="4315" href="Prelude.Maps.Abstract.Interface.html#608" class="Function Operator">⁉_</a><a id="4317" class="Symbol">)</a> <a id="4319" href="ShallowHoare.Ledger.html#4267" class="Bound">A</a>
<a id="4321" class="Symbol">...</a> <a id="4325" class="Symbol">|</a> <a id="4327" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4335" class="Symbol">|</a> <a id="4337" class="Symbol">_</a> <a id="4339" class="Symbol">=</a> <a id="4341" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4346" class="Symbol">...</a> <a id="4350" class="Symbol">|</a> <a id="4352" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4357" href="ShallowHoare.Ledger.html#4357" class="Bound">vᵃ</a> <a id="4360" class="Symbol">|</a> <a id="4362" href="Relation.Binary.PropositionalEquality.html#2356" class="InductiveConstructor Operator">≡[</a> <a id="4365" href="ShallowHoare.Ledger.html#4365" class="Bound">sᵃ</a> <a id="4368" href="Relation.Binary.PropositionalEquality.html#2356" class="InductiveConstructor Operator">]</a>
  <a id="4372" class="Keyword">with</a> <a id="4377" class="Bound">s</a> <a id="4379" href="Prelude.Maps.Abstract.Interface.html#608" class="Function Operator">⁉</a> <a id="4381" class="Bound">B</a> <a id="4383" class="Symbol">|</a> <a id="4385" href="Relation.Binary.PropositionalEquality.html#2382" class="Function">inspect</a> <a id="4393" class="Symbol">(</a><a id="4394" class="Bound">s</a> <a id="4396" href="Prelude.Maps.Abstract.Interface.html#608" class="Function Operator">⁉_</a><a id="4398" class="Symbol">)</a> <a id="4400" class="Bound">B</a>
<a id="4402" class="Symbol">...</a> <a id="4406" class="Symbol">|</a> <a id="4408" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4416" class="Symbol">|</a> <a id="4418" class="Symbol">_</a> <a id="4420" class="Symbol">=</a> <a id="4422" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4427" class="Symbol">...</a> <a id="4431" class="Symbol">|</a> <a id="4433" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4438" href="ShallowHoare.Ledger.html#4438" class="Bound">vᵇ</a> <a id="4441" class="Symbol">|</a> <a id="4443" href="Relation.Binary.PropositionalEquality.html#2356" class="InductiveConstructor Operator">≡[</a> <a id="4446" href="ShallowHoare.Ledger.html#4446" class="Bound">sᵇ</a> <a id="4449" href="Relation.Binary.PropositionalEquality.html#2356" class="InductiveConstructor Operator">]</a>
  <a id="4453" class="Keyword">with</a> <a id="4458" class="Bound">v</a> <a id="4460" href="Prelude.Ord.html#522" class="Function Operator">≤?</a> <a id="4463" class="Bound">vᵃ</a>
<a id="4466" class="Symbol">...</a> <a id="4470" class="Symbol">|</a> <a id="4472" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4475" class="Symbol">_</a> <a id="4477" class="Symbol">=</a> <a id="4479" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4484" class="Symbol">...</a> <a id="4488" class="Symbol">|</a> <a id="4490" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4494" class="Symbol">_</a>
  <a id="4498" class="Keyword">with</a> <a id="4503" class="Bound">k</a> <a id="4505" href="Prelude.DecEq.Core.html#137" class="Field Operator">≟</a> <a id="4507" class="Bound">A</a>
<a id="4509" class="Symbol">...</a> <a id="4513" class="Symbol">|</a> <a id="4515" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4519" href="ShallowHoare.Ledger.html#4519" class="Bound">eq</a> <a id="4522" class="Symbol">=</a> <a id="4524" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="4531" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4533" class="Bound">k≢A</a> <a id="4537" href="ShallowHoare.Ledger.html#4519" class="Bound">eq</a>
<a id="4540" class="Symbol">...</a> <a id="4544" class="Symbol">|</a> <a id="4546" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="4550" class="Symbol">_</a> <a id="4552" class="Keyword">with</a> <a id="4557" class="Bound">k</a> <a id="4559" href="Prelude.DecEq.Core.html#137" class="Field Operator">≟</a> <a id="4561" class="Bound">B</a>
<a id="4563" class="Symbol">...</a> <a id="4567" class="Symbol">|</a> <a id="4569" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4573" href="ShallowHoare.Ledger.html#4573" class="Bound">eq</a> <a id="4576" class="Symbol">=</a> <a id="4578" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="4585" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="4587" class="Bound">k≢B</a> <a id="4591" href="ShallowHoare.Ledger.html#4573" class="Bound">eq</a>
<a id="4594" class="Symbol">...</a> <a id="4598" class="Symbol">|</a> <a id="4600" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="4604" class="Symbol">_</a>  <a id="4607" class="Symbol">=</a> <a id="4609" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="4615" class="Symbol">(</a><a id="4616" href="Prelude.Maps.Abstract.Interface.html#14843" class="Function">singleton-reject</a> <a id="4633" class="Bound">k≢B</a><a id="4636" class="Symbol">)</a> <a id="4638" class="Symbol">(</a><a id="4639" href="Prelude.Maps.Abstract.Interface.html#14843" class="Function">singleton-reject</a> <a id="4656" class="Bound">k≢A</a><a id="4659" class="Symbol">)</a>

<a id="4662" class="Comment">-- Transferring a value to/from distinct participants in the minimal map.</a>
<a id="4736" class="Comment">-- (utilizes general lemmas about the 3 available commands: `just?`/`iff`/`_≔_`)</a>
<a id="transfer"></a><a id="4817" href="ShallowHoare.Ledger.html#4817" class="Function">transfer</a> <a id="4826" class="Symbol">:</a> <a id="4828" class="Symbol">∀</a> <a id="4830" class="Symbol">{</a><a id="4831" href="ShallowHoare.Ledger.html#4831" class="Bound">A</a> <a id="4833" href="ShallowHoare.Ledger.html#4833" class="Bound">B</a> <a id="4835" href="ShallowHoare.Ledger.html#4835" class="Bound">v</a> <a id="4837" href="ShallowHoare.Ledger.html#4837" class="Bound">v′</a><a id="4839" class="Symbol">}</a>
  <a id="4843" class="Symbol">→</a> <a id="4845" href="ShallowHoare.Ledger.html#4831" class="Bound">A</a> <a id="4847" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="4849" href="ShallowHoare.Ledger.html#4833" class="Bound">B</a>
  <a id="4853" class="Symbol">→</a> <a id="4855" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="4859" href="ShallowHoare.Ledger.html#2115" class="Function Operator">[</a> <a id="4861" href="ShallowHoare.Ledger.html#4831" class="Bound">A</a> <a id="4863" href="ShallowHoare.Ledger.html#2115" class="Function Operator">∣</a> <a id="4865" href="ShallowHoare.Ledger.html#4835" class="Bound">v</a> <a id="4867" href="ShallowHoare.Ledger.html#2115" class="Function Operator">↦</a> <a id="4869" href="ShallowHoare.Ledger.html#4833" class="Bound">B</a> <a id="4871" href="ShallowHoare.Ledger.html#2115" class="Function Operator">]</a> <a id="4873" class="Symbol">(</a><a id="4874" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="4884" class="Symbol">(</a><a id="4885" href="ShallowHoare.Ledger.html#4831" class="Bound">A</a> <a id="4887" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4889" href="ShallowHoare.Ledger.html#4835" class="Bound">v</a><a id="4890" class="Symbol">)</a> <a id="4892" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="4894" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="4904" class="Symbol">(</a><a id="4905" href="ShallowHoare.Ledger.html#4833" class="Bound">B</a> <a id="4907" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4909" href="ShallowHoare.Ledger.html#4837" class="Bound">v′</a><a id="4911" class="Symbol">))</a>
  <a id="4916" href="Prelude.Setoid.html#210" class="Field Operator">≈</a> <a id="4918" class="Symbol">(</a><a id="4919" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="4929" class="Symbol">(</a><a id="4930" href="ShallowHoare.Ledger.html#4831" class="Bound">A</a> <a id="4932" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4934" class="Number">0</a><a id="4935" class="Symbol">)</a> <a id="4937" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="4939" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="4949" class="Symbol">(</a><a id="4950" href="ShallowHoare.Ledger.html#4833" class="Bound">B</a> <a id="4952" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4954" href="ShallowHoare.Ledger.html#4837" class="Bound">v′</a> <a id="4957" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4959" href="ShallowHoare.Ledger.html#4835" class="Bound">v</a><a id="4960" class="Symbol">))</a>
<a id="4963" href="ShallowHoare.Ledger.html#4817" class="Function">transfer</a> <a id="4972" class="Symbol">{</a><a id="4973" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a><a id="4974" class="Symbol">}{</a><a id="4976" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a><a id="4977" class="Symbol">}{</a><a id="4979" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="4980" class="Symbol">}{</a><a id="4982" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a><a id="4984" class="Symbol">}</a> <a id="4986" href="ShallowHoare.Ledger.html#4986" class="Bound">A≢B</a> <a id="4990" class="Symbol">=</a>
  <a id="4994" class="Keyword">let</a>
    <a id="5002" href="ShallowHoare.Ledger.html#5002" class="Bound">m</a> <a id="5004" class="Symbol">=</a> <a id="5006" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5016" class="Symbol">(</a><a id="5017" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5019" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5021" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5022" class="Symbol">)</a> <a id="5024" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="5026" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5036" class="Symbol">(</a><a id="5037" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5039" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5041" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a><a id="5043" class="Symbol">)</a>
  <a id="5047" class="Keyword">in</a>
  <a id="5052" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
    <a id="5062" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="5066" href="ShallowHoare.Ledger.html#2115" class="Function Operator">[</a> <a id="5068" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5070" href="ShallowHoare.Ledger.html#2115" class="Function Operator">∣</a> <a id="5072" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5074" href="ShallowHoare.Ledger.html#2115" class="Function Operator">↦</a> <a id="5076" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5078" href="ShallowHoare.Ledger.html#2115" class="Function Operator">]</a> <a id="5080" href="ShallowHoare.Ledger.html#5002" class="Bound">m</a>
  <a id="5084" href="Relation.Binary.Reasoning.Base.Single.html#2470" class="Function Operator">≡⟨⟩</a>
    <a id="5092" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="5096" class="Symbol">(</a><a id="5097" href="Prelude.Maps.Abstract.Interface.html#21081" class="InductiveConstructor">just?</a> <a id="5103" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5105" class="Symbol">λ</a> <a id="5107" href="ShallowHoare.Ledger.html#5107" class="Bound">vᵃ</a> <a id="5110" class="Symbol">→</a> <a id="5112" href="Prelude.Maps.Abstract.Interface.html#21081" class="InductiveConstructor">just?</a> <a id="5118" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5120" class="Symbol">λ</a> <a id="5122" href="ShallowHoare.Ledger.html#5122" class="Bound">vᵇ</a> <a id="5125" class="Symbol">→</a> <a id="5127" href="Prelude.Maps.Abstract.Interface.html#21176" class="Function Operator">iff¿</a> <a id="5132" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5134" href="Prelude.Ord.html#249" class="Field Operator">≤</a> <a id="5136" href="ShallowHoare.Ledger.html#5107" class="Bound">vᵃ</a> <a id="5139" href="Prelude.Maps.Abstract.Interface.html#21176" class="Function Operator">¿</a> <a id="5141" class="Symbol">((</a><a id="5143" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5145" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5147" href="ShallowHoare.Ledger.html#5107" class="Bound">vᵃ</a> <a id="5150" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="5152" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5153" class="Symbol">)</a> <a id="5155" href="Prelude.Maps.Abstract.Interface.html#21000" class="InductiveConstructor Operator">∶</a> <a id="5157" class="Symbol">(</a><a id="5158" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5160" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5162" href="ShallowHoare.Ledger.html#5122" class="Bound">vᵇ</a> <a id="5165" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5167" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5168" class="Symbol">)))</a> <a id="5172" href="ShallowHoare.Ledger.html#5002" class="Bound">m</a>
  <a id="5176" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5179" href="Prelude.Maps.Abstract.Interface.html#22676" class="Function">just?-accept</a> <a id="5192" class="Symbol">(</a><a id="5193" href="Prelude.Maps.Abstract.Interface.html#1960" class="Function">↦-∪⁺ˡ</a> <a id="5199" class="Symbol">_</a> <a id="5201" class="Symbol">_</a> <a id="5203" href="Prelude.Maps.Abstract.Interface.html#7664" class="Function">singleton-law′</a><a id="5217" class="Symbol">)</a> <a id="5219" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5225" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="5229" class="Symbol">(</a><a id="5230" href="Prelude.Maps.Abstract.Interface.html#21081" class="InductiveConstructor">just?</a> <a id="5236" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5238" class="Symbol">λ</a> <a id="5240" href="ShallowHoare.Ledger.html#5240" class="Bound">vᵇ</a> <a id="5243" class="Symbol">→</a> <a id="5245" href="Prelude.Maps.Abstract.Interface.html#21176" class="Function Operator">iff¿</a> <a id="5250" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5252" href="Prelude.Ord.html#249" class="Field Operator">≤</a> <a id="5254" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5256" href="Prelude.Maps.Abstract.Interface.html#21176" class="Function Operator">¿</a> <a id="5258" class="Symbol">((</a><a id="5260" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5262" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5264" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5266" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="5268" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5269" class="Symbol">)</a> <a id="5271" href="Prelude.Maps.Abstract.Interface.html#21000" class="InductiveConstructor Operator">∶</a> <a id="5273" class="Symbol">(</a><a id="5274" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5276" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5278" href="ShallowHoare.Ledger.html#5240" class="Bound">vᵇ</a> <a id="5281" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5283" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5284" class="Symbol">)))</a> <a id="5288" href="ShallowHoare.Ledger.html#5002" class="Bound">m</a>
  <a id="5292" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5295" href="Prelude.Maps.Abstract.Interface.html#22676" class="Function">just?-accept</a> <a id="5308" class="Symbol">(</a><a id="5309" href="Prelude.Maps.Abstract.Interface.html#3807" class="Function">↦-∪⁺ʳ′</a> <a id="5316" class="Symbol">(</a><a id="5317" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="5324" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5326" href="ShallowHoare.Ledger.html#4986" class="Bound">A≢B</a> <a id="5330" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5332" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="5336" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5338" href="Prelude.Maps.Abstract.Interface.html#7426" class="Function">singleton∈</a><a id="5348" class="Symbol">)</a> <a id="5350" href="Prelude.Maps.Abstract.Interface.html#7664" class="Function">singleton-law′</a><a id="5364" class="Symbol">)</a> <a id="5366" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5372" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="5376" class="Symbol">(</a><a id="5377" href="Prelude.Maps.Abstract.Interface.html#21176" class="Function Operator">iff¿</a> <a id="5382" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5384" href="Prelude.Ord.html#249" class="Field Operator">≤</a> <a id="5386" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5388" href="Prelude.Maps.Abstract.Interface.html#21176" class="Function Operator">¿</a> <a id="5390" class="Symbol">((</a><a id="5392" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5394" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5396" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5398" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="5400" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5401" class="Symbol">)</a> <a id="5403" href="Prelude.Maps.Abstract.Interface.html#21000" class="InductiveConstructor Operator">∶</a> <a id="5405" class="Symbol">(</a><a id="5406" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5408" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5410" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5413" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5415" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5416" class="Symbol">)))</a> <a id="5420" href="ShallowHoare.Ledger.html#5002" class="Bound">m</a>
  <a id="5424" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5427" href="Prelude.Maps.Abstract.Interface.html#23065" class="Function">iff-accept</a> <a id="5438" class="Symbol">{</a><a id="5439" class="Argument">b</a> <a id="5441" class="Symbol">=</a> <a id="5443" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5445" href="Prelude.Ord.html#522" class="Function Operator">≤?</a> <a id="5448" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5449" class="Symbol">}</a> <a id="5451" class="Symbol">(</a><a id="5452" href="Relation.Nullary.Decidable.Core.html#1653" class="Function">fromWitness</a> <a id="5464" href="Data.Nat.Properties.html#4565" class="Function">Nat.≤-refl</a><a id="5474" class="Symbol">)</a> <a id="5476" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5482" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="5486" class="Symbol">((</a><a id="5488" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5490" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5492" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5494" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="5496" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5497" class="Symbol">)</a> <a id="5499" href="Prelude.Maps.Abstract.Interface.html#21000" class="InductiveConstructor Operator">∶</a> <a id="5501" class="Symbol">(</a><a id="5502" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5504" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5506" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5509" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5511" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5512" class="Symbol">))</a> <a id="5515" href="ShallowHoare.Ledger.html#5002" class="Bound">m</a>
  <a id="5519" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5522" href="Prelude.Maps.Abstract.Interface.html#21602" class="Function">≈-cong-cmd</a> <a id="5533" class="Symbol">(</a><a id="5534" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5536" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5538" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5541" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5543" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5544" class="Symbol">)</a> <a id="5546" href="Prelude.Maps.Abstract.Interface.html#13821" class="Function">update-update</a> <a id="5560" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5566" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="5570" class="Symbol">(</a><a id="5571" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5573" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5575" class="Symbol">(</a><a id="5576" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5579" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5581" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5582" class="Symbol">))</a> <a id="5585" class="Symbol">(</a><a id="5586" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5596" class="Symbol">(</a><a id="5597" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5599" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5601" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5603" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="5605" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5606" class="Symbol">)</a> <a id="5608" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="5610" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5620" class="Symbol">(</a><a id="5621" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5623" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5625" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a><a id="5627" class="Symbol">))</a>
  <a id="5632" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5635" href="Prelude.Maps.Abstract.Interface.html#21602" class="Function">≈-cong-cmd</a> <a id="5646" class="Symbol">(</a><a id="5647" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5649" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5651" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5654" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5656" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5657" class="Symbol">)</a> <a id="5659" class="Symbol">(</a><a id="5660" href="Prelude.Maps.Abstract.Interface.html#2132" class="Function">∪-comm</a> <a id="5667" class="Symbol">_</a> <a id="5669" class="Symbol">_</a> <a id="5671" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5673" href="Prelude.Maps.Abstract.Interface.html#7486" class="Function">singleton♯</a> <a id="5684" href="ShallowHoare.Ledger.html#4986" class="Bound">A≢B</a><a id="5687" class="Symbol">)</a> <a id="5689" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5695" href="Prelude.Maps.Abstract.Interface.html#21279" class="Function">run</a> <a id="5699" class="Symbol">(</a><a id="5700" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5702" href="Prelude.Maps.Abstract.Interface.html#21117" class="InductiveConstructor Operator">≔</a> <a id="5704" class="Symbol">(</a><a id="5705" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5708" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5710" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5711" class="Symbol">))</a> <a id="5714" class="Symbol">(</a><a id="5715" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5725" class="Symbol">(</a><a id="5726" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5728" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5730" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a><a id="5732" class="Symbol">)</a> <a id="5734" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="5736" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5746" class="Symbol">(</a><a id="5747" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5749" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5751" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5753" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="5755" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5756" class="Symbol">))</a>
  <a id="5761" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5764" href="Prelude.Maps.Abstract.Interface.html#13821" class="Function">update-update</a> <a id="5778" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5784" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5794" class="Symbol">(</a><a id="5795" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5797" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5799" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5802" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5804" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5805" class="Symbol">)</a> <a id="5807" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="5809" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5819" class="Symbol">(</a><a id="5820" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5822" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5824" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5826" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="5828" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5829" class="Symbol">)</a>
  <a id="5833" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">≈⟨</a> <a id="5836" href="Prelude.Maps.Abstract.Interface.html#2132" class="Function">∪-comm</a> <a id="5843" class="Symbol">_</a> <a id="5845" class="Symbol">_</a> <a id="5847" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5849" href="Prelude.Maps.Abstract.Interface.html#7486" class="Function">singleton♯</a> <a id="5860" class="Symbol">(</a><a id="5861" href="Relation.Binary.PropositionalEquality.Core.html#2301" class="Function">≢-sym</a> <a id="5867" href="ShallowHoare.Ledger.html#4986" class="Bound">A≢B</a><a id="5870" class="Symbol">)</a> <a id="5872" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">⟩</a>
    <a id="5878" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5888" class="Symbol">(</a><a id="5889" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5891" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5893" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a> <a id="5895" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="5897" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5898" class="Symbol">)</a> <a id="5900" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="5902" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5912" class="Symbol">(</a><a id="5913" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5915" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5917" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5920" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5922" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5923" class="Symbol">)</a>
  <a id="5927" href="Relation.Binary.Reasoning.Base.Single.html#2182" class="Function">≡⟨</a> <a id="5930" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="5935" class="Symbol">(λ</a> <a id="5938" href="ShallowHoare.Ledger.html#5938" class="Bound">x</a> <a id="5940" class="Symbol">→</a> <a id="5942" class="Symbol">(</a><a id="5943" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5953" class="Symbol">(</a><a id="5954" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="5956" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5958" href="ShallowHoare.Ledger.html#5938" class="Bound">x</a><a id="5959" class="Symbol">)</a> <a id="5961" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="5963" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="5973" class="Symbol">(</a><a id="5974" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="5976" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5978" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="5981" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5983" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="5984" class="Symbol">)))</a> <a id="5988" class="Symbol">(</a><a id="5989" href="Data.Nat.Properties.html#42140" class="Function">Nat.n∸n≡0</a> <a id="5999" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="6000" class="Symbol">)</a> <a id="6002" href="Relation.Binary.Reasoning.Base.Single.html#2182" class="Function">⟩</a>
    <a id="6008" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="6018" class="Symbol">(</a><a id="6019" href="ShallowHoare.Ledger.html#4973" class="Bound">A</a> <a id="6021" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6023" class="Number">0</a><a id="6024" class="Symbol">)</a> <a id="6026" href="Prelude.Maps.Abstract.Interface.html#575" class="Function Operator">∪</a> <a id="6028" href="Prelude.Maps.Abstract.Interface.html#7339" class="Function">singleton</a> <a id="6038" class="Symbol">(</a><a id="6039" href="ShallowHoare.Ledger.html#4976" class="Bound">B</a> <a id="6041" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6043" href="ShallowHoare.Ledger.html#4982" class="Bound">v′</a> <a id="6046" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6048" href="ShallowHoare.Ledger.html#4979" class="Bound">v</a><a id="6049" class="Symbol">)</a>
  <a id="6053" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">∎</a> <a id="6055" class="Keyword">where</a>
    <a id="6065" class="Keyword">open</a> <a id="6070" href="Prelude.Setoid.html#931" class="Module">≈-Reasoning</a>

<a id="6083" class="Comment">-- ** Operational semantics</a>
<a id="6111" class="Comment">-- We model configurations of the transition system as pairs of a ledger and its current state.</a>

<a id="6208" class="Keyword">infix</a> <a id="6214" class="Number">0</a> <a id="6216" href="ShallowHoare.Ledger.html#6240" class="Datatype Operator">_—→_</a> <a id="6221" href="ShallowHoare.Ledger.html#6355" class="Datatype Operator">_—→⋆_</a> <a id="6227" href="ShallowHoare.Ledger.html#6518" class="Function Operator">_—→⋆′_</a>

<a id="6235" class="Keyword">data</a> <a id="_—→_"></a><a id="6240" href="ShallowHoare.Ledger.html#6240" class="Datatype Operator">_—→_</a> <a id="6245" class="Symbol">:</a> <a id="6247" href="ShallowHoare.Ledger.html#956" class="Function">L</a> <a id="6249" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6251" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="6253" class="Symbol">→</a> <a id="6255" href="ShallowHoare.Ledger.html#956" class="Function">L</a> <a id="6257" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6259" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="6261" class="Symbol">→</a> <a id="6263" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="6268" class="Keyword">where</a>
  <a id="_—→_.singleStep"></a><a id="6276" href="ShallowHoare.Ledger.html#6276" class="InductiveConstructor">singleStep</a> <a id="6287" class="Symbol">:</a>
     <a id="6294" class="Comment">------------------------</a>
     <a id="6324" href="ShallowHoare.Ledger.html#1000" class="Generalizable">t</a> <a id="6326" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6328" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="6330" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6332" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="6334" href="ShallowHoare.Ledger.html#6240" class="Datatype Operator">—→</a> <a id="6337" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="6339" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6341" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="6343" href="ShallowHoare.Ledger.html#1000" class="Generalizable">t</a> <a id="6345" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="6347" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a>

<a id="6350" class="Keyword">data</a> <a id="_—→⋆_"></a><a id="6355" href="ShallowHoare.Ledger.html#6355" class="Datatype Operator">_—→⋆_</a> <a id="6361" class="Symbol">:</a> <a id="6363" href="ShallowHoare.Ledger.html#956" class="Function">L</a> <a id="6365" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6367" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="6369" class="Symbol">→</a> <a id="6371" href="ShallowHoare.Ledger.html#956" class="Function">L</a> <a id="6373" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6375" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="6377" class="Symbol">→</a> <a id="6379" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="6384" class="Keyword">where</a>
   <a id="_—→⋆_.base"></a><a id="6393" href="ShallowHoare.Ledger.html#6393" class="InductiveConstructor">base</a> <a id="6398" class="Symbol">:</a>
       <a id="6407" class="Comment">---------</a>
       <a id="6424" href="ShallowHoare.Ledger.html#1035" class="Generalizable">ls</a> <a id="6427" href="ShallowHoare.Ledger.html#6355" class="Datatype Operator">—→⋆</a> <a id="6431" href="ShallowHoare.Ledger.html#1035" class="Generalizable">ls</a>

   <a id="_—→⋆_.step"></a><a id="6438" href="ShallowHoare.Ledger.html#6438" class="InductiveConstructor">step</a> <a id="6443" class="Symbol">:</a>
       <a id="6452" href="ShallowHoare.Ledger.html#1035" class="Generalizable">ls</a> <a id="6455" href="ShallowHoare.Ledger.html#6240" class="Datatype Operator">—→</a> <a id="6458" href="ShallowHoare.Ledger.html#1038" class="Generalizable">ls′</a>
     <a id="6467" class="Symbol">→</a> <a id="6469" href="ShallowHoare.Ledger.html#1038" class="Generalizable">ls′</a> <a id="6473" href="ShallowHoare.Ledger.html#6355" class="Datatype Operator">—→⋆</a> <a id="6477" href="ShallowHoare.Ledger.html#1042" class="Generalizable">ls″</a>
       <a id="6488" class="Comment">----------</a>
     <a id="6504" class="Symbol">→</a> <a id="6506" href="ShallowHoare.Ledger.html#1035" class="Generalizable">ls</a> <a id="6509" href="ShallowHoare.Ledger.html#6355" class="Datatype Operator">—→⋆</a> <a id="6513" href="ShallowHoare.Ledger.html#1042" class="Generalizable">ls″</a>

<a id="_—→⋆′_"></a><a id="6518" href="ShallowHoare.Ledger.html#6518" class="Function Operator">_—→⋆′_</a> <a id="6525" class="Symbol">:</a> <a id="6527" href="ShallowHoare.Ledger.html#956" class="Function">L</a> <a id="6529" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6531" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="6533" class="Symbol">→</a> <a id="6535" href="ShallowHoare.Ledger.html#689" class="Function">S</a> <a id="6537" class="Symbol">→</a> <a id="6539" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="6544" href="ShallowHoare.Ledger.html#6544" class="Bound">ls</a> <a id="6547" href="ShallowHoare.Ledger.html#6518" class="Function Operator">—→⋆′</a> <a id="6552" href="ShallowHoare.Ledger.html#6552" class="Bound">s</a> <a id="6554" class="Symbol">=</a> <a id="6556" href="ShallowHoare.Ledger.html#6544" class="Bound">ls</a> <a id="6559" href="ShallowHoare.Ledger.html#6355" class="Datatype Operator">—→⋆</a> <a id="6563" class="Symbol">(</a><a id="6564" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6567" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6569" href="ShallowHoare.Ledger.html#6552" class="Bound">s</a><a id="6570" class="Symbol">)</a>

<a id="comp′"></a><a id="6573" href="ShallowHoare.Ledger.html#6573" class="Function">comp′</a> <a id="6579" class="Symbol">:</a>
    <a id="6585" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a>       <a id="6593" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6595" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a>  <a id="6598" href="ShallowHoare.Ledger.html#6518" class="Function Operator">—→⋆′</a> <a id="6603" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a>
  <a id="6608" class="Symbol">→</a> <a id="6610" href="ShallowHoare.Ledger.html#1017" class="Generalizable">l′</a>      <a id="6618" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6620" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a> <a id="6623" href="ShallowHoare.Ledger.html#6518" class="Function Operator">—→⋆′</a> <a id="6628" href="ShallowHoare.Ledger.html#985" class="Generalizable">s″</a>
  <a id="6633" class="Symbol">→</a> <a id="6635" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="6637" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="6640" href="ShallowHoare.Ledger.html#1017" class="Generalizable">l′</a> <a id="6643" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6645" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a>  <a id="6648" href="ShallowHoare.Ledger.html#6518" class="Function Operator">—→⋆′</a> <a id="6653" href="ShallowHoare.Ledger.html#985" class="Generalizable">s″</a>
<a id="6656" href="ShallowHoare.Ledger.html#6573" class="Function">comp′</a> <a id="6662" class="Symbol">{</a><a id="6663" class="Argument">l</a> <a id="6665" class="Symbol">=</a> <a id="6667" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6669" class="Symbol">}</a>    <a id="6674" href="ShallowHoare.Ledger.html#6393" class="InductiveConstructor">base</a>                   <a id="6697" href="ShallowHoare.Ledger.html#6697" class="Bound">s′→s″</a> <a id="6703" class="Symbol">=</a> <a id="6705" href="ShallowHoare.Ledger.html#6697" class="Bound">s′→s″</a>
<a id="6711" href="ShallowHoare.Ledger.html#6573" class="Function">comp′</a> <a id="6717" class="Symbol">{</a><a id="6718" class="Argument">l</a> <a id="6720" class="Symbol">=</a> <a id="6722" class="Symbol">_</a> <a id="6724" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6726" class="Symbol">_}</a> <a id="6729" class="Symbol">(</a><a id="6730" href="ShallowHoare.Ledger.html#6438" class="InductiveConstructor">step</a> <a id="6735" href="ShallowHoare.Ledger.html#6276" class="InductiveConstructor">singleStep</a> <a id="6746" href="ShallowHoare.Ledger.html#6746" class="Bound">s→s′</a><a id="6750" class="Symbol">)</a> <a id="6752" href="ShallowHoare.Ledger.html#6752" class="Bound">s′→s″</a> <a id="6758" class="Symbol">=</a> <a id="6760" href="ShallowHoare.Ledger.html#6438" class="InductiveConstructor">step</a> <a id="6765" href="ShallowHoare.Ledger.html#6276" class="InductiveConstructor">singleStep</a> <a id="6776" class="Symbol">(</a><a id="6777" href="ShallowHoare.Ledger.html#6573" class="Function">comp′</a> <a id="6783" href="ShallowHoare.Ledger.html#6746" class="Bound">s→s′</a> <a id="6788" href="ShallowHoare.Ledger.html#6752" class="Bound">s′→s″</a><a id="6793" class="Symbol">)</a>

<a id="oper-base⋆"></a><a id="6796" href="ShallowHoare.Ledger.html#6796" class="Function">oper-base⋆</a> <a id="6807" class="Symbol">:</a> <a id="6809" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="6811" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6813" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="6815" href="ShallowHoare.Ledger.html#6518" class="Function Operator">—→⋆′</a> <a id="6820" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="6822" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="6824" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="6826" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a>
<a id="6828" href="ShallowHoare.Ledger.html#6796" class="Function">oper-base⋆</a> <a id="6839" class="Symbol">{</a><a id="6840" class="Argument">l</a> <a id="6842" class="Symbol">=</a> <a id="6844" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6846" class="Symbol">}</a>    <a id="6851" class="Symbol">=</a> <a id="6853" href="ShallowHoare.Ledger.html#6393" class="InductiveConstructor">base</a>
<a id="6858" href="ShallowHoare.Ledger.html#6796" class="Function">oper-base⋆</a> <a id="6869" class="Symbol">{</a><a id="6870" class="Argument">l</a> <a id="6872" class="Symbol">=</a> <a id="6874" class="Symbol">_</a> <a id="6876" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6878" class="Symbol">_}</a> <a id="6881" class="Symbol">=</a> <a id="6883" href="ShallowHoare.Ledger.html#6438" class="InductiveConstructor">step</a> <a id="6888" href="ShallowHoare.Ledger.html#6276" class="InductiveConstructor">singleStep</a> <a id="6899" href="ShallowHoare.Ledger.html#6796" class="Function">oper-base⋆</a>

<a id="6911" class="Comment">-- ** Relating denotational and operational semantics.</a>
<a id="denot⇒oper"></a><a id="6966" href="ShallowHoare.Ledger.html#6966" class="Function">denot⇒oper</a> <a id="6977" class="Symbol">:</a> <a id="6979" class="Symbol">(</a><a id="6980" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="6982" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="6984" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="6986" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="6988" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6990" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a><a id="6992" class="Symbol">)</a> <a id="6994" class="Symbol">→</a> <a id="6996" class="Symbol">(</a><a id="6997" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="6999" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7001" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="7003" href="ShallowHoare.Ledger.html#6518" class="Function Operator">—→⋆′</a> <a id="7008" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a><a id="7010" class="Symbol">)</a>
<a id="7012" href="ShallowHoare.Ledger.html#6966" class="Function">denot⇒oper</a> <a id="7023" class="Symbol">{</a><a id="7024" class="Argument">l</a> <a id="7026" class="Symbol">=</a> <a id="7028" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7030" class="Symbol">}</a>    <a id="7035" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7040" class="Symbol">=</a> <a id="7042" href="ShallowHoare.Ledger.html#6393" class="InductiveConstructor">base</a>
<a id="7047" href="ShallowHoare.Ledger.html#6966" class="Function">denot⇒oper</a> <a id="7058" class="Symbol">{</a><a id="7059" class="Argument">l</a> <a id="7061" class="Symbol">=</a> <a id="7063" class="Symbol">_</a> <a id="7065" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7067" class="Symbol">_}</a> <a id="7070" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7075" class="Symbol">=</a> <a id="7077" href="ShallowHoare.Ledger.html#6438" class="InductiveConstructor">step</a> <a id="7082" href="ShallowHoare.Ledger.html#6276" class="InductiveConstructor">singleStep</a> <a id="7093" class="Symbol">(</a><a id="7094" href="ShallowHoare.Ledger.html#6966" class="Function">denot⇒oper</a> <a id="7105" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="7109" class="Symbol">)</a>

<a id="oper⇒denot"></a><a id="7112" href="ShallowHoare.Ledger.html#7112" class="Function">oper⇒denot</a> <a id="7123" class="Symbol">:</a> <a id="7125" class="Symbol">(</a><a id="7126" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="7128" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7130" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="7132" href="ShallowHoare.Ledger.html#6518" class="Function Operator">—→⋆′</a> <a id="7137" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a><a id="7139" class="Symbol">)</a> <a id="7141" class="Symbol">→</a> <a id="7143" class="Symbol">(</a><a id="7144" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="7146" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="7148" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="7150" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="7152" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7154" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a><a id="7156" class="Symbol">)</a>
<a id="7158" href="ShallowHoare.Ledger.html#7112" class="Function">oper⇒denot</a> <a id="7169" class="Symbol">{</a><a id="7170" class="Argument">l</a> <a id="7172" class="Symbol">=</a> <a id="7174" class="DottedPattern Symbol">.</a><a id="7175" href="Agda.Builtin.List.html#185" class="DottedPattern InductiveConstructor">[]</a><a id="7177" class="Symbol">}</a>   <a id="7181" href="ShallowHoare.Ledger.html#6393" class="InductiveConstructor">base</a>                <a id="7201" class="Symbol">=</a> <a id="7203" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="7208" href="ShallowHoare.Ledger.html#7112" class="Function">oper⇒denot</a> <a id="7219" class="Symbol">{</a><a id="7220" class="Argument">l</a> <a id="7222" class="Symbol">=</a> <a id="7224" class="Symbol">_</a> <a id="7226" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7228" class="Symbol">_}</a> <a id="7231" class="Symbol">(</a><a id="7232" href="ShallowHoare.Ledger.html#6438" class="InductiveConstructor">step</a> <a id="7237" href="ShallowHoare.Ledger.html#6276" class="InductiveConstructor">singleStep</a> <a id="7248" href="ShallowHoare.Ledger.html#7248" class="Bound">p</a><a id="7249" class="Symbol">)</a> <a id="7251" class="Symbol">=</a> <a id="7253" href="ShallowHoare.Ledger.html#7112" class="Function">oper⇒denot</a> <a id="7264" href="ShallowHoare.Ledger.html#7248" class="Bound">p</a>

<a id="denot⇔oper"></a><a id="7267" href="ShallowHoare.Ledger.html#7267" class="Function">denot⇔oper</a> <a id="7278" class="Symbol">:</a> <a id="7280" class="Symbol">(</a><a id="7281" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟦</a> <a id="7283" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="7285" href="ShallowHoare.Ledger.html#1303" class="Field Operator">⟧</a> <a id="7287" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="7289" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7291" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a><a id="7293" class="Symbol">)</a> <a id="7295" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="7297" class="Symbol">(</a><a id="7298" href="ShallowHoare.Ledger.html#1015" class="Generalizable">l</a> <a id="7300" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7302" href="ShallowHoare.Ledger.html#980" class="Generalizable">s</a> <a id="7304" href="ShallowHoare.Ledger.html#6518" class="Function Operator">—→⋆′</a> <a id="7309" href="ShallowHoare.Ledger.html#982" class="Generalizable">s′</a><a id="7311" class="Symbol">)</a>
<a id="7313" href="ShallowHoare.Ledger.html#7267" class="Function">denot⇔oper</a> <a id="7324" class="Symbol">=</a> <a id="7326" href="ShallowHoare.Ledger.html#6966" class="Function">denot⇒oper</a> <a id="7337" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7339" href="ShallowHoare.Ledger.html#7112" class="Function">oper⇒denot</a>
</pre></body></html>