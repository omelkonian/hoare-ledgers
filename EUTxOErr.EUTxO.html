<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>EUTxOErr.EUTxO</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/hoare-ledgers/tree/master///EUTxOErr/EUTxO.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">----------------------------------------------</a>
<a id="48" class="Comment">-- ** Basic definition for EUTxO-based ledgers.</a>

<a id="97" class="Keyword">module</a> <a id="104" href="EUTxOErr.EUTxO.html" class="Module">EUTxOErr.EUTxO</a> <a id="119" class="Keyword">where</a>

<a id="126" class="Keyword">open</a> <a id="131" class="Keyword">import</a> <a id="138" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="150" class="Symbol">;</a> <a id="152" class="Keyword">open</a> <a id="157" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="167" class="Keyword">open</a> <a id="172" href="Prelude.Init.html#7254" class="Module">L.Mem</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="206" class="Keyword">open</a> <a id="211" class="Keyword">import</a> <a id="218" href="Prelude.Maybes.html" class="Module">Prelude.Maybes</a>
<a id="233" class="Keyword">open</a> <a id="238" class="Keyword">import</a> <a id="245" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Prelude.Lists.html" class="Module">Prelude.Lists</a> <a id="339" class="Keyword">hiding</a> <a id="346" class="Symbol">(</a><a id="347" href="Prelude.Lists.Indexed.html#713" class="Function Operator">_⁉_</a><a id="350" class="Symbol">;</a> <a id="352" href="Prelude.Lists.Indexed.html#650" class="Function Operator">_‼_</a><a id="355" class="Symbol">;</a> <a id="357" href="Prelude.Lists.Mappings.html#724" class="Function">map↦</a><a id="361" class="Symbol">)</a>
<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Prelude.Lists.Dec.html" class="Module">Prelude.Lists.Dec</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Prelude.Lists.WithK.html" class="Module">Prelude.Lists.WithK</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="453" class="Keyword">open</a> <a id="458" class="Keyword">import</a> <a id="465" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="485" class="Keyword">open</a> <a id="490" class="Keyword">import</a> <a id="497" href="Prelude.FromList.html" class="Module">Prelude.FromList</a>
<a id="514" class="Keyword">open</a> <a id="519" class="Keyword">import</a> <a id="526" href="Prelude.Membership.html" class="Module">Prelude.Membership</a> <a id="545" class="Keyword">using</a> <a id="551" class="Symbol">(</a><a id="552" href="Prelude.Membership.html#455" class="Field Operator">_∈?_</a><a id="556" class="Symbol">;</a> <a id="558" href="Prelude.Membership.html#613" class="Function Operator">_∉?_</a><a id="562" class="Symbol">)</a>
<a id="564" class="Keyword">open</a> <a id="569" class="Keyword">import</a> <a id="576" href="Prelude.Irrelevance.html" class="Module">Prelude.Irrelevance</a>
<a id="596" class="Keyword">open</a> <a id="601" class="Keyword">import</a> <a id="608" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>
<a id="626" class="Keyword">open</a> <a id="631" class="Keyword">import</a> <a id="638" href="Prelude.Allable.html" class="Module">Prelude.Allable</a> <a id="654" class="Keyword">hiding</a> <a id="661" class="Symbol">(</a><a id="662" href="Prelude.Allable.html#207" class="Field">All</a><a id="665" class="Symbol">)</a>

<a id="668" class="Keyword">open</a> <a id="673" class="Keyword">import</a> <a id="680" href="Common.Utils.html" class="Module">Common.Utils</a> <a id="693" class="Keyword">public</a>
<a id="700" class="Keyword">open</a> <a id="705" class="Keyword">import</a> <a id="712" href="Common.Hash.html" class="Module">Common.Hash</a>  <a id="725" class="Keyword">public</a>
<a id="732" class="Keyword">open</a> <a id="737" class="Keyword">import</a> <a id="744" href="Common.Data.html" class="Module">Common.Data</a>  <a id="757" class="Keyword">public</a>
<a id="764" class="Keyword">open</a> <a id="769" class="Keyword">import</a> <a id="776" href="Common.Maps.html" class="Module">Common.Maps</a>  <a id="789" class="Keyword">public</a>
  <a id="798" class="Keyword">hiding</a> <a id="805" class="Symbol">(</a><a id="806" href="Prelude.Maps.AsSets.html#581" class="InductiveConstructor Operator">_⊣_</a><a id="809" class="Symbol">)</a>

<a id="Value"></a><a id="812" href="EUTxOErr.EUTxO.html#812" class="Function">Value</a>   <a id="820" class="Symbol">=</a> <a id="822" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="Address"></a><a id="824" href="EUTxOErr.EUTxO.html#824" class="Function">Address</a> <a id="832" class="Symbol">=</a> <a id="834" href="Common.Hash.html#69" class="Function">HashId</a>

<a id="842" class="Comment">-- Transaction context, identical to the type of transactions except where</a>
<a id="917" class="Comment">-- validators, redeemers, and datums have been replaced with hashes.</a>
<a id="986" class="Keyword">record</a> <a id="OutputInfo"></a><a id="993" href="EUTxOErr.EUTxO.html#993" class="Record">OutputInfo</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1011" class="Keyword">where</a>
  <a id="1019" class="Keyword">constructor</a> <a id="⦉_⦊_at_"></a><a id="1031" href="EUTxOErr.EUTxO.html#1031" class="InductiveConstructor Operator">⦉_⦊_at_</a>
  <a id="1041" class="Keyword">field</a> <a id="OutputInfo.datumHash"></a><a id="1047" href="EUTxOErr.EUTxO.html#1047" class="Field">datumHash</a> <a id="1057" class="Symbol">:</a> <a id="1059" href="Common.Data.html#224" class="Function">DATA</a>
        <a id="OutputInfo.value"></a><a id="1072" href="EUTxOErr.EUTxO.html#1072" class="Field">value</a>     <a id="1082" class="Symbol">:</a> <a id="1084" href="EUTxOErr.EUTxO.html#812" class="Function">Value</a>
        <a id="OutputInfo.address"></a><a id="1098" href="EUTxOErr.EUTxO.html#1098" class="Field">address</a>   <a id="1108" class="Symbol">:</a> <a id="1110" href="EUTxOErr.EUTxO.html#824" class="Function">Address</a>
<a id="1118" class="Keyword">unquoteDecl</a> <a id="DecEq-OutputInfo"></a><a id="1130" href="EUTxOErr.EUTxO.html#1130" class="Function">DecEq-OutputInfo</a> <a id="1147" class="Symbol">=</a> <a id="1149" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="1156" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="1162" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1164" class="Keyword">quote</a> <a id="1170" href="EUTxOErr.EUTxO.html#993" class="Record">OutputInfo</a> <a id="1181" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1183" href="EUTxOErr.EUTxO.html#1130" class="Function">DecEq-OutputInfo</a> <a id="1200" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
<a id="1202" class="Keyword">pattern</a> <a id="_at_"></a><a id="1210" href="EUTxOErr.EUTxO.html#1210" class="InductiveConstructor Operator">_at_</a> <a id="1215" href="EUTxOErr.EUTxO.html#1228" class="Bound">x</a> <a id="1217" href="EUTxOErr.EUTxO.html#1233" class="Bound">y</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="EUTxOErr.EUTxO.html#1031" class="InductiveConstructor Operator">⦉</a> <a id="1223" class="String">&quot;&quot;</a> <a id="1226" href="EUTxOErr.EUTxO.html#1031" class="InductiveConstructor Operator">⦊</a> <a id="1228" href="EUTxOErr.EUTxO.html#1228" class="Bound">x</a> <a id="1230" href="EUTxOErr.EUTxO.html#1031" class="InductiveConstructor Operator">at</a> <a id="1233" href="EUTxOErr.EUTxO.html#1233" class="Bound">y</a>

<a id="1236" class="Keyword">record</a> <a id="InputInfo"></a><a id="1243" href="EUTxOErr.EUTxO.html#1243" class="Record">InputInfo</a> <a id="1253" class="Symbol">:</a> <a id="1255" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1260" class="Keyword">where</a>
  <a id="1268" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="1274" href="EUTxOErr.EUTxO.html#1274" class="Field">outputRef</a>     <a id="1288" class="Symbol">:</a> <a id="1290" href="EUTxOErr.EUTxO.html#993" class="Record">OutputInfo</a>
        <a id="1309" class="Comment">-- NB: the actual implementation also keeps references here</a>
        <a id="InputInfo.validatorHash"></a><a id="1377" href="EUTxOErr.EUTxO.html#1377" class="Field">validatorHash</a> <a id="1391" class="Symbol">:</a> <a id="1393" href="Common.Hash.html#69" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="1408" href="EUTxOErr.EUTxO.html#1408" class="Field">redeemerHash</a>  <a id="1422" class="Symbol">:</a> <a id="1424" href="Common.Hash.html#69" class="Function">HashId</a>
<a id="1431" class="Keyword">unquoteDecl</a> <a id="DecEq-InputInfo"></a><a id="1443" href="EUTxOErr.EUTxO.html#1443" class="Function">DecEq-InputInfo</a> <a id="1459" class="Symbol">=</a> <a id="1461" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="1468" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="1474" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1476" class="Keyword">quote</a> <a id="1482" href="EUTxOErr.EUTxO.html#1243" class="Record">InputInfo</a> <a id="1492" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1494" href="EUTxOErr.EUTxO.html#1443" class="Function">DecEq-InputInfo</a> <a id="1510" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>

<a id="1513" class="Keyword">record</a> <a id="TxInfo"></a><a id="1520" href="EUTxOErr.EUTxO.html#1520" class="Record">TxInfo</a> <a id="1527" class="Symbol">:</a> <a id="1529" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1534" class="Keyword">where</a>
  <a id="1542" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="1548" href="EUTxOErr.EUTxO.html#1548" class="Field">inputs</a>    <a id="1558" class="Symbol">:</a> <a id="1560" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1565" href="EUTxOErr.EUTxO.html#1243" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="1583" href="EUTxOErr.EUTxO.html#1583" class="Field">outputs</a>   <a id="1593" class="Symbol">:</a> <a id="1595" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1600" href="EUTxOErr.EUTxO.html#993" class="Record">OutputInfo</a>
        <a id="TxInfo.forge"></a><a id="1619" href="EUTxOErr.EUTxO.html#1619" class="Field">forge</a>     <a id="1629" class="Symbol">:</a> <a id="1631" href="EUTxOErr.EUTxO.html#812" class="Function">Value</a>
<a id="1637" class="Keyword">unquoteDecl</a> <a id="DecEq-TxInfo"></a><a id="1649" href="EUTxOErr.EUTxO.html#1649" class="Function">DecEq-TxInfo</a> <a id="1662" class="Symbol">=</a> <a id="1664" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="1671" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="1677" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1679" class="Keyword">quote</a> <a id="1685" href="EUTxOErr.EUTxO.html#1520" class="Record">TxInfo</a> <a id="1692" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1694" href="EUTxOErr.EUTxO.html#1649" class="Function">DecEq-TxInfo</a> <a id="1707" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
<a id="1709" class="Comment">--</a>

<a id="1713" class="Keyword">record</a> <a id="TxOutput"></a><a id="1720" href="EUTxOErr.EUTxO.html#1720" class="Record">TxOutput</a> <a id="1729" class="Symbol">:</a> <a id="1731" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1736" class="Keyword">where</a>
  <a id="1744" class="Keyword">constructor</a> <a id="⦉_⦊_at_"></a><a id="1756" href="EUTxOErr.EUTxO.html#1756" class="InductiveConstructor Operator">⦉_⦊_at_</a>
  <a id="1766" class="Keyword">field</a> <a id="TxOutput.datum"></a><a id="1772" href="EUTxOErr.EUTxO.html#1772" class="Field">datum</a>    <a id="1781" class="Symbol">:</a> <a id="1783" href="Common.Data.html#224" class="Function">DATA</a>
        <a id="TxOutput.value"></a><a id="1796" href="EUTxOErr.EUTxO.html#1796" class="Field">value</a>    <a id="1805" class="Symbol">:</a> <a id="1807" href="EUTxOErr.EUTxO.html#812" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="1821" href="EUTxOErr.EUTxO.html#1821" class="Field">address</a>  <a id="1830" class="Symbol">:</a> <a id="1832" href="EUTxOErr.EUTxO.html#824" class="Function">Address</a>
<a id="1840" class="Keyword">open</a> <a id="1845" href="EUTxOErr.EUTxO.html#1720" class="Module">TxOutput</a> <a id="1854" class="Keyword">public</a>
<a id="1861" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="1873" href="EUTxOErr.EUTxO.html#1873" class="Function">DecEq-TxO</a> <a id="1883" class="Symbol">=</a> <a id="1885" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="1892" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="1898" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1900" class="Keyword">quote</a> <a id="1906" href="EUTxOErr.EUTxO.html#1720" class="Record">TxOutput</a> <a id="1915" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1917" href="EUTxOErr.EUTxO.html#1873" class="Function">DecEq-TxO</a> <a id="1927" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
<a id="1929" class="Keyword">pattern</a> <a id="_at_"></a><a id="1937" href="EUTxOErr.EUTxO.html#1937" class="InductiveConstructor Operator">_at_</a> <a id="1942" href="EUTxOErr.EUTxO.html#1955" class="Bound">x</a> <a id="1944" href="EUTxOErr.EUTxO.html#1960" class="Bound">y</a> <a id="1946" class="Symbol">=</a> <a id="1948" class="InductiveConstructor Operator">⦉</a> <a id="1950" class="String">&quot;&quot;</a> <a id="1953" class="InductiveConstructor Operator">⦊</a> <a id="1955" href="EUTxOErr.EUTxO.html#1955" class="Bound">x</a> <a id="1957" class="InductiveConstructor Operator">at</a> <a id="1960" href="EUTxOErr.EUTxO.html#1960" class="Bound">y</a>

<a id="1963" class="Keyword">record</a> <a id="TxOutputRef"></a><a id="1970" href="EUTxOErr.EUTxO.html#1970" class="Record">TxOutputRef</a> <a id="1982" class="Symbol">:</a> <a id="1984" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1989" class="Keyword">where</a>
  <a id="1997" class="Keyword">constructor</a> <a id="_indexed-at_"></a><a id="2009" href="EUTxOErr.EUTxO.html#2009" class="InductiveConstructor Operator">_indexed-at_</a>
  <a id="2024" class="Keyword">field</a> <a id="TxOutputRef.txId"></a><a id="2030" href="EUTxOErr.EUTxO.html#2030" class="Field">txId</a>  <a id="2036" class="Symbol">:</a> <a id="2038" href="Common.Hash.html#69" class="Function">HashId</a>
        <a id="TxOutputRef.index"></a><a id="2053" href="EUTxOErr.EUTxO.html#2053" class="Field">index</a> <a id="2059" class="Symbol">:</a> <a id="2061" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="2063" class="Keyword">open</a> <a id="2068" href="EUTxOErr.EUTxO.html#1970" class="Module">TxOutputRef</a> <a id="2080" class="Keyword">public</a>
<a id="2087" class="Keyword">unquoteDecl</a> <a id="DecEq-TxOR"></a><a id="2099" href="EUTxOErr.EUTxO.html#2099" class="Function">DecEq-TxOR</a> <a id="2110" class="Symbol">=</a> <a id="2112" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="2119" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="2125" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2127" class="Keyword">quote</a> <a id="2133" href="EUTxOErr.EUTxO.html#1970" class="Record">TxOutputRef</a> <a id="2145" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2147" href="EUTxOErr.EUTxO.html#2099" class="Function">DecEq-TxOR</a> <a id="2158" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>

<a id="Validator"></a><a id="2161" href="EUTxOErr.EUTxO.html#2161" class="Function">Validator</a>
  <a id="2173" class="Symbol">=</a> <a id="2175" href="Common.Hash.html#69" class="Function">HashId</a> <a id="2182" class="Comment">-- ^ self-reference to script&#39;s own hash</a>
  <a id="2225" class="Symbol">→</a> <a id="2227" href="EUTxOErr.EUTxO.html#1520" class="Record">TxInfo</a> <a id="2234" class="Comment">-- ^ context</a>
  <a id="2249" class="Symbol">→</a> <a id="2251" href="Common.Data.html#224" class="Function">DATA</a>   <a id="2258" class="Comment">-- ^ redeemer</a>
  <a id="2274" class="Symbol">→</a> <a id="2276" href="Common.Data.html#224" class="Function">DATA</a>   <a id="2283" class="Comment">-- ^ datum</a>
  <a id="2296" class="Symbol">→</a> <a id="2298" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>

<a id="call"></a><a id="2304" href="EUTxOErr.EUTxO.html#2304" class="Function">call</a> <a id="2309" class="Symbol">:</a> <a id="2311" href="EUTxOErr.EUTxO.html#2161" class="Function">Validator</a> <a id="2321" class="Symbol">→</a> <a id="2323" href="EUTxOErr.EUTxO.html#1520" class="Record">TxInfo</a> <a id="2330" class="Symbol">→</a> <a id="2332" href="Common.Data.html#224" class="Function">DATA</a> <a id="2337" class="Symbol">→</a> <a id="2339" href="Common.Data.html#224" class="Function">DATA</a> <a id="2344" class="Symbol">→</a> <a id="2346" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="2351" href="EUTxOErr.EUTxO.html#2304" class="Function">call</a> <a id="2356" href="EUTxOErr.EUTxO.html#2356" class="Bound">f</a> <a id="2358" class="Symbol">=</a> <a id="2360" href="EUTxOErr.EUTxO.html#2356" class="Bound">f</a> <a id="2362" class="Symbol">(</a><a id="2363" href="EUTxOErr.EUTxO.html#2356" class="Bound">f</a> <a id="2365" href="Common.Hash.html#96" class="Postulate Operator">♯</a><a id="2366" class="Symbol">)</a>

<a id="2369" class="Keyword">record</a> <a id="TxInput"></a><a id="2376" href="EUTxOErr.EUTxO.html#2376" class="Record">TxInput</a> <a id="2384" class="Symbol">:</a> <a id="2386" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="2391" class="Keyword">where</a>
  <a id="2399" class="Keyword">field</a> <a id="TxInput.outputRef"></a><a id="2405" href="EUTxOErr.EUTxO.html#2405" class="Field">outputRef</a> <a id="2415" class="Symbol">:</a> <a id="2417" href="EUTxOErr.EUTxO.html#1970" class="Record">TxOutputRef</a>
        <a id="TxInput.validator"></a><a id="2437" href="EUTxOErr.EUTxO.html#2437" class="Field">validator</a> <a id="2447" class="Symbol">:</a> <a id="2449" href="EUTxOErr.EUTxO.html#2161" class="Function">Validator</a>
        <a id="TxInput.redeemer"></a><a id="2467" href="EUTxOErr.EUTxO.html#2467" class="Field">redeemer</a>  <a id="2477" class="Symbol">:</a> <a id="2479" href="Common.Data.html#224" class="Function">DATA</a>
<a id="2484" class="Keyword">open</a> <a id="2489" href="EUTxOErr.EUTxO.html#2376" class="Module">TxInput</a> <a id="2497" class="Keyword">public</a>

<a id="2505" class="Keyword">record</a> <a id="Tx"></a><a id="2512" href="EUTxOErr.EUTxO.html#2512" class="Record">Tx</a> <a id="2515" class="Symbol">:</a> <a id="2517" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="2522" class="Keyword">where</a>
  <a id="2530" class="Keyword">field</a> <a id="Tx.inputs"></a><a id="2536" href="EUTxOErr.EUTxO.html#2536" class="Field">inputs</a>  <a id="2544" class="Symbol">:</a> <a id="2546" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2551" href="EUTxOErr.EUTxO.html#2376" class="Record">TxInput</a>
        <a id="Tx.outputs"></a><a id="2567" href="EUTxOErr.EUTxO.html#2567" class="Field">outputs</a> <a id="2575" class="Symbol">:</a> <a id="2577" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2582" href="EUTxOErr.EUTxO.html#1720" class="Record">TxOutput</a>
        <a id="Tx.forge"></a><a id="2599" href="EUTxOErr.EUTxO.html#2599" class="Field">forge</a>   <a id="2607" class="Symbol">:</a> <a id="2609" href="EUTxOErr.EUTxO.html#812" class="Function">Value</a>
<a id="2615" class="Keyword">open</a> <a id="2620" href="EUTxOErr.EUTxO.html#2512" class="Module">Tx</a> <a id="2623" class="Keyword">public</a>

<a id="2631" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="2670" href="EUTxOErr.EUTxO.html#2670" class="Function">L</a> <a id="2672" class="Symbol">=</a> <a id="2674" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2679" href="EUTxOErr.EUTxO.html#2512" class="Record">Tx</a>

<a id="2683" class="Comment">-- Auxiliary definitions.</a>

<a id="outputRefs"></a><a id="2710" href="EUTxOErr.EUTxO.html#2710" class="Function">outputRefs</a> <a id="2721" class="Symbol">:</a> <a id="2723" href="EUTxOErr.EUTxO.html#2512" class="Record">Tx</a> <a id="2726" class="Symbol">→</a> <a id="2728" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2733" href="EUTxOErr.EUTxO.html#1970" class="Record">TxOutputRef</a>
<a id="2745" href="EUTxOErr.EUTxO.html#2710" class="Function">outputRefs</a> <a id="2756" class="Symbol">=</a> <a id="2758" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2762" href="EUTxOErr.EUTxO.html#2405" class="Field">outputRef</a> <a id="2772" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2774" href="EUTxOErr.EUTxO.html#2536" class="Field">inputs</a>

<a id="Resolved"></a><a id="2782" href="EUTxOErr.EUTxO.html#2782" class="Function">Resolved</a> <a id="2791" class="Symbol">:</a> <a id="2793" href="Prelude.Init.html#13767" class="Function">Pred₀</a> <a id="2799" href="EUTxOErr.EUTxO.html#2512" class="Record">Tx</a>
<a id="2802" href="EUTxOErr.EUTxO.html#2782" class="Function">Resolved</a> <a id="2811" href="EUTxOErr.EUTxO.html#2811" class="Bound">tx</a> <a id="2814" class="Symbol">=</a> <a id="2816" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="2820" class="Symbol">(</a><a id="2821" href="Function.Base.html#645" class="Function">const</a> <a id="2827" href="EUTxOErr.EUTxO.html#1720" class="Record">TxOutput</a><a id="2835" class="Symbol">)</a> <a id="2837" class="Symbol">(</a><a id="2838" href="EUTxOErr.EUTxO.html#2710" class="Function">outputRefs</a> <a id="2849" href="EUTxOErr.EUTxO.html#2811" class="Bound">tx</a><a id="2851" class="Symbol">)</a>

<a id="ResolvedL"></a><a id="2854" href="EUTxOErr.EUTxO.html#2854" class="Function">ResolvedL</a> <a id="2864" class="Symbol">=</a> <a id="2866" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="2868" href="EUTxOErr.EUTxO.html#2670" class="Function">L</a> <a id="2870" class="Symbol">(</a><a id="2871" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="2875" href="EUTxOErr.EUTxO.html#2782" class="Function">Resolved</a><a id="2883" class="Symbol">)</a>

<a id="ResolvedInput"></a><a id="2886" href="EUTxOErr.EUTxO.html#2886" class="Function">ResolvedInput</a>  <a id="2901" class="Symbol">=</a> <a id="2903" href="EUTxOErr.EUTxO.html#2376" class="Record">TxInput</a> <a id="2911" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2913" href="EUTxOErr.EUTxO.html#1720" class="Record">TxOutput</a>
<a id="ResolvedInputs"></a><a id="2922" href="EUTxOErr.EUTxO.html#2922" class="Function">ResolvedInputs</a> <a id="2937" class="Symbol">=</a> <a id="2939" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2944" href="EUTxOErr.EUTxO.html#2886" class="Function">ResolvedInput</a>

<a id="resolveInputs"></a><a id="2959" href="EUTxOErr.EUTxO.html#2959" class="Function">resolveInputs</a> <a id="2973" class="Symbol">:</a> <a id="2975" class="Symbol">∀</a> <a id="2977" href="EUTxOErr.EUTxO.html#2977" class="Bound">tx</a> <a id="2980" class="Symbol">→</a> <a id="2982" href="EUTxOErr.EUTxO.html#2782" class="Function">Resolved</a> <a id="2991" href="EUTxOErr.EUTxO.html#2977" class="Bound">tx</a> <a id="2994" class="Symbol">→</a> <a id="2996" href="EUTxOErr.EUTxO.html#2922" class="Function">ResolvedInputs</a>
<a id="3011" href="EUTxOErr.EUTxO.html#2959" class="Function">resolveInputs</a> <a id="3025" href="EUTxOErr.EUTxO.html#3025" class="Bound">tx</a> <a id="3028" href="EUTxOErr.EUTxO.html#3028" class="Bound">resolvedTx</a> <a id="3039" class="Symbol">=</a> <a id="3041" href="Data.List.Membership.Setoid.html#1137" class="Function">mapWith∈</a> <a id="3050" class="Symbol">(</a><a id="3051" href="EUTxOErr.EUTxO.html#3025" class="Bound">tx</a> <a id="3054" class="Symbol">.</a><a id="3055" href="EUTxOErr.EUTxO.html#2536" class="Field">inputs</a><a id="3061" class="Symbol">)</a> <a id="3063" class="Symbol">λ</a> <a id="3065" class="Symbol">{</a><a id="3066" href="EUTxOErr.EUTxO.html#3066" class="Bound">i</a><a id="3067" class="Symbol">}</a> <a id="3069" href="EUTxOErr.EUTxO.html#3069" class="Bound">i∈</a> <a id="3072" class="Symbol">→</a>
  <a id="3076" href="EUTxOErr.EUTxO.html#3066" class="Bound">i</a> <a id="3078" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3080" href="Data.List.Relation.Unary.All.html#5775" class="Function">L.All.lookup</a> <a id="3093" href="EUTxOErr.EUTxO.html#3028" class="Bound">resolvedTx</a> <a id="3104" class="Symbol">(</a><a id="3105" href="Data.List.Membership.Propositional.Properties.html#3377" class="Function">∈-map⁺</a> <a id="3112" href="EUTxOErr.EUTxO.html#2405" class="Field">outputRef</a> <a id="3122" href="EUTxOErr.EUTxO.html#3069" class="Bound">i∈</a><a id="3124" class="Symbol">)</a>

<a id="resolved∈⁻"></a><a id="3127" href="EUTxOErr.EUTxO.html#3127" class="Function">resolved∈⁻</a> <a id="3138" class="Symbol">:</a> <a id="3140" class="Symbol">∀</a> <a id="3142" class="Symbol">{</a><a id="3143" href="EUTxOErr.EUTxO.html#3143" class="Bound">io</a><a id="3145" class="Symbol">}</a> <a id="3147" href="EUTxOErr.EUTxO.html#3147" class="Bound">tx</a> <a id="3150" class="Symbol">→</a> <a id="3152" class="Symbol">(</a><a id="3153" href="EUTxOErr.EUTxO.html#3153" class="Bound">resolvedTx</a> <a id="3164" class="Symbol">:</a> <a id="3166" href="EUTxOErr.EUTxO.html#2782" class="Function">Resolved</a> <a id="3175" href="EUTxOErr.EUTxO.html#3147" class="Bound">tx</a><a id="3177" class="Symbol">)</a>
  <a id="3181" class="Symbol">→</a> <a id="3183" href="EUTxOErr.EUTxO.html#3143" class="Bound">io</a> <a id="3186" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="3188" href="EUTxOErr.EUTxO.html#2959" class="Function">resolveInputs</a> <a id="3202" href="EUTxOErr.EUTxO.html#3147" class="Bound">tx</a> <a id="3205" href="EUTxOErr.EUTxO.html#3153" class="Bound">resolvedTx</a>
  <a id="3218" class="Symbol">→</a> <a id="3220" href="EUTxOErr.EUTxO.html#3143" class="Bound">io</a> <a id="3223" class="Symbol">.</a><a id="3224" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="3230" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="3232" href="EUTxOErr.EUTxO.html#3147" class="Bound">tx</a> <a id="3235" class="Symbol">.</a><a id="3236" href="EUTxOErr.EUTxO.html#2536" class="Field">inputs</a>
<a id="3243" href="EUTxOErr.EUTxO.html#3127" class="Function">resolved∈⁻</a> <a id="3254" class="Symbol">_</a> <a id="3256" class="Symbol">_</a> <a id="3258" href="EUTxOErr.EUTxO.html#3258" class="Bound">x∈</a>
  <a id="3263" class="Keyword">with</a> <a id="3268" class="Symbol">_</a> <a id="3270" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3272" href="EUTxOErr.EUTxO.html#3272" class="Bound">i∈</a> <a id="3275" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3277" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> ← <a id="3284" href="Prelude.Lists.Membership.html#4455" class="Function">∈-mapWith∈⁻</a> <a id="3296" href="EUTxOErr.EUTxO.html#3258" class="Bound">x∈</a>
  <a id="3301" class="Symbol">=</a> <a id="3303" href="EUTxOErr.EUTxO.html#3272" class="Bound">i∈</a>

<a id="mkOutputInfo"></a><a id="3307" href="EUTxOErr.EUTxO.html#3307" class="Function">mkOutputInfo</a> <a id="3320" class="Symbol">:</a> <a id="3322" href="EUTxOErr.EUTxO.html#1720" class="Record">TxOutput</a> <a id="3331" class="Symbol">→</a> <a id="3333" href="EUTxOErr.EUTxO.html#993" class="Record">OutputInfo</a>
<a id="3344" href="EUTxOErr.EUTxO.html#3307" class="Function">mkOutputInfo</a> <a id="3357" href="EUTxOErr.EUTxO.html#3357" class="Bound">o</a> <a id="3359" class="Symbol">=</a> <a id="3361" class="Keyword">record</a>
  <a id="3370" class="Symbol">{</a> <a id="3372" href="EUTxOErr.EUTxO.html#3372" class="Module">TxOutput</a> <a id="3381" href="EUTxOErr.EUTxO.html#3357" class="Bound">o</a>
  <a id="3385" class="Symbol">;</a> <a id="3387" href="EUTxOErr.EUTxO.html#1047" class="Field">datumHash</a> <a id="3397" class="Symbol">=</a> <a id="3399" href="EUTxOErr.EUTxO.html#3357" class="Bound">o</a> <a id="3401" class="Symbol">.</a><a id="3402" href="EUTxOErr.EUTxO.html#1772" class="Field">datum</a> <a id="3408" href="Common.Hash.html#96" class="Postulate Operator">♯</a> <a id="3410" class="Symbol">}</a>

<a id="mkInputInfo"></a><a id="3413" href="EUTxOErr.EUTxO.html#3413" class="Function">mkInputInfo</a> <a id="3425" class="Symbol">:</a> <a id="3427" href="EUTxOErr.EUTxO.html#2886" class="Function">ResolvedInput</a> <a id="3441" class="Symbol">→</a> <a id="3443" href="EUTxOErr.EUTxO.html#1243" class="Record">InputInfo</a>
<a id="3453" href="EUTxOErr.EUTxO.html#3413" class="Function">mkInputInfo</a> <a id="3465" class="Symbol">(</a><a id="3466" href="EUTxOErr.EUTxO.html#3466" class="Bound">i</a> <a id="3468" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3470" href="EUTxOErr.EUTxO.html#3470" class="Bound">o</a><a id="3471" class="Symbol">)</a> <a id="3473" class="Symbol">=</a> <a id="3475" class="Keyword">record</a>
  <a id="3484" class="Symbol">{</a> <a id="3486" href="EUTxOErr.EUTxO.html#1274" class="Field">outputRef</a>     <a id="3500" class="Symbol">=</a> <a id="3502" href="EUTxOErr.EUTxO.html#3307" class="Function">mkOutputInfo</a> <a id="3515" href="EUTxOErr.EUTxO.html#3470" class="Bound">o</a>
  <a id="3519" class="Symbol">;</a> <a id="3521" href="EUTxOErr.EUTxO.html#1377" class="Field">validatorHash</a> <a id="3535" class="Symbol">=</a> <a id="3537" href="EUTxOErr.EUTxO.html#3466" class="Bound">i</a> <a id="3539" class="Symbol">.</a><a id="3540" href="EUTxOErr.EUTxO.html#2437" class="Field">validator</a> <a id="3550" href="Common.Hash.html#96" class="Postulate Operator">♯</a>
  <a id="3554" class="Symbol">;</a> <a id="3556" href="EUTxOErr.EUTxO.html#1408" class="Field">redeemerHash</a>  <a id="3570" class="Symbol">=</a> <a id="3572" href="EUTxOErr.EUTxO.html#3466" class="Bound">i</a> <a id="3574" class="Symbol">.</a><a id="3575" href="EUTxOErr.EUTxO.html#2467" class="Field">redeemer</a> <a id="3584" href="Common.Hash.html#96" class="Postulate Operator">♯</a> <a id="3586" class="Symbol">}</a>

<a id="mkTxInfo"></a><a id="3589" href="EUTxOErr.EUTxO.html#3589" class="Function">mkTxInfo</a> <a id="3598" class="Symbol">:</a> <a id="3600" class="Symbol">∀</a> <a id="3602" class="Symbol">(</a><a id="3603" href="EUTxOErr.EUTxO.html#3603" class="Bound">tx</a> <a id="3606" class="Symbol">:</a> <a id="3608" href="EUTxOErr.EUTxO.html#2512" class="Record">Tx</a><a id="3610" class="Symbol">)</a> <a id="3612" class="Symbol">→</a> <a id="3614" href="EUTxOErr.EUTxO.html#2782" class="Function">Resolved</a> <a id="3623" href="EUTxOErr.EUTxO.html#3603" class="Bound">tx</a> <a id="3626" class="Symbol">→</a> <a id="3628" href="EUTxOErr.EUTxO.html#1520" class="Record">TxInfo</a>
<a id="3635" href="EUTxOErr.EUTxO.html#3589" class="Function">mkTxInfo</a> <a id="3644" href="EUTxOErr.EUTxO.html#3644" class="Bound">tx</a> <a id="3647" href="EUTxOErr.EUTxO.html#3647" class="Bound">resolvedTx</a> <a id="3658" class="Symbol">=</a> <a id="3660" class="Keyword">record</a>
  <a id="3669" class="Symbol">{</a> <a id="3671" href="EUTxOErr.EUTxO.html#3671" class="Module">Tx</a> <a id="3674" href="EUTxOErr.EUTxO.html#3644" class="Bound">tx</a>
  <a id="3679" class="Symbol">;</a> <a id="3681" href="EUTxOErr.EUTxO.html#1548" class="Field">inputs</a>  <a id="3689" class="Symbol">=</a> <a id="3691" href="EUTxOErr.EUTxO.html#3413" class="Function">mkInputInfo</a>  <a id="3704" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="3708" href="EUTxOErr.EUTxO.html#2959" class="Function">resolveInputs</a> <a id="3722" href="EUTxOErr.EUTxO.html#3644" class="Bound">tx</a> <a id="3725" href="EUTxOErr.EUTxO.html#3647" class="Bound">resolvedTx</a>
  <a id="3738" class="Symbol">;</a> <a id="3740" href="EUTxOErr.EUTxO.html#1583" class="Field">outputs</a> <a id="3748" class="Symbol">=</a> <a id="3750" href="EUTxOErr.EUTxO.html#3307" class="Function">mkOutputInfo</a> <a id="3763" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="3767" href="EUTxOErr.EUTxO.html#3644" class="Bound">tx</a> <a id="3770" class="Symbol">.</a><a id="3771" href="EUTxOErr.EUTxO.html#2567" class="Field">outputs</a> <a id="3779" class="Symbol">}</a>

<a id="3782" class="Comment">-- The state of a ledger maps output references locked by a validator to a value.</a>

<a id="S"></a><a id="3865" href="EUTxOErr.EUTxO.html#3865" class="Function">S</a> <a id="3867" class="Symbol">:</a> <a id="3869" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="3874" href="EUTxOErr.EUTxO.html#3865" class="Function">S</a> <a id="3876" class="Symbol">=</a> <a id="3878" href="Prelude.Maps.AsSets.html#550" class="Record">Map⟨</a> <a id="3883" href="EUTxOErr.EUTxO.html#1970" class="Record">TxOutputRef</a> <a id="3895" href="Prelude.Maps.AsSets.html#550" class="Record">↦</a> <a id="3897" href="EUTxOErr.EUTxO.html#1720" class="Record">TxOutput</a> <a id="3906" href="Prelude.Maps.AsSets.html#550" class="Record">⟩</a>

<a id="mkUtxo"></a><a id="3909" href="EUTxOErr.EUTxO.html#3909" class="Function">mkUtxo</a> <a id="3916" class="Symbol">:</a> <a id="3918" class="Symbol">∀</a> <a id="3920" class="Symbol">{</a><a id="3921" href="EUTxOErr.EUTxO.html#3921" class="Bound">out</a><a id="3924" class="Symbol">}</a> <a id="3926" href="EUTxOErr.EUTxO.html#3926" class="Bound">tx</a> <a id="3929" class="Symbol">→</a> <a id="3931" href="EUTxOErr.EUTxO.html#3921" class="Bound">out</a> <a id="3935" href="Data.List.Membership.Setoid.html#896" class="Function Operator">L.Mem.∈</a> <a id="3943" href="EUTxOErr.EUTxO.html#2567" class="Field">outputs</a> <a id="3951" href="EUTxOErr.EUTxO.html#3926" class="Bound">tx</a> <a id="3954" class="Symbol">→</a> <a id="3956" href="EUTxOErr.EUTxO.html#1970" class="Record">TxOutputRef</a> <a id="3968" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3970" href="EUTxOErr.EUTxO.html#1720" class="Record">TxOutput</a>
<a id="3979" href="EUTxOErr.EUTxO.html#3909" class="Function">mkUtxo</a> <a id="3986" class="Symbol">{</a><a id="3987" href="EUTxOErr.EUTxO.html#3987" class="Bound">out</a><a id="3990" class="Symbol">}</a> <a id="3992" href="EUTxOErr.EUTxO.html#3992" class="Bound">tx</a> <a id="3995" href="EUTxOErr.EUTxO.html#3995" class="Bound">out∈</a> <a id="4000" class="Symbol">=</a> <a id="4002" class="Symbol">(</a><a id="4003" href="EUTxOErr.EUTxO.html#3992" class="Bound">tx</a> <a id="4006" href="Common.Hash.html#96" class="Postulate Operator">♯</a><a id="4007" class="Symbol">)</a> <a id="4009" href="EUTxOErr.EUTxO.html#2009" class="InductiveConstructor Operator">indexed-at</a> <a id="4020" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="4024" class="Symbol">(</a><a id="4025" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="4037" href="EUTxOErr.EUTxO.html#3995" class="Bound">out∈</a><a id="4041" class="Symbol">)</a> <a id="4043" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4045" href="EUTxOErr.EUTxO.html#3987" class="Bound">out</a>

<a id="4050" class="Keyword">postulate</a> <a id="Unique-mkUtxo"></a><a id="4060" href="EUTxOErr.EUTxO.html#4060" class="Postulate">Unique-mkUtxo</a> <a id="4074" class="Symbol">:</a> <a id="4076" class="Symbol">∀</a> <a id="4078" href="EUTxOErr.EUTxO.html#4078" class="Bound">t</a> <a id="4080" class="Symbol">→</a> <a id="4082" href="Data.List.Relation.Unary.Unique.Setoid.html#728" class="Datatype">Unique</a> <a id="4089" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4091" href="Data.List.Base.html#1553" class="Function">map</a> <a id="4095" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="4101" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4103" href="Data.List.Membership.Setoid.html#1137" class="Function">mapWith∈</a> <a id="4112" class="Symbol">(</a><a id="4113" href="EUTxOErr.EUTxO.html#4078" class="Bound">t</a> <a id="4115" class="Symbol">.</a><a id="4116" href="EUTxOErr.EUTxO.html#2567" class="Field">outputs</a><a id="4123" class="Symbol">)</a> <a id="4125" class="Symbol">(</a><a id="4126" href="EUTxOErr.EUTxO.html#3909" class="Function">mkUtxo</a> <a id="4133" href="EUTxOErr.EUTxO.html#4078" class="Bound">t</a><a id="4134" class="Symbol">)</a>

<a id="utxoTx"></a><a id="4137" href="EUTxOErr.EUTxO.html#4137" class="Function">utxoTx</a> <a id="4144" class="Symbol">:</a> <a id="4146" href="EUTxOErr.EUTxO.html#2512" class="Record">Tx</a> <a id="4149" class="Symbol">→</a> <a id="4151" href="EUTxOErr.EUTxO.html#3865" class="Function">S</a>
<a id="4153" href="EUTxOErr.EUTxO.html#4137" class="Function">utxoTx</a> <a id="4160" href="EUTxOErr.EUTxO.html#4160" class="Bound">tx</a> <a id="4163" class="Symbol">=</a> <a id="4165" href="Prelude.FromList.html#214" class="Field">fromList</a> <a id="4174" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4176" href="Data.List.Membership.Setoid.html#1137" class="Function">L.Mem.mapWith∈</a> <a id="4191" class="Symbol">(</a><a id="4192" href="EUTxOErr.EUTxO.html#4160" class="Bound">tx</a> <a id="4195" class="Symbol">.</a><a id="4196" href="EUTxOErr.EUTxO.html#2567" class="Field">outputs</a><a id="4203" class="Symbol">)</a> <a id="4205" class="Symbol">(</a><a id="4206" href="EUTxOErr.EUTxO.html#3909" class="Function">mkUtxo</a> <a id="4213" href="EUTxOErr.EUTxO.html#4160" class="Bound">tx</a><a id="4215" class="Symbol">)</a>

<a id="4218" class="Keyword">record</a> <a id="IsValidTx"></a><a id="4225" href="EUTxOErr.EUTxO.html#4225" class="Record">IsValidTx</a> <a id="4235" class="Symbol">(</a><a id="4236" href="EUTxOErr.EUTxO.html#4236" class="Bound">tx</a> <a id="4239" class="Symbol">:</a> <a id="4241" href="EUTxOErr.EUTxO.html#2512" class="Record">Tx</a><a id="4243" class="Symbol">)</a> <a id="4245" class="Symbol">(</a><a id="4246" href="EUTxOErr.EUTxO.html#4246" class="Bound">utxos</a> <a id="4252" class="Symbol">:</a> <a id="4254" href="EUTxOErr.EUTxO.html#3865" class="Function">S</a><a id="4255" class="Symbol">)</a> <a id="4257" class="Symbol">:</a> <a id="4259" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="4264" class="Keyword">where</a>
  <a id="4272" class="Keyword">field</a>
    <a id="IsValidTx.noDoubleSpending"></a><a id="4282" href="EUTxOErr.EUTxO.html#4282" class="Field">noDoubleSpending</a> <a id="4299" class="Symbol">:</a>
      <a id="4307" href="Prelude.Irrelevance.List.Unique.html#1002" class="Function">·Unique</a> <a id="4315" class="Symbol">(</a><a id="4316" href="EUTxOErr.EUTxO.html#2710" class="Function">outputRefs</a> <a id="4327" href="EUTxOErr.EUTxO.html#4236" class="Bound">tx</a><a id="4329" class="Symbol">)</a>

    <a id="IsValidTx.validOutputRefs"></a><a id="4336" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a> <a id="4352" class="Symbol">:</a>
      <a id="4360" href="Prelude.Allable.html#267" class="Function">∀[</a> <a id="4363" href="EUTxOErr.EUTxO.html#4363" class="Bound">ref</a> <a id="4367" href="Prelude.Allable.html#267" class="Function">∈</a> <a id="4369" href="EUTxOErr.EUTxO.html#2710" class="Function">outputRefs</a> <a id="4380" href="EUTxOErr.EUTxO.html#4236" class="Bound">tx</a> <a id="4383" href="Prelude.Allable.html#267" class="Function">]</a>
        <a id="4393" class="Symbol">(</a><a id="4394" href="EUTxOErr.EUTxO.html#4363" class="Bound">ref</a> <a id="4398" href="Prelude.Maps.AsSets.html#1627" class="Function Operator">∈ᵈ</a> <a id="4401" href="EUTxOErr.EUTxO.html#4246" class="Bound">utxos</a><a id="4406" class="Symbol">)</a>

  <a id="IsValidTx.resolved"></a><a id="4411" href="EUTxOErr.EUTxO.html#4411" class="Function">resolved</a> <a id="4420" class="Symbol">:</a> <a id="4422" href="EUTxOErr.EUTxO.html#2782" class="Function">Resolved</a> <a id="4431" href="EUTxOErr.EUTxO.html#4236" class="Bound">tx</a>
  <a id="4436" href="EUTxOErr.EUTxO.html#4411" class="Function">resolved</a> <a id="4445" class="Symbol">=</a> <a id="4447" href="Data.List.Relation.Unary.All.html#2944" class="Function">L.All.map</a> <a id="4457" class="Symbol">(</a><a id="4458" href="EUTxOErr.EUTxO.html#4246" class="Bound">utxos</a> <a id="4464" href="Common.Maps.html#1257" class="Function Operator">‼_</a><a id="4466" class="Symbol">)</a> <a id="4468" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a>

  <a id="IsValidTx.txInfo"></a><a id="4487" href="EUTxOErr.EUTxO.html#4487" class="Function">txInfo</a> <a id="4494" class="Symbol">=</a> <a id="4496" href="EUTxOErr.EUTxO.html#3589" class="Function">mkTxInfo</a> <a id="4505" href="EUTxOErr.EUTxO.html#4236" class="Bound">tx</a> <a id="4508" href="EUTxOErr.EUTxO.html#4411" class="Function">resolved</a>
  <a id="IsValidTx.resolvedInputs"></a><a id="4519" href="EUTxOErr.EUTxO.html#4519" class="Function">resolvedInputs</a> <a id="4534" class="Symbol">=</a> <a id="4536" href="EUTxOErr.EUTxO.html#2959" class="Function">resolveInputs</a> <a id="4550" href="EUTxOErr.EUTxO.html#4236" class="Bound">tx</a> <a id="4553" href="EUTxOErr.EUTxO.html#4411" class="Function">resolved</a>

  <a id="4565" class="Keyword">field</a>
    <a id="IsValidTx.preservesValues"></a><a id="4575" href="EUTxOErr.EUTxO.html#4575" class="Field">preservesValues</a> <a id="4591" class="Symbol">:</a>
      <a id="4599" href="EUTxOErr.EUTxO.html#4236" class="Bound">tx</a> <a id="4602" class="Symbol">.</a><a id="4603" href="EUTxOErr.EUTxO.html#2599" class="Field">forge</a> <a id="4609" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="4611" href="Common.Utils.html#101" class="Function">∑</a> <a id="4613" href="EUTxOErr.EUTxO.html#4519" class="Function">resolvedInputs</a> <a id="4628" class="Symbol">(</a><a id="4629" href="EUTxOErr.EUTxO.html#1796" class="Field">value</a> <a id="4635" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4637" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="4642" class="Symbol">)</a> <a id="4644" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4646" href="Common.Utils.html#101" class="Function">∑</a> <a id="4648" class="Symbol">(</a><a id="4649" href="EUTxOErr.EUTxO.html#4236" class="Bound">tx</a> <a id="4652" class="Symbol">.</a><a id="4653" href="EUTxOErr.EUTxO.html#2567" class="Field">outputs</a><a id="4660" class="Symbol">)</a> <a id="4662" href="EUTxOErr.EUTxO.html#1796" class="Field">value</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="4673" href="EUTxOErr.EUTxO.html#4673" class="Field">allInputsValidate</a> <a id="4691" class="Symbol">:</a>
      <a id="4699" href="Prelude.Allable.html#267" class="Function">∀[</a> <a id="4702" href="EUTxOErr.EUTxO.html#4702" class="Bound">(</a><a id="4703" href="EUTxOErr.EUTxO.html#4703" class="Bound">i</a> <a id="4705" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4707" href="EUTxOErr.EUTxO.html#4707" class="Bound">o</a><a id="4708" href="EUTxOErr.EUTxO.html#4702" class="Bound">)</a> <a id="4710" href="Prelude.Allable.html#267" class="Function">∈</a> <a id="4712" href="EUTxOErr.EUTxO.html#4519" class="Function">resolvedInputs</a> <a id="4727" href="Prelude.Allable.html#267" class="Function">]</a>
        <a id="4737" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="4739" class="Symbol">(</a><a id="4740" href="EUTxOErr.EUTxO.html#2304" class="Function">call</a> <a id="4745" class="Symbol">(</a><a id="4746" href="EUTxOErr.EUTxO.html#4703" class="Bound">i</a> <a id="4748" class="Symbol">.</a><a id="4749" href="EUTxOErr.EUTxO.html#2437" class="Field">validator</a><a id="4758" class="Symbol">)</a> <a id="4760" href="EUTxOErr.EUTxO.html#4487" class="Function">txInfo</a> <a id="4767" class="Symbol">(</a><a id="4768" href="EUTxOErr.EUTxO.html#4703" class="Bound">i</a> <a id="4770" class="Symbol">.</a><a id="4771" href="EUTxOErr.EUTxO.html#2467" class="Field">redeemer</a><a id="4779" class="Symbol">)</a> <a id="4781" class="Symbol">(</a><a id="4782" href="EUTxOErr.EUTxO.html#4707" class="Bound">o</a> <a id="4784" class="Symbol">.</a><a id="4785" href="EUTxOErr.EUTxO.html#1772" class="Field">datum</a><a id="4790" class="Symbol">))</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="4798" href="EUTxOErr.EUTxO.html#4798" class="Field">validateValidHashes</a> <a id="4818" class="Symbol">:</a>
      <a id="4826" href="Prelude.Allable.html#267" class="Function">∀[</a> <a id="4829" href="EUTxOErr.EUTxO.html#4829" class="Bound">(</a><a id="4830" href="EUTxOErr.EUTxO.html#4830" class="Bound">i</a> <a id="4832" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4834" href="EUTxOErr.EUTxO.html#4834" class="Bound">o</a><a id="4835" href="EUTxOErr.EUTxO.html#4829" class="Bound">)</a> <a id="4837" href="Prelude.Allable.html#267" class="Function">∈</a> <a id="4839" href="EUTxOErr.EUTxO.html#4519" class="Function">resolvedInputs</a> <a id="4854" href="Prelude.Allable.html#267" class="Function">]</a>
        <a id="4864" class="Symbol">(</a><a id="4865" href="EUTxOErr.EUTxO.html#4834" class="Bound">o</a> <a id="4867" class="Symbol">.</a><a id="4868" href="EUTxOErr.EUTxO.html#1821" class="Field">address</a> <a id="4876" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4878" href="EUTxOErr.EUTxO.html#4830" class="Bound">i</a> <a id="4880" class="Symbol">.</a><a id="4881" href="EUTxOErr.EUTxO.html#2437" class="Field">validator</a> <a id="4891" href="Common.Hash.html#96" class="Postulate Operator">♯</a><a id="4892" class="Symbol">)</a>

<a id="4895" class="Keyword">open</a> <a id="4900" href="EUTxOErr.EUTxO.html#4225" class="Module">IsValidTx</a> <a id="4910" class="Keyword">public</a>

<a id="4918" class="Keyword">instance</a>
  <a id="·Valid"></a><a id="4929" href="EUTxOErr.EUTxO.html#4929" class="Function">·Valid</a> <a id="4936" class="Symbol">:</a> <a id="4938" class="Symbol">∀</a> <a id="4940" class="Symbol">{</a><a id="4941" href="EUTxOErr.EUTxO.html#4941" class="Bound">tx</a> <a id="4944" href="EUTxOErr.EUTxO.html#4944" class="Bound">s</a><a id="4945" class="Symbol">}</a> <a id="4947" class="Symbol">→</a> <a id="4949" href="Prelude.Irrelevance.Core.html#215" class="Record Operator">·</a> <a id="4951" href="EUTxOErr.EUTxO.html#4225" class="Record">IsValidTx</a> <a id="4961" href="EUTxOErr.EUTxO.html#4941" class="Bound">tx</a> <a id="4964" href="EUTxOErr.EUTxO.html#4944" class="Bound">s</a>
  <a id="4968" href="EUTxOErr.EUTxO.html#4929" class="Function">·Valid</a> <a id="4975" class="Symbol">{</a><a id="4976" class="Argument">s</a> <a id="4978" class="Symbol">=</a> <a id="4980" class="Keyword">record</a> <a id="4987" class="Symbol">{</a><a id="4988" href="Prelude.Maps.AsSets.html#679" class="Field">uniq</a> <a id="4993" class="Symbol">=</a> <a id="4995" href="EUTxOErr.EUTxO.html#4995" class="Bound">·uniq</a><a id="5000" class="Symbol">}}</a> <a id="5003" class="Symbol">.</a><a id="5004" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a>
    <a id="5011" class="Symbol">(</a><a id="5012" class="Keyword">record</a> <a id="5019" class="Symbol">{</a> <a id="5021" href="EUTxOErr.EUTxO.html#4282" class="Field">noDoubleSpending</a> <a id="5038" class="Symbol">=</a> <a id="5040" href="EUTxOErr.EUTxO.html#5040" class="Bound">ndp</a>
            <a id="5056" class="Symbol">;</a> <a id="5058" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a> <a id="5074" class="Symbol">=</a> <a id="5076" href="EUTxOErr.EUTxO.html#5076" class="Bound">vor</a>
            <a id="5092" class="Symbol">;</a> <a id="5094" href="EUTxOErr.EUTxO.html#4575" class="Field">preservesValues</a> <a id="5110" class="Symbol">=</a> <a id="5112" href="EUTxOErr.EUTxO.html#5112" class="Bound">pv</a>
            <a id="5127" class="Symbol">;</a> <a id="5129" href="EUTxOErr.EUTxO.html#4673" class="Field">allInputsValidate</a> <a id="5147" class="Symbol">=</a> <a id="5149" href="EUTxOErr.EUTxO.html#5149" class="Bound">aiv</a>
            <a id="5165" class="Symbol">;</a> <a id="5167" href="EUTxOErr.EUTxO.html#4798" class="Field">validateValidHashes</a> <a id="5187" class="Symbol">=</a> <a id="5189" href="EUTxOErr.EUTxO.html#5189" class="Bound">vvh</a>
            <a id="5205" class="Symbol">})</a>
    <a id="5212" class="Symbol">(</a><a id="5213" class="Keyword">record</a> <a id="5220" class="Symbol">{</a> <a id="5222" href="EUTxOErr.EUTxO.html#4282" class="Field">noDoubleSpending</a> <a id="5239" class="Symbol">=</a> <a id="5241" href="EUTxOErr.EUTxO.html#5241" class="Bound">ndp′</a>
            <a id="5258" class="Symbol">;</a> <a id="5260" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a> <a id="5276" class="Symbol">=</a> <a id="5278" href="EUTxOErr.EUTxO.html#5278" class="Bound">vor′</a>
            <a id="5295" class="Symbol">;</a> <a id="5297" href="EUTxOErr.EUTxO.html#4575" class="Field">preservesValues</a> <a id="5313" class="Symbol">=</a> <a id="5315" href="EUTxOErr.EUTxO.html#5315" class="Bound">pv′</a>
            <a id="5331" class="Symbol">;</a> <a id="5333" href="EUTxOErr.EUTxO.html#4673" class="Field">allInputsValidate</a> <a id="5351" class="Symbol">=</a> <a id="5353" href="EUTxOErr.EUTxO.html#5353" class="Bound">aiv′</a>
            <a id="5370" class="Symbol">;</a> <a id="5372" href="EUTxOErr.EUTxO.html#4798" class="Field">validateValidHashes</a> <a id="5392" class="Symbol">=</a> <a id="5394" href="EUTxOErr.EUTxO.html#5394" class="Bound">vvh′</a>
            <a id="5411" class="Symbol">})</a>
    <a id="5418" class="Keyword">with</a> <a id="5423" href="EUTxOErr.EUTxO.html#5423" class="Bound">uniq</a> ← <a id="5430" href="Relation.Nullary.html#1847" class="Function">recompute</a> <a id="5440" href="Prelude.Decidable.Core.html#166" class="Field">dec</a> <a id="5444" href="EUTxOErr.EUTxO.html#4995" class="Bound">·uniq</a>
    <a id="5454" class="Keyword">rewrite</a> <a id="5462" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="5465" href="EUTxOErr.EUTxO.html#5040" class="Bound">ndp</a> <a id="5469" href="EUTxOErr.EUTxO.html#5241" class="Bound">ndp′</a>
          <a id="5484" class="Symbol">|</a> <a id="5486" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="5503" class="Symbol">(</a><a id="5504" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="5510" href="EUTxOErr.EUTxO.html#5423" class="Bound">uniq</a><a id="5514" class="Symbol">)</a> <a id="5516" href="EUTxOErr.EUTxO.html#5076" class="Bound">vor</a> <a id="5520" href="EUTxOErr.EUTxO.html#5278" class="Bound">vor′</a>
          <a id="5535" class="Symbol">|</a> <a id="5537" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="5540" href="EUTxOErr.EUTxO.html#5112" class="Bound">pv</a> <a id="5543" href="EUTxOErr.EUTxO.html#5315" class="Bound">pv′</a>
          <a id="5557" class="Symbol">|</a> <a id="5559" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="5576" href="Data.Bool.Properties.html#15414" class="Function">B.T-irrelevant</a> <a id="5591" href="EUTxOErr.EUTxO.html#5149" class="Bound">aiv</a> <a id="5595" href="EUTxOErr.EUTxO.html#5353" class="Bound">aiv′</a>
          <a id="5610" class="Symbol">|</a> <a id="5612" href="Prelude.Irrelevance.Core.html#254" class="Field">∀≡</a> <a id="5615" href="EUTxOErr.EUTxO.html#5189" class="Bound">vvh</a> <a id="5619" href="EUTxOErr.EUTxO.html#5394" class="Bound">vvh′</a>
          <a id="5634" class="Symbol">=</a> <a id="5636" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="isValidTx?"></a><a id="5642" href="EUTxOErr.EUTxO.html#5642" class="Function">isValidTx?</a> <a id="5653" class="Symbol">:</a> <a id="5655" class="Symbol">∀</a> <a id="5657" href="EUTxOErr.EUTxO.html#5657" class="Bound">tx</a> <a id="5660" href="EUTxOErr.EUTxO.html#5660" class="Bound">s</a> <a id="5662" class="Symbol">→</a> <a id="5664" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="5668" class="Symbol">(</a><a id="5669" href="EUTxOErr.EUTxO.html#4225" class="Record">IsValidTx</a> <a id="5679" href="EUTxOErr.EUTxO.html#5657" class="Bound">tx</a> <a id="5682" href="EUTxOErr.EUTxO.html#5660" class="Bound">s</a><a id="5683" class="Symbol">)</a>
<a id="5685" href="EUTxOErr.EUTxO.html#5642" class="Function">isValidTx?</a> <a id="5696" href="EUTxOErr.EUTxO.html#5696" class="Bound">tx</a> <a id="5699" href="EUTxOErr.EUTxO.html#5699" class="Bound">s</a><a id="5700" class="Symbol">@(</a><a id="5702" class="Keyword">record</a> <a id="5709" class="Symbol">{</a><a id="5710" href="Prelude.Maps.AsSets.html#679" class="Field">uniq</a> <a id="5715" class="Symbol">=</a> <a id="5717" href="EUTxOErr.EUTxO.html#5717" class="Bound">·uniq</a><a id="5722" class="Symbol">})</a>
  <a id="5727" class="Keyword">with</a> <a id="5732" href="EUTxOErr.EUTxO.html#5732" class="Bound">uniq</a> ← <a id="5739" href="Relation.Nullary.html#1847" class="Function">recompute</a> <a id="5749" href="Prelude.Decidable.Core.html#166" class="Field">dec</a> <a id="5753" href="EUTxOErr.EUTxO.html#5717" class="Bound">·uniq</a>
  <a id="5761" class="Keyword">with</a> <a id="5766" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="5770" class="Symbol">...</a> <a id="5774" class="Symbol">|</a> <a id="5776" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5779" href="EUTxOErr.EUTxO.html#5779" class="Bound">¬p</a> <a id="5782" class="Symbol">=</a> <a id="5784" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5787" class="Symbol">(</a><a id="5788" href="EUTxOErr.EUTxO.html#5779" class="Bound">¬p</a> <a id="5791" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="5793" href="EUTxOErr.EUTxO.html#4282" class="Field">noDoubleSpending</a><a id="5809" class="Symbol">)</a>
<a id="5811" class="Symbol">...</a> <a id="5815" class="Symbol">|</a> <a id="5817" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5821" href="EUTxOErr.EUTxO.html#5821" class="Bound">ndp</a> <a id="5825" class="Keyword">with</a> <a id="5830" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="5834" class="Symbol">...</a> <a id="5838" class="Symbol">|</a> <a id="5840" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5843" href="EUTxOErr.EUTxO.html#5843" class="Bound">¬p</a> <a id="5846" class="Symbol">=</a> <a id="5848" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5851" class="Symbol">(</a><a id="5852" href="EUTxOErr.EUTxO.html#5843" class="Bound">¬p</a> <a id="5855" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="5857" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a><a id="5872" class="Symbol">)</a>
<a id="5874" class="Symbol">...</a> <a id="5878" class="Symbol">|</a> <a id="5880" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="5884" href="EUTxOErr.EUTxO.html#5884" class="Bound">vor</a> <a id="5888" class="Keyword">with</a> <a id="5893" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="5897" class="Symbol">...</a> <a id="5901" class="Symbol">|</a> <a id="5903" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5906" href="EUTxOErr.EUTxO.html#5906" class="Bound">¬p</a> <a id="5909" class="Symbol">=</a> <a id="5911" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="5914" href="EUTxOErr.EUTxO.html#5929" class="Function">absurd</a>
  <a id="5923" class="Keyword">where</a> <a id="5929" href="EUTxOErr.EUTxO.html#5929" class="Function">absurd</a> <a id="5936" class="Symbol">:</a> <a id="5938" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="5940" href="EUTxOErr.EUTxO.html#4225" class="Record">IsValidTx</a> <a id="5950" class="Bound">tx</a> <a id="5953" class="Bound">s</a>
        <a id="5963" href="EUTxOErr.EUTxO.html#5929" class="Function">absurd</a> <a id="5970" class="Symbol">(</a><a id="5971" class="Keyword">record</a> <a id="5978" class="Symbol">{</a><a id="5979" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a> <a id="5995" class="Symbol">=</a> <a id="5997" href="EUTxOErr.EUTxO.html#5997" class="Bound">vor′</a><a id="6001" class="Symbol">;</a> <a id="6003" href="EUTxOErr.EUTxO.html#4575" class="Field">preservesValues</a> <a id="6019" class="Symbol">=</a> <a id="6021" href="EUTxOErr.EUTxO.html#6021" class="Bound">p</a><a id="6022" class="Symbol">})</a>
          <a id="6035" class="Keyword">rewrite</a> <a id="6043" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="6060" class="Symbol">(</a><a id="6061" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="6067" href="EUTxOErr.EUTxO.html#5732" class="Bound">uniq</a><a id="6071" class="Symbol">)</a> <a id="6073" class="Bound">vor</a> <a id="6077" href="EUTxOErr.EUTxO.html#5997" class="Bound">vor′</a> <a id="6082" class="Symbol">=</a> <a id="6084" href="EUTxOErr.EUTxO.html#5906" class="Bound">¬p</a> <a id="6087" href="EUTxOErr.EUTxO.html#6021" class="Bound">p</a>
<a id="6089" class="Symbol">...</a> <a id="6093" class="Symbol">|</a> <a id="6095" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="6099" href="EUTxOErr.EUTxO.html#6099" class="Bound">pv</a> <a id="6102" class="Keyword">with</a> <a id="6107" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="6111" class="Symbol">...</a> <a id="6115" class="Symbol">|</a> <a id="6117" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="6120" href="EUTxOErr.EUTxO.html#6120" class="Bound">¬p</a> <a id="6123" class="Symbol">=</a> <a id="6125" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="6128" href="EUTxOErr.EUTxO.html#6143" class="Function">absurd</a>
  <a id="6137" class="Keyword">where</a> <a id="6143" href="EUTxOErr.EUTxO.html#6143" class="Function">absurd</a> <a id="6150" class="Symbol">:</a> <a id="6152" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="6154" href="EUTxOErr.EUTxO.html#4225" class="Record">IsValidTx</a> <a id="6164" class="Bound">tx</a> <a id="6167" class="Bound">s</a>
        <a id="6177" href="EUTxOErr.EUTxO.html#6143" class="Function">absurd</a> <a id="6184" class="Symbol">(</a><a id="6185" class="Keyword">record</a> <a id="6192" class="Symbol">{</a><a id="6193" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a> <a id="6209" class="Symbol">=</a> <a id="6211" href="EUTxOErr.EUTxO.html#6211" class="Bound">vor′</a><a id="6215" class="Symbol">;</a> <a id="6217" href="EUTxOErr.EUTxO.html#4673" class="Field">allInputsValidate</a> <a id="6235" class="Symbol">=</a> <a id="6237" href="EUTxOErr.EUTxO.html#6237" class="Bound">p</a><a id="6238" class="Symbol">})</a>
          <a id="6251" class="Keyword">rewrite</a> <a id="6259" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="6276" class="Symbol">(</a><a id="6277" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="6283" href="EUTxOErr.EUTxO.html#5732" class="Bound">uniq</a><a id="6287" class="Symbol">)</a> <a id="6289" class="Bound">vor</a> <a id="6293" href="EUTxOErr.EUTxO.html#6211" class="Bound">vor′</a> <a id="6298" class="Symbol">=</a> <a id="6300" href="EUTxOErr.EUTxO.html#6120" class="Bound">¬p</a> <a id="6303" href="EUTxOErr.EUTxO.html#6237" class="Bound">p</a>
<a id="6305" class="Symbol">...</a> <a id="6309" class="Symbol">|</a> <a id="6311" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="6315" href="EUTxOErr.EUTxO.html#6315" class="Bound">aiv</a> <a id="6319" class="Keyword">with</a> <a id="6324" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="6328" class="Symbol">...</a> <a id="6332" class="Symbol">|</a> <a id="6334" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="6337" href="EUTxOErr.EUTxO.html#6337" class="Bound">¬p</a> <a id="6340" class="Symbol">=</a> <a id="6342" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="6345" href="EUTxOErr.EUTxO.html#6360" class="Function">absurd</a>
  <a id="6354" class="Keyword">where</a> <a id="6360" href="EUTxOErr.EUTxO.html#6360" class="Function">absurd</a> <a id="6367" class="Symbol">:</a> <a id="6369" href="Relation.Nullary.html#665" class="Function Operator">¬</a> <a id="6371" href="EUTxOErr.EUTxO.html#4225" class="Record">IsValidTx</a> <a id="6381" class="Bound">tx</a> <a id="6384" class="Bound">s</a>
        <a id="6394" href="EUTxOErr.EUTxO.html#6360" class="Function">absurd</a> <a id="6401" class="Symbol">(</a><a id="6402" class="Keyword">record</a> <a id="6409" class="Symbol">{</a><a id="6410" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a> <a id="6426" class="Symbol">=</a> <a id="6428" href="EUTxOErr.EUTxO.html#6428" class="Bound">vor′</a><a id="6432" class="Symbol">;</a> <a id="6434" href="EUTxOErr.EUTxO.html#4798" class="Field">validateValidHashes</a> <a id="6454" class="Symbol">=</a> <a id="6456" href="EUTxOErr.EUTxO.html#6456" class="Bound">p</a><a id="6457" class="Symbol">})</a>
          <a id="6470" class="Keyword">rewrite</a> <a id="6478" href="Data.List.Relation.Unary.All.html#6499" class="Function">L.All.irrelevant</a> <a id="6495" class="Symbol">(</a><a id="6496" href="Prelude.Lists.WithK.html#2778" class="Function">∈-irr</a> <a id="6502" href="EUTxOErr.EUTxO.html#5732" class="Bound">uniq</a><a id="6506" class="Symbol">)</a> <a id="6508" class="Bound">vor</a> <a id="6512" href="EUTxOErr.EUTxO.html#6428" class="Bound">vor′</a> <a id="6517" class="Symbol">=</a> <a id="6519" href="EUTxOErr.EUTxO.html#6337" class="Bound">¬p</a> <a id="6522" href="EUTxOErr.EUTxO.html#6456" class="Bound">p</a>
<a id="6524" class="Symbol">...</a> <a id="6528" class="Symbol">|</a> <a id="6530" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="6534" href="EUTxOErr.EUTxO.html#6534" class="Bound">vvh</a> <a id="6538" class="Symbol">=</a> <a id="6540" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="6544" class="Keyword">record</a>
  <a id="6553" class="Symbol">{</a> <a id="6555" href="EUTxOErr.EUTxO.html#4282" class="Field">noDoubleSpending</a> <a id="6572" class="Symbol">=</a> <a id="6574" class="Bound">ndp</a>
  <a id="6580" class="Symbol">;</a> <a id="6582" href="EUTxOErr.EUTxO.html#4336" class="Field">validOutputRefs</a> <a id="6598" class="Symbol">=</a> <a id="6600" class="Bound">vor</a>
  <a id="6606" class="Symbol">;</a> <a id="6608" href="EUTxOErr.EUTxO.html#4575" class="Field">preservesValues</a> <a id="6624" class="Symbol">=</a> <a id="6626" class="Bound">pv</a>
  <a id="6631" class="Symbol">;</a> <a id="6633" href="EUTxOErr.EUTxO.html#4673" class="Field">allInputsValidate</a> <a id="6651" class="Symbol">=</a> <a id="6653" class="Bound">aiv</a>
  <a id="6659" class="Symbol">;</a> <a id="6661" href="EUTxOErr.EUTxO.html#4798" class="Field">validateValidHashes</a> <a id="6681" class="Symbol">=</a> <a id="6683" href="EUTxOErr.EUTxO.html#6534" class="Bound">vvh</a> <a id="6687" class="Symbol">}</a>

<a id="isValidTx"></a><a id="6690" href="EUTxOErr.EUTxO.html#6690" class="Function">isValidTx</a> <a id="6700" class="Symbol">:</a> <a id="6702" href="EUTxOErr.EUTxO.html#2512" class="Record">Tx</a> <a id="6705" class="Symbol">→</a> <a id="6707" href="EUTxOErr.EUTxO.html#3865" class="Function">S</a> <a id="6709" class="Symbol">→</a> <a id="6711" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="6716" href="EUTxOErr.EUTxO.html#6690" class="Function">isValidTx</a> <a id="6726" href="EUTxOErr.EUTxO.html#6726" class="Bound">tx</a> <a id="6729" href="EUTxOErr.EUTxO.html#6729" class="Bound">s</a> <a id="6731" class="Symbol">=</a> <a id="6733" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="6735" href="EUTxOErr.EUTxO.html#5642" class="Function">isValidTx?</a> <a id="6746" href="EUTxOErr.EUTxO.html#6726" class="Bound">tx</a> <a id="6749" href="EUTxOErr.EUTxO.html#6729" class="Bound">s</a> <a id="6751" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a>

<a id="6754" class="Comment">-- this is a property of the postulated cryptography (hashing in this case)</a>
<a id="6830" class="Keyword">postulate</a> <a id="s♯t"></a><a id="6840" href="EUTxOErr.EUTxO.html#6840" class="Postulate">s♯t</a> <a id="6844" class="Symbol">:</a> <a id="6846" class="Symbol">∀</a> <a id="6848" class="Symbol">{</a><a id="6849" href="EUTxOErr.EUTxO.html#6849" class="Bound">t</a> <a id="6851" href="EUTxOErr.EUTxO.html#6851" class="Bound">s</a><a id="6852" class="Symbol">}</a> <a id="6854" class="Symbol">→</a> <a id="6856" href="EUTxOErr.EUTxO.html#4225" class="Record">IsValidTx</a> <a id="6866" href="EUTxOErr.EUTxO.html#6849" class="Bound">t</a> <a id="6868" href="EUTxOErr.EUTxO.html#6851" class="Bound">s</a> <a id="6870" class="Symbol">→</a> <a id="6872" href="Common.Maps.html#2022" class="Function">keys</a> <a id="6877" class="Symbol">(</a><a id="6878" href="EUTxOErr.EUTxO.html#6851" class="Bound">s</a> <a id="6880" href="Common.Maps.html#1946" class="Function Operator">─ᵏˢ</a> <a id="6884" href="EUTxOErr.EUTxO.html#2710" class="Function">outputRefs</a> <a id="6895" href="EUTxOErr.EUTxO.html#6849" class="Bound">t</a><a id="6896" class="Symbol">)</a> <a id="6898" href="Prelude.Apartness.html#255" class="Field Operator">♯</a> <a id="6900" href="Common.Maps.html#2022" class="Function">keys</a> <a id="6905" class="Symbol">(</a><a id="6906" href="EUTxOErr.EUTxO.html#4137" class="Function">utxoTx</a> <a id="6913" href="EUTxOErr.EUTxO.html#6849" class="Bound">t</a><a id="6914" class="Symbol">)</a>
</pre></body></html>