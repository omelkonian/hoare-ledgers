<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Shallow.Ledger</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="54" class="Keyword">open</a> <a id="59" href="Prelude.Init.html#3702" class="Module">Integer</a> <a id="67" class="Keyword">using</a> <a id="73" class="Symbol">()</a> <a id="76" class="Keyword">renaming</a> <a id="85" class="Symbol">(</a><a id="86" href="Data.Integer.Base.html#5023" class="Function Operator">_-_</a> <a id="90" class="Symbol">to</a> <a id="93" class="Function Operator">_-ℤ_</a><a id="97" class="Symbol">;</a> <a id="99" href="Data.Integer.Base.html#4844" class="Function Operator">_+_</a> <a id="103" class="Symbol">to</a> <a id="106" class="Function Operator">_+ℤ_</a><a id="110" class="Symbol">)</a>
<a id="112" class="Keyword">open</a> <a id="117" class="Keyword">import</a> <a id="124" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="138" class="Keyword">open</a> <a id="143" class="Keyword">import</a> <a id="150" href="Prelude.Sets.html" class="Module">Prelude.Sets</a> <a id="163" class="Keyword">hiding</a> <a id="170" class="Symbol">(</a><a id="171" href="Prelude.Sets.AsUniqueLists.SetMappings.html#1196" class="Function Operator">_↦_</a><a id="174" class="Symbol">)</a>

<a id="177" class="Keyword">module</a> <a id="184" href="Shallow.Ledger.html" class="Module">Shallow.Ledger</a>
  <a id="201" class="Symbol">(</a><a id="202" href="Shallow.Ledger.html#202" class="Bound">Part</a> <a id="207" class="Symbol">:</a> <a id="209" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="212" class="Symbol">)</a> <a id="214" class="Comment">-- a fixed set of participants</a>
  <a id="247" class="Symbol">⦃</a> <a id="249" href="Shallow.Ledger.html#249" class="Bound">_</a> <a id="251" class="Symbol">:</a> <a id="253" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="259" href="Shallow.Ledger.html#202" class="Bound">Part</a> <a id="264" class="Symbol">⦄</a>
  <a id="268" class="Keyword">where</a>

<a id="275" class="Comment">-- The state of a ledger assigns a balance to each participant</a>
<a id="S"></a><a id="338" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="340" class="Symbol">=</a> <a id="342" href="Shallow.Ledger.html#202" class="Bound">Part</a> <a id="347" class="Symbol">→</a> <a id="349" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>

<a id="352" class="Comment">-- A transaction is transferring money from one participant to another</a>
<a id="423" class="Keyword">data</a> <a id="Tx"></a><a id="428" href="Shallow.Ledger.html#428" class="Datatype">Tx</a> <a id="431" class="Symbol">:</a> <a id="433" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="437" class="Keyword">where</a>
  <a id="Tx._—→⟨_⟩_"></a><a id="445" href="Shallow.Ledger.html#445" class="InductiveConstructor Operator">_—→⟨_⟩_</a> <a id="453" class="Symbol">:</a> <a id="455" href="Shallow.Ledger.html#202" class="Bound">Part</a> <a id="460" class="Symbol">→</a> <a id="462" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="464" class="Symbol">→</a> <a id="466" href="Shallow.Ledger.html#202" class="Bound">Part</a> <a id="471" class="Symbol">→</a> <a id="473" href="Shallow.Ledger.html#428" class="Datatype">Tx</a>

<a id="477" class="Comment">-- A ledger is a list of transactions</a>
<a id="L"></a><a id="515" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="517" class="Symbol">=</a> <a id="519" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="524" href="Shallow.Ledger.html#428" class="Datatype">Tx</a>

<a id="528" class="Keyword">variable</a>
  <a id="539" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="541" href="Shallow.Ledger.html#541" class="Generalizable">s′</a> <a id="544" href="Shallow.Ledger.html#544" class="Generalizable">s″</a> <a id="547" class="Symbol">:</a> <a id="549" href="Shallow.Ledger.html#338" class="Function">S</a>
  <a id="553" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="555" href="Shallow.Ledger.html#555" class="Generalizable">t′</a> <a id="558" href="Shallow.Ledger.html#558" class="Generalizable">t″</a> <a id="561" class="Symbol">:</a> <a id="563" href="Shallow.Ledger.html#428" class="Datatype">Tx</a>
  <a id="568" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="570" href="Shallow.Ledger.html#570" class="Generalizable">l′</a> <a id="573" href="Shallow.Ledger.html#573" class="Generalizable">l″</a> <a id="576" class="Symbol">:</a> <a id="578" href="Shallow.Ledger.html#515" class="Function">L</a>
  <a id="582" href="Shallow.Ledger.html#582" class="Generalizable">ls</a> <a id="585" href="Shallow.Ledger.html#585" class="Generalizable">ls′</a> <a id="589" href="Shallow.Ledger.html#589" class="Generalizable">ls″</a> <a id="593" class="Symbol">:</a> <a id="595" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="597" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="599" href="Shallow.Ledger.html#338" class="Function">S</a>

<a id="602" class="Comment">-- ** Denotational semantics</a>

<a id="Domain"></a><a id="632" href="Shallow.Ledger.html#632" class="Function">Domain</a> <a id="639" class="Symbol">=</a> <a id="641" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="643" class="Symbol">→</a> <a id="645" href="Shallow.Ledger.html#338" class="Function">S</a>

<a id="648" class="Keyword">record</a> <a id="Denotable"></a><a id="655" href="Shallow.Ledger.html#655" class="Record">Denotable</a> <a id="665" class="Symbol">(</a><a id="666" href="Shallow.Ledger.html#666" class="Bound">A</a> <a id="668" class="Symbol">:</a> <a id="670" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="673" class="Symbol">)</a> <a id="675" class="Symbol">:</a> <a id="677" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="681" class="Keyword">where</a>
  <a id="689" class="Keyword">field</a>
    <a id="Denotable.⟦_⟧"></a><a id="699" href="Shallow.Ledger.html#699" class="Field Operator">⟦_⟧</a> <a id="703" class="Symbol">:</a> <a id="705" href="Shallow.Ledger.html#666" class="Bound">A</a> <a id="707" class="Symbol">→</a> <a id="709" href="Shallow.Ledger.html#632" class="Function">Domain</a>
<a id="716" class="Keyword">open</a> <a id="721" href="Shallow.Ledger.html#655" class="Module">Denotable</a> <a id="731" class="Symbol">{{...}}</a> <a id="739" class="Keyword">public</a>

<a id="747" class="Keyword">instance</a>
  <a id="⟦Tx⟧"></a><a id="758" href="Shallow.Ledger.html#758" class="Function">⟦Tx⟧</a> <a id="763" class="Symbol">:</a> <a id="765" href="Shallow.Ledger.html#655" class="Record">Denotable</a> <a id="775" href="Shallow.Ledger.html#428" class="Datatype">Tx</a>
  <a id="780" href="Shallow.Ledger.html#758" class="Function">⟦Tx⟧</a> <a id="785" class="Symbol">.</a><a id="786" href="Shallow.Ledger.html#699" class="Field Operator">⟦_⟧</a> <a id="790" class="Symbol">(</a><a id="791" href="Shallow.Ledger.html#791" class="Bound">p₁</a> <a id="794" href="Shallow.Ledger.html#445" class="InductiveConstructor Operator">—→⟨</a> <a id="798" href="Shallow.Ledger.html#798" class="Bound">n</a> <a id="800" href="Shallow.Ledger.html#445" class="InductiveConstructor Operator">⟩</a> <a id="802" href="Shallow.Ledger.html#802" class="Bound">p₂</a><a id="804" class="Symbol">)</a> <a id="806" href="Shallow.Ledger.html#806" class="Bound">s</a> <a id="808" href="Shallow.Ledger.html#808" class="Bound">p</a> <a id="810" class="Symbol">=</a>
    <a id="816" class="Keyword">let</a> <a id="820" href="Shallow.Ledger.html#820" class="Bound">prev</a> <a id="825" class="Symbol">=</a> <a id="827" href="Shallow.Ledger.html#806" class="Bound">s</a> <a id="829" href="Shallow.Ledger.html#808" class="Bound">p</a>
    <a id="835" class="Keyword">in</a>  <a id="839" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="842" href="Shallow.Ledger.html#791" class="Bound">p₁</a> <a id="845" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="848" href="Shallow.Ledger.html#802" class="Bound">p₂</a> <a id="851" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>
          <a id="866" href="Shallow.Ledger.html#820" class="Bound">prev</a>
        <a id="879" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="884" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="887" href="Shallow.Ledger.html#808" class="Bound">p</a> <a id="889" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="892" href="Shallow.Ledger.html#791" class="Bound">p₁</a> <a id="895" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>
          <a id="910" href="Shallow.Ledger.html#820" class="Bound">prev</a> <a id="915" href="Shallow.Ledger.html#93" class="Function Operator">-ℤ</a> <a id="918" href="Shallow.Ledger.html#798" class="Bound">n</a>
        <a id="928" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="933" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="936" href="Shallow.Ledger.html#808" class="Bound">p</a> <a id="938" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="941" href="Shallow.Ledger.html#802" class="Bound">p₂</a> <a id="944" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>
          <a id="959" href="Shallow.Ledger.html#820" class="Bound">prev</a> <a id="964" href="Shallow.Ledger.html#106" class="Function Operator">+ℤ</a> <a id="967" href="Shallow.Ledger.html#798" class="Bound">n</a>
        <a id="977" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
          <a id="992" href="Shallow.Ledger.html#820" class="Bound">prev</a>

  <a id="⟦L⟧"></a><a id="1000" href="Shallow.Ledger.html#1000" class="Function">⟦L⟧</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="Shallow.Ledger.html#655" class="Record">Denotable</a> <a id="1016" href="Shallow.Ledger.html#515" class="Function">L</a>
  <a id="1020" href="Shallow.Ledger.html#1000" class="Function">⟦L⟧</a> <a id="1024" class="Symbol">.</a><a id="1025" href="Shallow.Ledger.html#699" class="Field Operator">⟦_⟧</a> <a id="1029" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>      <a id="1037" href="Shallow.Ledger.html#1037" class="Bound">s</a> <a id="1039" class="Symbol">=</a> <a id="1041" href="Shallow.Ledger.html#1037" class="Bound">s</a>
  <a id="1045" href="Shallow.Ledger.html#1000" class="Function">⟦L⟧</a> <a id="1049" class="Symbol">.</a><a id="1050" href="Shallow.Ledger.html#699" class="Field Operator">⟦_⟧</a> <a id="1054" class="Symbol">(</a><a id="1055" href="Shallow.Ledger.html#1055" class="Bound">t</a> <a id="1057" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1059" href="Shallow.Ledger.html#1059" class="Bound">l</a><a id="1060" class="Symbol">)</a> <a id="1062" class="Symbol">=</a> <a id="1064" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1066" href="Shallow.Ledger.html#1059" class="Bound">l</a> <a id="1068" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="1070" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1072" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1074" href="Shallow.Ledger.html#1055" class="Bound">t</a> <a id="1076" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a>

<a id="lem"></a><a id="1079" href="Shallow.Ledger.html#1079" class="Function">lem</a> <a id="1083" class="Symbol">:</a> <a id="1085" class="Symbol">∀</a> <a id="1087" href="Shallow.Ledger.html#1087" class="Bound">x</a> <a id="1089" class="Symbol">→</a> <a id="1091" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1093" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="1095" class="InductiveConstructor Operator">∷</a> <a id="1097" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="1099" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="1101" href="Shallow.Ledger.html#1087" class="Bound">x</a> <a id="1103" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1105" class="Symbol">(</a><a id="1106" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1108" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="1110" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="1112" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1114" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1116" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="1118" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="1119" class="Symbol">)</a> <a id="1121" href="Shallow.Ledger.html#1087" class="Bound">x</a>
<a id="1123" href="Shallow.Ledger.html#1079" class="Function">lem</a> <a id="1127" class="Symbol">_</a> <a id="1129" class="Symbol">=</a> <a id="1131" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="comp"></a><a id="1137" href="Shallow.Ledger.html#1137" class="Function">comp</a> <a id="1142" class="Symbol">:</a> <a id="1144" class="Symbol">∀</a> <a id="1146" href="Shallow.Ledger.html#1146" class="Bound">x</a> <a id="1148" class="Symbol">→</a> <a id="1150" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1152" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="1154" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="1157" href="Shallow.Ledger.html#570" class="Generalizable">l′</a> <a id="1160" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="1162" href="Shallow.Ledger.html#1146" class="Bound">x</a> <a id="1164" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1166" class="Symbol">(</a><a id="1167" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1169" href="Shallow.Ledger.html#570" class="Generalizable">l′</a> <a id="1172" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="1174" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1176" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1178" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="1180" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="1181" class="Symbol">)</a> <a id="1183" href="Shallow.Ledger.html#1146" class="Bound">x</a>
<a id="1185" href="Shallow.Ledger.html#1137" class="Function">comp</a> <a id="1190" class="Symbol">{</a><a id="1191" class="Argument">l</a> <a id="1193" class="Symbol">=</a> <a id="1195" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1197" class="Symbol">}</a>    <a id="1202" class="Symbol">{</a><a id="1203" href="Shallow.Ledger.html#1203" class="Bound">l′</a><a id="1205" class="Symbol">}</a> <a id="1207" href="Shallow.Ledger.html#1207" class="Bound">x</a> <a id="1209" class="Symbol">=</a> <a id="1211" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1216" href="Shallow.Ledger.html#1137" class="Function">comp</a> <a id="1221" class="Symbol">{</a><a id="1222" class="Argument">l</a> <a id="1224" class="Symbol">=</a> <a id="1226" href="Shallow.Ledger.html#1226" class="Bound">t</a> <a id="1228" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1230" href="Shallow.Ledger.html#1230" class="Bound">l</a><a id="1231" class="Symbol">}</a> <a id="1233" class="Symbol">{</a><a id="1234" href="Shallow.Ledger.html#1234" class="Bound">l′</a><a id="1236" class="Symbol">}</a> <a id="1238" href="Shallow.Ledger.html#1238" class="Bound">x</a> <a id="1240" class="Keyword">rewrite</a> <a id="1248" href="Shallow.Ledger.html#1079" class="Function">lem</a> <a id="1252" class="Symbol">{</a><a id="1253" href="Shallow.Ledger.html#1226" class="Bound">t</a><a id="1254" class="Symbol">}{</a><a id="1256" href="Shallow.Ledger.html#1230" class="Bound">l</a><a id="1257" class="Symbol">}</a> <a id="1259" href="Shallow.Ledger.html#1238" class="Bound">x</a> <a id="1261" class="Symbol">|</a> <a id="1263" href="Shallow.Ledger.html#1137" class="Function">comp</a> <a id="1268" class="Symbol">{</a><a id="1269" href="Shallow.Ledger.html#1230" class="Bound">l</a><a id="1270" class="Symbol">}{</a><a id="1272" href="Shallow.Ledger.html#1234" class="Bound">l′</a><a id="1274" class="Symbol">}</a> <a id="1276" class="Symbol">(</a><a id="1277" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1279" href="Shallow.Ledger.html#1226" class="Bound">t</a> <a id="1281" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="1283" href="Shallow.Ledger.html#1238" class="Bound">x</a><a id="1284" class="Symbol">)</a> <a id="1286" class="Symbol">=</a> <a id="1288" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1294" class="Comment">-- ** Operational semantics</a>

<a id="1323" class="Keyword">infix</a> <a id="1329" class="Number">0</a> <a id="1331" href="Shallow.Ledger.html#1355" class="Datatype Operator">_—→_</a> <a id="1336" href="Shallow.Ledger.html#1555" class="Datatype Operator">_—→⋆_</a> <a id="1342" href="Shallow.Ledger.html#1717" class="Function Operator">_—→⋆′_</a>

<a id="1350" class="Keyword">data</a> <a id="_—→_"></a><a id="1355" href="Shallow.Ledger.html#1355" class="Datatype Operator">_—→_</a> <a id="1360" class="Symbol">:</a> <a id="1362" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="1364" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1366" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="1368" class="Symbol">→</a> <a id="1370" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="1372" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1374" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="1376" class="Symbol">→</a> <a id="1378" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1382" class="Keyword">where</a>
  <a id="_—→_.singleStep"></a><a id="1390" href="Shallow.Ledger.html#1390" class="InductiveConstructor">singleStep</a> <a id="1401" class="Symbol">:</a>
    <a id="1407" class="Comment">------------------------</a>
    <a id="1436" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="1438" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1440" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="1442" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1444" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="1446" href="Shallow.Ledger.html#1355" class="Datatype Operator">—→</a> <a id="1449" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="1451" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1453" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="1455" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="1457" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="1459" href="Shallow.Ledger.html#539" class="Generalizable">s</a>

<a id="1462" class="Keyword">data</a> <a id="_—→′_"></a><a id="1467" href="Shallow.Ledger.html#1467" class="Datatype Operator">_—→′_</a> <a id="1473" class="Symbol">:</a> <a id="1475" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="1477" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1479" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="1481" class="Symbol">→</a> <a id="1483" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="1485" class="Symbol">→</a> <a id="1487" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1491" class="Keyword">where</a>
  <a id="_—→′_.finalStep"></a><a id="1499" href="Shallow.Ledger.html#1499" class="InductiveConstructor">finalStep</a> <a id="1509" class="Symbol">:</a>
    <a id="1515" class="Comment">--------------</a>
    <a id="1534" class="Symbol">(</a><a id="1535" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1538" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1540" href="Shallow.Ledger.html#539" class="Generalizable">s</a><a id="1541" class="Symbol">)</a> <a id="1543" href="Shallow.Ledger.html#1467" class="Datatype Operator">—→′</a> <a id="1547" href="Shallow.Ledger.html#539" class="Generalizable">s</a>

<a id="1550" class="Keyword">data</a> <a id="_—→⋆_"></a><a id="1555" href="Shallow.Ledger.html#1555" class="Datatype Operator">_—→⋆_</a> <a id="1561" class="Symbol">:</a> <a id="1563" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="1565" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1567" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="1569" class="Symbol">→</a> <a id="1571" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="1573" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1575" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="1577" class="Symbol">→</a> <a id="1579" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1583" class="Keyword">where</a>
   <a id="_—→⋆_.base"></a><a id="1592" href="Shallow.Ledger.html#1592" class="InductiveConstructor">base</a> <a id="1597" class="Symbol">:</a>
       <a id="1606" class="Comment">---------</a>
       <a id="1623" href="Shallow.Ledger.html#582" class="Generalizable">ls</a> <a id="1626" href="Shallow.Ledger.html#1555" class="Datatype Operator">—→⋆</a> <a id="1630" href="Shallow.Ledger.html#582" class="Generalizable">ls</a>

   <a id="_—→⋆_.step"></a><a id="1637" href="Shallow.Ledger.html#1637" class="InductiveConstructor">step</a> <a id="1642" class="Symbol">:</a>
       <a id="1651" href="Shallow.Ledger.html#582" class="Generalizable">ls</a> <a id="1654" href="Shallow.Ledger.html#1355" class="Datatype Operator">—→</a> <a id="1657" href="Shallow.Ledger.html#585" class="Generalizable">ls′</a>
     <a id="1666" class="Symbol">→</a> <a id="1668" href="Shallow.Ledger.html#585" class="Generalizable">ls′</a> <a id="1672" href="Shallow.Ledger.html#1555" class="Datatype Operator">—→⋆</a> <a id="1676" href="Shallow.Ledger.html#589" class="Generalizable">ls″</a>
       <a id="1687" class="Comment">----------</a>
     <a id="1703" class="Symbol">→</a> <a id="1705" href="Shallow.Ledger.html#582" class="Generalizable">ls</a> <a id="1708" href="Shallow.Ledger.html#1555" class="Datatype Operator">—→⋆</a> <a id="1712" href="Shallow.Ledger.html#589" class="Generalizable">ls″</a>

<a id="_—→⋆′_"></a><a id="1717" href="Shallow.Ledger.html#1717" class="Function Operator">_—→⋆′_</a> <a id="1724" class="Symbol">:</a> <a id="1726" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="1728" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1730" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="1732" class="Symbol">→</a> <a id="1734" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="1736" class="Symbol">→</a> <a id="1738" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1742" href="Shallow.Ledger.html#1742" class="Bound">ls</a> <a id="1745" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="1750" href="Shallow.Ledger.html#1750" class="Bound">s</a> <a id="1752" class="Symbol">=</a> <a id="1754" href="Shallow.Ledger.html#1742" class="Bound">ls</a> <a id="1757" href="Shallow.Ledger.html#1555" class="Datatype Operator">—→⋆</a> <a id="1761" class="Symbol">(</a><a id="1762" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1765" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1767" href="Shallow.Ledger.html#1750" class="Bound">s</a><a id="1768" class="Symbol">)</a>

<a id="comp′"></a><a id="1771" href="Shallow.Ledger.html#1771" class="Function">comp′</a> <a id="1777" class="Symbol">:</a> <a id="1779" href="Shallow.Ledger.html#568" class="Generalizable">l</a>       <a id="1787" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1789" href="Shallow.Ledger.html#539" class="Generalizable">s</a>  <a id="1792" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="1797" href="Shallow.Ledger.html#541" class="Generalizable">s′</a>
      <a id="1806" class="Symbol">→</a> <a id="1808" href="Shallow.Ledger.html#570" class="Generalizable">l′</a>      <a id="1816" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1818" href="Shallow.Ledger.html#541" class="Generalizable">s′</a> <a id="1821" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="1826" href="Shallow.Ledger.html#544" class="Generalizable">s″</a>
      <a id="1835" class="Symbol">→</a> <a id="1837" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="1839" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="1842" href="Shallow.Ledger.html#570" class="Generalizable">l′</a> <a id="1845" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1847" href="Shallow.Ledger.html#539" class="Generalizable">s</a>  <a id="1850" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="1855" href="Shallow.Ledger.html#544" class="Generalizable">s″</a>
<a id="1858" href="Shallow.Ledger.html#1771" class="Function">comp′</a> <a id="1864" class="Symbol">{</a><a id="1865" class="Argument">l</a> <a id="1867" class="Symbol">=</a> <a id="1869" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1871" class="Symbol">}</a>    <a id="1876" href="Shallow.Ledger.html#1592" class="InductiveConstructor">base</a>                   <a id="1899" href="Shallow.Ledger.html#1899" class="Bound">s′→s″</a> <a id="1905" class="Symbol">=</a> <a id="1907" href="Shallow.Ledger.html#1899" class="Bound">s′→s″</a>
<a id="1913" href="Shallow.Ledger.html#1771" class="Function">comp′</a> <a id="1919" class="Symbol">{</a><a id="1920" class="Argument">l</a> <a id="1922" class="Symbol">=</a> <a id="1924" class="Symbol">_</a> <a id="1926" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1928" class="Symbol">_}</a> <a id="1931" class="Symbol">(</a><a id="1932" href="Shallow.Ledger.html#1637" class="InductiveConstructor">step</a> <a id="1937" href="Shallow.Ledger.html#1390" class="InductiveConstructor">singleStep</a> <a id="1948" href="Shallow.Ledger.html#1948" class="Bound">s→s′</a><a id="1952" class="Symbol">)</a> <a id="1954" href="Shallow.Ledger.html#1954" class="Bound">s′→s″</a> <a id="1960" class="Symbol">=</a> <a id="1962" href="Shallow.Ledger.html#1637" class="InductiveConstructor">step</a> <a id="1967" href="Shallow.Ledger.html#1390" class="InductiveConstructor">singleStep</a> <a id="1978" class="Symbol">(</a><a id="1979" href="Shallow.Ledger.html#1771" class="Function">comp′</a> <a id="1985" href="Shallow.Ledger.html#1948" class="Bound">s→s′</a> <a id="1990" href="Shallow.Ledger.html#1954" class="Bound">s′→s″</a><a id="1995" class="Symbol">)</a>

<a id="oper-base⋆"></a><a id="1998" href="Shallow.Ledger.html#1998" class="Function">oper-base⋆</a> <a id="2009" class="Symbol">:</a> <a id="2011" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2013" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2015" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="2017" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="2022" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="2024" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2026" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="2028" href="Shallow.Ledger.html#539" class="Generalizable">s</a>
<a id="2030" href="Shallow.Ledger.html#1998" class="Function">oper-base⋆</a> <a id="2041" class="Symbol">{</a><a id="2042" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2044" class="Symbol">}</a>    <a id="2049" class="Symbol">=</a> <a id="2051" href="Shallow.Ledger.html#1592" class="InductiveConstructor">base</a>
<a id="2056" href="Shallow.Ledger.html#1998" class="Function">oper-base⋆</a> <a id="2067" class="Symbol">{_</a> <a id="2070" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2072" class="Symbol">_}</a> <a id="2075" class="Symbol">=</a> <a id="2077" href="Shallow.Ledger.html#1637" class="InductiveConstructor">step</a> <a id="2082" href="Shallow.Ledger.html#1390" class="InductiveConstructor">singleStep</a> <a id="2093" href="Shallow.Ledger.html#1998" class="Function">oper-base⋆</a>

<a id="2105" class="Comment">-- ** Relating denotational and operational semantics</a>

<a id="denot⇔oper"></a><a id="2160" href="Shallow.Ledger.html#2160" class="Function">denot⇔oper</a> <a id="2171" class="Symbol">:</a> <a id="2173" class="Symbol">(</a><a id="2174" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="2176" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2178" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="2180" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="2182" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2184" href="Shallow.Ledger.html#541" class="Generalizable">s′</a><a id="2186" class="Symbol">)</a> <a id="2188" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="2190" class="Symbol">(</a><a id="2191" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2193" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2195" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="2197" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="2202" href="Shallow.Ledger.html#541" class="Generalizable">s′</a><a id="2204" class="Symbol">)</a>
<a id="2206" href="Shallow.Ledger.html#2160" class="Function">denot⇔oper</a> <a id="2217" class="Symbol">=</a> <a id="2219" href="Shallow.Ledger.html#2255" class="Function">denot→oper</a> <a id="2230" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2232" href="Shallow.Ledger.html#2413" class="Function">oper→denot</a>
  <a id="2245" class="Keyword">where</a>
    <a id="2255" href="Shallow.Ledger.html#2255" class="Function">denot→oper</a> <a id="2266" class="Symbol">:</a> <a id="2268" class="Symbol">(</a><a id="2269" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="2271" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2273" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="2275" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="2277" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2279" href="Shallow.Ledger.html#541" class="Generalizable">s′</a><a id="2281" class="Symbol">)</a> <a id="2283" class="Symbol">→</a> <a id="2285" class="Symbol">(</a><a id="2286" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2288" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2290" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="2292" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="2297" href="Shallow.Ledger.html#541" class="Generalizable">s′</a><a id="2299" class="Symbol">)</a>
    <a id="2305" href="Shallow.Ledger.html#2255" class="Function">denot→oper</a> <a id="2316" class="Symbol">{</a><a id="2317" class="Argument">l</a> <a id="2319" class="Symbol">=</a> <a id="2321" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2323" class="Symbol">}</a>    <a id="2328" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2333" class="Symbol">=</a> <a id="2335" href="Shallow.Ledger.html#1592" class="InductiveConstructor">base</a>
    <a id="2344" href="Shallow.Ledger.html#2255" class="Function">denot→oper</a> <a id="2355" class="Symbol">{</a><a id="2356" class="Argument">l</a> <a id="2358" class="Symbol">=</a> <a id="2360" class="Symbol">_</a> <a id="2362" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2364" class="Symbol">_}</a> <a id="2367" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2372" class="Symbol">=</a> <a id="2374" href="Shallow.Ledger.html#1637" class="InductiveConstructor">step</a> <a id="2379" href="Shallow.Ledger.html#1390" class="InductiveConstructor">singleStep</a> <a id="2390" class="Symbol">(</a><a id="2391" href="Shallow.Ledger.html#2255" class="Function">denot→oper</a> <a id="2402" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2406" class="Symbol">)</a>

    <a id="2413" href="Shallow.Ledger.html#2413" class="Function">oper→denot</a> <a id="2424" class="Symbol">:</a> <a id="2426" class="Symbol">(</a><a id="2427" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2429" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2431" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="2433" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="2438" href="Shallow.Ledger.html#541" class="Generalizable">s′</a><a id="2440" class="Symbol">)</a> <a id="2442" class="Symbol">→</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="2447" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2449" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="2451" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="2453" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2455" href="Shallow.Ledger.html#541" class="Generalizable">s′</a><a id="2457" class="Symbol">)</a>
    <a id="2463" href="Shallow.Ledger.html#2413" class="Function">oper→denot</a> <a id="2474" class="Symbol">{</a><a id="2475" class="Argument">l</a> <a id="2477" class="Symbol">=</a> <a id="2479" class="DottedPattern Symbol">.</a><a id="2480" href="Agda.Builtin.List.html#185" class="DottedPattern InductiveConstructor">[]</a><a id="2482" class="Symbol">}</a>   <a id="2486" href="Shallow.Ledger.html#1592" class="InductiveConstructor">base</a>                <a id="2506" class="Symbol">=</a> <a id="2508" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="2517" href="Shallow.Ledger.html#2413" class="Function">oper→denot</a> <a id="2528" class="Symbol">{</a><a id="2529" class="Argument">l</a> <a id="2531" class="Symbol">=</a> <a id="2533" class="Symbol">_</a> <a id="2535" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2537" class="Symbol">_}</a> <a id="2540" class="Symbol">(</a><a id="2541" href="Shallow.Ledger.html#1637" class="InductiveConstructor">step</a> <a id="2546" href="Shallow.Ledger.html#1390" class="InductiveConstructor">singleStep</a> <a id="2557" href="Shallow.Ledger.html#2557" class="Bound">p</a><a id="2558" class="Symbol">)</a> <a id="2560" class="Symbol">=</a> <a id="2562" href="Shallow.Ledger.html#2413" class="Function">oper→denot</a> <a id="2573" href="Shallow.Ledger.html#2557" class="Bound">p</a>

<a id="2576" class="Comment">-- ** Axiomatic semantics</a>
<a id="Predˢ"></a><a id="2602" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a> <a id="2608" class="Symbol">=</a> <a id="2610" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="2615" href="Shallow.Ledger.html#338" class="Function">S</a> <a id="2617" href="Level.html#512" class="Function">0ℓ</a>

<a id="2621" class="Keyword">variable</a>
  <a id="2632" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="2634" href="Shallow.Ledger.html#2634" class="Generalizable">P′</a> <a id="2637" href="Shallow.Ledger.html#2637" class="Generalizable">P₁</a> <a id="2640" href="Shallow.Ledger.html#2640" class="Generalizable">P₂</a> <a id="2643" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="2645" href="Shallow.Ledger.html#2645" class="Generalizable">Q′</a> <a id="2648" href="Shallow.Ledger.html#2648" class="Generalizable">Q₁</a> <a id="2651" href="Shallow.Ledger.html#2651" class="Generalizable">Q₂</a> <a id="2654" href="Shallow.Ledger.html#2654" class="Generalizable">R</a> <a id="2656" class="Symbol">:</a> <a id="2658" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a>

<a id="2665" class="Keyword">data</a> <a id="⟨_⟩_⟨_⟩"></a><a id="2670" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨_⟩_⟨_⟩</a> <a id="2678" class="Symbol">:</a> <a id="2680" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a> <a id="2686" class="Symbol">→</a> <a id="2688" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="2690" class="Symbol">→</a> <a id="2692" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a> <a id="2698" class="Symbol">→</a> <a id="2700" href="Agda.Primitive.html#326" class="Primitive">Set₁</a> <a id="2705" class="Keyword">where</a>

  <a id="⟨_⟩_⟨_⟩.base"></a><a id="2714" href="Shallow.Ledger.html#2714" class="InductiveConstructor">base</a> <a id="2719" class="Symbol">:</a>
    <a id="2725" class="Comment">--------------</a>
    <a id="2744" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="2746" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="2748" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="2750" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2753" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="2755" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="2757" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a>
  <a id="2761" class="Comment">--   -------------------------</a>
  <a id="2794" class="Comment">--   ⟨ P ∘ ⟦ t ⟧ ⟩ [ t ] ⟨ P ⟩</a>

  <a id="⟨_⟩_⟨_⟩.step"></a><a id="2828" href="Shallow.Ledger.html#2828" class="InductiveConstructor">step</a> <a id="2833" class="Symbol">:</a>
      <a id="2841" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="2843" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="2845" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="2847" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2849" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="2851" href="Shallow.Ledger.html#2654" class="Generalizable">R</a> <a id="2853" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a>
      <a id="2861" class="Comment">-------------------------</a>
    <a id="2891" class="Symbol">→</a> <a id="2893" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="2895" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="2897" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2899" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="2901" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="2903" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="2905" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="2907" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="2909" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2911" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="2913" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="2915" href="Shallow.Ledger.html#2654" class="Generalizable">R</a> <a id="2917" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a>
  <a id="2921" class="Comment">--     ⟨ P ⟩ l  ⟨ Q ⟩</a>
  <a id="2945" class="Comment">--   → ⟨ Q ⟩ l′ ⟨ R ⟩</a>
  <a id="2969" class="Comment">--     -------------------</a>
  <a id="2998" class="Comment">--   → ⟨ P ⟩ l ++ l′ ⟨ R ⟩</a>

  <a id="⟨_⟩_⟨_⟩.weaken-strengthen"></a><a id="3028" href="Shallow.Ledger.html#3028" class="InductiveConstructor">weaken-strengthen</a> <a id="3046" class="Symbol">:</a>

      <a id="3055" href="Shallow.Ledger.html#2634" class="Generalizable">P′</a> <a id="3058" href="Prelude.General.html#1680" class="Function Operator">⊢</a> <a id="3060" href="Shallow.Ledger.html#2632" class="Generalizable">P</a>
    <a id="3066" class="Symbol">→</a> <a id="3068" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a>  <a id="3071" href="Prelude.General.html#1680" class="Function Operator">⊢</a> <a id="3073" href="Shallow.Ledger.html#2645" class="Generalizable">Q′</a>
    <a id="3080" class="Symbol">→</a> <a id="3082" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3084" href="Shallow.Ledger.html#2632" class="Generalizable">P</a>  <a id="3087" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="3089" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3091" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3093" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a>  <a id="3096" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a>
      <a id="3104" class="Comment">---------------</a>
    <a id="3124" class="Symbol">→</a> <a id="3126" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3128" href="Shallow.Ledger.html#2634" class="Generalizable">P′</a> <a id="3131" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="3133" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3135" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3137" href="Shallow.Ledger.html#2645" class="Generalizable">Q′</a> <a id="3140" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a>

<a id="3143" class="Comment">-- utilities</a>
<a id="axiom-base⋆"></a><a id="3156" href="Shallow.Ledger.html#3156" class="Function">axiom-base⋆</a> <a id="3168" class="Symbol">:</a> <a id="3170" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3172" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="3174" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3176" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3178" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3180" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="3182" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="3184" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3186" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3188" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="3190" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a>
<a id="3192" href="Shallow.Ledger.html#3156" class="Function">axiom-base⋆</a> <a id="3204" class="Symbol">{</a><a id="3205" class="Argument">l</a> <a id="3207" class="Symbol">=</a> <a id="3209" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3211" class="Symbol">}</a>    <a id="3216" class="Symbol">=</a> <a id="3218" href="Shallow.Ledger.html#2714" class="InductiveConstructor">base</a>
<a id="3223" href="Shallow.Ledger.html#3156" class="Function">axiom-base⋆</a> <a id="3235" class="Symbol">{</a><a id="3236" class="Argument">l</a> <a id="3238" class="Symbol">=</a> <a id="3240" class="Symbol">_</a> <a id="3242" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3244" class="Symbol">_}</a> <a id="3247" class="Symbol">=</a> <a id="3249" href="Shallow.Ledger.html#2828" class="InductiveConstructor">step</a> <a id="3254" href="Shallow.Ledger.html#3156" class="Function">axiom-base⋆</a>

<a id="3267" class="Keyword">postulate</a>
  <a id="⟦⟧-comm"></a><a id="3279" href="Shallow.Ledger.html#3279" class="Postulate">⟦⟧-comm</a> <a id="3287" class="Symbol">:</a> <a id="3289" class="Symbol">(</a><a id="3290" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3292" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="3294" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="3296" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3298" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3300" href="Shallow.Ledger.html#555" class="Generalizable">t′</a> <a id="3303" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="3304" class="Symbol">)</a> <a id="3306" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="3308" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3310" class="Symbol">(</a><a id="3311" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3313" href="Shallow.Ledger.html#555" class="Generalizable">t′</a> <a id="3316" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="3318" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3320" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3322" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="3324" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="3325" class="Symbol">)</a> <a id="3327" href="Shallow.Ledger.html#539" class="Generalizable">s</a>
<a id="3329" class="Comment">-- ⟦⟧-comm {A —→⟨ n ⟩ B}{A′ —→⟨ n′ ⟩ B′} = {!!}</a>

<a id="denot-comm"></a><a id="3378" href="Shallow.Ledger.html#3378" class="Function">denot-comm</a> <a id="3389" class="Symbol">:</a> <a id="3391" class="Symbol">(</a><a id="3392" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3394" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="3396" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="3398" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3400" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3402" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3404" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="3405" class="Symbol">)</a> <a id="3407" href="Shallow.Ledger.html#539" class="Generalizable">s</a> <a id="3409" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3411" class="Symbol">(</a><a id="3412" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3414" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3416" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="3418" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3420" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3422" href="Shallow.Ledger.html#553" class="Generalizable">t</a> <a id="3424" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="3425" class="Symbol">)</a> <a id="3427" href="Shallow.Ledger.html#539" class="Generalizable">s</a>
<a id="3429" href="Shallow.Ledger.html#3378" class="Function">denot-comm</a> <a id="3440" class="Symbol">{</a><a id="3441" href="Shallow.Ledger.html#3441" class="Bound">t</a><a id="3442" class="Symbol">}{</a><a id="3444" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3446" class="Symbol">}</a>    <a id="3451" class="Symbol">{</a><a id="3452" href="Shallow.Ledger.html#3452" class="Bound">s</a><a id="3453" class="Symbol">}</a> <a id="3455" class="Symbol">=</a> <a id="3457" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3462" href="Shallow.Ledger.html#3378" class="Function">denot-comm</a> <a id="3473" class="Symbol">{</a><a id="3474" href="Shallow.Ledger.html#3474" class="Bound">t</a><a id="3475" class="Symbol">}{</a><a id="3477" href="Shallow.Ledger.html#3477" class="Bound">t′</a> <a id="3480" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3482" href="Shallow.Ledger.html#3482" class="Bound">l</a><a id="3483" class="Symbol">}{</a><a id="3485" href="Shallow.Ledger.html#3485" class="Bound">s</a><a id="3486" class="Symbol">}</a>
  <a id="3490" class="Keyword">rewrite</a> <a id="3498" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="3502" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3504" href="Shallow.Ledger.html#3378" class="Function">denot-comm</a> <a id="3515" class="Symbol">{</a><a id="3516" href="Shallow.Ledger.html#3477" class="Bound">t′</a><a id="3518" class="Symbol">}{</a><a id="3520" href="Shallow.Ledger.html#3482" class="Bound">l</a><a id="3521" class="Symbol">}{</a><a id="3523" href="Shallow.Ledger.html#3485" class="Bound">s</a><a id="3524" class="Symbol">}</a>
        <a id="3534" class="Symbol">|</a> <a id="3536" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="3540" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3542" href="Shallow.Ledger.html#3378" class="Function">denot-comm</a> <a id="3553" class="Symbol">{</a><a id="3554" href="Shallow.Ledger.html#3477" class="Bound">t′</a><a id="3556" class="Symbol">}{</a><a id="3558" href="Shallow.Ledger.html#3482" class="Bound">l</a><a id="3559" class="Symbol">}{</a><a id="3561" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3563" href="Shallow.Ledger.html#3474" class="Bound">t</a> <a id="3565" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="3567" href="Shallow.Ledger.html#3485" class="Bound">s</a><a id="3568" class="Symbol">}</a>
        <a id="3578" class="Symbol">|</a> <a id="3580" href="Shallow.Ledger.html#3279" class="Postulate">⟦⟧-comm</a> <a id="3588" class="Symbol">{</a><a id="3589" href="Shallow.Ledger.html#3474" class="Bound">t</a><a id="3590" class="Symbol">}{</a><a id="3592" href="Shallow.Ledger.html#3477" class="Bound">t′</a><a id="3594" class="Symbol">}{</a><a id="3596" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3598" href="Shallow.Ledger.html#3482" class="Bound">l</a> <a id="3600" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="3602" href="Shallow.Ledger.html#3485" class="Bound">s</a><a id="3603" class="Symbol">}</a>
        <a id="3613" class="Symbol">|</a> <a id="3615" href="Shallow.Ledger.html#3378" class="Function">denot-comm</a> <a id="3626" class="Symbol">{</a><a id="3627" href="Shallow.Ledger.html#3474" class="Bound">t</a><a id="3628" class="Symbol">}{</a><a id="3630" href="Shallow.Ledger.html#3482" class="Bound">l</a><a id="3631" class="Symbol">}{</a><a id="3633" href="Shallow.Ledger.html#3485" class="Bound">s</a><a id="3634" class="Symbol">}</a>
        <a id="3644" class="Symbol">|</a> <a id="3646" href="Shallow.Ledger.html#3378" class="Function">denot-comm</a> <a id="3657" class="Symbol">{</a><a id="3658" href="Shallow.Ledger.html#3474" class="Bound">t</a><a id="3659" class="Symbol">}{</a><a id="3661" href="Shallow.Ledger.html#3482" class="Bound">l</a><a id="3662" class="Symbol">}{</a><a id="3664" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3666" href="Shallow.Ledger.html#3477" class="Bound">t′</a> <a id="3669" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a> <a id="3671" href="Shallow.Ledger.html#3485" class="Bound">s</a><a id="3672" class="Symbol">}</a>
        <a id="3682" class="Symbol">=</a> <a id="3684" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="3690" class="Comment">-- equivalences</a>
<a id="axiom⇔denot"></a><a id="3706" href="Shallow.Ledger.html#3706" class="Function">axiom⇔denot</a> <a id="3718" class="Symbol">:</a> <a id="3720" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3722" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="3724" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="3726" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3728" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3730" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="3732" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="3734" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="3736" class="Symbol">(</a><a id="3737" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="3739" href="Prelude.General.html#1680" class="Function Operator">⊢</a> <a id="3741" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="3743" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3745" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3747" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3749" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="3750" class="Symbol">)</a>
<a id="3752" href="Shallow.Ledger.html#3706" class="Function">axiom⇔denot</a> <a id="3764" class="Symbol">=</a> <a id="3766" href="Shallow.Ledger.html#3804" class="Function">axiom→denot</a> <a id="3778" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3780" href="Shallow.Ledger.html#4063" class="Function">denot→axiom</a>
  <a id="3794" class="Keyword">where</a>
    <a id="3804" href="Shallow.Ledger.html#3804" class="Function">axiom→denot</a> <a id="3816" class="Symbol">:</a> <a id="3818" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3820" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="3822" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="3824" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3826" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="3828" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="3830" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="3832" class="Symbol">→</a> <a id="3834" class="Symbol">(</a><a id="3835" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="3837" href="Prelude.General.html#1680" class="Function Operator">⊢</a> <a id="3839" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="3841" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3843" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="3845" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="3847" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="3848" class="Symbol">)</a>
    <a id="3854" href="Shallow.Ledger.html#3804" class="Function">axiom→denot</a> <a id="3866" href="Shallow.Ledger.html#2714" class="InductiveConstructor">base</a>                              <a id="3900" href="Shallow.Ledger.html#3900" class="Bound">Ps</a> <a id="3903" class="Symbol">=</a> <a id="3905" href="Shallow.Ledger.html#3900" class="Bound">Ps</a>
    <a id="3912" href="Shallow.Ledger.html#3804" class="Function">axiom→denot</a> <a id="3924" class="Symbol">(</a><a id="3925" href="Shallow.Ledger.html#2828" class="InductiveConstructor">step</a> <a id="3930" href="Shallow.Ledger.html#3930" class="Bound">PlQ</a><a id="3933" class="Symbol">)</a>                        <a id="3958" class="Symbol">=</a> <a id="3960" href="Shallow.Ledger.html#3804" class="Function">axiom→denot</a> <a id="3972" href="Shallow.Ledger.html#3930" class="Bound">PlQ</a>
    <a id="3980" href="Shallow.Ledger.html#3804" class="Function">axiom→denot</a> <a id="3992" class="Symbol">(</a><a id="3993" href="Shallow.Ledger.html#3028" class="InductiveConstructor">weaken-strengthen</a> <a id="4011" href="Shallow.Ledger.html#4011" class="Bound">P⊢P′</a> <a id="4016" href="Shallow.Ledger.html#4016" class="Bound">Q′⊢Q</a> <a id="4021" href="Shallow.Ledger.html#4021" class="Bound">PlQ</a><a id="4024" class="Symbol">)</a> <a id="4026" class="Symbol">=</a> <a id="4028" href="Shallow.Ledger.html#4016" class="Bound">Q′⊢Q</a> <a id="4033" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4035" href="Shallow.Ledger.html#3804" class="Function">axiom→denot</a> <a id="4047" href="Shallow.Ledger.html#4021" class="Bound">PlQ</a> <a id="4051" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4053" href="Shallow.Ledger.html#4011" class="Bound">P⊢P′</a>

    <a id="4063" href="Shallow.Ledger.html#4063" class="Function">denot→axiom</a> <a id="4075" class="Symbol">:</a> <a id="4077" class="Symbol">(</a><a id="4078" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="4080" href="Prelude.General.html#1680" class="Function Operator">⊢</a> <a id="4082" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="4084" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4086" href="Shallow.Ledger.html#699" class="Field Operator">⟦</a> <a id="4088" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="4090" href="Shallow.Ledger.html#699" class="Field Operator">⟧</a><a id="4091" class="Symbol">)</a> <a id="4093" class="Symbol">→</a> <a id="4095" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="4097" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="4099" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="4101" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="4103" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="4105" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="4107" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a>
    <a id="4113" href="Shallow.Ledger.html#4063" class="Function">denot→axiom</a> <a id="4125" class="Symbol">{</a><a id="4126" class="Argument">l</a> <a id="4128" class="Symbol">=</a> <a id="4130" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4132" class="Symbol">}</a>    <a id="4137" href="Shallow.Ledger.html#4137" class="Bound">H</a> <a id="4139" class="Symbol">=</a> <a id="4141" href="Shallow.Ledger.html#3028" class="InductiveConstructor">weaken-strengthen</a> <a id="4159" class="Symbol">(λ</a> <a id="4162" href="Shallow.Ledger.html#4162" class="Bound">x</a> <a id="4164" class="Symbol">→</a> <a id="4166" href="Shallow.Ledger.html#4162" class="Bound">x</a><a id="4167" class="Symbol">)</a> <a id="4169" href="Shallow.Ledger.html#4137" class="Bound">H</a> <a id="4171" href="Shallow.Ledger.html#2714" class="InductiveConstructor">base</a>
    <a id="4180" href="Shallow.Ledger.html#4063" class="Function">denot→axiom</a> <a id="4192" class="Symbol">{</a><a id="4193" class="Argument">l</a> <a id="4195" class="Symbol">=</a> <a id="4197" class="Symbol">_</a> <a id="4199" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4201" class="Symbol">_}</a> <a id="4204" href="Shallow.Ledger.html#4204" class="Bound">H</a> <a id="4206" class="Symbol">=</a> <a id="4208" href="Shallow.Ledger.html#3028" class="InductiveConstructor">weaken-strengthen</a> <a id="4226" href="Shallow.Ledger.html#4204" class="Bound">H</a> <a id="4228" class="Symbol">(λ</a> <a id="4231" href="Shallow.Ledger.html#4231" class="Bound">x</a> <a id="4233" class="Symbol">→</a> <a id="4235" href="Shallow.Ledger.html#4231" class="Bound">x</a><a id="4236" class="Symbol">)</a> <a id="4238" href="Shallow.Ledger.html#3156" class="Function">axiom-base⋆</a>

<a id="axiom⇔oper"></a><a id="4251" href="Shallow.Ledger.html#4251" class="Function">axiom⇔oper</a> <a id="4262" class="Symbol">:</a> <a id="4264" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="4266" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="4268" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="4270" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="4272" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟨</a> <a id="4274" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="4276" href="Shallow.Ledger.html#2670" class="Datatype Operator">⟩</a> <a id="4278" href="Prelude.General.html#618" class="Function Operator">⇔</a> <a id="4280" class="Symbol">(∀</a> <a id="4283" class="Symbol">{</a><a id="4284" href="Shallow.Ledger.html#4284" class="Bound">s</a> <a id="4286" href="Shallow.Ledger.html#4286" class="Bound">s′</a><a id="4288" class="Symbol">}</a> <a id="4290" class="Symbol">→</a> <a id="4292" href="Shallow.Ledger.html#2632" class="Generalizable">P</a> <a id="4294" href="Shallow.Ledger.html#4284" class="Bound">s</a> <a id="4296" class="Symbol">→</a> <a id="4298" href="Shallow.Ledger.html#568" class="Generalizable">l</a> <a id="4300" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4302" href="Shallow.Ledger.html#4284" class="Bound">s</a> <a id="4304" href="Shallow.Ledger.html#1717" class="Function Operator">—→⋆′</a> <a id="4309" href="Shallow.Ledger.html#4286" class="Bound">s′</a> <a id="4312" class="Symbol">→</a> <a id="4314" href="Shallow.Ledger.html#2643" class="Generalizable">Q</a> <a id="4316" href="Shallow.Ledger.html#4286" class="Bound">s′</a><a id="4318" class="Symbol">)</a>
<a id="4320" href="Shallow.Ledger.html#4251" class="Function">axiom⇔oper</a> <a id="4331" class="Symbol">=</a> <a id="4333" class="Symbol">(λ{</a> <a id="4337" href="Shallow.Ledger.html#4337" class="Bound">P⊢</a> <a id="4340" href="Shallow.Ledger.html#4340" class="Bound">Ps</a> <a id="4343" href="Shallow.Ledger.html#4343" class="Bound">s→s′</a> <a id="4348" class="Symbol">→</a> <a id="4350" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="4356" class="Symbol">_</a> <a id="4358" class="Symbol">(</a><a id="4359" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="4365" href="Shallow.Ledger.html#2160" class="Function">denot⇔oper</a> <a id="4376" href="Shallow.Ledger.html#4343" class="Bound">s→s′</a><a id="4380" class="Symbol">)</a> <a id="4382" class="Symbol">(</a><a id="4383" href="Shallow.Ledger.html#4337" class="Bound">P⊢</a> <a id="4386" href="Shallow.Ledger.html#4340" class="Bound">Ps</a><a id="4388" class="Symbol">)</a> <a id="4390" class="Comment">{-P⊢ Ps-}</a><a id="4399" class="Symbol">})</a> <a id="4402" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4404" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="4410" href="Shallow.Ledger.html#3706" class="Function">axiom⇔denot</a>
           <a id="4433" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4435" class="Symbol">λ</a> <a id="4437" href="Shallow.Ledger.html#4437" class="Bound">H</a> <a id="4439" class="Symbol">→</a> <a id="4441" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="4447" href="Shallow.Ledger.html#3706" class="Function">axiom⇔denot</a> <a id="4459" class="Symbol">λ</a> <a id="4461" href="Shallow.Ledger.html#4461" class="Bound">Ps</a> <a id="4464" class="Symbol">→</a> <a id="4466" href="Shallow.Ledger.html#4437" class="Bound">H</a> <a id="4468" href="Shallow.Ledger.html#4461" class="Bound">Ps</a> <a id="4471" href="Shallow.Ledger.html#1998" class="Function">oper-base⋆</a>
<a id="4482" class="Comment">-- axiom⇔oper = axiom→oper , oper→axiom</a>
<a id="4522" class="Comment">--   where</a>
<a id="4533" class="Comment">--     axiom→oper : ⟨ P ⟩ l ⟨ Q ⟩ → (∀ {s s′} → P s → l , s —→⋆′ s′ → Q s′)</a>
<a id="4609" class="Comment">--     axiom→oper base                              Ps base                   = Ps</a>
<a id="4692" class="Comment">--     axiom→oper (step PlQ)                        Ps (step singleStep s→s′) = axiom→oper PlQ Ps s→s′</a>
<a id="4795" class="Comment">--     axiom→oper (weaken-strengthen P⊢P′ Q′⊢Q PlQ) Ps s→s′                   = Q′⊢Q $ axiom→oper PlQ (P⊢P′ Ps) s→s′</a>

<a id="4913" class="Comment">--     oper→axiom : (∀ {s s′} → P s → l , s —→⋆′ s′ → Q s′) → ⟨ P ⟩ l ⟨ Q ⟩</a>
<a id="4989" class="Comment">--     oper→axiom {l = []}    H = weaken-strengthen (λ x → x) (flip H base) base</a>
<a id="5070" class="Comment">--     oper→axiom {l = _ ∷ _} H = weaken-strengthen (λ Ps → H Ps oper-base⋆) (λ x → x) axiom-base⋆</a>

<a id="5170" class="Comment">-- ** Separation logic</a>

<a id="mod"></a><a id="5194" href="Shallow.Ledger.html#5194" class="Function">mod</a> <a id="5198" class="Symbol">:</a> <a id="5200" href="Shallow.Ledger.html#515" class="Function">L</a> <a id="5202" class="Symbol">→</a> <a id="5204" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="5209" href="Shallow.Ledger.html#202" class="Bound">Part</a> <a id="5214" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>
<a id="5216" href="Shallow.Ledger.html#5194" class="Function">mod</a> <a id="5220" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="5223" class="Symbol">=</a> <a id="5225" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a>
<a id="5227" href="Shallow.Ledger.html#5194" class="Function">mod</a> <a id="5231" class="Symbol">(</a><a id="5232" href="Shallow.Ledger.html#5232" class="Bound">p₁</a> <a id="5235" href="Shallow.Ledger.html#445" class="InductiveConstructor Operator">—→⟨</a> <a id="5239" class="Symbol">_</a> <a id="5241" href="Shallow.Ledger.html#445" class="InductiveConstructor Operator">⟩</a> <a id="5243" href="Shallow.Ledger.html#5243" class="Bound">p₂</a> <a id="5246" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5248" href="Shallow.Ledger.html#5248" class="Bound">l</a><a id="5249" class="Symbol">)</a> <a id="5251" class="Symbol">=</a> <a id="5253" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="5263" href="Shallow.Ledger.html#5232" class="Bound">p₁</a> <a id="5266" href="Prelude.Sets.AsUniqueLists.Core.html#2841" class="Function Operator">∪</a> <a id="5268" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="5278" href="Shallow.Ledger.html#5243" class="Bound">p₂</a> <a id="5281" href="Prelude.Sets.AsUniqueLists.Core.html#2841" class="Function Operator">∪</a> <a id="5283" href="Shallow.Ledger.html#5194" class="Function">mod</a> <a id="5287" href="Shallow.Ledger.html#5248" class="Bound">l</a>

<a id="■_"></a><a id="5290" href="Shallow.Ledger.html#5290" class="Function Operator">■_</a> <a id="5293" class="Symbol">:</a> <a id="5295" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="5299" class="Symbol">→</a> <a id="5301" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a>
<a id="5307" href="Shallow.Ledger.html#5290" class="Function Operator">■_</a> <a id="5310" class="Symbol">=</a> <a id="5312" href="Function.Base.html#636" class="Function">const</a>

<a id="_↦_"></a><a id="5319" href="Shallow.Ledger.html#5319" class="Function Operator">_↦_</a> <a id="5323" class="Symbol">:</a> <a id="5325" href="Shallow.Ledger.html#202" class="Bound">Part</a> <a id="5330" class="Symbol">→</a> <a id="5332" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="5334" class="Symbol">→</a> <a id="5336" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a>
<a id="5342" class="Symbol">(</a><a id="5343" href="Shallow.Ledger.html#5343" class="Bound">p</a> <a id="5345" href="Shallow.Ledger.html#5319" class="Function Operator">↦</a> <a id="5347" href="Shallow.Ledger.html#5347" class="Bound">z</a><a id="5348" class="Symbol">)</a> <a id="5350" href="Shallow.Ledger.html#5350" class="Bound">s</a> <a id="5352" class="Symbol">=</a> <a id="5354" href="Shallow.Ledger.html#5350" class="Bound">s</a> <a id="5356" href="Shallow.Ledger.html#5343" class="Bound">p</a> <a id="5358" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5360" href="Shallow.Ledger.html#5347" class="Bound">z</a>

<a id="_`∧_"></a><a id="5363" href="Shallow.Ledger.html#5363" class="Function Operator">_`∧_</a> <a id="5368" class="Symbol">:</a> <a id="5370" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a> <a id="5376" class="Symbol">→</a> <a id="5378" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a> <a id="5384" class="Symbol">→</a> <a id="5386" href="Shallow.Ledger.html#2602" class="Function">Predˢ</a>
<a id="5392" class="Symbol">(</a><a id="5393" href="Shallow.Ledger.html#5393" class="Bound">P</a> <a id="5395" href="Shallow.Ledger.html#5363" class="Function Operator">`∧</a> <a id="5398" href="Shallow.Ledger.html#5398" class="Bound">Q</a><a id="5399" class="Symbol">)</a> <a id="5401" href="Shallow.Ledger.html#5401" class="Bound">s</a> <a id="5403" class="Symbol">=</a> <a id="5405" href="Shallow.Ledger.html#5393" class="Bound">P</a> <a id="5407" href="Shallow.Ledger.html#5401" class="Bound">s</a> <a id="5409" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5411" href="Shallow.Ledger.html#5398" class="Bound">Q</a> <a id="5413" href="Shallow.Ledger.html#5401" class="Bound">s</a>

<a id="5416" class="Comment">-- _♯_←_ : S → S → S → Set</a>
<a id="5443" class="Comment">-- s₁ ♯ s₂ ← s = {!!}</a>
<a id="5465" class="Comment">-- (s₁ ♯ s₂) × (s ≡ union s₁ s₂)</a>
<a id="5498" class="Comment">-- [STUCK] cannot express this using *shallow* Agda functions, need *deep* finite maps</a>

<a id="5586" class="Comment">-- inference rules</a>

<a id="5606" class="Comment">{-
[SEP-COMM] : P ∗ Q ⊣⊢ Q ∗ P
[SEP-COMM] = {!!} , {!!}

[SEP-ASSOC] : P ∗ (Q ∗ R) ⊣⊢ (P ∗ Q) ∗ R
[SEP-ASSOC] = {!!} , {!!}

[SEP-MONO] :
     P₁ ⊢ Q₁
   → P₂ ⊢ Q₂
     -----------------
   → P₁ ∗ P₂ ⊢ Q₁ ∗ Q₂
[SEP-MONO] P₁⊢Q₁ P₂⊢Q₂ = {!!}
-}</a>

<a id="5850" class="Comment">{-
postulate
  fv : Assertion → Set⟨ Part ⟩

[FRAME] :
    ⟨ P ⟩ l ⟨ Q ⟩
  → mod l ∩ fv R ≡ ∅
    -------------------------
  → ⟨ P ∗ R ⟩ l ⟨ Q ∗ R ⟩
-}</a>

<a id="6004" class="Comment">-- ** Concurrent separation logic</a>
<a id="6038" class="Comment">{-
[INTERLEAVE]
    Interleaving l l′ l″
  → ⟨ P ⟩ l ⟨ Q ⟩
  → ⟨ P ⟩ l′ ⟨ Q ⟩
  → mod l ∩ mod l′ ≡ ∅
    ------------------------
  → ⟨ P ∗ P′ ⟩ l″ ⟨ Q ∗ Q′ ⟩
-}</a>
</pre></body></html>