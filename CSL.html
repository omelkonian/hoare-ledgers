<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>CSL</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Keyword">open</a> <a id="45" class="Keyword">import</a> <a id="52" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="65" class="Keyword">open</a> <a id="70" class="Keyword">import</a> <a id="77" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Prelude.Set%2527.html" class="Module">Prelude.Set&#39;</a>

<a id="117" class="Keyword">module</a> <a id="124" href="CSL.html" class="Module">CSL</a> <a id="128" class="Symbol">(</a><a id="129" href="CSL.html#129" class="Bound">Part</a> <a id="134" class="Symbol">:</a> <a id="136" class="PrimitiveType">Set</a><a id="139" class="Symbol">)</a> <a id="141" class="Symbol">{{</a><a id="143" href="CSL.html#143" class="Bound">_</a> <a id="145" class="Symbol">:</a> <a id="147" href="Prelude.DecEq.html#550" class="Record">DecEq</a> <a id="153" href="CSL.html#129" class="Bound">Part</a><a id="157" class="Symbol">}}</a> <a id="160" class="Keyword">where</a>

<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Ledger.html" class="Module">Ledger</a> <a id="186" href="CSL.html#129" class="Bound">Part</a>
<a id="191" class="Keyword">open</a> <a id="196" class="Keyword">import</a> <a id="203" href="HoareLogic.html" class="Module">HoareLogic</a> <a id="214" href="CSL.html#129" class="Bound">Part</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="SL.html" class="Module">SL</a> <a id="234" href="CSL.html#129" class="Bound">Part</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Dec.html" class="Module">Dec</a> <a id="255" href="CSL.html#129" class="Bound">Part</a>

<a id="261" class="Comment">-- ** Concurrent separation logic</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Data.List.Relation.Ternary.Interleaving.html" class="Module">Data.List.Relation.Ternary.Interleaving</a>
<a id="_∥_≡_"></a><a id="347" href="CSL.html#347" class="Function Operator">_∥_≡_</a> <a id="353" class="Symbol">:</a> <a id="355" href="Ledger.html#923" class="Function">L</a> <a id="357" class="Symbol">→</a> <a id="359" href="Ledger.html#923" class="Function">L</a> <a id="361" class="Symbol">→</a> <a id="363" href="Ledger.html#923" class="Function">L</a> <a id="365" class="Symbol">→</a> <a id="367" class="PrimitiveType">Set</a>
<a id="371" href="CSL.html#371" class="Bound">l₁</a> <a id="374" href="CSL.html#347" class="Function Operator">∥</a> <a id="376" href="CSL.html#376" class="Bound">l₂</a> <a id="379" href="CSL.html#347" class="Function Operator">≡</a> <a id="381" href="CSL.html#381" class="Bound">l</a> <a id="383" class="Symbol">=</a> <a id="385" href="Data.List.Relation.Ternary.Interleaving.html#961" class="Datatype">Interleaving</a> <a id="398" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="402" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="406" href="CSL.html#371" class="Bound">l₁</a> <a id="409" href="CSL.html#376" class="Bound">l₂</a> <a id="412" href="CSL.html#381" class="Bound">l</a>

<a id="[INTERLEAVE]"></a><a id="415" href="CSL.html#415" class="Function">[INTERLEAVE]</a> <a id="428" class="Symbol">:</a>
    <a id="434" href="Ledger.html#990" class="Generalizable">l₁</a> <a id="437" href="CSL.html#347" class="Function Operator">∥</a> <a id="439" href="Ledger.html#993" class="Generalizable">l₂</a> <a id="442" href="CSL.html#347" class="Function Operator">≡</a> <a id="444" href="Ledger.html#982" class="Generalizable">l</a>
  <a id="448" class="Symbol">→</a> <a id="450" href="HoareLogic.html#1547" class="Datatype Operator">⟨</a> <a id="452" href="HoareLogic.html#1510" class="Generalizable">P₁</a> <a id="455" href="HoareLogic.html#1547" class="Datatype Operator">⟩</a> <a id="457" href="Ledger.html#990" class="Generalizable">l₁</a> <a id="460" href="HoareLogic.html#1547" class="Datatype Operator">⟨</a> <a id="462" href="HoareLogic.html#1521" class="Generalizable">Q₁</a> <a id="465" href="HoareLogic.html#1547" class="Datatype Operator">⟩</a>
  <a id="469" class="Symbol">→</a> <a id="471" href="HoareLogic.html#1547" class="Datatype Operator">⟨</a> <a id="473" href="HoareLogic.html#1513" class="Generalizable">P₂</a> <a id="476" href="HoareLogic.html#1547" class="Datatype Operator">⟩</a> <a id="478" href="Ledger.html#993" class="Generalizable">l₂</a> <a id="481" href="HoareLogic.html#1547" class="Datatype Operator">⟨</a> <a id="483" href="HoareLogic.html#1524" class="Generalizable">Q₂</a> <a id="486" href="HoareLogic.html#1547" class="Datatype Operator">⟩</a>
  <a id="490" class="Symbol">→</a> <a id="492" href="Dec.html#252" class="Function">mods</a> <a id="497" href="Ledger.html#990" class="Generalizable">l₁</a> <a id="500" href="Prelude.Set%2527.html#2644" class="Function Operator">♯</a> <a id="502" href="Dec.html#252" class="Function">mods</a> <a id="507" href="Ledger.html#993" class="Generalizable">l₂</a>
  <a id="512" class="Comment">-- → fv P₁ ∪ fv Q₁ S.♯ mod l₂</a>
  <a id="544" class="Comment">-- → fv P₂ ∪ fv Q₂ S.♯ mod l₁</a>
    <a id="578" class="Comment">---------------------------</a>
  <a id="608" class="Symbol">→</a> <a id="610" href="HoareLogic.html#1547" class="Datatype Operator">⟨</a> <a id="612" href="HoareLogic.html#1510" class="Generalizable">P₁</a> <a id="615" href="HoareLogic.html#935" class="InductiveConstructor Operator">`∗</a> <a id="618" href="HoareLogic.html#1513" class="Generalizable">P₂</a> <a id="621" href="HoareLogic.html#1547" class="Datatype Operator">⟩</a> <a id="623" href="Ledger.html#982" class="Generalizable">l</a> <a id="625" href="HoareLogic.html#1547" class="Datatype Operator">⟨</a> <a id="627" href="HoareLogic.html#1521" class="Generalizable">Q₁</a> <a id="630" href="HoareLogic.html#935" class="InductiveConstructor Operator">`∗</a> <a id="633" href="HoareLogic.html#1524" class="Generalizable">Q₂</a> <a id="636" href="HoareLogic.html#1547" class="Datatype Operator">⟩</a>
<a id="638" href="CSL.html#415" class="Function">[INTERLEAVE]</a> <a id="651" class="Symbol">=</a> <a id="653" class="Symbol">{!!}</a>

<a id="659" class="Comment">-- h :</a>
<a id="666" class="Comment">--     s₁ ♯ s₂ ← s</a>
<a id="685" class="Comment">--   → l₁ ∥ l₂ ← l</a>
<a id="704" class="Comment">--   → mod l₁ S.♯ mod l₂</a>
<a id="729" class="Comment">--     -------------------------------</a>
<a id="768" class="Comment">--   → ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂ ← ⟦ l ⟧ s</a>
<a id="807" class="Comment">-- h {s₁}{s₂}{s}{l₁}{l₂}{l} s₁♯s₂ l₁∥l₂ l₁♯l₂ = h₁ , h₂</a>
<a id="863" class="Comment">--   where</a>
<a id="874" class="Comment">--     ps₁ = proj₁ (⟦ l₁ ⟧ s₁)</a>
<a id="905" class="Comment">--     ps₂ = proj₁ (⟦ l₂ ⟧ s₂)</a>

<a id="937" class="Comment">--     All∉ : All (_∉′ ps₂) (list ps₁)</a>
<a id="976" class="Comment">--     All∉ = {!!}</a>

<a id="996" class="Comment">--     h₁ : ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂</a>
<a id="1030" class="Comment">--     h₁ = let p = L.filter-none (_∈′? ps₂) {xs = list ps₁} All∉ in {!!} -- subst _ p refl</a>

<a id="1123" class="Comment">--     h₂ : ⟦ l ⟧ s ≡ᵐ union (⟦ l₁ ⟧ s₁) (⟦ l₂ ⟧ s₂)</a>
<a id="1176" class="Comment">--     h₂ = {!!}</a>

<a id="1194" class="Comment">-- [INTERLEAVE] :</a>
<a id="1212" class="Comment">--     l₁ ∥ l₂ ← l</a>
<a id="1231" class="Comment">--   → ⟨ P₁ ⟩ l₁ ⟨ Q₁ ⟩</a>
<a id="1255" class="Comment">--   → ⟨ P₂ ⟩ l₂ ⟨ Q₂ ⟩</a>
<a id="1279" class="Comment">--   → mod l₁ S.♯ mod l₂</a>
<a id="1304" class="Comment">--   -- → fv P₁ ∪ fv Q₁ S.♯ mod l₂</a>
<a id="1339" class="Comment">--   -- → fv P₂ ∪ fv Q₂ S.♯ mod l₁</a>
<a id="1374" class="Comment">--     ---------------------------</a>
<a id="1409" class="Comment">--   → ⟨ P₁ `∗ P₂ ⟩ l ⟨ Q₁ `∗ Q₂ ⟩</a>

<a id="1445" class="Comment">-- [INTERLEAVE] {l₁}{l₂}{l}{P₁}{Q₁}{P₂}{Q₂} l₁∥l₂ PlQ PlQ′ l₁♯l₂ = proj₂ axiom⇔denot d</a>
<a id="1532" class="Comment">--   where</a>
<a id="1543" class="Comment">--     d : (P₁ `∗ P₂) `⊢ (Q₁ `∗ Q₂) `∘ ⟦ l ⟧</a>
<a id="1588" class="Comment">--     d {s} (s₁ , s₂ , s₁♯s₂ , Ps₁ , Ps₂) = _ , _ , q , q₁ , q₂</a>
<a id="1653" class="Comment">--       where</a>
<a id="1668" class="Comment">--         q₁ : Q₁ ∙ ⟦ l₁ ⟧ s₁</a>
<a id="1699" class="Comment">--         q₁ = proj₁ axiom⇔denot PlQ Ps₁</a>

<a id="1742" class="Comment">--         q₂ : Q₂ ∙ ⟦ l₂ ⟧ s₂</a>
<a id="1773" class="Comment">--         q₂ = proj₁ axiom⇔denot PlQ′ Ps₂</a>

<a id="1817" class="Comment">--         q : ⟦ l₁ ⟧ s₁ ♯ ⟦ l₂ ⟧ s₂ ← ⟦ l ⟧ s</a>
<a id="1864" class="Comment">--         q = {!!} -- h s₁♯s₂ l₁∥l₂ l₁♯l₂</a>
<a id="1907" class="Comment">-- -}</a>
</pre></body></html>