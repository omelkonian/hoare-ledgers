<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ValueSepUTxO.UTxO</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">----------------------------------------------</a>
<a id="48" class="Comment">-- ** Abstract definition for UTxO-based ledgers.</a>

<a id="99" class="Keyword">module</a> <a id="106" href="ValueSepUTxO.UTxO.html" class="Module">ValueSepUTxO.UTxO</a> <a id="124" class="Keyword">where</a>

<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="155" class="Symbol">;</a> <a id="157" class="Keyword">open</a> <a id="162" href="Prelude.Init.html#397" class="Module">SetAsType</a>
<a id="172" class="Keyword">open</a> <a id="177" class="Keyword">import</a> <a id="184" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="256" class="Keyword">open</a> <a id="261" class="Keyword">import</a> <a id="268" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="280" class="Keyword">open</a> <a id="285" class="Keyword">import</a> <a id="292" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="335" class="Keyword">open</a> <a id="340" class="Keyword">import</a> <a id="347" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="395" class="Keyword">open</a> <a id="400" class="Keyword">import</a> <a id="407" href="Prelude.FromList.html" class="Module">Prelude.FromList</a>
<a id="424" class="Keyword">open</a> <a id="429" class="Keyword">import</a> <a id="436" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="478" class="Keyword">open</a> <a id="483" class="Keyword">import</a> <a id="490" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>

<a id="506" class="Keyword">open</a> <a id="511" class="Keyword">import</a> <a id="518" href="Prelude.Bags.html" class="Module">Prelude.Bags</a>
<a id="531" class="Keyword">instance</a>
  <a id="Sℕ"></a><a id="542" href="ValueSepUTxO.UTxO.html#542" class="Function">Sℕ</a>  <a id="546" class="Symbol">=</a> <a id="548" href="Prelude.Semigroup.html#2138" class="Function">Semigroup-ℕ-+</a><a id="561" class="Symbol">;</a> <a id="Sℕ⁺"></a><a id="563" href="ValueSepUTxO.UTxO.html#563" class="Function">Sℕ⁺</a> <a id="567" class="Symbol">=</a> <a id="569" href="Prelude.Semigroup.html#2431" class="Function">SemigroupLaws-ℕ-+</a>
  <a id="Mℕ"></a><a id="589" href="ValueSepUTxO.UTxO.html#589" class="Function">Mℕ</a>  <a id="593" class="Symbol">=</a> <a id="595" href="Prelude.Monoid.html#1365" class="Function">Monoid-ℕ-+</a><a id="605" class="Symbol">;</a>    <a id="Mℕ⁺"></a><a id="610" href="ValueSepUTxO.UTxO.html#610" class="Function">Mℕ⁺</a> <a id="614" class="Symbol">=</a> <a id="616" href="Prelude.Monoid.html#1443" class="Function">MonoidLaws-ℕ-+</a>

<a id="Value"></a><a id="632" href="ValueSepUTxO.UTxO.html#632" class="Function">Value</a>   <a id="640" class="Symbol">=</a> <a id="642" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="HashId"></a><a id="644" href="ValueSepUTxO.UTxO.html#644" class="Function">HashId</a>  <a id="652" class="Symbol">=</a> <a id="654" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="Address"></a><a id="656" href="ValueSepUTxO.UTxO.html#656" class="Function">Address</a> <a id="664" class="Symbol">=</a> <a id="666" href="ValueSepUTxO.UTxO.html#644" class="Function">HashId</a>
<a id="673" class="Keyword">postulate</a> <a id="_♯"></a><a id="683" href="ValueSepUTxO.UTxO.html#683" class="Postulate Operator">_♯</a> <a id="686" class="Symbol">:</a> <a id="688" class="Symbol">∀</a> <a id="690" class="Symbol">{</a><a id="691" href="ValueSepUTxO.UTxO.html#691" class="Bound">A</a> <a id="693" class="Symbol">:</a> <a id="695" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="700" href="Prelude.Init.html#238" class="Generalizable">ℓ</a><a id="701" class="Symbol">}</a> <a id="703" class="Symbol">→</a> <a id="705" href="ValueSepUTxO.UTxO.html#691" class="Bound">A</a> <a id="707" class="Symbol">→</a> <a id="709" href="ValueSepUTxO.UTxO.html#644" class="Function">HashId</a>

<a id="DATA"></a><a id="717" href="ValueSepUTxO.UTxO.html#717" class="Function">DATA</a> <a id="722" class="Symbol">=</a> <a id="724" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="726" class="Comment">-- T0D0: more realistic data for redeemers</a>

<a id="770" class="Keyword">record</a> <a id="TxOutput"></a><a id="777" href="ValueSepUTxO.UTxO.html#777" class="Record">TxOutput</a> <a id="786" class="Symbol">:</a> <a id="788" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="793" class="Keyword">where</a>
  <a id="801" class="Keyword">constructor</a> <a id="_at_"></a><a id="813" href="ValueSepUTxO.UTxO.html#813" class="InductiveConstructor Operator">_at_</a>
  <a id="820" class="Keyword">field</a> <a id="TxOutput.value"></a><a id="826" href="ValueSepUTxO.UTxO.html#826" class="Field">value</a>   <a id="834" class="Symbol">:</a> <a id="836" href="ValueSepUTxO.UTxO.html#632" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="850" href="ValueSepUTxO.UTxO.html#850" class="Field">address</a> <a id="858" class="Symbol">:</a> <a id="860" href="ValueSepUTxO.UTxO.html#656" class="Function">Address</a>
<a id="868" class="Keyword">open</a> <a id="873" href="ValueSepUTxO.UTxO.html#777" class="Module">TxOutput</a> <a id="882" class="Keyword">public</a>
<a id="889" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="901" href="ValueSepUTxO.UTxO.html#901" class="Function">DecEq-TxO</a> <a id="911" class="Symbol">=</a> <a id="913" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="920" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="926" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="928" class="Keyword">quote</a> <a id="934" href="ValueSepUTxO.UTxO.html#777" class="Record">TxOutput</a> <a id="943" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="945" href="ValueSepUTxO.UTxO.html#901" class="Function">DecEq-TxO</a> <a id="955" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="TxOutputRef"></a><a id="958" href="ValueSepUTxO.UTxO.html#958" class="Function">TxOutputRef</a> <a id="970" class="Symbol">:</a> <a id="972" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="977" href="ValueSepUTxO.UTxO.html#958" class="Function">TxOutputRef</a> <a id="989" class="Symbol">=</a> <a id="991" href="ValueSepUTxO.UTxO.html#644" class="Function">HashId</a>

<a id="999" class="Keyword">record</a> <a id="InputInfo"></a><a id="1006" href="ValueSepUTxO.UTxO.html#1006" class="Record">InputInfo</a> <a id="1016" class="Symbol">:</a> <a id="1018" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1023" class="Keyword">where</a>
  <a id="1031" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="1037" href="ValueSepUTxO.UTxO.html#1037" class="Field">outputRef</a>     <a id="1051" class="Symbol">:</a> <a id="1053" href="ValueSepUTxO.UTxO.html#958" class="Function">TxOutputRef</a>
        <a id="InputInfo.validatorHash"></a><a id="1073" href="ValueSepUTxO.UTxO.html#1073" class="Field">validatorHash</a> <a id="1087" class="Symbol">:</a> <a id="1089" href="ValueSepUTxO.UTxO.html#644" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="1104" href="ValueSepUTxO.UTxO.html#1104" class="Field">redeemerHash</a>  <a id="1118" class="Symbol">:</a> <a id="1120" href="ValueSepUTxO.UTxO.html#644" class="Function">HashId</a>
<a id="1127" class="Keyword">unquoteDecl</a> <a id="DecEq-InputInfo"></a><a id="1139" href="ValueSepUTxO.UTxO.html#1139" class="Function">DecEq-InputInfo</a> <a id="1155" class="Symbol">=</a> <a id="1157" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="1164" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="1170" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1172" class="Keyword">quote</a> <a id="1178" href="ValueSepUTxO.UTxO.html#1006" class="Record">InputInfo</a> <a id="1188" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1190" href="ValueSepUTxO.UTxO.html#1139" class="Function">DecEq-InputInfo</a> <a id="1206" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="1209" class="Keyword">record</a> <a id="TxInfo"></a><a id="1216" href="ValueSepUTxO.UTxO.html#1216" class="Record">TxInfo</a> <a id="1223" class="Symbol">:</a> <a id="1225" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1230" class="Keyword">where</a>
  <a id="1238" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="1244" href="ValueSepUTxO.UTxO.html#1244" class="Field">inputs</a>  <a id="1252" class="Symbol">:</a> <a id="1254" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1259" href="ValueSepUTxO.UTxO.html#1006" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="1277" href="ValueSepUTxO.UTxO.html#1277" class="Field">outputs</a> <a id="1285" class="Symbol">:</a> <a id="1287" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1292" href="ValueSepUTxO.UTxO.html#777" class="Record">TxOutput</a>
        <a id="TxInfo.forge"></a><a id="1309" href="ValueSepUTxO.UTxO.html#1309" class="Field">forge</a>   <a id="1317" class="Symbol">:</a> <a id="1319" href="ValueSepUTxO.UTxO.html#632" class="Function">Value</a>
<a id="1325" class="Keyword">unquoteDecl</a> <a id="DecEq-TxInfo"></a><a id="1337" href="ValueSepUTxO.UTxO.html#1337" class="Function">DecEq-TxInfo</a> <a id="1350" class="Symbol">=</a> <a id="1352" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="1359" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="1365" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1367" class="Keyword">quote</a> <a id="1373" href="ValueSepUTxO.UTxO.html#1216" class="Record">TxInfo</a> <a id="1380" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1382" href="ValueSepUTxO.UTxO.html#1337" class="Function">DecEq-TxInfo</a> <a id="1395" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="1398" class="Keyword">record</a> <a id="TxInput"></a><a id="1405" href="ValueSepUTxO.UTxO.html#1405" class="Record">TxInput</a> <a id="1413" class="Symbol">:</a> <a id="1415" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1420" class="Keyword">where</a>
  <a id="1428" class="Keyword">field</a> <a id="TxInput.outputRef"></a><a id="1434" href="ValueSepUTxO.UTxO.html#1434" class="Field">outputRef</a> <a id="1444" class="Symbol">:</a> <a id="1446" href="ValueSepUTxO.UTxO.html#777" class="Record">TxOutput</a>
        <a id="TxInput.validator"></a><a id="1463" href="ValueSepUTxO.UTxO.html#1463" class="Field">validator</a> <a id="1473" class="Symbol">:</a> <a id="1475" href="ValueSepUTxO.UTxO.html#1216" class="Record">TxInfo</a> <a id="1482" class="Symbol">→</a> <a id="1484" href="ValueSepUTxO.UTxO.html#717" class="Function">DATA</a> <a id="1489" class="Symbol">→</a> <a id="1491" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
        <a id="TxInput.redeemer"></a><a id="1504" href="ValueSepUTxO.UTxO.html#1504" class="Field">redeemer</a>  <a id="1514" class="Symbol">:</a> <a id="1516" href="ValueSepUTxO.UTxO.html#717" class="Function">DATA</a>
<a id="1521" class="Keyword">open</a> <a id="1526" href="ValueSepUTxO.UTxO.html#1405" class="Module">TxInput</a> <a id="1534" class="Keyword">public</a>

<a id="mkInputInfo"></a><a id="1542" href="ValueSepUTxO.UTxO.html#1542" class="Function">mkInputInfo</a> <a id="1554" class="Symbol">:</a> <a id="1556" href="ValueSepUTxO.UTxO.html#1405" class="Record">TxInput</a> <a id="1564" class="Symbol">→</a> <a id="1566" href="ValueSepUTxO.UTxO.html#1006" class="Record">InputInfo</a>
<a id="1576" href="ValueSepUTxO.UTxO.html#1542" class="Function">mkInputInfo</a> <a id="1588" href="ValueSepUTxO.UTxO.html#1588" class="Bound">i</a> <a id="1590" class="Symbol">=</a> <a id="1592" class="Keyword">record</a>
  <a id="1601" class="Symbol">{</a> <a id="1603" href="ValueSepUTxO.UTxO.html#1037" class="Field">outputRef</a>     <a id="1617" class="Symbol">=</a> <a id="1619" href="ValueSepUTxO.UTxO.html#1588" class="Bound">i</a> <a id="1621" class="Symbol">.</a><a id="1622" href="ValueSepUTxO.UTxO.html#1434" class="Field">outputRef</a> <a id="1632" href="ValueSepUTxO.UTxO.html#683" class="Postulate Operator">♯</a>
  <a id="1636" class="Symbol">;</a> <a id="1638" href="ValueSepUTxO.UTxO.html#1073" class="Field">validatorHash</a> <a id="1652" class="Symbol">=</a> <a id="1654" href="ValueSepUTxO.UTxO.html#1588" class="Bound">i</a> <a id="1656" class="Symbol">.</a><a id="1657" href="ValueSepUTxO.UTxO.html#1463" class="Field">validator</a> <a id="1667" href="ValueSepUTxO.UTxO.html#683" class="Postulate Operator">♯</a>
  <a id="1671" class="Symbol">;</a> <a id="1673" href="ValueSepUTxO.UTxO.html#1104" class="Field">redeemerHash</a>  <a id="1687" class="Symbol">=</a> <a id="1689" href="ValueSepUTxO.UTxO.html#1588" class="Bound">i</a> <a id="1691" class="Symbol">.</a><a id="1692" href="ValueSepUTxO.UTxO.html#1504" class="Field">redeemer</a> <a id="1701" href="ValueSepUTxO.UTxO.html#683" class="Postulate Operator">♯</a> <a id="1703" class="Symbol">}</a>

<a id="1706" class="Keyword">record</a> <a id="Tx"></a><a id="1713" href="ValueSepUTxO.UTxO.html#1713" class="Record">Tx</a> <a id="1716" class="Symbol">:</a> <a id="1718" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1723" class="Keyword">where</a>
  <a id="1731" class="Keyword">field</a>
    <a id="Tx.inputs"></a><a id="1741" href="ValueSepUTxO.UTxO.html#1741" class="Field">inputs</a>  <a id="1749" class="Symbol">:</a> <a id="1751" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1756" href="ValueSepUTxO.UTxO.html#1405" class="Record">TxInput</a>
    <a id="Tx.outputs"></a><a id="1768" href="ValueSepUTxO.UTxO.html#1768" class="Field">outputs</a> <a id="1776" class="Symbol">:</a> <a id="1778" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1783" href="ValueSepUTxO.UTxO.html#777" class="Record">TxOutput</a>
    <a id="Tx.forge"></a><a id="1796" href="ValueSepUTxO.UTxO.html#1796" class="Field">forge</a>   <a id="1804" class="Symbol">:</a> <a id="1806" href="ValueSepUTxO.UTxO.html#632" class="Function">Value</a>
<a id="1812" class="Keyword">open</a> <a id="1817" href="ValueSepUTxO.UTxO.html#1713" class="Module">Tx</a> <a id="1820" class="Keyword">public</a>

<a id="mkTxInfo"></a><a id="1828" href="ValueSepUTxO.UTxO.html#1828" class="Function">mkTxInfo</a> <a id="1837" class="Symbol">:</a> <a id="1839" href="ValueSepUTxO.UTxO.html#1713" class="Record">Tx</a> <a id="1842" class="Symbol">→</a> <a id="1844" href="ValueSepUTxO.UTxO.html#1216" class="Record">TxInfo</a>
<a id="1851" href="ValueSepUTxO.UTxO.html#1828" class="Function">mkTxInfo</a> <a id="1860" href="ValueSepUTxO.UTxO.html#1860" class="Bound">tx</a> <a id="1863" class="Symbol">=</a> <a id="1865" class="Keyword">record</a>
  <a id="1874" class="Symbol">{</a> <a id="1876" href="ValueSepUTxO.UTxO.html#1244" class="Field">inputs</a>  <a id="1884" class="Symbol">=</a> <a id="1886" href="ValueSepUTxO.UTxO.html#1542" class="Function">mkInputInfo</a> <a id="1898" href="Prelude.Functor.html#361" class="Field Operator">&lt;$&gt;</a> <a id="1902" href="ValueSepUTxO.UTxO.html#1860" class="Bound">tx</a> <a id="1905" class="Symbol">.</a><a id="1906" href="ValueSepUTxO.UTxO.html#1741" class="Field">inputs</a>
  <a id="1915" class="Symbol">;</a> <a id="1917" href="ValueSepUTxO.UTxO.html#1277" class="Field">outputs</a> <a id="1925" class="Symbol">=</a> <a id="1927" href="ValueSepUTxO.UTxO.html#1860" class="Bound">tx</a> <a id="1930" class="Symbol">.</a><a id="1931" href="ValueSepUTxO.UTxO.html#1768" class="Field">outputs</a>
  <a id="1941" class="Symbol">;</a> <a id="1943" href="ValueSepUTxO.UTxO.html#1309" class="Field">forge</a>   <a id="1951" class="Symbol">=</a> <a id="1953" href="ValueSepUTxO.UTxO.html#1860" class="Bound">tx</a> <a id="1956" class="Symbol">.</a><a id="1957" href="ValueSepUTxO.UTxO.html#1796" class="Field">forge</a> <a id="1963" class="Symbol">}</a>

<a id="1966" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="2005" href="ValueSepUTxO.UTxO.html#2005" class="Function">L</a> <a id="2007" class="Symbol">=</a> <a id="2009" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2014" href="ValueSepUTxO.UTxO.html#1713" class="Record">Tx</a>

<a id="2018" class="Comment">-- The state of a ledger maps addresses to a value.</a>

<a id="S"></a><a id="2071" href="ValueSepUTxO.UTxO.html#2071" class="Function">S</a> <a id="2073" class="Symbol">:</a> <a id="2075" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="2080" href="ValueSepUTxO.UTxO.html#2071" class="Function">S</a> <a id="2082" class="Symbol">=</a> <a id="2084" href="Prelude.Bags.html#241" class="Function Operator">Bag⟨</a> <a id="2089" href="ValueSepUTxO.UTxO.html#656" class="Function">Address</a> <a id="2097" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2099" href="ValueSepUTxO.UTxO.html#632" class="Function">Value</a> <a id="2105" href="Prelude.Bags.html#241" class="Function Operator">⟩</a>

<a id="2108" class="Keyword">instance</a>
  <a id="FromList-S"></a><a id="2119" href="ValueSepUTxO.UTxO.html#2119" class="Function">FromList-S</a> <a id="2130" class="Symbol">:</a> <a id="2132" href="Prelude.FromList.html#107" class="Record">FromList</a> <a id="2141" href="ValueSepUTxO.UTxO.html#777" class="Record">TxOutput</a> <a id="2150" href="ValueSepUTxO.UTxO.html#2071" class="Function">S</a>
  <a id="2154" href="ValueSepUTxO.UTxO.html#2119" class="Function">FromList-S</a> <a id="2165" class="Symbol">.</a><a id="2166" href="Prelude.FromList.html#174" class="Field">fromList</a> <a id="2175" class="Symbol">=</a> <a id="2177" href="Prelude.FromList.html#174" class="Field">fromList</a> <a id="2186" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2188" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2192" class="Symbol">(λ</a> <a id="2195" href="ValueSepUTxO.UTxO.html#2195" class="Bound">txo</a> <a id="2199" class="Symbol">→</a> <a id="2201" href="ValueSepUTxO.UTxO.html#2195" class="Bound">txo</a> <a id="2205" class="Symbol">.</a><a id="2206" href="ValueSepUTxO.UTxO.html#850" class="Field">address</a> <a id="2214" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2216" href="ValueSepUTxO.UTxO.html#2195" class="Bound">txo</a> <a id="2220" class="Symbol">.</a><a id="2221" href="ValueSepUTxO.UTxO.html#826" class="Field">value</a><a id="2226" class="Symbol">)</a>

<a id="outputRefs"></a><a id="2229" href="ValueSepUTxO.UTxO.html#2229" class="Function">outputRefs</a> <a id="2240" class="Symbol">:</a> <a id="2242" href="ValueSepUTxO.UTxO.html#1713" class="Record">Tx</a> <a id="2245" class="Symbol">→</a> <a id="2247" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2252" href="ValueSepUTxO.UTxO.html#777" class="Record">TxOutput</a>
<a id="2261" href="ValueSepUTxO.UTxO.html#2229" class="Function">outputRefs</a> <a id="2272" class="Symbol">=</a> <a id="2274" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2278" href="ValueSepUTxO.UTxO.html#1434" class="Field">outputRef</a> <a id="2288" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2290" href="ValueSepUTxO.UTxO.html#1741" class="Field">inputs</a>

<a id="stxoTx"></a><a id="2298" href="ValueSepUTxO.UTxO.html#2298" class="Function">stxoTx</a> <a id="utxoTx"></a><a id="2305" href="ValueSepUTxO.UTxO.html#2305" class="Function">utxoTx</a> <a id="2312" class="Symbol">:</a> <a id="2314" href="ValueSepUTxO.UTxO.html#1713" class="Record">Tx</a> <a id="2317" class="Symbol">→</a> <a id="2319" href="ValueSepUTxO.UTxO.html#2071" class="Function">S</a>
<a id="2321" href="ValueSepUTxO.UTxO.html#2298" class="Function">stxoTx</a> <a id="2328" class="Symbol">=</a> <a id="2330" href="Prelude.FromList.html#174" class="Field">fromList</a> <a id="2339" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2341" href="ValueSepUTxO.UTxO.html#2229" class="Function">outputRefs</a>
<a id="2352" href="ValueSepUTxO.UTxO.html#2305" class="Function">utxoTx</a> <a id="2359" class="Symbol">=</a> <a id="2361" href="Prelude.FromList.html#174" class="Field">fromList</a> <a id="2370" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2372" href="ValueSepUTxO.UTxO.html#1768" class="Field">outputs</a>

<a id="∑"></a><a id="2381" href="ValueSepUTxO.UTxO.html#2381" class="Function">∑</a> <a id="2383" class="Symbol">:</a> <a id="2385" class="Symbol">∀</a> <a id="2387" class="Symbol">{</a><a id="2388" href="ValueSepUTxO.UTxO.html#2388" class="Bound">A</a> <a id="2390" class="Symbol">:</a> <a id="2392" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="2396" class="Symbol">}</a> <a id="2398" class="Symbol">→</a> <a id="2400" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2405" href="ValueSepUTxO.UTxO.html#2388" class="Bound">A</a> <a id="2407" class="Symbol">→</a> <a id="2409" class="Symbol">(</a><a id="2410" href="ValueSepUTxO.UTxO.html#2388" class="Bound">A</a> <a id="2412" class="Symbol">→</a> <a id="2414" href="ValueSepUTxO.UTxO.html#632" class="Function">Value</a><a id="2419" class="Symbol">)</a> <a id="2421" class="Symbol">→</a> <a id="2423" href="ValueSepUTxO.UTxO.html#632" class="Function">Value</a>
<a id="2429" href="ValueSepUTxO.UTxO.html#2381" class="Function">∑</a> <a id="2431" href="ValueSepUTxO.UTxO.html#2431" class="Bound">xs</a> <a id="2434" href="ValueSepUTxO.UTxO.html#2434" class="Bound">f</a> <a id="2436" class="Symbol">=</a> <a id="2438" href="Prelude.Lists.Sums.html#283" class="Function">∑ℕ</a> <a id="2441" class="Symbol">(</a><a id="2442" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2446" href="ValueSepUTxO.UTxO.html#2434" class="Bound">f</a> <a id="2448" href="ValueSepUTxO.UTxO.html#2431" class="Bound">xs</a><a id="2450" class="Symbol">)</a>

<a id="2453" class="Keyword">record</a> <a id="IsValidTx"></a><a id="2460" href="ValueSepUTxO.UTxO.html#2460" class="Record">IsValidTx</a> <a id="2470" class="Symbol">(</a><a id="2471" href="ValueSepUTxO.UTxO.html#2471" class="Bound">tx</a> <a id="2474" class="Symbol">:</a> <a id="2476" href="ValueSepUTxO.UTxO.html#1713" class="Record">Tx</a><a id="2478" class="Symbol">)</a> <a id="2480" class="Symbol">(</a><a id="2481" href="ValueSepUTxO.UTxO.html#2481" class="Bound">utxos</a> <a id="2487" class="Symbol">:</a> <a id="2489" href="ValueSepUTxO.UTxO.html#2071" class="Function">S</a><a id="2490" class="Symbol">)</a> <a id="2492" class="Symbol">:</a> <a id="2494" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="2499" class="Keyword">where</a>
  <a id="2507" class="Keyword">field</a>
    <a id="IsValidTx.validOutputRefs"></a><a id="2517" href="ValueSepUTxO.UTxO.html#2517" class="Field">validOutputRefs</a> <a id="2533" class="Symbol">:</a>
      <a id="2541" href="ValueSepUTxO.UTxO.html#2298" class="Function">stxoTx</a> <a id="2548" href="ValueSepUTxO.UTxO.html#2471" class="Bound">tx</a> <a id="2551" href="Prelude.Bags.AsLists.html#2983" class="Function Operator">⊆ˢ</a> <a id="2554" href="ValueSepUTxO.UTxO.html#2481" class="Bound">utxos</a>

    <a id="IsValidTx.preservesValues"></a><a id="2565" href="ValueSepUTxO.UTxO.html#2565" class="Field">preservesValues</a> <a id="2581" class="Symbol">:</a>
      <a id="2589" href="ValueSepUTxO.UTxO.html#2471" class="Bound">tx</a> <a id="2592" class="Symbol">.</a><a id="2593" href="ValueSepUTxO.UTxO.html#1796" class="Field">forge</a> <a id="2599" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2601" href="ValueSepUTxO.UTxO.html#2381" class="Function">∑</a> <a id="2603" class="Symbol">(</a><a id="2604" href="ValueSepUTxO.UTxO.html#2471" class="Bound">tx</a> <a id="2607" class="Symbol">.</a><a id="2608" href="ValueSepUTxO.UTxO.html#1741" class="Field">inputs</a><a id="2614" class="Symbol">)</a> <a id="2616" class="Symbol">(</a><a id="2617" href="ValueSepUTxO.UTxO.html#826" class="Field">value</a> <a id="2623" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2625" href="ValueSepUTxO.UTxO.html#1434" class="Field">outputRef</a><a id="2634" class="Symbol">)</a> <a id="2636" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2638" href="ValueSepUTxO.UTxO.html#2381" class="Function">∑</a> <a id="2640" class="Symbol">(</a><a id="2641" href="ValueSepUTxO.UTxO.html#2471" class="Bound">tx</a> <a id="2644" class="Symbol">.</a><a id="2645" href="ValueSepUTxO.UTxO.html#1768" class="Field">outputs</a><a id="2652" class="Symbol">)</a> <a id="2654" href="ValueSepUTxO.UTxO.html#826" class="Field">value</a>

    <a id="2665" class="Comment">-- noDoubleSpending :</a>
    <a id="2691" class="Comment">--   Unique (outputRefs tx)</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="2724" href="ValueSepUTxO.UTxO.html#2724" class="Field">allInputsValidate</a> <a id="2742" class="Symbol">:</a>
      <a id="2750" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="2754" class="Symbol">(λ</a> <a id="2757" href="ValueSepUTxO.UTxO.html#2757" class="Bound">i</a> <a id="2759" class="Symbol">→</a> <a id="2761" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2763" class="Symbol">(</a><a id="2764" href="ValueSepUTxO.UTxO.html#1463" class="Field">validator</a> <a id="2774" href="ValueSepUTxO.UTxO.html#2757" class="Bound">i</a> <a id="2776" class="Symbol">(</a><a id="2777" href="ValueSepUTxO.UTxO.html#1828" class="Function">mkTxInfo</a> <a id="2786" href="ValueSepUTxO.UTxO.html#2471" class="Bound">tx</a><a id="2788" class="Symbol">)</a> <a id="2790" class="Symbol">(</a><a id="2791" href="ValueSepUTxO.UTxO.html#2757" class="Bound">i</a> <a id="2793" class="Symbol">.</a><a id="2794" href="ValueSepUTxO.UTxO.html#1504" class="Field">redeemer</a><a id="2802" class="Symbol">)))</a> <a id="2806" class="Symbol">(</a><a id="2807" href="ValueSepUTxO.UTxO.html#2471" class="Bound">tx</a> <a id="2810" class="Symbol">.</a><a id="2811" href="ValueSepUTxO.UTxO.html#1741" class="Field">inputs</a><a id="2817" class="Symbol">)</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="2824" href="ValueSepUTxO.UTxO.html#2824" class="Field">validateValidHashes</a> <a id="2844" class="Symbol">:</a>
      <a id="2852" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="2856" class="Symbol">(λ</a> <a id="2859" href="ValueSepUTxO.UTxO.html#2859" class="Bound">i</a> <a id="2861" class="Symbol">→</a> <a id="2863" href="ValueSepUTxO.UTxO.html#2859" class="Bound">i</a> <a id="2865" class="Symbol">.</a><a id="2866" href="ValueSepUTxO.UTxO.html#1434" class="Field">outputRef</a> <a id="2876" class="Symbol">.</a><a id="2877" href="ValueSepUTxO.UTxO.html#850" class="Field">address</a> <a id="2885" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2887" href="ValueSepUTxO.UTxO.html#2859" class="Bound">i</a> <a id="2889" class="Symbol">.</a><a id="2890" href="ValueSepUTxO.UTxO.html#1463" class="Field">validator</a> <a id="2900" href="ValueSepUTxO.UTxO.html#683" class="Postulate Operator">♯</a><a id="2901" class="Symbol">)</a> <a id="2903" class="Symbol">(</a><a id="2904" href="ValueSepUTxO.UTxO.html#2471" class="Bound">tx</a> <a id="2907" class="Symbol">.</a><a id="2908" href="ValueSepUTxO.UTxO.html#1741" class="Field">inputs</a><a id="2914" class="Symbol">)</a>

<a id="2917" class="Keyword">open</a> <a id="2922" href="ValueSepUTxO.UTxO.html#2460" class="Module">IsValidTx</a> <a id="2932" class="Keyword">public</a>

<a id="isValidTx?"></a><a id="2940" href="ValueSepUTxO.UTxO.html#2940" class="Function">isValidTx?</a> <a id="2951" class="Symbol">:</a> <a id="2953" class="Symbol">∀</a> <a id="2955" href="ValueSepUTxO.UTxO.html#2955" class="Bound">tx</a> <a id="2958" href="ValueSepUTxO.UTxO.html#2958" class="Bound">s</a> <a id="2960" class="Symbol">→</a> <a id="2962" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="2966" class="Symbol">(</a><a id="2967" href="ValueSepUTxO.UTxO.html#2460" class="Record">IsValidTx</a> <a id="2977" href="ValueSepUTxO.UTxO.html#2955" class="Bound">tx</a> <a id="2980" href="ValueSepUTxO.UTxO.html#2958" class="Bound">s</a><a id="2981" class="Symbol">)</a>
<a id="2983" href="ValueSepUTxO.UTxO.html#2940" class="Function">isValidTx?</a> <a id="2994" href="ValueSepUTxO.UTxO.html#2994" class="Bound">tx</a> <a id="2997" href="ValueSepUTxO.UTxO.html#2997" class="Bound">utxos</a>
  <a id="3005" class="Keyword">with</a> <a id="3010" href="Prelude.Decidable.Base.html#143" class="Field">dec</a>
<a id="3014" class="Symbol">...</a> <a id="3018" class="Symbol">|</a> <a id="3020" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3023" href="ValueSepUTxO.UTxO.html#3023" class="Bound">¬p</a> <a id="3026" class="Symbol">=</a> <a id="3028" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3031" class="Symbol">(</a><a id="3032" href="ValueSepUTxO.UTxO.html#3023" class="Bound">¬p</a> <a id="3035" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3037" href="ValueSepUTxO.UTxO.html#2517" class="Field">validOutputRefs</a><a id="3052" class="Symbol">)</a>
<a id="3054" class="Symbol">...</a> <a id="3058" class="Symbol">|</a> <a id="3060" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3064" href="ValueSepUTxO.UTxO.html#3064" class="Bound">p₁</a>
  <a id="3069" class="Keyword">with</a> <a id="3074" href="Prelude.Decidable.Base.html#143" class="Field">dec</a>
<a id="3078" class="Symbol">...</a> <a id="3082" class="Symbol">|</a> <a id="3084" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3087" href="ValueSepUTxO.UTxO.html#3087" class="Bound">¬p</a> <a id="3090" class="Symbol">=</a> <a id="3092" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3095" class="Symbol">(</a><a id="3096" href="ValueSepUTxO.UTxO.html#3087" class="Bound">¬p</a> <a id="3099" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3101" href="ValueSepUTxO.UTxO.html#2565" class="Field">preservesValues</a><a id="3116" class="Symbol">)</a>
<a id="3118" class="Symbol">...</a> <a id="3122" class="Symbol">|</a> <a id="3124" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3128" href="ValueSepUTxO.UTxO.html#3128" class="Bound">p₂</a>
<a id="3131" class="Comment">--   with dec</a>
<a id="3145" class="Comment">-- ... | no ¬p = no (¬p ∘ noDoubleSpending)</a>
<a id="3189" class="Comment">-- ... | yes p₃</a>
  <a id="3207" class="Keyword">with</a> <a id="3212" href="Prelude.Decidable.Base.html#143" class="Field">dec</a>
<a id="3216" class="Symbol">...</a> <a id="3220" class="Symbol">|</a> <a id="3222" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3225" href="ValueSepUTxO.UTxO.html#3225" class="Bound">¬p</a> <a id="3228" class="Symbol">=</a> <a id="3230" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3233" class="Symbol">(</a><a id="3234" href="ValueSepUTxO.UTxO.html#3225" class="Bound">¬p</a> <a id="3237" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3239" href="ValueSepUTxO.UTxO.html#2724" class="Field">allInputsValidate</a><a id="3256" class="Symbol">)</a>
<a id="3258" class="Symbol">...</a> <a id="3262" class="Symbol">|</a> <a id="3264" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3268" href="ValueSepUTxO.UTxO.html#3268" class="Bound">p₄</a>
  <a id="3273" class="Keyword">with</a> <a id="3278" href="Prelude.Decidable.Base.html#143" class="Field">dec</a>
<a id="3282" class="Symbol">...</a> <a id="3286" class="Symbol">|</a> <a id="3288" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3291" href="ValueSepUTxO.UTxO.html#3291" class="Bound">¬p</a> <a id="3294" class="Symbol">=</a> <a id="3296" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3299" class="Symbol">(</a><a id="3300" href="ValueSepUTxO.UTxO.html#3291" class="Bound">¬p</a> <a id="3303" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3305" href="ValueSepUTxO.UTxO.html#2824" class="Field">validateValidHashes</a><a id="3324" class="Symbol">)</a>
<a id="3326" class="Symbol">...</a> <a id="3330" class="Symbol">|</a> <a id="3332" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3336" href="ValueSepUTxO.UTxO.html#3336" class="Bound">p₅</a> <a id="3339" class="Symbol">=</a> <a id="3341" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3345" class="Keyword">record</a> <a id="3352" class="Symbol">{</a> <a id="3354" href="ValueSepUTxO.UTxO.html#2517" class="Field">validOutputRefs</a> <a id="3370" class="Symbol">=</a> <a id="3372" class="Bound">p₁</a><a id="3374" class="Symbol">;</a> <a id="3376" href="ValueSepUTxO.UTxO.html#2565" class="Field">preservesValues</a> <a id="3392" class="Symbol">=</a> <a id="3394" class="Bound">p₂</a>
                          <a id="3423" class="Symbol">;</a> <a id="3425" href="ValueSepUTxO.UTxO.html#2724" class="Field">allInputsValidate</a> <a id="3443" class="Symbol">=</a> <a id="3445" class="Bound">p₄</a><a id="3447" class="Symbol">;</a> <a id="3449" href="ValueSepUTxO.UTxO.html#2824" class="Field">validateValidHashes</a> <a id="3469" class="Symbol">=</a> <a id="3471" href="ValueSepUTxO.UTxO.html#3336" class="Bound">p₅</a> <a id="3474" class="Symbol">}</a>

<a id="isValidTx"></a><a id="3477" href="ValueSepUTxO.UTxO.html#3477" class="Function">isValidTx</a> <a id="3487" class="Symbol">:</a> <a id="3489" href="ValueSepUTxO.UTxO.html#1713" class="Record">Tx</a> <a id="3492" class="Symbol">→</a> <a id="3494" href="ValueSepUTxO.UTxO.html#2071" class="Function">S</a> <a id="3496" class="Symbol">→</a> <a id="3498" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="3503" href="ValueSepUTxO.UTxO.html#3477" class="Function">isValidTx</a> <a id="3513" href="ValueSepUTxO.UTxO.html#3513" class="Bound">tx</a> <a id="3516" href="ValueSepUTxO.UTxO.html#3516" class="Bound">s</a> <a id="3518" class="Symbol">=</a> <a id="3520" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="3522" href="ValueSepUTxO.UTxO.html#2940" class="Function">isValidTx?</a> <a id="3533" href="ValueSepUTxO.UTxO.html#3513" class="Bound">tx</a> <a id="3536" href="ValueSepUTxO.UTxO.html#3516" class="Bound">s</a> <a id="3538" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
</pre></body></html>