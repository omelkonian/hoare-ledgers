<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ValueSepUTxO.UTxO</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/hoare-ledgers/tree/master/ValueSepUTxO/UTxO.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">----------------------------------------------</a>
<a id="48" class="Comment">-- ** Abstract definition for UTxO-based ledgers.</a>

<a id="99" class="Keyword">module</a> <a id="106" href="ValueSepUTxO.UTxO.html" class="Module">ValueSepUTxO.UTxO</a> <a id="124" class="Keyword">where</a>

<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="155" class="Symbol">;</a> <a id="157" class="Keyword">open</a> <a id="162" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="172" class="Keyword">open</a> <a id="177" class="Keyword">import</a> <a id="184" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="256" class="Keyword">open</a> <a id="261" class="Keyword">import</a> <a id="268" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="280" class="Keyword">open</a> <a id="285" class="Keyword">import</a> <a id="292" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Prelude.Lists.Dec.html" class="Module">Prelude.Lists.Dec</a>
<a id="336" class="Keyword">open</a> <a id="341" class="Keyword">import</a> <a id="348" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="396" class="Keyword">open</a> <a id="401" class="Keyword">import</a> <a id="408" href="Prelude.FromList.html" class="Module">Prelude.FromList</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="449" class="Keyword">open</a> <a id="454" class="Keyword">import</a> <a id="461" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>

<a id="507" class="Keyword">open</a> <a id="512" class="Keyword">import</a> <a id="519" href="Prelude.Bags.html" class="Module">Prelude.Bags</a>
<a id="532" class="Keyword">instance</a>
  <a id="Sℕ"></a><a id="543" href="ValueSepUTxO.UTxO.html#543" class="Function">Sℕ</a>  <a id="547" class="Symbol">=</a> <a id="549" href="Prelude.Semigroup.html#4333" class="Function">Semigroup-ℕ-+</a><a id="562" class="Symbol">;</a> <a id="Sℕ⁺"></a><a id="564" href="ValueSepUTxO.UTxO.html#564" class="Function">Sℕ⁺</a> <a id="568" class="Symbol">=</a> <a id="570" href="Prelude.Semigroup.html#4626" class="Function">SemigroupLaws-ℕ-+</a>
  <a id="Mℕ"></a><a id="590" href="ValueSepUTxO.UTxO.html#590" class="Function">Mℕ</a>  <a id="594" class="Symbol">=</a> <a id="596" href="Prelude.Monoid.html#3120" class="Function">Monoid-ℕ-+</a><a id="606" class="Symbol">;</a>    <a id="Mℕ⁺"></a><a id="611" href="ValueSepUTxO.UTxO.html#611" class="Function">Mℕ⁺</a> <a id="615" class="Symbol">=</a> <a id="617" href="Prelude.Monoid.html#3191" class="Function">MonoidLaws-ℕ-+</a>

<a id="Value"></a><a id="633" href="ValueSepUTxO.UTxO.html#633" class="Function">Value</a>   <a id="641" class="Symbol">=</a> <a id="643" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="HashId"></a><a id="645" href="ValueSepUTxO.UTxO.html#645" class="Function">HashId</a>  <a id="653" class="Symbol">=</a> <a id="655" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="Address"></a><a id="657" href="ValueSepUTxO.UTxO.html#657" class="Function">Address</a> <a id="665" class="Symbol">=</a> <a id="667" href="ValueSepUTxO.UTxO.html#645" class="Function">HashId</a>
<a id="674" class="Keyword">postulate</a> <a id="_♯"></a><a id="684" href="ValueSepUTxO.UTxO.html#684" class="Postulate Operator">_♯</a> <a id="687" class="Symbol">:</a> <a id="689" class="Symbol">∀</a> <a id="691" class="Symbol">{</a><a id="692" href="ValueSepUTxO.UTxO.html#692" class="Bound">A</a> <a id="694" class="Symbol">:</a> <a id="696" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="701" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="702" class="Symbol">}</a> <a id="704" class="Symbol">→</a> <a id="706" href="ValueSepUTxO.UTxO.html#692" class="Bound">A</a> <a id="708" class="Symbol">→</a> <a id="710" href="ValueSepUTxO.UTxO.html#645" class="Function">HashId</a>

<a id="DATA"></a><a id="718" href="ValueSepUTxO.UTxO.html#718" class="Function">DATA</a> <a id="723" class="Symbol">=</a> <a id="725" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="727" class="Comment">-- T0D0: more realistic data for redeemers</a>

<a id="771" class="Keyword">record</a> <a id="TxOutput"></a><a id="778" href="ValueSepUTxO.UTxO.html#778" class="Record">TxOutput</a> <a id="787" class="Symbol">:</a> <a id="789" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="794" class="Keyword">where</a>
  <a id="802" class="Keyword">constructor</a> <a id="_at_"></a><a id="814" href="ValueSepUTxO.UTxO.html#814" class="InductiveConstructor Operator">_at_</a>
  <a id="821" class="Keyword">field</a> <a id="TxOutput.value"></a><a id="827" href="ValueSepUTxO.UTxO.html#827" class="Field">value</a>   <a id="835" class="Symbol">:</a> <a id="837" href="ValueSepUTxO.UTxO.html#633" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="851" href="ValueSepUTxO.UTxO.html#851" class="Field">address</a> <a id="859" class="Symbol">:</a> <a id="861" href="ValueSepUTxO.UTxO.html#657" class="Function">Address</a>
<a id="869" class="Keyword">open</a> <a id="874" href="ValueSepUTxO.UTxO.html#778" class="Module">TxOutput</a> <a id="883" class="Keyword">public</a>
<a id="890" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="902" href="ValueSepUTxO.UTxO.html#902" class="Function">DecEq-TxO</a> <a id="912" class="Symbol">=</a> <a id="914" href="Prelude.Generics.Deriving.html#1119" class="Macro">DERIVE</a> <a id="921" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="927" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="929" class="Keyword">quote</a> <a id="935" href="ValueSepUTxO.UTxO.html#778" class="Record">TxOutput</a> <a id="944" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="946" href="ValueSepUTxO.UTxO.html#902" class="Function">DecEq-TxO</a> <a id="956" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="TxOutputRef"></a><a id="959" href="ValueSepUTxO.UTxO.html#959" class="Function">TxOutputRef</a> <a id="971" class="Symbol">:</a> <a id="973" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="978" href="ValueSepUTxO.UTxO.html#959" class="Function">TxOutputRef</a> <a id="990" class="Symbol">=</a> <a id="992" href="ValueSepUTxO.UTxO.html#645" class="Function">HashId</a>

<a id="1000" class="Keyword">record</a> <a id="InputInfo"></a><a id="1007" href="ValueSepUTxO.UTxO.html#1007" class="Record">InputInfo</a> <a id="1017" class="Symbol">:</a> <a id="1019" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1024" class="Keyword">where</a>
  <a id="1032" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="1038" href="ValueSepUTxO.UTxO.html#1038" class="Field">outputRef</a>     <a id="1052" class="Symbol">:</a> <a id="1054" href="ValueSepUTxO.UTxO.html#959" class="Function">TxOutputRef</a>
        <a id="InputInfo.validatorHash"></a><a id="1074" href="ValueSepUTxO.UTxO.html#1074" class="Field">validatorHash</a> <a id="1088" class="Symbol">:</a> <a id="1090" href="ValueSepUTxO.UTxO.html#645" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="1105" href="ValueSepUTxO.UTxO.html#1105" class="Field">redeemerHash</a>  <a id="1119" class="Symbol">:</a> <a id="1121" href="ValueSepUTxO.UTxO.html#645" class="Function">HashId</a>
<a id="1128" class="Keyword">unquoteDecl</a> <a id="DecEq-InputInfo"></a><a id="1140" href="ValueSepUTxO.UTxO.html#1140" class="Function">DecEq-InputInfo</a> <a id="1156" class="Symbol">=</a> <a id="1158" href="Prelude.Generics.Deriving.html#1119" class="Macro">DERIVE</a> <a id="1165" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="1171" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1173" class="Keyword">quote</a> <a id="1179" href="ValueSepUTxO.UTxO.html#1007" class="Record">InputInfo</a> <a id="1189" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1191" href="ValueSepUTxO.UTxO.html#1140" class="Function">DecEq-InputInfo</a> <a id="1207" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="1210" class="Keyword">record</a> <a id="TxInfo"></a><a id="1217" href="ValueSepUTxO.UTxO.html#1217" class="Record">TxInfo</a> <a id="1224" class="Symbol">:</a> <a id="1226" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1231" class="Keyword">where</a>
  <a id="1239" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="1245" href="ValueSepUTxO.UTxO.html#1245" class="Field">inputs</a>  <a id="1253" class="Symbol">:</a> <a id="1255" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1260" href="ValueSepUTxO.UTxO.html#1007" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="1278" href="ValueSepUTxO.UTxO.html#1278" class="Field">outputs</a> <a id="1286" class="Symbol">:</a> <a id="1288" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1293" href="ValueSepUTxO.UTxO.html#778" class="Record">TxOutput</a>
        <a id="TxInfo.forge"></a><a id="1310" href="ValueSepUTxO.UTxO.html#1310" class="Field">forge</a>   <a id="1318" class="Symbol">:</a> <a id="1320" href="ValueSepUTxO.UTxO.html#633" class="Function">Value</a>
<a id="1326" class="Keyword">unquoteDecl</a> <a id="DecEq-TxInfo"></a><a id="1338" href="ValueSepUTxO.UTxO.html#1338" class="Function">DecEq-TxInfo</a> <a id="1351" class="Symbol">=</a> <a id="1353" href="Prelude.Generics.Deriving.html#1119" class="Macro">DERIVE</a> <a id="1360" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="1366" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1368" class="Keyword">quote</a> <a id="1374" href="ValueSepUTxO.UTxO.html#1217" class="Record">TxInfo</a> <a id="1381" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1383" href="ValueSepUTxO.UTxO.html#1338" class="Function">DecEq-TxInfo</a> <a id="1396" href="Data.List.Base.html#5034" class="Function Operator">]</a>

<a id="1399" class="Keyword">record</a> <a id="TxInput"></a><a id="1406" href="ValueSepUTxO.UTxO.html#1406" class="Record">TxInput</a> <a id="1414" class="Symbol">:</a> <a id="1416" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1421" class="Keyword">where</a>
  <a id="1429" class="Keyword">field</a> <a id="TxInput.outputRef"></a><a id="1435" href="ValueSepUTxO.UTxO.html#1435" class="Field">outputRef</a> <a id="1445" class="Symbol">:</a> <a id="1447" href="ValueSepUTxO.UTxO.html#778" class="Record">TxOutput</a>
        <a id="TxInput.validator"></a><a id="1464" href="ValueSepUTxO.UTxO.html#1464" class="Field">validator</a> <a id="1474" class="Symbol">:</a> <a id="1476" href="ValueSepUTxO.UTxO.html#1217" class="Record">TxInfo</a> <a id="1483" class="Symbol">→</a> <a id="1485" href="ValueSepUTxO.UTxO.html#718" class="Function">DATA</a> <a id="1490" class="Symbol">→</a> <a id="1492" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
        <a id="TxInput.redeemer"></a><a id="1505" href="ValueSepUTxO.UTxO.html#1505" class="Field">redeemer</a>  <a id="1515" class="Symbol">:</a> <a id="1517" href="ValueSepUTxO.UTxO.html#718" class="Function">DATA</a>
<a id="1522" class="Keyword">open</a> <a id="1527" href="ValueSepUTxO.UTxO.html#1406" class="Module">TxInput</a> <a id="1535" class="Keyword">public</a>

<a id="mkInputInfo"></a><a id="1543" href="ValueSepUTxO.UTxO.html#1543" class="Function">mkInputInfo</a> <a id="1555" class="Symbol">:</a> <a id="1557" href="ValueSepUTxO.UTxO.html#1406" class="Record">TxInput</a> <a id="1565" class="Symbol">→</a> <a id="1567" href="ValueSepUTxO.UTxO.html#1007" class="Record">InputInfo</a>
<a id="1577" href="ValueSepUTxO.UTxO.html#1543" class="Function">mkInputInfo</a> <a id="1589" href="ValueSepUTxO.UTxO.html#1589" class="Bound">i</a> <a id="1591" class="Symbol">=</a> <a id="1593" class="Keyword">record</a>
  <a id="1602" class="Symbol">{</a> <a id="1604" href="ValueSepUTxO.UTxO.html#1038" class="Field">outputRef</a>     <a id="1618" class="Symbol">=</a> <a id="1620" href="ValueSepUTxO.UTxO.html#1589" class="Bound">i</a> <a id="1622" class="Symbol">.</a><a id="1623" href="ValueSepUTxO.UTxO.html#1435" class="Field">outputRef</a> <a id="1633" href="ValueSepUTxO.UTxO.html#684" class="Postulate Operator">♯</a>
  <a id="1637" class="Symbol">;</a> <a id="1639" href="ValueSepUTxO.UTxO.html#1074" class="Field">validatorHash</a> <a id="1653" class="Symbol">=</a> <a id="1655" href="ValueSepUTxO.UTxO.html#1589" class="Bound">i</a> <a id="1657" class="Symbol">.</a><a id="1658" href="ValueSepUTxO.UTxO.html#1464" class="Field">validator</a> <a id="1668" href="ValueSepUTxO.UTxO.html#684" class="Postulate Operator">♯</a>
  <a id="1672" class="Symbol">;</a> <a id="1674" href="ValueSepUTxO.UTxO.html#1105" class="Field">redeemerHash</a>  <a id="1688" class="Symbol">=</a> <a id="1690" href="ValueSepUTxO.UTxO.html#1589" class="Bound">i</a> <a id="1692" class="Symbol">.</a><a id="1693" href="ValueSepUTxO.UTxO.html#1505" class="Field">redeemer</a> <a id="1702" href="ValueSepUTxO.UTxO.html#684" class="Postulate Operator">♯</a> <a id="1704" class="Symbol">}</a>

<a id="1707" class="Keyword">record</a> <a id="Tx"></a><a id="1714" href="ValueSepUTxO.UTxO.html#1714" class="Record">Tx</a> <a id="1717" class="Symbol">:</a> <a id="1719" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1724" class="Keyword">where</a>
  <a id="1732" class="Keyword">field</a>
    <a id="Tx.inputs"></a><a id="1742" href="ValueSepUTxO.UTxO.html#1742" class="Field">inputs</a>  <a id="1750" class="Symbol">:</a> <a id="1752" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1757" href="ValueSepUTxO.UTxO.html#1406" class="Record">TxInput</a>
    <a id="Tx.outputs"></a><a id="1769" href="ValueSepUTxO.UTxO.html#1769" class="Field">outputs</a> <a id="1777" class="Symbol">:</a> <a id="1779" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1784" href="ValueSepUTxO.UTxO.html#778" class="Record">TxOutput</a>
    <a id="Tx.forge"></a><a id="1797" href="ValueSepUTxO.UTxO.html#1797" class="Field">forge</a>   <a id="1805" class="Symbol">:</a> <a id="1807" href="ValueSepUTxO.UTxO.html#633" class="Function">Value</a>
<a id="1813" class="Keyword">open</a> <a id="1818" href="ValueSepUTxO.UTxO.html#1714" class="Module">Tx</a> <a id="1821" class="Keyword">public</a>

<a id="mkTxInfo"></a><a id="1829" href="ValueSepUTxO.UTxO.html#1829" class="Function">mkTxInfo</a> <a id="1838" class="Symbol">:</a> <a id="1840" href="ValueSepUTxO.UTxO.html#1714" class="Record">Tx</a> <a id="1843" class="Symbol">→</a> <a id="1845" href="ValueSepUTxO.UTxO.html#1217" class="Record">TxInfo</a>
<a id="1852" href="ValueSepUTxO.UTxO.html#1829" class="Function">mkTxInfo</a> <a id="1861" href="ValueSepUTxO.UTxO.html#1861" class="Bound">tx</a> <a id="1864" class="Symbol">=</a> <a id="1866" class="Keyword">record</a>
  <a id="1875" class="Symbol">{</a> <a id="1877" href="ValueSepUTxO.UTxO.html#1245" class="Field">inputs</a>  <a id="1885" class="Symbol">=</a> <a id="1887" href="ValueSepUTxO.UTxO.html#1543" class="Function">mkInputInfo</a> <a id="1899" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="1903" href="ValueSepUTxO.UTxO.html#1861" class="Bound">tx</a> <a id="1906" class="Symbol">.</a><a id="1907" href="ValueSepUTxO.UTxO.html#1742" class="Field">inputs</a>
  <a id="1916" class="Symbol">;</a> <a id="1918" href="ValueSepUTxO.UTxO.html#1278" class="Field">outputs</a> <a id="1926" class="Symbol">=</a> <a id="1928" href="ValueSepUTxO.UTxO.html#1861" class="Bound">tx</a> <a id="1931" class="Symbol">.</a><a id="1932" href="ValueSepUTxO.UTxO.html#1769" class="Field">outputs</a>
  <a id="1942" class="Symbol">;</a> <a id="1944" href="ValueSepUTxO.UTxO.html#1310" class="Field">forge</a>   <a id="1952" class="Symbol">=</a> <a id="1954" href="ValueSepUTxO.UTxO.html#1861" class="Bound">tx</a> <a id="1957" class="Symbol">.</a><a id="1958" href="ValueSepUTxO.UTxO.html#1797" class="Field">forge</a> <a id="1964" class="Symbol">}</a>

<a id="1967" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="2006" href="ValueSepUTxO.UTxO.html#2006" class="Function">L</a> <a id="2008" class="Symbol">=</a> <a id="2010" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2015" href="ValueSepUTxO.UTxO.html#1714" class="Record">Tx</a>

<a id="2019" class="Comment">-- The state of a ledger maps addresses to a value.</a>

<a id="S"></a><a id="2072" href="ValueSepUTxO.UTxO.html#2072" class="Function">S</a> <a id="2074" class="Symbol">:</a> <a id="2076" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="2081" href="ValueSepUTxO.UTxO.html#2072" class="Function">S</a> <a id="2083" class="Symbol">=</a> <a id="2085" href="Prelude.Bags.AsLists.html#820" class="Record">Bag⟨</a> <a id="2090" href="ValueSepUTxO.UTxO.html#657" class="Function">Address</a> <a id="2098" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2100" href="ValueSepUTxO.UTxO.html#633" class="Function">Value</a> <a id="2106" href="Prelude.Bags.AsLists.html#820" class="Record">⟩</a>

<a id="2109" class="Keyword">instance</a>
  <a id="FromList-S"></a><a id="2120" href="ValueSepUTxO.UTxO.html#2120" class="Function">FromList-S</a> <a id="2131" class="Symbol">:</a> <a id="2133" href="Prelude.FromList.html#130" class="Record">FromList</a> <a id="2142" href="ValueSepUTxO.UTxO.html#778" class="Record">TxOutput</a> <a id="2151" href="ValueSepUTxO.UTxO.html#2072" class="Function">S</a>
  <a id="2155" href="ValueSepUTxO.UTxO.html#2120" class="Function">FromList-S</a> <a id="2166" class="Symbol">.</a><a id="2167" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="2176" class="Symbol">=</a> <a id="2178" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="2187" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2189" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2193" class="Symbol">(λ</a> <a id="2196" href="ValueSepUTxO.UTxO.html#2196" class="Bound">txo</a> <a id="2200" class="Symbol">→</a> <a id="2202" href="ValueSepUTxO.UTxO.html#2196" class="Bound">txo</a> <a id="2206" class="Symbol">.</a><a id="2207" href="ValueSepUTxO.UTxO.html#851" class="Field">address</a> <a id="2215" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2217" href="ValueSepUTxO.UTxO.html#2196" class="Bound">txo</a> <a id="2221" class="Symbol">.</a><a id="2222" href="ValueSepUTxO.UTxO.html#827" class="Field">value</a><a id="2227" class="Symbol">)</a>

<a id="outputRefs"></a><a id="2230" href="ValueSepUTxO.UTxO.html#2230" class="Function">outputRefs</a> <a id="2241" class="Symbol">:</a> <a id="2243" href="ValueSepUTxO.UTxO.html#1714" class="Record">Tx</a> <a id="2246" class="Symbol">→</a> <a id="2248" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2253" href="ValueSepUTxO.UTxO.html#778" class="Record">TxOutput</a>
<a id="2262" href="ValueSepUTxO.UTxO.html#2230" class="Function">outputRefs</a> <a id="2273" class="Symbol">=</a> <a id="2275" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2279" href="ValueSepUTxO.UTxO.html#1435" class="Field">outputRef</a> <a id="2289" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2291" href="ValueSepUTxO.UTxO.html#1742" class="Field">inputs</a>

<a id="stxoTx"></a><a id="2299" href="ValueSepUTxO.UTxO.html#2299" class="Function">stxoTx</a> <a id="utxoTx"></a><a id="2306" href="ValueSepUTxO.UTxO.html#2306" class="Function">utxoTx</a> <a id="2313" class="Symbol">:</a> <a id="2315" href="ValueSepUTxO.UTxO.html#1714" class="Record">Tx</a> <a id="2318" class="Symbol">→</a> <a id="2320" href="ValueSepUTxO.UTxO.html#2072" class="Function">S</a>
<a id="2322" href="ValueSepUTxO.UTxO.html#2299" class="Function">stxoTx</a> <a id="2329" class="Symbol">=</a> <a id="2331" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="2340" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2342" href="ValueSepUTxO.UTxO.html#2230" class="Function">outputRefs</a>
<a id="2353" href="ValueSepUTxO.UTxO.html#2306" class="Function">utxoTx</a> <a id="2360" class="Symbol">=</a> <a id="2362" href="Prelude.FromList.html#197" class="Field">fromList</a> <a id="2371" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2373" href="ValueSepUTxO.UTxO.html#1769" class="Field">outputs</a>

<a id="∑"></a><a id="2382" href="ValueSepUTxO.UTxO.html#2382" class="Function">∑</a> <a id="2384" class="Symbol">:</a> <a id="2386" class="Symbol">∀</a> <a id="2388" class="Symbol">{</a><a id="2389" href="ValueSepUTxO.UTxO.html#2389" class="Bound">A</a> <a id="2391" class="Symbol">:</a> <a id="2393" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="2397" class="Symbol">}</a> <a id="2399" class="Symbol">→</a> <a id="2401" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2406" href="ValueSepUTxO.UTxO.html#2389" class="Bound">A</a> <a id="2408" class="Symbol">→</a> <a id="2410" class="Symbol">(</a><a id="2411" href="ValueSepUTxO.UTxO.html#2389" class="Bound">A</a> <a id="2413" class="Symbol">→</a> <a id="2415" href="ValueSepUTxO.UTxO.html#633" class="Function">Value</a><a id="2420" class="Symbol">)</a> <a id="2422" class="Symbol">→</a> <a id="2424" href="ValueSepUTxO.UTxO.html#633" class="Function">Value</a>
<a id="2430" href="ValueSepUTxO.UTxO.html#2382" class="Function">∑</a> <a id="2432" href="ValueSepUTxO.UTxO.html#2432" class="Bound">xs</a> <a id="2435" href="ValueSepUTxO.UTxO.html#2435" class="Bound">f</a> <a id="2437" class="Symbol">=</a> <a id="2439" href="Prelude.Lists.Sums.html#295" class="Function">∑ℕ</a> <a id="2442" class="Symbol">(</a><a id="2443" href="Data.List.Base.html#1553" class="Function">map</a> <a id="2447" href="ValueSepUTxO.UTxO.html#2435" class="Bound">f</a> <a id="2449" href="ValueSepUTxO.UTxO.html#2432" class="Bound">xs</a><a id="2451" class="Symbol">)</a>

<a id="2454" class="Keyword">record</a> <a id="IsValidTx"></a><a id="2461" href="ValueSepUTxO.UTxO.html#2461" class="Record">IsValidTx</a> <a id="2471" class="Symbol">(</a><a id="2472" href="ValueSepUTxO.UTxO.html#2472" class="Bound">tx</a> <a id="2475" class="Symbol">:</a> <a id="2477" href="ValueSepUTxO.UTxO.html#1714" class="Record">Tx</a><a id="2479" class="Symbol">)</a> <a id="2481" class="Symbol">(</a><a id="2482" href="ValueSepUTxO.UTxO.html#2482" class="Bound">utxos</a> <a id="2488" class="Symbol">:</a> <a id="2490" href="ValueSepUTxO.UTxO.html#2072" class="Function">S</a><a id="2491" class="Symbol">)</a> <a id="2493" class="Symbol">:</a> <a id="2495" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="2500" class="Keyword">where</a>
  <a id="2508" class="Keyword">field</a>
    <a id="IsValidTx.validOutputRefs"></a><a id="2518" href="ValueSepUTxO.UTxO.html#2518" class="Field">validOutputRefs</a> <a id="2534" class="Symbol">:</a>
      <a id="2542" href="ValueSepUTxO.UTxO.html#2299" class="Function">stxoTx</a> <a id="2549" href="ValueSepUTxO.UTxO.html#2472" class="Bound">tx</a> <a id="2552" href="Prelude.Bags.AsLists.html#3008" class="Function Operator">⊆ˢ</a> <a id="2555" href="ValueSepUTxO.UTxO.html#2482" class="Bound">utxos</a>

    <a id="IsValidTx.preservesValues"></a><a id="2566" href="ValueSepUTxO.UTxO.html#2566" class="Field">preservesValues</a> <a id="2582" class="Symbol">:</a>
      <a id="2590" href="ValueSepUTxO.UTxO.html#2472" class="Bound">tx</a> <a id="2593" class="Symbol">.</a><a id="2594" href="ValueSepUTxO.UTxO.html#1797" class="Field">forge</a> <a id="2600" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="2602" href="ValueSepUTxO.UTxO.html#2382" class="Function">∑</a> <a id="2604" class="Symbol">(</a><a id="2605" href="ValueSepUTxO.UTxO.html#2472" class="Bound">tx</a> <a id="2608" class="Symbol">.</a><a id="2609" href="ValueSepUTxO.UTxO.html#1742" class="Field">inputs</a><a id="2615" class="Symbol">)</a> <a id="2617" class="Symbol">(</a><a id="2618" href="ValueSepUTxO.UTxO.html#827" class="Field">value</a> <a id="2624" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2626" href="ValueSepUTxO.UTxO.html#1435" class="Field">outputRef</a><a id="2635" class="Symbol">)</a> <a id="2637" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2639" href="ValueSepUTxO.UTxO.html#2382" class="Function">∑</a> <a id="2641" class="Symbol">(</a><a id="2642" href="ValueSepUTxO.UTxO.html#2472" class="Bound">tx</a> <a id="2645" class="Symbol">.</a><a id="2646" href="ValueSepUTxO.UTxO.html#1769" class="Field">outputs</a><a id="2653" class="Symbol">)</a> <a id="2655" href="ValueSepUTxO.UTxO.html#827" class="Field">value</a>

    <a id="2666" class="Comment">-- noDoubleSpending :</a>
    <a id="2692" class="Comment">--   Unique (outputRefs tx)</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="2725" href="ValueSepUTxO.UTxO.html#2725" class="Field">allInputsValidate</a> <a id="2743" class="Symbol">:</a>
      <a id="2751" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="2755" class="Symbol">(λ</a> <a id="2758" href="ValueSepUTxO.UTxO.html#2758" class="Bound">i</a> <a id="2760" class="Symbol">→</a> <a id="2762" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="2764" class="Symbol">(</a><a id="2765" href="ValueSepUTxO.UTxO.html#1464" class="Field">validator</a> <a id="2775" href="ValueSepUTxO.UTxO.html#2758" class="Bound">i</a> <a id="2777" class="Symbol">(</a><a id="2778" href="ValueSepUTxO.UTxO.html#1829" class="Function">mkTxInfo</a> <a id="2787" href="ValueSepUTxO.UTxO.html#2472" class="Bound">tx</a><a id="2789" class="Symbol">)</a> <a id="2791" class="Symbol">(</a><a id="2792" href="ValueSepUTxO.UTxO.html#2758" class="Bound">i</a> <a id="2794" class="Symbol">.</a><a id="2795" href="ValueSepUTxO.UTxO.html#1505" class="Field">redeemer</a><a id="2803" class="Symbol">)))</a> <a id="2807" class="Symbol">(</a><a id="2808" href="ValueSepUTxO.UTxO.html#2472" class="Bound">tx</a> <a id="2811" class="Symbol">.</a><a id="2812" href="ValueSepUTxO.UTxO.html#1742" class="Field">inputs</a><a id="2818" class="Symbol">)</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="2825" href="ValueSepUTxO.UTxO.html#2825" class="Field">validateValidHashes</a> <a id="2845" class="Symbol">:</a>
      <a id="2853" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="2857" class="Symbol">(λ</a> <a id="2860" href="ValueSepUTxO.UTxO.html#2860" class="Bound">i</a> <a id="2862" class="Symbol">→</a> <a id="2864" href="ValueSepUTxO.UTxO.html#2860" class="Bound">i</a> <a id="2866" class="Symbol">.</a><a id="2867" href="ValueSepUTxO.UTxO.html#1435" class="Field">outputRef</a> <a id="2877" class="Symbol">.</a><a id="2878" href="ValueSepUTxO.UTxO.html#851" class="Field">address</a> <a id="2886" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2888" href="ValueSepUTxO.UTxO.html#2860" class="Bound">i</a> <a id="2890" class="Symbol">.</a><a id="2891" href="ValueSepUTxO.UTxO.html#1464" class="Field">validator</a> <a id="2901" href="ValueSepUTxO.UTxO.html#684" class="Postulate Operator">♯</a><a id="2902" class="Symbol">)</a> <a id="2904" class="Symbol">(</a><a id="2905" href="ValueSepUTxO.UTxO.html#2472" class="Bound">tx</a> <a id="2908" class="Symbol">.</a><a id="2909" href="ValueSepUTxO.UTxO.html#1742" class="Field">inputs</a><a id="2915" class="Symbol">)</a>

<a id="2918" class="Keyword">open</a> <a id="2923" href="ValueSepUTxO.UTxO.html#2461" class="Module">IsValidTx</a> <a id="2933" class="Keyword">public</a>

<a id="isValidTx?"></a><a id="2941" href="ValueSepUTxO.UTxO.html#2941" class="Function">isValidTx?</a> <a id="2952" class="Symbol">:</a> <a id="2954" class="Symbol">∀</a> <a id="2956" href="ValueSepUTxO.UTxO.html#2956" class="Bound">tx</a> <a id="2959" href="ValueSepUTxO.UTxO.html#2959" class="Bound">s</a> <a id="2961" class="Symbol">→</a> <a id="2963" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="2967" class="Symbol">(</a><a id="2968" href="ValueSepUTxO.UTxO.html#2461" class="Record">IsValidTx</a> <a id="2978" href="ValueSepUTxO.UTxO.html#2956" class="Bound">tx</a> <a id="2981" href="ValueSepUTxO.UTxO.html#2959" class="Bound">s</a><a id="2982" class="Symbol">)</a>
<a id="2984" href="ValueSepUTxO.UTxO.html#2941" class="Function">isValidTx?</a> <a id="2995" href="ValueSepUTxO.UTxO.html#2995" class="Bound">tx</a> <a id="2998" href="ValueSepUTxO.UTxO.html#2998" class="Bound">utxos</a>
  <a id="3006" class="Keyword">with</a> <a id="3011" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="3015" class="Symbol">...</a> <a id="3019" class="Symbol">|</a> <a id="3021" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3024" href="ValueSepUTxO.UTxO.html#3024" class="Bound">¬p</a> <a id="3027" class="Symbol">=</a> <a id="3029" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3032" class="Symbol">(</a><a id="3033" href="ValueSepUTxO.UTxO.html#3024" class="Bound">¬p</a> <a id="3036" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3038" href="ValueSepUTxO.UTxO.html#2518" class="Field">validOutputRefs</a><a id="3053" class="Symbol">)</a>
<a id="3055" class="Symbol">...</a> <a id="3059" class="Symbol">|</a> <a id="3061" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3065" href="ValueSepUTxO.UTxO.html#3065" class="Bound">p₁</a>
  <a id="3070" class="Keyword">with</a> <a id="3075" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="3079" class="Symbol">...</a> <a id="3083" class="Symbol">|</a> <a id="3085" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3088" href="ValueSepUTxO.UTxO.html#3088" class="Bound">¬p</a> <a id="3091" class="Symbol">=</a> <a id="3093" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3096" class="Symbol">(</a><a id="3097" href="ValueSepUTxO.UTxO.html#3088" class="Bound">¬p</a> <a id="3100" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3102" href="ValueSepUTxO.UTxO.html#2566" class="Field">preservesValues</a><a id="3117" class="Symbol">)</a>
<a id="3119" class="Symbol">...</a> <a id="3123" class="Symbol">|</a> <a id="3125" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3129" href="ValueSepUTxO.UTxO.html#3129" class="Bound">p₂</a>
<a id="3132" class="Comment">--   with dec</a>
<a id="3146" class="Comment">-- ... | no ¬p = no (¬p ∘ noDoubleSpending)</a>
<a id="3190" class="Comment">-- ... | yes p₃</a>
  <a id="3208" class="Keyword">with</a> <a id="3213" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="3217" class="Symbol">...</a> <a id="3221" class="Symbol">|</a> <a id="3223" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3226" href="ValueSepUTxO.UTxO.html#3226" class="Bound">¬p</a> <a id="3229" class="Symbol">=</a> <a id="3231" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3234" class="Symbol">(</a><a id="3235" href="ValueSepUTxO.UTxO.html#3226" class="Bound">¬p</a> <a id="3238" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3240" href="ValueSepUTxO.UTxO.html#2725" class="Field">allInputsValidate</a><a id="3257" class="Symbol">)</a>
<a id="3259" class="Symbol">...</a> <a id="3263" class="Symbol">|</a> <a id="3265" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3269" href="ValueSepUTxO.UTxO.html#3269" class="Bound">p₄</a>
  <a id="3274" class="Keyword">with</a> <a id="3279" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
<a id="3283" class="Symbol">...</a> <a id="3287" class="Symbol">|</a> <a id="3289" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3292" href="ValueSepUTxO.UTxO.html#3292" class="Bound">¬p</a> <a id="3295" class="Symbol">=</a> <a id="3297" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3300" class="Symbol">(</a><a id="3301" href="ValueSepUTxO.UTxO.html#3292" class="Bound">¬p</a> <a id="3304" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3306" href="ValueSepUTxO.UTxO.html#2825" class="Field">validateValidHashes</a><a id="3325" class="Symbol">)</a>
<a id="3327" class="Symbol">...</a> <a id="3331" class="Symbol">|</a> <a id="3333" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3337" href="ValueSepUTxO.UTxO.html#3337" class="Bound">p₅</a> <a id="3340" class="Symbol">=</a> <a id="3342" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3346" class="Keyword">record</a> <a id="3353" class="Symbol">{</a> <a id="3355" href="ValueSepUTxO.UTxO.html#2518" class="Field">validOutputRefs</a> <a id="3371" class="Symbol">=</a> <a id="3373" class="Bound">p₁</a><a id="3375" class="Symbol">;</a> <a id="3377" href="ValueSepUTxO.UTxO.html#2566" class="Field">preservesValues</a> <a id="3393" class="Symbol">=</a> <a id="3395" class="Bound">p₂</a>
                          <a id="3424" class="Symbol">;</a> <a id="3426" href="ValueSepUTxO.UTxO.html#2725" class="Field">allInputsValidate</a> <a id="3444" class="Symbol">=</a> <a id="3446" class="Bound">p₄</a><a id="3448" class="Symbol">;</a> <a id="3450" href="ValueSepUTxO.UTxO.html#2825" class="Field">validateValidHashes</a> <a id="3470" class="Symbol">=</a> <a id="3472" href="ValueSepUTxO.UTxO.html#3337" class="Bound">p₅</a> <a id="3475" class="Symbol">}</a>

<a id="isValidTx"></a><a id="3478" href="ValueSepUTxO.UTxO.html#3478" class="Function">isValidTx</a> <a id="3488" class="Symbol">:</a> <a id="3490" href="ValueSepUTxO.UTxO.html#1714" class="Record">Tx</a> <a id="3493" class="Symbol">→</a> <a id="3495" href="ValueSepUTxO.UTxO.html#2072" class="Function">S</a> <a id="3497" class="Symbol">→</a> <a id="3499" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="3504" href="ValueSepUTxO.UTxO.html#3478" class="Function">isValidTx</a> <a id="3514" href="ValueSepUTxO.UTxO.html#3514" class="Bound">tx</a> <a id="3517" href="ValueSepUTxO.UTxO.html#3517" class="Bound">s</a> <a id="3519" class="Symbol">=</a> <a id="3521" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="3523" href="ValueSepUTxO.UTxO.html#2941" class="Function">isValidTx?</a> <a id="3534" href="ValueSepUTxO.UTxO.html#3514" class="Bound">tx</a> <a id="3537" href="ValueSepUTxO.UTxO.html#3517" class="Bound">s</a> <a id="3539" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a>
</pre></body></html>