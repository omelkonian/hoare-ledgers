<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ValueSepInt.Ledger</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/hoare-ledgers/tree/master///ValueSepInt/Ledger.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------</a>
<a id="44" class="Comment">-- ** Denotational &amp; operational semantics</a>

<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="112" class="Symbol">;</a> <a id="114" class="Keyword">open</a> <a id="119" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="129" class="Keyword">open</a> <a id="134" class="Keyword">import</a> <a id="141" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="183" class="Keyword">open</a> <a id="188" class="Keyword">import</a> <a id="195" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="237" class="Keyword">open</a> <a id="242" class="Keyword">import</a> <a id="249" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="414" class="Keyword">module</a> <a id="421" href="ValueSepInt.Ledger.html" class="Module">ValueSepInt.Ledger</a>
  <a id="442" class="Symbol">(</a><a id="443" href="ValueSepInt.Ledger.html#443" class="Bound">Part</a> <a id="448" class="Symbol">:</a> <a id="450" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="454" class="Symbol">)</a> <a id="456" class="Comment">-- a fixed set of participants</a>
  <a id="489" class="Symbol">⦃</a> <a id="491" href="ValueSepInt.Ledger.html#491" class="Bound">_</a> <a id="493" class="Symbol">:</a> <a id="495" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="501" href="ValueSepInt.Ledger.html#443" class="Bound">Part</a> <a id="506" class="Symbol">⦄</a>
  <a id="510" class="Keyword">where</a>

<a id="517" class="Keyword">open</a> <a id="522" class="Keyword">import</a> <a id="529" href="ValueSepInt.Maps.html" class="Module">ValueSepInt.Maps</a>

<a id="V"></a><a id="547" href="ValueSepInt.Ledger.html#547" class="Function">V</a> <a id="549" class="Symbol">=</a> <a id="551" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
<a id="553" class="Keyword">instance</a>
  <a id="Sℤ"></a><a id="564" href="ValueSepInt.Ledger.html#564" class="Function">Sℤ</a>  <a id="568" class="Symbol">=</a> <a id="570" href="Prelude.Semigroup.html#5215" class="Function">Semigroup-ℤ-+</a>
  <a id="Sℤ⁺"></a><a id="586" href="ValueSepInt.Ledger.html#586" class="Function">Sℤ⁺</a> <a id="590" class="Symbol">=</a> <a id="592" href="Prelude.Semigroup.html#5274" class="Function">SemigroupLaws-ℤ-+</a>
  <a id="Mℤ"></a><a id="612" href="ValueSepInt.Ledger.html#612" class="Function">Mℤ</a>  <a id="616" class="Symbol">=</a> <a id="618" href="Prelude.Monoid.html#3574" class="Function">Monoid-ℤ-+</a>
  <a id="Mℤ⁺"></a><a id="631" href="ValueSepInt.Ledger.html#631" class="Function">Mℤ⁺</a> <a id="635" class="Symbol">=</a> <a id="637" href="Prelude.Monoid.html#3646" class="Function">MonoidLaws-ℤ-+</a>

<a id="653" class="Keyword">variable</a>
  <a id="664" href="ValueSepInt.Ledger.html#664" class="Generalizable">A</a> <a id="666" href="ValueSepInt.Ledger.html#666" class="Generalizable">B</a> <a id="668" href="ValueSepInt.Ledger.html#668" class="Generalizable">C</a> <a id="670" href="ValueSepInt.Ledger.html#670" class="Generalizable">D</a> <a id="672" class="Symbol">:</a> <a id="674" href="ValueSepInt.Ledger.html#443" class="Bound">Part</a>
  <a id="681" href="ValueSepInt.Ledger.html#681" class="Generalizable">v</a> <a id="683" href="ValueSepInt.Ledger.html#683" class="Generalizable">v′</a> <a id="686" href="ValueSepInt.Ledger.html#686" class="Generalizable">v″</a> <a id="689" class="Symbol">:</a> <a id="691" href="ValueSepInt.Ledger.html#547" class="Function">V</a>

<a id="694" class="Comment">-- The state of a ledger is a collection of participants, along with their balance.</a>
<a id="S"></a><a id="778" href="ValueSepInt.Ledger.html#778" class="Function">S</a> <a id="780" class="Symbol">:</a> <a id="782" href="Agda.Primitive.html#320" class="Primitive">Type</a>
<a id="787" href="ValueSepInt.Ledger.html#778" class="Function">S</a> <a id="789" class="Symbol">=</a> <a id="791" href="ValueSepInt.Maps.html#381" class="Function">Map⟨</a> <a id="796" href="ValueSepInt.Ledger.html#443" class="Bound">Part</a> <a id="801" href="ValueSepInt.Maps.html#381" class="Function">↦</a> <a id="803" href="ValueSepInt.Ledger.html#547" class="Function">V</a> <a id="805" href="ValueSepInt.Maps.html#381" class="Function">⟩</a>

<a id="808" class="Comment">-- A transaction is transferring money from one participant to another.</a>
<a id="880" class="Keyword">record</a> <a id="Tx"></a><a id="887" href="ValueSepInt.Ledger.html#887" class="Record">Tx</a> <a id="890" class="Symbol">:</a> <a id="892" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="897" class="Keyword">where</a>
  <a id="905" class="Keyword">constructor</a> <a id="_—→⟨_⟩_"></a><a id="917" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">_—→⟨_⟩_</a>
  <a id="927" class="Keyword">field</a>
    <a id="Tx.sender"></a><a id="937" href="ValueSepInt.Ledger.html#937" class="Field">sender</a>   <a id="946" class="Symbol">:</a> <a id="948" href="ValueSepInt.Ledger.html#443" class="Bound">Part</a>
    <a id="Tx.value"></a><a id="957" href="ValueSepInt.Ledger.html#957" class="Field">value</a>    <a id="966" class="Symbol">:</a> <a id="968" href="ValueSepInt.Ledger.html#547" class="Function">V</a>
    <a id="Tx.receiver"></a><a id="974" href="ValueSepInt.Ledger.html#974" class="Field">receiver</a> <a id="983" class="Symbol">:</a> <a id="985" href="ValueSepInt.Ledger.html#443" class="Bound">Part</a>
<a id="990" class="Keyword">open</a> <a id="995" href="ValueSepInt.Ledger.html#887" class="Module">Tx</a> <a id="998" class="Keyword">public</a>
<a id="1005" class="Keyword">unquoteDecl</a> <a id="DecEq-Tx"></a><a id="1017" href="ValueSepInt.Ledger.html#1017" class="Function">DecEq-Tx</a> <a id="1026" class="Symbol">=</a> <a id="1028" href="Prelude.Generics.Deriving.html#1365" class="Macro">DERIVE</a> <a id="1035" href="Prelude.DecEq.Core.html#148" class="Record">DecEq</a> <a id="1041" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1043" class="Keyword">quote</a> <a id="1049" href="ValueSepInt.Ledger.html#887" class="Record">Tx</a> <a id="1052" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1054" href="ValueSepInt.Ledger.html#1017" class="Function">DecEq-Tx</a> <a id="1063" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>

<a id="1066" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="1105" href="ValueSepInt.Ledger.html#1105" class="Function">L</a> <a id="1107" class="Symbol">=</a> <a id="1109" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1114" href="ValueSepInt.Ledger.html#887" class="Record">Tx</a>

<a id="1118" class="Keyword">variable</a>
  <a id="1129" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="1131" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a> <a id="1134" href="ValueSepInt.Ledger.html#1134" class="Generalizable">s″</a> <a id="1137" href="ValueSepInt.Ledger.html#1137" class="Generalizable">s₁</a> <a id="1140" href="ValueSepInt.Ledger.html#1140" class="Generalizable">s₁′</a> <a id="1144" href="ValueSepInt.Ledger.html#1144" class="Generalizable">s₁″</a> <a id="1148" href="ValueSepInt.Ledger.html#1148" class="Generalizable">s₂</a> <a id="1151" href="ValueSepInt.Ledger.html#1151" class="Generalizable">s₂′</a> <a id="1155" href="ValueSepInt.Ledger.html#1155" class="Generalizable">s₂″</a> <a id="1159" href="ValueSepInt.Ledger.html#1159" class="Generalizable">s₃</a> <a id="1162" href="ValueSepInt.Ledger.html#1162" class="Generalizable">s₃′</a> <a id="1166" href="ValueSepInt.Ledger.html#1166" class="Generalizable">s₃″</a> <a id="1170" href="ValueSepInt.Ledger.html#1170" class="Generalizable">s₂₃</a> <a id="1174" href="ValueSepInt.Ledger.html#1174" class="Generalizable">s₂₃′</a> <a id="1179" href="ValueSepInt.Ledger.html#1179" class="Generalizable">s₂₃″</a> <a id="1184" class="Symbol">:</a> <a id="1186" href="ValueSepInt.Ledger.html#778" class="Function">S</a>
  <a id="1190" href="ValueSepInt.Ledger.html#1190" class="Generalizable">t</a> <a id="1192" href="ValueSepInt.Ledger.html#1192" class="Generalizable">t′</a> <a id="1195" href="ValueSepInt.Ledger.html#1195" class="Generalizable">t″</a> <a id="1198" class="Symbol">:</a> <a id="1200" href="ValueSepInt.Ledger.html#887" class="Record">Tx</a>
  <a id="1205" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="1207" href="ValueSepInt.Ledger.html#1207" class="Generalizable">l′</a> <a id="1210" href="ValueSepInt.Ledger.html#1210" class="Generalizable">l″</a> <a id="1213" href="ValueSepInt.Ledger.html#1213" class="Generalizable">l₁</a> <a id="1216" href="ValueSepInt.Ledger.html#1216" class="Generalizable">l₂</a> <a id="1219" class="Symbol">:</a> <a id="1221" href="ValueSepInt.Ledger.html#1105" class="Function">L</a>
  <a id="1225" href="ValueSepInt.Ledger.html#1225" class="Generalizable">ls</a> <a id="1228" href="ValueSepInt.Ledger.html#1228" class="Generalizable">ls′</a> <a id="1232" href="ValueSepInt.Ledger.html#1232" class="Generalizable">ls″</a> <a id="1236" class="Symbol">:</a> <a id="1238" href="ValueSepInt.Ledger.html#1105" class="Function">L</a> <a id="1240" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1242" href="ValueSepInt.Ledger.html#778" class="Function">S</a>

  <a id="1247" href="ValueSepInt.Ledger.html#1247" class="Generalizable">ms</a> <a id="1250" href="ValueSepInt.Ledger.html#1250" class="Generalizable">ms′</a> <a id="1254" href="ValueSepInt.Ledger.html#1254" class="Generalizable">ms″</a> <a id="1258" class="Symbol">:</a> <a id="1260" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1266" href="ValueSepInt.Ledger.html#778" class="Function">S</a>
  <a id="1270" href="ValueSepInt.Ledger.html#1270" class="Generalizable">mls</a> <a id="1274" href="ValueSepInt.Ledger.html#1274" class="Generalizable">mls′</a> <a id="1279" href="ValueSepInt.Ledger.html#1279" class="Generalizable">mls″</a> <a id="1284" class="Symbol">:</a> <a id="1286" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1292" class="Symbol">(</a><a id="1293" href="ValueSepInt.Ledger.html#1105" class="Function">L</a> <a id="1295" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1297" href="ValueSepInt.Ledger.html#778" class="Function">S</a><a id="1298" class="Symbol">)</a>

<a id="1301" class="Comment">-- ** Denotational semantics</a>

<a id="1331" class="Comment">-- The meaning of a transaction or a whole ledger will be denoted by state transformers,</a>
<a id="1420" class="Comment">-- i.e. a function from the current state to the updated one.</a>
<a id="Domain"></a><a id="1482" href="ValueSepInt.Ledger.html#1482" class="Function">Domain</a> <a id="1489" class="Symbol">=</a> <a id="1491" href="ValueSepInt.Ledger.html#778" class="Function">S</a> <a id="1493" class="Symbol">→</a> <a id="1495" href="ValueSepInt.Ledger.html#778" class="Function">S</a>

<a id="1498" class="Keyword">record</a> <a id="Denotable"></a><a id="1505" href="ValueSepInt.Ledger.html#1505" class="Record">Denotable</a> <a id="1515" class="Symbol">(</a><a id="1516" href="ValueSepInt.Ledger.html#1516" class="Bound">A</a> <a id="1518" class="Symbol">:</a> <a id="1520" href="Agda.Primitive.html#320" class="Primitive">Type</a><a id="1524" class="Symbol">)</a> <a id="1526" class="Symbol">:</a> <a id="1528" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1533" class="Keyword">where</a>
  <a id="1541" class="Keyword">field</a> <a id="Denotable.⟦_⟧"></a><a id="1547" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦_⟧</a> <a id="1551" class="Symbol">:</a> <a id="1553" href="ValueSepInt.Ledger.html#1516" class="Bound">A</a> <a id="1555" class="Symbol">→</a> <a id="1557" href="ValueSepInt.Ledger.html#1482" class="Function">Domain</a>
<a id="1564" class="Keyword">open</a> <a id="1569" href="ValueSepInt.Ledger.html#1505" class="Module">Denotable</a> <a id="1579" class="Symbol">⦃...⦄</a> <a id="1585" class="Keyword">public</a>

<a id="1593" class="Comment">-- Express the action of tranferring values between keys in a map.</a>
<a id="1660" class="Comment">-- NB: a transaction goes through only when:</a>
<a id="1705" class="Comment">--   1. both participants are present in the domain</a>
<a id="1757" class="Comment">--   2. the sender holds sufficient funds</a>
<a id="1799" class="Keyword">instance</a>
  <a id="1810" class="Comment">-- we denote a transaction as the map transformation that implements the transfer</a>
  <a id="⟦Tx⟧"></a><a id="1894" href="ValueSepInt.Ledger.html#1894" class="Function">⟦Tx⟧</a> <a id="1899" class="Symbol">:</a> <a id="1901" href="ValueSepInt.Ledger.html#1505" class="Record">Denotable</a> <a id="1911" href="ValueSepInt.Ledger.html#887" class="Record">Tx</a>
  <a id="1916" href="ValueSepInt.Ledger.html#1894" class="Function">⟦Tx⟧</a> <a id="1921" class="Symbol">.</a><a id="1922" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦_⟧</a> <a id="1926" class="Symbol">(</a><a id="1927" href="ValueSepInt.Ledger.html#1927" class="Bound">A</a> <a id="1929" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">—→⟨</a> <a id="1933" href="ValueSepInt.Ledger.html#1933" class="Bound">v</a> <a id="1935" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">⟩</a> <a id="1937" href="ValueSepInt.Ledger.html#1937" class="Bound">B</a><a id="1938" class="Symbol">)</a> <a id="1940" href="ValueSepInt.Ledger.html#1940" class="Bound">s</a> <a id="1942" class="Symbol">=</a> <a id="1944" href="ValueSepInt.Ledger.html#1940" class="Bound">s</a> <a id="1946" href="ValueSepInt.Maps.html#1215" class="Function Operator">[</a> <a id="1948" href="ValueSepInt.Ledger.html#1927" class="Bound">A</a> <a id="1950" href="ValueSepInt.Maps.html#1215" class="Function Operator">↝</a> <a id="1952" class="Symbol">(</a><a id="1953" href="Data.Integer.Base.html#5032" class="Function Operator">Integer._-</a> <a id="1964" href="ValueSepInt.Ledger.html#1933" class="Bound">v</a><a id="1965" class="Symbol">)</a> <a id="1967" href="ValueSepInt.Maps.html#1215" class="Function Operator">]</a> <a id="1969" href="ValueSepInt.Maps.html#1215" class="Function Operator">[</a> <a id="1971" href="ValueSepInt.Ledger.html#1937" class="Bound">B</a> <a id="1973" href="ValueSepInt.Maps.html#1215" class="Function Operator">↝</a> <a id="1975" class="Symbol">(</a><a id="1976" href="Data.Integer.Base.html#4853" class="Function Operator">Integer._+</a> <a id="1987" href="ValueSepInt.Ledger.html#1933" class="Bound">v</a><a id="1988" class="Symbol">)</a> <a id="1990" href="ValueSepInt.Maps.html#1215" class="Function Operator">]</a>

  <a id="1995" class="Comment">-- we denote a ledger as the composition of the denotations of its transactions,</a>
  <a id="2078" class="Comment">-- i.e. we run all transactions in sequence</a>
  <a id="⟦L⟧"></a><a id="2124" href="ValueSepInt.Ledger.html#2124" class="Function">⟦L⟧</a> <a id="2128" class="Symbol">:</a> <a id="2130" href="ValueSepInt.Ledger.html#1505" class="Record">Denotable</a> <a id="2140" href="ValueSepInt.Ledger.html#1105" class="Function">L</a>
  <a id="2144" href="ValueSepInt.Ledger.html#2124" class="Function">⟦L⟧</a> <a id="2148" class="Symbol">.</a><a id="2149" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦_⟧</a> <a id="2153" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>      <a id="2161" class="Symbol">=</a> <a id="2163" href="Function.Base.html#624" class="Function">id</a>
  <a id="2168" href="ValueSepInt.Ledger.html#2124" class="Function">⟦L⟧</a> <a id="2172" class="Symbol">.</a><a id="2173" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦_⟧</a> <a id="2177" class="Symbol">(</a><a id="2178" href="ValueSepInt.Ledger.html#2178" class="Bound">t</a> <a id="2180" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2182" href="ValueSepInt.Ledger.html#2182" class="Bound">l</a><a id="2183" class="Symbol">)</a> <a id="2185" class="Symbol">=</a> <a id="2187" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="2189" href="ValueSepInt.Ledger.html#2182" class="Bound">l</a> <a id="2191" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a> <a id="2193" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2195" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="2197" href="ValueSepInt.Ledger.html#2178" class="Bound">t</a> <a id="2199" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a>

<a id="comp"></a><a id="2202" href="ValueSepInt.Ledger.html#2202" class="Function">comp</a> <a id="2207" class="Symbol">:</a> <a id="2209" class="Symbol">∀</a> <a id="2211" href="ValueSepInt.Ledger.html#2211" class="Bound">x</a> <a id="2213" class="Symbol">→</a> <a id="2215" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="2217" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="2219" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2222" href="ValueSepInt.Ledger.html#1207" class="Generalizable">l′</a> <a id="2225" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a> <a id="2227" href="ValueSepInt.Ledger.html#2211" class="Bound">x</a> <a id="2229" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2231" class="Symbol">(</a><a id="2232" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="2234" href="ValueSepInt.Ledger.html#1207" class="Generalizable">l′</a> <a id="2237" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a> <a id="2239" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2241" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="2243" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="2245" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a><a id="2246" class="Symbol">)</a> <a id="2248" href="ValueSepInt.Ledger.html#2211" class="Bound">x</a>
<a id="2250" href="ValueSepInt.Ledger.html#2202" class="Function">comp</a> <a id="2255" class="Symbol">{</a><a id="2256" class="Argument">l</a> <a id="2258" class="Symbol">=</a> <a id="2260" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2262" class="Symbol">}</a>    <a id="2267" class="Symbol">_</a> <a id="2269" class="Symbol">=</a> <a id="2271" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="2276" href="ValueSepInt.Ledger.html#2202" class="Function">comp</a> <a id="2281" class="Symbol">{</a><a id="2282" class="Argument">l</a> <a id="2284" class="Symbol">=</a> <a id="2286" href="ValueSepInt.Ledger.html#2286" class="Bound">t</a> <a id="2288" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2290" href="ValueSepInt.Ledger.html#2290" class="Bound">l</a><a id="2291" class="Symbol">}</a> <a id="2293" href="ValueSepInt.Ledger.html#2293" class="Bound">x</a> <a id="2295" class="Symbol">=</a> <a id="2297" href="ValueSepInt.Ledger.html#2202" class="Function">comp</a> <a id="2302" class="Symbol">{</a><a id="2303" href="ValueSepInt.Ledger.html#2290" class="Bound">l</a><a id="2304" class="Symbol">}</a> <a id="2306" class="Symbol">(</a><a id="2307" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="2309" href="ValueSepInt.Ledger.html#2286" class="Bound">t</a> <a id="2311" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a> <a id="2313" href="ValueSepInt.Ledger.html#2293" class="Bound">x</a><a id="2314" class="Symbol">)</a>

<a id="2317" class="Comment">-- Executing transactions never introduces new keys in the resulting map out-of-thin-air.</a>
<a id="2407" class="Comment">-- ** Operational semantics</a>
<a id="2435" class="Comment">-- We model configurations of the transition system as pairs of a ledger and its current state.</a>

<a id="2532" class="Keyword">infix</a> <a id="2538" class="Number">0</a> <a id="2540" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">_—→_</a>
<a id="2545" class="Keyword">data</a> <a id="_—→_"></a><a id="2550" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">_—→_</a> <a id="2555" class="Symbol">:</a> <a id="2557" href="ValueSepInt.Ledger.html#1105" class="Function">L</a> <a id="2559" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2561" href="ValueSepInt.Ledger.html#778" class="Function">S</a> <a id="2563" class="Symbol">→</a> <a id="2565" href="ValueSepInt.Ledger.html#778" class="Function">S</a> <a id="2567" class="Symbol">→</a> <a id="2569" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="2574" class="Keyword">where</a>

  <a id="_—→_.base"></a><a id="2583" href="ValueSepInt.Ledger.html#2583" class="InductiveConstructor">base</a> <a id="2588" class="Symbol">:</a>
    <a id="2594" href="Prelude.InferenceRules.html#47641" class="Function Operator">────────────</a>
    <a id="2611" href="Prelude.Monoid.html#222" class="Field">ε</a> <a id="2613" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2615" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="2617" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="2620" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a>

  <a id="_—→_.step"></a><a id="2625" href="ValueSepInt.Ledger.html#2625" class="InductiveConstructor">step</a> <a id="2630" class="Symbol">:</a> <a id="2632" class="Keyword">let</a> <a id="2636" href="ValueSepInt.Ledger.html#2636" class="Bound">t</a> <a id="2638" class="Symbol">=</a> <a id="2640" href="ValueSepInt.Ledger.html#664" class="Generalizable">A</a> <a id="2642" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">—→⟨</a> <a id="2646" href="ValueSepInt.Ledger.html#681" class="Generalizable">v</a> <a id="2648" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">⟩</a> <a id="2650" href="ValueSepInt.Ledger.html#666" class="Generalizable">B</a> <a id="2652" class="Keyword">in</a>

    <a id="2660" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="2662" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="2664" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2666" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="2668" href="ValueSepInt.Ledger.html#2636" class="Bound">t</a> <a id="2670" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a> <a id="2672" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="2674" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="2677" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>
      <a id="2686" href="Prelude.InferenceRules.html#14210" class="Function Operator">─────────────────</a>
      <a id="2710" href="ValueSepInt.Ledger.html#2636" class="Bound">t</a> <a id="2712" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2714" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="2716" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2718" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="2720" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="2723" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>

<a id="oper-comp"></a><a id="2727" href="ValueSepInt.Ledger.html#2727" class="Function">oper-comp</a> <a id="2737" class="Symbol">:</a>
  <a id="2741" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="2743" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a>       <a id="2751" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2753" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a>  <a id="2756" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="2759" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>
  <a id="2764" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="2766" href="ValueSepInt.Ledger.html#1207" class="Generalizable">l′</a>      <a id="2774" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2776" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a> <a id="2779" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="2782" href="ValueSepInt.Ledger.html#1134" class="Generalizable">s″</a>
    <a id="2789" href="Prelude.InferenceRules.html#14187" class="Function Operator">──────────────────</a>
    <a id="2812" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="2814" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2817" href="ValueSepInt.Ledger.html#1207" class="Generalizable">l′</a> <a id="2820" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2822" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a>  <a id="2825" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="2828" href="ValueSepInt.Ledger.html#1134" class="Generalizable">s″</a>
<a id="2831" href="ValueSepInt.Ledger.html#2727" class="Function">oper-comp</a> <a id="2841" class="Symbol">{</a><a id="2842" class="Argument">l</a> <a id="2844" class="Symbol">=</a> <a id="2846" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2848" class="Symbol">}</a>    <a id="2853" href="ValueSepInt.Ledger.html#2583" class="InductiveConstructor">base</a>        <a id="2865" href="ValueSepInt.Ledger.html#2865" class="Bound">s′→s″</a> <a id="2871" class="Symbol">=</a> <a id="2873" href="ValueSepInt.Ledger.html#2865" class="Bound">s′→s″</a>
<a id="2879" href="ValueSepInt.Ledger.html#2727" class="Function">oper-comp</a> <a id="2889" class="Symbol">{</a><a id="2890" class="Argument">l</a> <a id="2892" class="Symbol">=</a> <a id="2894" class="Symbol">_</a> <a id="2896" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2898" class="Symbol">_}</a> <a id="2901" class="Symbol">(</a><a id="2902" href="ValueSepInt.Ledger.html#2625" class="InductiveConstructor">step</a> <a id="2907" href="ValueSepInt.Ledger.html#2907" class="Bound">s→s′</a><a id="2911" class="Symbol">)</a> <a id="2913" href="ValueSepInt.Ledger.html#2913" class="Bound">s′→s″</a> <a id="2919" class="Symbol">=</a> <a id="2921" href="ValueSepInt.Ledger.html#2625" class="InductiveConstructor">step</a> <a id="2926" class="Symbol">(</a><a id="2927" href="ValueSepInt.Ledger.html#2727" class="Function">oper-comp</a> <a id="2937" href="ValueSepInt.Ledger.html#2907" class="Bound">s→s′</a> <a id="2942" href="ValueSepInt.Ledger.html#2913" class="Bound">s′→s″</a><a id="2947" class="Symbol">)</a>

<a id="2950" class="Comment">-- ** Relating denotational and operational semantics.</a>
<a id="denot⇒oper"></a><a id="3005" href="ValueSepInt.Ledger.html#3005" class="Function">denot⇒oper</a> <a id="3016" class="Symbol">:</a>
  <a id="3020" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="3022" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="3024" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a> <a id="3026" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="3028" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3030" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>
  <a id="3035" href="Prelude.InferenceRules.html#14310" class="Function Operator">────────────</a>
  <a id="3050" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="3052" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3054" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="3056" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="3059" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>
<a id="3062" href="ValueSepInt.Ledger.html#3005" class="Function">denot⇒oper</a> <a id="3073" class="Symbol">{</a><a id="3074" class="Argument">l</a> <a id="3076" class="Symbol">=</a> <a id="3078" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="3080" class="Symbol">}</a> <a id="3082" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3087" class="Symbol">=</a> <a id="3089" href="ValueSepInt.Ledger.html#2583" class="InductiveConstructor">base</a>
<a id="3094" href="ValueSepInt.Ledger.html#3005" class="Function">denot⇒oper</a> <a id="3105" class="Symbol">{</a><a id="3106" class="Argument">l</a> <a id="3108" class="Symbol">=</a> <a id="3110" href="ValueSepInt.Ledger.html#3110" class="Bound">A</a> <a id="3112" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">—→⟨</a> <a id="3116" href="ValueSepInt.Ledger.html#3116" class="Bound">v</a> <a id="3118" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">⟩</a> <a id="3120" href="ValueSepInt.Ledger.html#3120" class="Bound">B</a> <a id="3122" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3124" href="ValueSepInt.Ledger.html#3124" class="Bound">l</a><a id="3125" class="Symbol">}{</a><a id="3127" href="ValueSepInt.Ledger.html#3127" class="Bound">s</a><a id="3128" class="Symbol">}</a> <a id="3130" href="ValueSepInt.Ledger.html#3130" class="Bound">l≡</a> <a id="3133" class="Symbol">=</a> <a id="3135" href="ValueSepInt.Ledger.html#2625" class="InductiveConstructor">step</a> <a id="3140" class="Symbol">(</a><a id="3141" href="ValueSepInt.Ledger.html#3005" class="Function">denot⇒oper</a> <a id="3152" href="ValueSepInt.Ledger.html#3130" class="Bound">l≡</a><a id="3154" class="Symbol">)</a>

<a id="oper⇒denot"></a><a id="3157" href="ValueSepInt.Ledger.html#3157" class="Function">oper⇒denot</a> <a id="3168" class="Symbol">:</a>
  <a id="3172" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="3174" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3176" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="3178" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="3181" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>
  <a id="3186" href="Prelude.InferenceRules.html#14310" class="Function Operator">────────────</a>
  <a id="3201" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="3203" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="3205" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a> <a id="3207" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="3209" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3211" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>
<a id="3214" href="ValueSepInt.Ledger.html#3157" class="Function">oper⇒denot</a> <a id="3225" class="Symbol">{</a><a id="3226" class="Argument">l</a> <a id="3228" class="Symbol">=</a> <a id="3230" class="DottedPattern Symbol">.</a><a id="3231" href="Agda.Builtin.List.html#167" class="DottedPattern InductiveConstructor">[]</a><a id="3233" class="Symbol">}</a> <a id="3235" href="ValueSepInt.Ledger.html#2583" class="InductiveConstructor">base</a> <a id="3240" class="Symbol">=</a> <a id="3242" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="3247" href="ValueSepInt.Ledger.html#3157" class="Function">oper⇒denot</a> <a id="3258" class="Symbol">{</a><a id="3259" class="Argument">l</a> <a id="3261" class="Symbol">=</a> <a id="3263" href="ValueSepInt.Ledger.html#3263" class="Bound">A</a> <a id="3265" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">—→⟨</a> <a id="3269" href="ValueSepInt.Ledger.html#3269" class="Bound">v</a> <a id="3271" href="ValueSepInt.Ledger.html#917" class="InductiveConstructor Operator">⟩</a> <a id="3273" href="ValueSepInt.Ledger.html#3273" class="Bound">B</a> <a id="3275" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3277" class="Symbol">_}{</a><a id="3280" href="ValueSepInt.Ledger.html#3280" class="Bound">s</a><a id="3281" class="Symbol">}</a> <a id="3283" class="Symbol">(</a><a id="3284" href="ValueSepInt.Ledger.html#2625" class="InductiveConstructor">step</a> <a id="3289" href="ValueSepInt.Ledger.html#3289" class="Bound">p</a><a id="3290" class="Symbol">)</a> <a id="3292" class="Symbol">=</a> <a id="3294" href="ValueSepInt.Ledger.html#3157" class="Function">oper⇒denot</a> <a id="3305" href="ValueSepInt.Ledger.html#3289" class="Bound">p</a>

<a id="denot⇔oper"></a><a id="3308" href="ValueSepInt.Ledger.html#3308" class="Function">denot⇔oper</a> <a id="3319" class="Symbol">:</a>
  <a id="3323" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟦</a> <a id="3325" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="3327" href="ValueSepInt.Ledger.html#1547" class="Field Operator">⟧</a> <a id="3329" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="3331" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3333" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>
  <a id="3338" href="Prelude.InferenceRules.html#70370" class="Function Operator">════════════</a>
  <a id="3353" href="ValueSepInt.Ledger.html#1205" class="Generalizable">l</a> <a id="3355" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3357" href="ValueSepInt.Ledger.html#1129" class="Generalizable">s</a> <a id="3359" href="ValueSepInt.Ledger.html#2550" class="Datatype Operator">—→</a> <a id="3362" href="ValueSepInt.Ledger.html#1131" class="Generalizable">s′</a>
<a id="3365" href="ValueSepInt.Ledger.html#3308" class="Function">denot⇔oper</a> <a id="3376" class="Symbol">=</a> <a id="3378" href="ValueSepInt.Ledger.html#3005" class="Function">denot⇒oper</a> <a id="3389" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3391" href="ValueSepInt.Ledger.html#3157" class="Function">oper⇒denot</a>
</pre></body></html>