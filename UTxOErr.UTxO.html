<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxOErr.UTxO</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">----------------------------------------------</a>
<a id="48" class="Comment">-- ** Basic definition for UTxO-based ledgers.</a>

<a id="96" class="Keyword">module</a> <a id="103" href="UTxOErr.UTxO.html" class="Module">UTxOErr.UTxO</a> <a id="116" class="Keyword">where</a>

<a id="123" class="Keyword">open</a> <a id="128" class="Keyword">import</a> <a id="135" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="147" class="Symbol">;</a> <a id="149" class="Keyword">open</a> <a id="154" href="Prelude.Init.html#397" class="Module">SetAsType</a>
<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="192" class="Keyword">open</a> <a id="197" class="Keyword">import</a> <a id="204" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="298" class="Keyword">open</a> <a id="303" class="Keyword">import</a> <a id="310" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="327" class="Keyword">open</a> <a id="332" class="Keyword">import</a> <a id="339" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>

<a id="388" class="Keyword">open</a> <a id="393" class="Keyword">import</a> <a id="400" href="UTxOErr.Maps.html" class="Module">UTxOErr.Maps</a>

<a id="Value"></a><a id="414" href="UTxOErr.UTxO.html#414" class="Function">Value</a>   <a id="422" class="Symbol">=</a> <a id="424" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="HashId"></a><a id="426" href="UTxOErr.UTxO.html#426" class="Function">HashId</a>  <a id="434" class="Symbol">=</a> <a id="436" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="Address"></a><a id="438" href="UTxOErr.UTxO.html#438" class="Function">Address</a> <a id="446" class="Symbol">=</a> <a id="448" href="UTxOErr.UTxO.html#426" class="Function">HashId</a>
<a id="455" class="Keyword">postulate</a> <a id="_♯"></a><a id="465" href="UTxOErr.UTxO.html#465" class="Postulate Operator">_♯</a> <a id="468" class="Symbol">:</a> <a id="470" class="Symbol">∀</a> <a id="472" class="Symbol">{</a><a id="473" href="UTxOErr.UTxO.html#473" class="Bound">A</a> <a id="475" class="Symbol">:</a> <a id="477" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="482" href="Prelude.Init.html#238" class="Generalizable">ℓ</a><a id="483" class="Symbol">}</a> <a id="485" class="Symbol">→</a> <a id="487" href="UTxOErr.UTxO.html#473" class="Bound">A</a> <a id="489" class="Symbol">→</a> <a id="491" href="UTxOErr.UTxO.html#426" class="Function">HashId</a>

<a id="DATA"></a><a id="499" href="UTxOErr.UTxO.html#499" class="Function">DATA</a> <a id="504" class="Symbol">=</a> <a id="506" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="508" class="Comment">-- T0D0: more realistic data for redeemers</a>

<a id="552" class="Keyword">record</a> <a id="TxOutputRef"></a><a id="559" href="UTxOErr.UTxO.html#559" class="Record">TxOutputRef</a> <a id="571" class="Symbol">:</a> <a id="573" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="578" class="Keyword">where</a>
  <a id="586" class="Keyword">constructor</a> <a id="_indexed-at_"></a><a id="598" href="UTxOErr.UTxO.html#598" class="InductiveConstructor Operator">_indexed-at_</a>
  <a id="613" class="Keyword">field</a> <a id="TxOutputRef.txId"></a><a id="619" href="UTxOErr.UTxO.html#619" class="Field">txId</a>  <a id="625" class="Symbol">:</a> <a id="627" href="UTxOErr.UTxO.html#426" class="Function">HashId</a>
        <a id="TxOutputRef.index"></a><a id="642" href="UTxOErr.UTxO.html#642" class="Field">index</a> <a id="648" class="Symbol">:</a> <a id="650" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="652" class="Keyword">open</a> <a id="657" href="UTxOErr.UTxO.html#559" class="Module">TxOutputRef</a> <a id="669" class="Keyword">public</a>
<a id="676" class="Keyword">unquoteDecl</a> <a id="DecEq-TxOR"></a><a id="688" href="UTxOErr.UTxO.html#688" class="Function">DecEq-TxOR</a> <a id="699" class="Symbol">=</a> <a id="701" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="708" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="714" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="716" class="Keyword">quote</a> <a id="722" href="UTxOErr.UTxO.html#559" class="Record">TxOutputRef</a> <a id="734" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="736" href="UTxOErr.UTxO.html#688" class="Function">DecEq-TxOR</a> <a id="747" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="750" class="Keyword">record</a> <a id="TxOutput"></a><a id="757" href="UTxOErr.UTxO.html#757" class="Record">TxOutput</a> <a id="766" class="Symbol">:</a> <a id="768" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="773" class="Keyword">where</a>
  <a id="781" class="Keyword">constructor</a> <a id="_at_"></a><a id="793" href="UTxOErr.UTxO.html#793" class="InductiveConstructor Operator">_at_</a>
  <a id="800" class="Keyword">field</a> <a id="TxOutput.value"></a><a id="806" href="UTxOErr.UTxO.html#806" class="Field">value</a>    <a id="815" class="Symbol">:</a> <a id="817" href="UTxOErr.UTxO.html#414" class="Function">Value</a>
        <a id="TxOutput.address"></a><a id="831" href="UTxOErr.UTxO.html#831" class="Field">address</a>  <a id="840" class="Symbol">:</a> <a id="842" href="UTxOErr.UTxO.html#438" class="Function">Address</a>
<a id="850" class="Keyword">open</a> <a id="855" href="UTxOErr.UTxO.html#757" class="Module">TxOutput</a> <a id="864" class="Keyword">public</a>
<a id="871" class="Keyword">unquoteDecl</a> <a id="DecEq-TxO"></a><a id="883" href="UTxOErr.UTxO.html#883" class="Function">DecEq-TxO</a> <a id="893" class="Symbol">=</a> <a id="895" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="902" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="908" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="910" class="Keyword">quote</a> <a id="916" href="UTxOErr.UTxO.html#757" class="Record">TxOutput</a> <a id="925" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="927" href="UTxOErr.UTxO.html#883" class="Function">DecEq-TxO</a> <a id="937" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="940" class="Keyword">record</a> <a id="InputInfo"></a><a id="947" href="UTxOErr.UTxO.html#947" class="Record">InputInfo</a> <a id="957" class="Symbol">:</a> <a id="959" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="964" class="Keyword">where</a>
  <a id="972" class="Keyword">field</a> <a id="InputInfo.outputRef"></a><a id="978" href="UTxOErr.UTxO.html#978" class="Field">outputRef</a>     <a id="992" class="Symbol">:</a> <a id="994" href="UTxOErr.UTxO.html#559" class="Record">TxOutputRef</a>
        <a id="InputInfo.validatorHash"></a><a id="1014" href="UTxOErr.UTxO.html#1014" class="Field">validatorHash</a> <a id="1028" class="Symbol">:</a> <a id="1030" href="UTxOErr.UTxO.html#426" class="Function">HashId</a>
        <a id="InputInfo.redeemerHash"></a><a id="1045" href="UTxOErr.UTxO.html#1045" class="Field">redeemerHash</a>  <a id="1059" class="Symbol">:</a> <a id="1061" href="UTxOErr.UTxO.html#426" class="Function">HashId</a>

<a id="1069" class="Keyword">record</a> <a id="TxInfo"></a><a id="1076" href="UTxOErr.UTxO.html#1076" class="Record">TxInfo</a> <a id="1083" class="Symbol">:</a> <a id="1085" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1090" class="Keyword">where</a>
  <a id="1098" class="Keyword">field</a> <a id="TxInfo.inputs"></a><a id="1104" href="UTxOErr.UTxO.html#1104" class="Field">inputs</a>  <a id="1112" class="Symbol">:</a> <a id="1114" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1119" href="UTxOErr.UTxO.html#947" class="Record">InputInfo</a>
        <a id="TxInfo.outputs"></a><a id="1137" href="UTxOErr.UTxO.html#1137" class="Field">outputs</a> <a id="1145" class="Symbol">:</a> <a id="1147" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1152" href="UTxOErr.UTxO.html#757" class="Record">TxOutput</a>
        <a id="TxInfo.forge"></a><a id="1169" href="UTxOErr.UTxO.html#1169" class="Field">forge</a>   <a id="1177" class="Symbol">:</a> <a id="1179" href="UTxOErr.UTxO.html#414" class="Function">Value</a>

<a id="1186" class="Keyword">record</a> <a id="TxInput"></a><a id="1193" href="UTxOErr.UTxO.html#1193" class="Record">TxInput</a> <a id="1201" class="Symbol">:</a> <a id="1203" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1208" class="Keyword">where</a>
  <a id="1216" class="Keyword">field</a> <a id="TxInput.outputRef"></a><a id="1222" href="UTxOErr.UTxO.html#1222" class="Field">outputRef</a> <a id="1232" class="Symbol">:</a> <a id="1234" href="UTxOErr.UTxO.html#559" class="Record">TxOutputRef</a>
        <a id="TxInput.validator"></a><a id="1254" href="UTxOErr.UTxO.html#1254" class="Field">validator</a> <a id="1264" class="Symbol">:</a> <a id="1266" href="UTxOErr.UTxO.html#1076" class="Record">TxInfo</a> <a id="1273" class="Symbol">→</a> <a id="1275" href="UTxOErr.UTxO.html#499" class="Function">DATA</a> <a id="1280" class="Symbol">→</a> <a id="1282" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
        <a id="TxInput.redeemer"></a><a id="1295" href="UTxOErr.UTxO.html#1295" class="Field">redeemer</a>  <a id="1305" class="Symbol">:</a> <a id="1307" href="UTxOErr.UTxO.html#499" class="Function">DATA</a>
<a id="1312" class="Keyword">open</a> <a id="1317" href="UTxOErr.UTxO.html#1193" class="Module">TxInput</a> <a id="1325" class="Keyword">public</a>

<a id="mkInputInfo"></a><a id="1333" href="UTxOErr.UTxO.html#1333" class="Function">mkInputInfo</a> <a id="1345" class="Symbol">:</a> <a id="1347" href="UTxOErr.UTxO.html#1193" class="Record">TxInput</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="UTxOErr.UTxO.html#947" class="Record">InputInfo</a>
<a id="1367" href="UTxOErr.UTxO.html#1333" class="Function">mkInputInfo</a> <a id="1379" href="UTxOErr.UTxO.html#1379" class="Bound">i</a> <a id="1381" class="Symbol">=</a> <a id="1383" class="Keyword">record</a>
  <a id="1392" class="Symbol">{</a> <a id="1394" href="UTxOErr.UTxO.html#978" class="Field">outputRef</a>     <a id="1408" class="Symbol">=</a> <a id="1410" href="UTxOErr.UTxO.html#1379" class="Bound">i</a> <a id="1412" class="Symbol">.</a><a id="1413" href="UTxOErr.UTxO.html#1222" class="Field">outputRef</a>
  <a id="1425" class="Symbol">;</a> <a id="1427" href="UTxOErr.UTxO.html#1014" class="Field">validatorHash</a> <a id="1441" class="Symbol">=</a> <a id="1443" href="UTxOErr.UTxO.html#1379" class="Bound">i</a> <a id="1445" class="Symbol">.</a><a id="1446" href="UTxOErr.UTxO.html#1254" class="Field">validator</a> <a id="1456" href="UTxOErr.UTxO.html#465" class="Postulate Operator">♯</a>
  <a id="1460" class="Symbol">;</a> <a id="1462" href="UTxOErr.UTxO.html#1045" class="Field">redeemerHash</a>  <a id="1476" class="Symbol">=</a> <a id="1478" href="UTxOErr.UTxO.html#1379" class="Bound">i</a> <a id="1480" class="Symbol">.</a><a id="1481" href="UTxOErr.UTxO.html#1295" class="Field">redeemer</a> <a id="1490" href="UTxOErr.UTxO.html#465" class="Postulate Operator">♯</a> <a id="1492" class="Symbol">}</a>

<a id="1495" class="Keyword">record</a> <a id="Tx"></a><a id="1502" href="UTxOErr.UTxO.html#1502" class="Record">Tx</a> <a id="1505" class="Symbol">:</a> <a id="1507" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1512" class="Keyword">where</a>
  <a id="1520" class="Keyword">field</a>
    <a id="Tx.inputs"></a><a id="1530" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a>  <a id="1538" class="Symbol">:</a> <a id="1540" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1545" href="UTxOErr.UTxO.html#1193" class="Record">TxInput</a>
    <a id="Tx.outputs"></a><a id="1557" href="UTxOErr.UTxO.html#1557" class="Field">outputs</a> <a id="1565" class="Symbol">:</a> <a id="1567" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1572" href="UTxOErr.UTxO.html#757" class="Record">TxOutput</a>
    <a id="Tx.forge"></a><a id="1585" href="UTxOErr.UTxO.html#1585" class="Field">forge</a>   <a id="1593" class="Symbol">:</a> <a id="1595" href="UTxOErr.UTxO.html#414" class="Function">Value</a>
<a id="1601" class="Keyword">open</a> <a id="1606" href="UTxOErr.UTxO.html#1502" class="Module">Tx</a> <a id="1609" class="Keyword">public</a>

<a id="mkTxInfo"></a><a id="1617" href="UTxOErr.UTxO.html#1617" class="Function">mkTxInfo</a> <a id="1626" class="Symbol">:</a> <a id="1628" href="UTxOErr.UTxO.html#1502" class="Record">Tx</a> <a id="1631" class="Symbol">→</a> <a id="1633" href="UTxOErr.UTxO.html#1076" class="Record">TxInfo</a>
<a id="1640" href="UTxOErr.UTxO.html#1617" class="Function">mkTxInfo</a> <a id="1649" href="UTxOErr.UTxO.html#1649" class="Bound">tx</a> <a id="1652" class="Symbol">=</a> <a id="1654" class="Keyword">record</a>
  <a id="1663" class="Symbol">{</a> <a id="1665" href="UTxOErr.UTxO.html#1104" class="Field">inputs</a>  <a id="1673" class="Symbol">=</a> <a id="1675" href="UTxOErr.UTxO.html#1333" class="Function">mkInputInfo</a> <a id="1687" href="Prelude.Functor.html#359" class="Field Operator">&lt;$&gt;</a> <a id="1691" href="UTxOErr.UTxO.html#1649" class="Bound">tx</a> <a id="1694" class="Symbol">.</a><a id="1695" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a>
  <a id="1704" class="Symbol">;</a> <a id="1706" href="UTxOErr.UTxO.html#1137" class="Field">outputs</a> <a id="1714" class="Symbol">=</a> <a id="1716" href="UTxOErr.UTxO.html#1649" class="Bound">tx</a> <a id="1719" class="Symbol">.</a><a id="1720" href="UTxOErr.UTxO.html#1557" class="Field">outputs</a>
  <a id="1730" class="Symbol">;</a> <a id="1732" href="UTxOErr.UTxO.html#1169" class="Field">forge</a>   <a id="1740" class="Symbol">=</a> <a id="1742" href="UTxOErr.UTxO.html#1649" class="Bound">tx</a> <a id="1745" class="Symbol">.</a><a id="1746" href="UTxOErr.UTxO.html#1585" class="Field">forge</a> <a id="1752" class="Symbol">}</a>

<a id="1755" class="Comment">-- A ledger is a list of transactions.</a>
<a id="L"></a><a id="1794" href="UTxOErr.UTxO.html#1794" class="Function">L</a> <a id="1796" class="Symbol">=</a> <a id="1798" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1803" href="UTxOErr.UTxO.html#1502" class="Record">Tx</a>

<a id="1807" class="Comment">-- The state of a ledger maps output references locked by a validator to a value.</a>

<a id="S"></a><a id="1890" href="UTxOErr.UTxO.html#1890" class="Function">S</a> <a id="1892" class="Symbol">:</a> <a id="1894" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="1899" href="UTxOErr.UTxO.html#1890" class="Function">S</a> <a id="1901" class="Symbol">=</a> <a id="1903" href="UTxOErr.Maps.html#471" class="Function">Map⟨</a> <a id="1908" href="UTxOErr.UTxO.html#559" class="Record">TxOutputRef</a> <a id="1920" href="UTxOErr.Maps.html#471" class="Function">↦</a> <a id="1922" href="UTxOErr.UTxO.html#757" class="Record">TxOutput</a> <a id="1931" href="UTxOErr.Maps.html#471" class="Function">⟩</a>

<a id="outputRefs"></a><a id="1934" href="UTxOErr.UTxO.html#1934" class="Function">outputRefs</a> <a id="1945" class="Symbol">:</a> <a id="1947" href="UTxOErr.UTxO.html#1502" class="Record">Tx</a> <a id="1950" class="Symbol">→</a> <a id="1952" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1957" href="UTxOErr.UTxO.html#559" class="Record">TxOutputRef</a>
<a id="1969" href="UTxOErr.UTxO.html#1934" class="Function">outputRefs</a> <a id="1980" class="Symbol">=</a> <a id="1982" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1986" href="UTxOErr.UTxO.html#1222" class="Field">outputRef</a> <a id="1996" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1998" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a>

<a id="mkUtxo"></a><a id="2006" href="UTxOErr.UTxO.html#2006" class="Function">mkUtxo</a> <a id="2013" class="Symbol">:</a> <a id="2015" class="Symbol">∀</a> <a id="2017" class="Symbol">{</a><a id="2018" href="UTxOErr.UTxO.html#2018" class="Bound">out</a><a id="2021" class="Symbol">}</a> <a id="2023" href="UTxOErr.UTxO.html#2023" class="Bound">tx</a> <a id="2026" class="Symbol">→</a> <a id="2028" href="UTxOErr.UTxO.html#2018" class="Bound">out</a> <a id="2032" href="Data.List.Membership.Setoid.html#887" class="Function Operator">L.Mem.∈</a> <a id="2040" href="UTxOErr.UTxO.html#1557" class="Field">outputs</a> <a id="2048" href="UTxOErr.UTxO.html#2023" class="Bound">tx</a> <a id="2051" class="Symbol">→</a> <a id="2053" href="UTxOErr.UTxO.html#559" class="Record">TxOutputRef</a> <a id="2065" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2067" href="UTxOErr.UTxO.html#757" class="Record">TxOutput</a>
<a id="2076" href="UTxOErr.UTxO.html#2006" class="Function">mkUtxo</a> <a id="2083" class="Symbol">{</a><a id="2084" href="UTxOErr.UTxO.html#2084" class="Bound">out</a><a id="2087" class="Symbol">}</a> <a id="2089" href="UTxOErr.UTxO.html#2089" class="Bound">tx</a> <a id="2092" href="UTxOErr.UTxO.html#2092" class="Bound">out∈</a> <a id="2097" class="Symbol">=</a> <a id="2099" class="Symbol">(</a><a id="2100" href="UTxOErr.UTxO.html#2089" class="Bound">tx</a> <a id="2103" href="UTxOErr.UTxO.html#465" class="Postulate Operator">♯</a><a id="2104" class="Symbol">)</a> <a id="2106" href="UTxOErr.UTxO.html#598" class="InductiveConstructor Operator">indexed-at</a> <a id="2117" href="Prelude.ToN.html#116" class="Field">toℕ</a> <a id="2121" class="Symbol">(</a><a id="2122" href="Data.List.Relation.Unary.Any.html#1817" class="Function">L.Any.index</a> <a id="2134" href="UTxOErr.UTxO.html#2092" class="Bound">out∈</a><a id="2138" class="Symbol">)</a>
                     <a id="2161" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2163" href="UTxOErr.UTxO.html#2084" class="Bound">out</a>

<a id="utxoTx"></a><a id="2168" href="UTxOErr.UTxO.html#2168" class="Function">utxoTx</a> <a id="2175" class="Symbol">:</a> <a id="2177" href="UTxOErr.UTxO.html#1502" class="Record">Tx</a> <a id="2180" class="Symbol">→</a> <a id="2182" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2187" class="Symbol">(</a><a id="2188" href="UTxOErr.UTxO.html#559" class="Record">TxOutputRef</a> <a id="2200" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2202" href="UTxOErr.UTxO.html#757" class="Record">TxOutput</a><a id="2210" class="Symbol">)</a>
<a id="2212" href="UTxOErr.UTxO.html#2168" class="Function">utxoTx</a> <a id="2219" href="UTxOErr.UTxO.html#2219" class="Bound">tx</a> <a id="2222" class="Symbol">=</a> <a id="2224" href="Data.List.Membership.Setoid.html#1128" class="Function">L.Mem.mapWith∈</a> <a id="2239" class="Symbol">(</a><a id="2240" href="UTxOErr.UTxO.html#2219" class="Bound">tx</a> <a id="2243" class="Symbol">.</a><a id="2244" href="UTxOErr.UTxO.html#1557" class="Field">outputs</a><a id="2251" class="Symbol">)</a> <a id="2253" class="Symbol">(</a><a id="2254" href="UTxOErr.UTxO.html#2006" class="Function">mkUtxo</a> <a id="2261" href="UTxOErr.UTxO.html#2219" class="Bound">tx</a><a id="2263" class="Symbol">)</a>

<a id="utxoTxS"></a><a id="2266" href="UTxOErr.UTxO.html#2266" class="Function">utxoTxS</a> <a id="2274" class="Symbol">:</a> <a id="2276" href="UTxOErr.UTxO.html#1502" class="Record">Tx</a> <a id="2279" class="Symbol">→</a> <a id="2281" href="UTxOErr.UTxO.html#1890" class="Function">S</a>
<a id="2283" href="UTxOErr.UTxO.html#2266" class="Function">utxoTxS</a> <a id="2291" class="Symbol">=</a> <a id="2293" href="UTxOErr.Maps.html#1180" class="Function">mkMap</a> <a id="2299" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2301" href="UTxOErr.UTxO.html#2168" class="Function">utxoTx</a>

<a id="getSpentOutput"></a><a id="2309" href="UTxOErr.UTxO.html#2309" class="Function">getSpentOutput</a> <a id="2324" class="Symbol">:</a> <a id="2326" href="UTxOErr.UTxO.html#1890" class="Function">S</a> <a id="2328" class="Symbol">→</a> <a id="2330" href="UTxOErr.UTxO.html#1193" class="Record">TxInput</a> <a id="2338" class="Symbol">→</a> <a id="2340" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2346" href="UTxOErr.UTxO.html#757" class="Record">TxOutput</a>
<a id="2355" href="UTxOErr.UTxO.html#2309" class="Function">getSpentOutput</a> <a id="2370" href="UTxOErr.UTxO.html#2370" class="Bound">s</a> <a id="2372" href="UTxOErr.UTxO.html#2372" class="Bound">i</a> <a id="2374" class="Symbol">=</a> <a id="2376" href="UTxOErr.UTxO.html#2370" class="Bound">s</a> <a id="2378" class="Symbol">(</a><a id="2379" href="UTxOErr.UTxO.html#2372" class="Bound">i</a> <a id="2381" class="Symbol">.</a><a id="2382" href="UTxOErr.UTxO.html#1222" class="Field">outputRef</a><a id="2391" class="Symbol">)</a>

<a id="∑"></a><a id="2394" href="UTxOErr.UTxO.html#2394" class="Function">∑</a> <a id="2396" class="Symbol">:</a> <a id="2398" class="Symbol">∀</a> <a id="2400" class="Symbol">{</a><a id="2401" href="UTxOErr.UTxO.html#2401" class="Bound">A</a> <a id="2403" class="Symbol">:</a> <a id="2405" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="2409" class="Symbol">}</a> <a id="2411" class="Symbol">→</a> <a id="2413" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2418" href="UTxOErr.UTxO.html#2401" class="Bound">A</a> <a id="2420" class="Symbol">→</a> <a id="2422" class="Symbol">(</a><a id="2423" href="UTxOErr.UTxO.html#2401" class="Bound">A</a> <a id="2425" class="Symbol">→</a> <a id="2427" href="UTxOErr.UTxO.html#414" class="Function">Value</a><a id="2432" class="Symbol">)</a> <a id="2434" class="Symbol">→</a> <a id="2436" href="UTxOErr.UTxO.html#414" class="Function">Value</a>
<a id="2442" href="UTxOErr.UTxO.html#2394" class="Function">∑</a> <a id="2444" href="UTxOErr.UTxO.html#2444" class="Bound">xs</a> <a id="2447" href="UTxOErr.UTxO.html#2447" class="Bound">f</a> <a id="2449" class="Symbol">=</a> <a id="2451" href="Prelude.Lists.Sums.html#283" class="Function">∑ℕ</a> <a id="2454" class="Symbol">(</a><a id="2455" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2459" href="UTxOErr.UTxO.html#2447" class="Bound">f</a> <a id="2461" href="UTxOErr.UTxO.html#2444" class="Bound">xs</a><a id="2463" class="Symbol">)</a>

<a id="∑M"></a><a id="2466" href="UTxOErr.UTxO.html#2466" class="Function">∑M</a> <a id="2469" class="Symbol">:</a> <a id="2471" class="Symbol">∀</a> <a id="2473" class="Symbol">{</a><a id="2474" href="UTxOErr.UTxO.html#2474" class="Bound">A</a> <a id="2476" class="Symbol">:</a> <a id="2478" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="2482" class="Symbol">}</a> <a id="2484" class="Symbol">→</a> <a id="2486" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2491" class="Symbol">(</a><a id="2492" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2498" href="UTxOErr.UTxO.html#2474" class="Bound">A</a><a id="2499" class="Symbol">)</a> <a id="2501" class="Symbol">→</a> <a id="2503" class="Symbol">(</a><a id="2504" href="UTxOErr.UTxO.html#2474" class="Bound">A</a> <a id="2506" class="Symbol">→</a> <a id="2508" href="UTxOErr.UTxO.html#414" class="Function">Value</a><a id="2513" class="Symbol">)</a> <a id="2515" class="Symbol">→</a> <a id="2517" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2523" href="UTxOErr.UTxO.html#414" class="Function">Value</a>
<a id="2529" href="UTxOErr.UTxO.html#2466" class="Function">∑M</a> <a id="2532" href="UTxOErr.UTxO.html#2532" class="Bound">xs</a> <a id="2535" href="UTxOErr.UTxO.html#2535" class="Bound">f</a> <a id="2537" class="Symbol">=</a> <a id="2539" class="Symbol">(</a><a id="2540" href="Function.Base.html#1554" class="Function">flip</a> <a id="2545" href="UTxOErr.UTxO.html#2394" class="Function">∑</a> <a id="2547" href="UTxOErr.UTxO.html#2535" class="Bound">f</a><a id="2548" class="Symbol">)</a> <a id="2550" href="Prelude.Functor.html#359" class="Field Operator">&lt;$&gt;</a> <a id="2554" href="UTxOErr.UTxO.html#2611" class="Function">seqM</a> <a id="2559" href="UTxOErr.UTxO.html#2532" class="Bound">xs</a>
  <a id="2564" class="Keyword">where</a>
    <a id="2574" class="Comment">-- if one fails everything fails</a>
    <a id="2611" href="UTxOErr.UTxO.html#2611" class="Function">seqM</a> <a id="2616" class="Symbol">:</a> <a id="2618" class="Symbol">∀</a> <a id="2620" class="Symbol">{</a><a id="2621" href="UTxOErr.UTxO.html#2621" class="Bound">A</a> <a id="2623" class="Symbol">:</a> <a id="2625" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="2629" class="Symbol">}</a> <a id="2631" class="Symbol">→</a> <a id="2633" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2638" class="Symbol">(</a><a id="2639" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2645" href="UTxOErr.UTxO.html#2621" class="Bound">A</a><a id="2646" class="Symbol">)</a> <a id="2648" class="Symbol">→</a> <a id="2650" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2656" class="Symbol">(</a><a id="2657" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2662" href="UTxOErr.UTxO.html#2621" class="Bound">A</a><a id="2663" class="Symbol">)</a>
    <a id="2669" href="UTxOErr.UTxO.html#2611" class="Function">seqM</a> <a id="2674" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="2683" class="Symbol">=</a> <a id="2685" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2690" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="2697" href="UTxOErr.UTxO.html#2611" class="Function">seqM</a> <a id="2702" class="Symbol">(</a><a id="2703" href="UTxOErr.UTxO.html#2703" class="Bound">x</a> <a id="2705" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2707" href="UTxOErr.UTxO.html#2707" class="Bound">xs</a><a id="2709" class="Symbol">)</a> <a id="2711" class="Symbol">=</a> <a id="2713" class="Symbol">⦇</a> <a id="2715" href="UTxOErr.UTxO.html#2703" class="Bound">x</a> <a id="2717" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2719" href="UTxOErr.UTxO.html#2611" class="Function">seqM</a> <a id="2724" href="UTxOErr.UTxO.html#2707" class="Bound">xs</a> <a id="2727" class="Symbol">⦈</a>

<a id="2730" class="Keyword">record</a> <a id="IsValidTx"></a><a id="2737" href="UTxOErr.UTxO.html#2737" class="Record">IsValidTx</a> <a id="2747" class="Symbol">(</a><a id="2748" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a> <a id="2751" class="Symbol">:</a> <a id="2753" href="UTxOErr.UTxO.html#1502" class="Record">Tx</a><a id="2755" class="Symbol">)</a> <a id="2757" class="Symbol">(</a><a id="2758" href="UTxOErr.UTxO.html#2758" class="Bound">utxos</a> <a id="2764" class="Symbol">:</a> <a id="2766" href="UTxOErr.UTxO.html#1890" class="Function">S</a><a id="2767" class="Symbol">)</a> <a id="2769" class="Symbol">:</a> <a id="2771" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="2776" class="Keyword">where</a>
  <a id="2784" class="Keyword">field</a>
    <a id="IsValidTx.validOutputRefs"></a><a id="2794" href="UTxOErr.UTxO.html#2794" class="Field">validOutputRefs</a> <a id="2810" class="Symbol">:</a>
      <a id="2818" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="2822" class="Symbol">(</a><a id="2823" href="UTxOErr.Maps.html#696" class="Function Operator">_∈ᵈ</a> <a id="2827" href="UTxOErr.UTxO.html#2758" class="Bound">utxos</a><a id="2832" class="Symbol">)</a> <a id="2834" class="Symbol">(</a><a id="2835" href="UTxOErr.UTxO.html#1934" class="Function">outputRefs</a> <a id="2846" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a><a id="2848" class="Symbol">)</a>

    <a id="IsValidTx.preservesValues"></a><a id="2855" href="UTxOErr.UTxO.html#2855" class="Field">preservesValues</a> <a id="2871" class="Symbol">:</a>
      <a id="2879" href="Data.Maybe.Relation.Unary.Any.html#830" class="Datatype">M.Any.Any</a> <a id="2889" class="Symbol">(λ</a> <a id="2892" href="UTxOErr.UTxO.html#2892" class="Bound">q</a> <a id="2894" class="Symbol">→</a> <a id="2896" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a> <a id="2899" class="Symbol">.</a><a id="2900" href="UTxOErr.UTxO.html#1585" class="Field">forge</a> <a id="2906" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2908" href="UTxOErr.UTxO.html#2892" class="Bound">q</a> <a id="2910" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2912" href="UTxOErr.UTxO.html#2394" class="Function">∑</a> <a id="2914" class="Symbol">(</a><a id="2915" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a> <a id="2918" class="Symbol">.</a><a id="2919" href="UTxOErr.UTxO.html#1557" class="Field">outputs</a><a id="2926" class="Symbol">)</a> <a id="2928" href="UTxOErr.UTxO.html#806" class="Field">value</a><a id="2933" class="Symbol">)</a>
                <a id="2951" class="Symbol">(</a><a id="2952" href="UTxOErr.UTxO.html#2466" class="Function">∑M</a> <a id="2955" class="Symbol">(</a><a id="2956" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2960" class="Symbol">(</a><a id="2961" href="UTxOErr.UTxO.html#2309" class="Function">getSpentOutput</a> <a id="2976" href="UTxOErr.UTxO.html#2758" class="Bound">utxos</a><a id="2981" class="Symbol">)</a> <a id="2983" class="Symbol">(</a><a id="2984" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a> <a id="2987" class="Symbol">.</a><a id="2988" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a><a id="2994" class="Symbol">))</a> <a id="2997" href="UTxOErr.UTxO.html#806" class="Field">value</a><a id="3002" class="Symbol">)</a>

    <a id="IsValidTx.noDoubleSpending"></a><a id="3009" href="UTxOErr.UTxO.html#3009" class="Field">noDoubleSpending</a> <a id="3026" class="Symbol">:</a>
      <a id="3034" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">Unique</a> <a id="3041" class="Symbol">(</a><a id="3042" href="UTxOErr.UTxO.html#1934" class="Function">outputRefs</a> <a id="3053" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a><a id="3055" class="Symbol">)</a>

    <a id="IsValidTx.allInputsValidate"></a><a id="3062" href="UTxOErr.UTxO.html#3062" class="Field">allInputsValidate</a> <a id="3080" class="Symbol">:</a>
      <a id="3088" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="3092" class="Symbol">(λ</a> <a id="3095" href="UTxOErr.UTxO.html#3095" class="Bound">i</a> <a id="3097" class="Symbol">→</a> <a id="3099" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="3101" class="Symbol">(</a><a id="3102" href="UTxOErr.UTxO.html#1254" class="Field">validator</a> <a id="3112" href="UTxOErr.UTxO.html#3095" class="Bound">i</a> <a id="3114" class="Symbol">(</a><a id="3115" href="UTxOErr.UTxO.html#1617" class="Function">mkTxInfo</a> <a id="3124" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a><a id="3126" class="Symbol">)</a> <a id="3128" class="Symbol">(</a><a id="3129" href="UTxOErr.UTxO.html#3095" class="Bound">i</a> <a id="3131" class="Symbol">.</a><a id="3132" href="UTxOErr.UTxO.html#1295" class="Field">redeemer</a><a id="3140" class="Symbol">)))</a>
          <a id="3154" class="Symbol">(</a><a id="3155" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a> <a id="3158" class="Symbol">.</a><a id="3159" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a><a id="3165" class="Symbol">)</a>

    <a id="IsValidTx.validateValidHashes"></a><a id="3172" href="UTxOErr.UTxO.html#3172" class="Field">validateValidHashes</a> <a id="3192" class="Symbol">:</a>
      <a id="3200" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="3204" class="Symbol">(λ</a> <a id="3207" href="UTxOErr.UTxO.html#3207" class="Bound">i</a> <a id="3209" class="Symbol">→</a> <a id="3211" href="Data.Maybe.Relation.Unary.Any.html#830" class="Datatype">M.Any.Any</a> <a id="3221" class="Symbol">(λ</a> <a id="3224" href="UTxOErr.UTxO.html#3224" class="Bound">o</a> <a id="3226" class="Symbol">→</a> <a id="3228" href="UTxOErr.UTxO.html#3224" class="Bound">o</a> <a id="3230" class="Symbol">.</a><a id="3231" href="UTxOErr.UTxO.html#831" class="Field">address</a> <a id="3239" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3241" href="UTxOErr.UTxO.html#3207" class="Bound">i</a> <a id="3243" class="Symbol">.</a><a id="3244" href="UTxOErr.UTxO.html#1254" class="Field">validator</a> <a id="3254" href="UTxOErr.UTxO.html#465" class="Postulate Operator">♯</a><a id="3255" class="Symbol">)</a> <a id="3257" class="Symbol">(</a><a id="3258" href="UTxOErr.UTxO.html#2309" class="Function">getSpentOutput</a> <a id="3273" href="UTxOErr.UTxO.html#2758" class="Bound">utxos</a> <a id="3279" href="UTxOErr.UTxO.html#3207" class="Bound">i</a><a id="3280" class="Symbol">))</a>
          <a id="3293" class="Symbol">(</a><a id="3294" href="UTxOErr.UTxO.html#2748" class="Bound">tx</a> <a id="3297" class="Symbol">.</a><a id="3298" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a><a id="3304" class="Symbol">)</a>

<a id="3307" class="Keyword">open</a> <a id="3312" href="UTxOErr.UTxO.html#2737" class="Module">IsValidTx</a> <a id="3322" class="Keyword">public</a>

<a id="isValidTx?"></a><a id="3330" href="UTxOErr.UTxO.html#3330" class="Function">isValidTx?</a> <a id="3341" class="Symbol">:</a> <a id="3343" class="Symbol">∀</a> <a id="3345" href="UTxOErr.UTxO.html#3345" class="Bound">tx</a> <a id="3348" href="UTxOErr.UTxO.html#3348" class="Bound">s</a> <a id="3350" class="Symbol">→</a> <a id="3352" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="3356" class="Symbol">(</a><a id="3357" href="UTxOErr.UTxO.html#2737" class="Record">IsValidTx</a> <a id="3367" href="UTxOErr.UTxO.html#3345" class="Bound">tx</a> <a id="3370" href="UTxOErr.UTxO.html#3348" class="Bound">s</a><a id="3371" class="Symbol">)</a>
<a id="3373" href="UTxOErr.UTxO.html#3330" class="Function">isValidTx?</a> <a id="3384" href="UTxOErr.UTxO.html#3384" class="Bound">tx</a> <a id="3387" href="UTxOErr.UTxO.html#3387" class="Bound">utxos</a>
  <a id="3395" class="Keyword">with</a> <a id="3400" href="Data.List.Relation.Unary.All.html#6240" class="Function">all?</a> <a id="3405" class="Symbol">(</a><a id="3406" href="UTxOErr.Maps.html#767" class="Function Operator">_∈ᵈ?</a> <a id="3411" href="UTxOErr.UTxO.html#3387" class="Bound">utxos</a><a id="3416" class="Symbol">)</a> <a id="3418" class="Symbol">(</a><a id="3419" href="UTxOErr.UTxO.html#1934" class="Function">outputRefs</a> <a id="3430" href="UTxOErr.UTxO.html#3384" class="Bound">tx</a><a id="3432" class="Symbol">)</a>
<a id="3434" class="Symbol">...</a> <a id="3438" class="Symbol">|</a> <a id="3440" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3443" href="UTxOErr.UTxO.html#3443" class="Bound">¬p</a> <a id="3446" class="Symbol">=</a> <a id="3448" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3451" class="Symbol">(</a><a id="3452" href="UTxOErr.UTxO.html#3443" class="Bound">¬p</a> <a id="3455" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3457" href="UTxOErr.UTxO.html#2794" class="Field">validOutputRefs</a> <a id="3473" class="Symbol">)</a>
<a id="3475" class="Symbol">...</a> <a id="3479" class="Symbol">|</a> <a id="3481" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3485" href="UTxOErr.UTxO.html#3485" class="Bound">p₁</a>
  <a id="3490" class="Keyword">with</a> <a id="3495" href="Data.Maybe.Relation.Unary.Any.html#2128" class="Function">M.Any.dec</a> <a id="3505" class="Symbol">(λ</a> <a id="3508" href="UTxOErr.UTxO.html#3508" class="Bound">q</a> <a id="3510" class="Symbol">→</a> <a id="3512" class="Bound">tx</a> <a id="3515" class="Symbol">.</a><a id="3516" href="UTxOErr.UTxO.html#1585" class="Field">forge</a> <a id="3522" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3524" href="UTxOErr.UTxO.html#3508" class="Bound">q</a> <a id="3526" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="3528" href="UTxOErr.UTxO.html#2394" class="Function">∑</a> <a id="3530" class="Symbol">(</a><a id="3531" class="Bound">tx</a> <a id="3534" class="Symbol">.</a><a id="3535" href="UTxOErr.UTxO.html#1557" class="Field">outputs</a><a id="3542" class="Symbol">)</a> <a id="3544" href="UTxOErr.UTxO.html#806" class="Field">value</a><a id="3549" class="Symbol">)</a>
                 <a id="3568" class="Symbol">(</a><a id="3569" href="UTxOErr.UTxO.html#2466" class="Function">∑M</a> <a id="3572" class="Symbol">(</a><a id="3573" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3577" class="Symbol">(</a><a id="3578" href="UTxOErr.UTxO.html#2309" class="Function">getSpentOutput</a> <a id="3593" class="Bound">utxos</a><a id="3598" class="Symbol">)</a> <a id="3600" class="Symbol">(</a><a id="3601" class="Bound">tx</a> <a id="3604" class="Symbol">.</a><a id="3605" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a><a id="3611" class="Symbol">))</a> <a id="3614" href="UTxOErr.UTxO.html#806" class="Field">value</a><a id="3619" class="Symbol">)</a>
<a id="3621" class="Symbol">...</a> <a id="3625" class="Symbol">|</a> <a id="3627" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3630" href="UTxOErr.UTxO.html#3630" class="Bound">¬p</a> <a id="3633" class="Symbol">=</a> <a id="3635" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3638" class="Symbol">(</a><a id="3639" href="UTxOErr.UTxO.html#3630" class="Bound">¬p</a> <a id="3642" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3644" href="UTxOErr.UTxO.html#2855" class="Field">preservesValues</a><a id="3659" class="Symbol">)</a>
<a id="3661" class="Symbol">...</a> <a id="3665" class="Symbol">|</a> <a id="3667" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3671" href="UTxOErr.UTxO.html#3671" class="Bound">p₂</a>
  <a id="3676" class="Keyword">with</a> <a id="3681" href="Prelude.DecLists.html#1474" class="Function">unique?</a> <a id="3689" class="Symbol">(</a><a id="3690" href="UTxOErr.UTxO.html#1934" class="Function">outputRefs</a> <a id="3701" class="Bound">tx</a><a id="3703" class="Symbol">)</a>
<a id="3705" class="Symbol">...</a> <a id="3709" class="Symbol">|</a> <a id="3711" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3714" href="UTxOErr.UTxO.html#3714" class="Bound">¬p</a> <a id="3717" class="Symbol">=</a> <a id="3719" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3722" class="Symbol">(</a><a id="3723" href="UTxOErr.UTxO.html#3714" class="Bound">¬p</a> <a id="3726" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3728" href="UTxOErr.UTxO.html#3009" class="Field">noDoubleSpending</a><a id="3744" class="Symbol">)</a>
<a id="3746" class="Symbol">...</a> <a id="3750" class="Symbol">|</a> <a id="3752" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3756" href="UTxOErr.UTxO.html#3756" class="Bound">p₃</a>
  <a id="3761" class="Keyword">with</a> <a id="3766" href="Data.List.Relation.Unary.All.html#6240" class="Function">all?</a> <a id="3771" class="Symbol">(λ</a> <a id="3774" href="UTxOErr.UTxO.html#3774" class="Bound">i</a> <a id="3776" class="Symbol">→</a> <a id="3778" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="3781" class="Symbol">(</a><a id="3782" href="UTxOErr.UTxO.html#1254" class="Field">validator</a> <a id="3792" href="UTxOErr.UTxO.html#3774" class="Bound">i</a> <a id="3794" class="Symbol">(</a><a id="3795" href="UTxOErr.UTxO.html#1617" class="Function">mkTxInfo</a> <a id="3804" class="Bound">tx</a><a id="3806" class="Symbol">)</a> <a id="3808" class="Symbol">(</a><a id="3809" href="UTxOErr.UTxO.html#3774" class="Bound">i</a> <a id="3811" class="Symbol">.</a><a id="3812" href="UTxOErr.UTxO.html#1295" class="Field">redeemer</a><a id="3820" class="Symbol">)))</a>
            <a id="3836" class="Symbol">(</a><a id="3837" class="Bound">tx</a> <a id="3840" class="Symbol">.</a><a id="3841" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a><a id="3847" class="Symbol">)</a>
<a id="3849" class="Symbol">...</a> <a id="3853" class="Symbol">|</a> <a id="3855" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3858" href="UTxOErr.UTxO.html#3858" class="Bound">¬p</a> <a id="3861" class="Symbol">=</a> <a id="3863" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3866" class="Symbol">(</a><a id="3867" href="UTxOErr.UTxO.html#3858" class="Bound">¬p</a> <a id="3870" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3872" href="UTxOErr.UTxO.html#3062" class="Field">allInputsValidate</a><a id="3889" class="Symbol">)</a>
<a id="3891" class="Symbol">...</a> <a id="3895" class="Symbol">|</a> <a id="3897" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3901" href="UTxOErr.UTxO.html#3901" class="Bound">p₄</a>
  <a id="3906" class="Keyword">with</a> <a id="3911" href="Data.List.Relation.Unary.All.html#6240" class="Function">all?</a> <a id="3916" class="Symbol">(λ</a> <a id="3919" href="UTxOErr.UTxO.html#3919" class="Bound">i</a> <a id="3921" class="Symbol">→</a> <a id="3923" href="Data.Maybe.Relation.Unary.Any.html#2128" class="Function">M.Any.dec</a> <a id="3933" class="Symbol">(λ</a> <a id="3936" href="UTxOErr.UTxO.html#3936" class="Bound">o</a> <a id="3938" class="Symbol">→</a> <a id="3940" href="UTxOErr.UTxO.html#3936" class="Bound">o</a> <a id="3942" class="Symbol">.</a><a id="3943" href="UTxOErr.UTxO.html#831" class="Field">address</a> <a id="3951" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="3953" href="UTxOErr.UTxO.html#3919" class="Bound">i</a> <a id="3955" class="Symbol">.</a><a id="3956" href="UTxOErr.UTxO.html#1254" class="Field">validator</a> <a id="3966" href="UTxOErr.UTxO.html#465" class="Postulate Operator">♯</a><a id="3967" class="Symbol">)</a> <a id="3969" class="Symbol">(</a><a id="3970" href="UTxOErr.UTxO.html#2309" class="Function">getSpentOutput</a> <a id="3985" class="Bound">utxos</a> <a id="3991" href="UTxOErr.UTxO.html#3919" class="Bound">i</a><a id="3992" class="Symbol">))</a>
            <a id="4007" class="Symbol">(</a><a id="4008" class="Bound">tx</a> <a id="4011" class="Symbol">.</a><a id="4012" href="UTxOErr.UTxO.html#1530" class="Field">inputs</a><a id="4018" class="Symbol">)</a>
<a id="4020" class="Symbol">...</a> <a id="4024" class="Symbol">|</a> <a id="4026" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4029" href="UTxOErr.UTxO.html#4029" class="Bound">¬p</a> <a id="4032" class="Symbol">=</a> <a id="4034" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4037" class="Symbol">(</a><a id="4038" href="UTxOErr.UTxO.html#4029" class="Bound">¬p</a> <a id="4041" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4043" href="UTxOErr.UTxO.html#3172" class="Field">validateValidHashes</a><a id="4062" class="Symbol">)</a>
<a id="4064" class="Symbol">...</a> <a id="4068" class="Symbol">|</a> <a id="4070" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4074" href="UTxOErr.UTxO.html#4074" class="Bound">p₅</a> <a id="4077" class="Symbol">=</a> <a id="4079" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4083" class="Keyword">record</a> <a id="4090" class="Symbol">{</a><a id="4091" href="UTxOErr.UTxO.html#2794" class="Field">validOutputRefs</a> <a id="4107" class="Symbol">=</a> <a id="4109" class="Bound">p₁</a><a id="4111" class="Symbol">;</a> <a id="4113" href="UTxOErr.UTxO.html#2855" class="Field">preservesValues</a> <a id="4129" class="Symbol">=</a> <a id="4131" class="Bound">p₂</a><a id="4133" class="Symbol">;</a> <a id="4135" href="UTxOErr.UTxO.html#3009" class="Field">noDoubleSpending</a> <a id="4152" class="Symbol">=</a> <a id="4154" class="Bound">p₃</a><a id="4156" class="Symbol">;</a> <a id="4158" href="UTxOErr.UTxO.html#3062" class="Field">allInputsValidate</a> <a id="4176" class="Symbol">=</a> <a id="4178" class="Bound">p₄</a><a id="4180" class="Symbol">;</a> <a id="4182" href="UTxOErr.UTxO.html#3172" class="Field">validateValidHashes</a> <a id="4202" class="Symbol">=</a> <a id="4204" href="UTxOErr.UTxO.html#4074" class="Bound">p₅</a><a id="4206" class="Symbol">}</a>

<a id="isValidTx"></a><a id="4209" href="UTxOErr.UTxO.html#4209" class="Function">isValidTx</a> <a id="4219" class="Symbol">:</a> <a id="4221" href="UTxOErr.UTxO.html#1502" class="Record">Tx</a> <a id="4224" class="Symbol">→</a> <a id="4226" href="UTxOErr.UTxO.html#1890" class="Function">S</a> <a id="4228" class="Symbol">→</a> <a id="4230" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="4235" href="UTxOErr.UTxO.html#4209" class="Function">isValidTx</a> <a id="4245" href="UTxOErr.UTxO.html#4245" class="Bound">tx</a> <a id="4248" href="UTxOErr.UTxO.html#4248" class="Bound">s</a> <a id="4250" class="Symbol">=</a> <a id="4252" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="4254" href="UTxOErr.UTxO.html#3330" class="Function">isValidTx?</a> <a id="4265" href="UTxOErr.UTxO.html#4245" class="Bound">tx</a> <a id="4268" href="UTxOErr.UTxO.html#4248" class="Bound">s</a> <a id="4270" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
</pre></body></html>